
<!DOCTYPE HTML>
<html lang="zh" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>第二章 探索扫描 · Kali Linux 网络扫描秘籍</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        <meta name="author" content="wizardforcel">
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-comment/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="ch3.html" />
    
    
    <link rel="prev" href="ch1.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="輸入並搜尋" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://www.gitbook.com/book/wizardforcel/kali-linux-network-scanning-cookbook" target="_blank" class="custom-link">Kali Linux 网络扫描秘籍</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Kali Linux 网络扫描秘籍 中文版
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="ch1.html">
            
                <a href="ch1.html">
            
                    
                    第一章 起步
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3" data-path="ch2.html">
            
                <a href="ch2.html">
            
                    
                    第二章 探索扫描
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="ch3.html">
            
                <a href="ch3.html">
            
                    
                    第三章 端口扫描
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="ch4.html">
            
                <a href="ch4.html">
            
                    
                    第四章 指纹识别
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="ch5.html">
            
                <a href="ch5.html">
            
                    
                    第五章 漏洞扫描
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="ch6.html">
            
                <a href="ch6.html">
            
                    
                    第六章 拒绝服务
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="ch7.html">
            
                <a href="ch7.html">
            
                    
                    第七章 Web 应用扫描
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="ch8.html">
            
                <a href="ch8.html">
            
                    
                    第八章 自动化 Kali 工具
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本書使用 GitBook 釋出
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >第二章 探索扫描</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="&#x7B2C;&#x4E8C;&#x7AE0;-&#x63A2;&#x7D22;&#x626B;&#x63CF;">&#x7B2C;&#x4E8C;&#x7AE0; &#x63A2;&#x7D22;&#x626B;&#x63CF;</h1>
<blockquote>
<p>&#x4F5C;&#x8005;&#xFF1A;Justin Hutchens</p>
<p>&#x8BD1;&#x8005;&#xFF1A;<a href="https://github.com/" target="_blank">&#x98DE;&#x9F99;</a></p>
<p>&#x534F;&#x8BAE;&#xFF1A;<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></p>
</blockquote>
<h2 id="21-&#x4F7F;&#x7528;-scapy-&#x63A2;&#x7D22;&#x7B2C;&#x4E8C;&#x5C42;">2.1 &#x4F7F;&#x7528; Scapy &#x63A2;&#x7D22;&#x7B2C;&#x4E8C;&#x5C42;</h2>
<p>Scapy &#x662F;&#x4E00;&#x4E2A;&#x5F3A;&#x5927;&#x7684;&#x4EA4;&#x4E92;&#x5DE5;&#x5177;&#xFF0C;&#x53EF;&#x7528;&#x4E8E;&#x6355;&#x83B7;&#xFF0C;&#x5206;&#x6790;&#xFF0C;&#x64CD;&#x4F5C;&#x751A;&#x81F3;&#x521B;&#x5EFA;&#x534F;&#x8BAE;&#x517C;&#x5BB9;&#x7684;&#x7F51;&#x7EDC;&#x6D41;&#x91CF;&#xFF0C;&#x7136;&#x540E;&#x6CE8;&#x5165;&#x5230;&#x7F51;&#x7EDC;&#x4E2D;&#x3002; Scapy &#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x5728; Python &#x4E2D;&#x4F7F;&#x7528;&#x7684;&#x5E93;&#xFF0C;&#x4ECE;&#x800C;&#x63D0;&#x4F9B;&#x521B;&#x5EFA;&#x9AD8;&#x6548;&#x7684;&#x811A;&#x672C;&#xFF0C;&#x6765;&#x6267;&#x884C;&#x7F51;&#x7EDC;&#x6D41;&#x91CF;&#x5904;&#x7406;&#x548C;&#x64CD;&#x4F5C;&#x7684;&#x51FD;&#x6570;&#x3002; &#x8FD9;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x79D8;&#x7C4D;&#x6F14;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x4F7F;&#x7528; Scapy &#x6267;&#x884C; ARP &#x53D1;&#x73B0;&#xFF0C;&#x4EE5;&#x53CA;&#x5982;&#x4F55;&#x4F7F;&#x7528;P ython &#x548C; Scapy &#x521B;&#x5EFA;&#x811A;&#x672C;&#x6765;&#x7B80;&#x5316;&#x7B2C;&#x4E8C;&#x5C42;&#x53D1;&#x73B0;&#x8FC7;&#x7A0B;&#x3002;</p>
<h3 id="&#x51C6;&#x5907;">&#x51C6;&#x5907;</h3>
<p>&#x8981;&#x4F7F;&#x7528; Scapy &#x6267;&#x884C; ARP &#x53D1;&#x73B0;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x5728; LAN &#x4E0A;&#x81F3;&#x5C11;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x54CD;&#x5E94; ARP &#x8BF7;&#x6C42;&#x7684;&#x7CFB;&#x7EDF;&#x3002; &#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4F7F;&#x7528; Linux &#x548C; Windows &#x7CFB;&#x7EDF;&#x7684;&#x7EC4;&#x5408;&#x3002; &#x6709;&#x5173;&#x5728;&#x672C;&#x5730;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x8BBE;&#x7F6E;&#x7CFB;&#x7EDF;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x5165;&#x4E2D;&#x7684;&#x201C;&#x5B89;&#x88C5; Metasploitable2&#x201D;&#x548C;&#x201C;&#x5B89;&#x88C5; Windows Server&#x201D;&#x79D8;&#x7C4D;&#x3002;</p>
<p>&#x6B64;&#x5916;&#xFF0C;&#x672C;&#x8282;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#xFF08;&#x5982; VIM &#x6216; Nano&#xFF09;&#x5C06;&#x811A;&#x672C;&#x5199;&#x5165;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3002; &#x6709;&#x5173;&#x7F16;&#x5199;&#x811A;&#x672C;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x5165;&#x95E8;&#x4E2D;&#x7684;&#x201C;&#x4F7F;&#x7528;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#xFF08;VIM &#x548C; Nano&#xFF09;&#x201D;&#x79D8;&#x7C4D;&#x3002;</p>
<h3 id="&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;">&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;</h3>
<p>&#x4E3A;&#x4E86;&#x4E86;&#x89E3; ARP &#x53D1;&#x73B0;&#x7684;&#x5DE5;&#x4F5C;&#x539F;&#x7406;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528; Scapy &#x6765;&#x5F00;&#x53D1;&#x81EA;&#x5B9A;&#x4E49;&#x6570;&#x636E;&#x5305;&#xFF0C;&#x8FD9;&#x5141;&#x8BA9;&#x6211;&#x4EEC;&#x80FD;&#x591F;&#x4F7F;&#x7528; ARP &#x8BC6;&#x522B; LAN &#x4E0A;&#x7684;&#x4E3B;&#x673A;&#x3002; &#x8981;&#x5728; Kali Linux &#x4E2D;&#x5F00;&#x59CB;&#x4F7F;&#x7528; Scapy&#xFF0C;&#x8BF7;&#x4ECE;&#x7EC8;&#x7AEF;&#x8F93;&#x5165;<code>scapy</code>&#x547D;&#x4EE4;&#x3002; &#x7136;&#x540E;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>display()</code>&#x51FD;&#x6570;&#x4EE5;&#x4E0B;&#x5217;&#x65B9;&#x5F0F;&#x67E5;&#x770B;&#x5728; Scapy &#x4E2D;&#x521B;&#x5EFA;&#x7684;&#x4EFB;&#x4F55; ARP &#x5BF9;&#x8C61;&#x7684;&#x9ED8;&#x8BA4;&#x914D;&#x7F6E;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# scapy Welcome to Scapy (2.2.0) 
&gt;&gt;&gt; ARP().display() 
###[ ARP ]###
  hwtype= 0x1
  ptype= 0x800
  hwlen= 6
  plen= 4
  op= who-has
  hwsrc= 00:0c:29:fd:01:05
  psrc= 172.16.36.232
  hwdst= 00:00:00:00:00:00
  pdst= 0.0.0.0
</code></pre><p>&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;IP &#x548C; MAC &#x6E90;&#x5730;&#x5740;&#x90FD;&#x4F1A;&#x81EA;&#x52A8;&#x914D;&#x7F6E;&#x4E3A;&#x4E0E;&#x8FD0;&#x884C; Scapy &#x7684;&#x4E3B;&#x673A;&#x76F8;&#x5173;&#x7684;&#x503C;&#x3002; &#x9664;&#x975E;&#x4F60;&#x9700;&#x8981;&#x4F2A;&#x9020;&#x6E90;&#x5730;&#x5740;&#xFF0C;&#x5426;&#x5219;&#x5BF9;&#x4E8E;&#x4EFB;&#x4F55; Scapy &#x5BF9;&#x8C61;&#x6C38;&#x8FDC;&#x4E0D;&#x5FC5;&#x66F4;&#x6539;&#x8FD9;&#x4E9B;&#x503C;&#x3002; ARP &#x7684;&#x9ED8;&#x8BA4;&#x64CD;&#x4F5C;&#x7801;&#x503C;&#x88AB;&#x81EA;&#x52A8;&#x8BBE;&#x7F6E;&#x4E3A;<code>who-has</code>&#xFF0C;&#x8868;&#x660E;&#x8BE5;&#x5C01;&#x5305;&#x7528;&#x4E8E;&#x8BF7;&#x6C42; IP &#x548C; MAC &#x5173;&#x8054;&#x3002; &#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x63D0;&#x4F9B;&#x7684;&#x552F;&#x4E00;&#x503C;&#x662F;&#x76EE;&#x6807; IP &#x5730;&#x5740;&#x3002; &#x4E3A;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; ARP &#x51FD;&#x6570;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x5C06;&#x5176;&#x8D4B;&#x7ED9;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x3002; &#x53D8;&#x91CF;&#x7684;&#x540D;&#x79F0;&#x662F;&#x65E0;&#x6240;&#x8C13;&#xFF08;&#x5728;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528;&#x53D8;&#x91CF;&#x540D;&#x79F0;<code>arp_request</code>&#xFF09;&#x3002; &#x770B;&#x770B;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#xFF1A;</p>
<pre><code>&gt;&gt;&gt; arp_request = ARP() 
&gt;&gt;&gt; arp_request.pdst = &quot;172.16.36.135&quot; 
&gt;&gt;&gt; arp_request.display() 
###[ ARP ]###
  hwtype= 0x1
  ptype= 0x800
  hwlen= 6
  plen= 4
  op= who-has
  hwsrc= 00:0c:29:65:fc:d2
  psrc= 172.16.36.132
  hwdst= 00:00:00:00:00:00
  pdst= 172.16.36.135
</code></pre><p>&#x6CE8;&#x610F;&#xFF0C;<code>display()</code>&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x5728;&#x65B0;&#x521B;&#x5EFA;&#x7684; ARP &#x5BF9;&#x8C61;&#x4E0A;&#x8C03;&#x7528;&#xFF0C;&#x6765;&#x9A8C;&#x8BC1;&#x914D;&#x7F6E;&#x503C;&#x662F;&#x5426;&#x5DF2;&#x66F4;&#x65B0;&#x3002; &#x5BF9;&#x4E8E;&#x6B64;&#x7EC3;&#x4E60;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;&#x4E0E;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x7F51;&#x7EDC;&#x4E2D;&#x7684;&#x6D3B;&#x52A8;&#x8BA1;&#x7B97;&#x673A;&#x5BF9;&#x5E94;&#x7684;&#x76EE;&#x6807; IP &#x5730;&#x5740;&#x3002; &#x7136;&#x540E;<code>sr1()</code>&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x53D1;&#x9001;&#x8BF7;&#x6C42;&#x5E76;&#x8FD4;&#x56DE;&#x7B2C;&#x4E00;&#x4E2A;&#x54CD;&#x5E94;&#xFF1A;</p>
<pre><code>&gt;&gt;&gt; sr1(arp_request) 
Begin emission: 
......................................*
Finished to send 1 packets.

Received 39 packets, got 1 answers, remaining 0 packets 
&lt;ARP  hwtype=0x1 ptype=0x800 hwlen=6 plen=4 op=is-at hwsrc=00:0c:29:3d:84:32 psrc=172.16.36.135 hwdst=00:0c:29:65:fc:d2 pdst=172.16.36.132 |&lt;Padding  load=&apos;\x00\x00\x00\x00\x00\x00\x00\x00\x00\ x00\x00\x00\x00\x00\x00\x00\x00\x00&apos; |&gt;&gt;
</code></pre><p>&#x6216;&#x8005;&#xFF0C;&#x6A21;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x8BE5;&#x51FD;&#x6570;&#xFF0C;&#x5E76;&#x5C06;&#x4EFB;&#x4F55;&#x7279;&#x6B8A;&#x914D;&#x7F6E;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x7ED9;&#x5B83;&#xFF0C;&#x6765;&#x6267;&#x884C;&#x76F8;&#x540C;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x5982;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#x6240;&#x793A;&#x3002; &#x8FD9;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x4F7F;&#x7528;&#x4E0D;&#x5FC5;&#x8981;&#x7684;&#x53D8;&#x91CF;&#x7684;&#x6DF7;&#x4E71;&#xFF0C;&#x5E76;&#x4E14;&#x8FD8;&#x53EF;&#x4EE5;&#x5728;&#x5355;&#x884C;&#x4EE3;&#x7801;&#x4E2D;&#x5B8C;&#x6210;&#x6574;&#x4E2A;&#x4EFB;&#x52A1;&#xFF1A;</p>
<pre><code>&gt;&gt;&gt; sr1(ARP(pdst=&quot;172.16.36.135&quot;)) 
Begin emission: .........................*
Finished to send 1 packets.

Received 26 packets, got 1 answers, remaining 0 packets 
&lt;ARP  hwtype=0x1 ptype=0x800 hwlen=6 plen=4 op=is-at hwsrc=00:0c:29:3d:84:32 psrc=172.16.36.135 hwdst=00:0c:29:65:fc:d2 pdst=172.16.36.132 |&lt;Padding  load=&apos;\x00\x00\x00\x00\x00\x00\x00\x00\x00\ x00\x00\x00\x00\x00\x00\x00\x00\x00&apos; |&gt;&gt;
</code></pre><p>&#x6CE8;&#x610F;&#xFF0C;&#x5728;&#x8FD9;&#x4E9B;&#x60C5;&#x51B5;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x4E2D;&#xFF0C;&#x8FD4;&#x56DE;&#x54CD;&#x5E94;&#x8868;&#x660E;&#xFF0C;<code>172.16.36.135</code>&#x7684; IP &#x5730;&#x5740;&#x7684; MAC &#x5730;&#x5740;&#x4E3A;<code>00&#xFF1A;0C&#xFF1A;29&#xFF1A;3D&#xFF1A;84&#xFF1A;32</code>&#x3002; &#x5982;&#x679C;&#x6267;&#x884C;&#x76F8;&#x540C;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x4F46;&#x662F;&#x76EE;&#x6807; IP &#x5730;&#x5740;&#x4E0D;&#x5BF9;&#x5E94;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x7F51;&#x7EDC;&#x4E0A;&#x7684;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#xFF0C;&#x5219;&#x4E0D;&#x4F1A;&#x6536;&#x5230;&#x4EFB;&#x4F55;&#x54CD;&#x5E94;&#xFF0C;&#x5E76;&#x4E14;&#x8BE5;&#x529F;&#x80FD;&#x5C06;&#x65E0;&#x9650;&#x7EE7;&#x7EED;&#x5206;&#x6790;&#x672C;&#x5730;&#x63A5;&#x53E3;&#x4E0A;&#x4F20;&#x5165;&#x7684;&#x6D41;&#x91CF; &#x3002;</p>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>Ctrl + C</code>&#x5F3A;&#x5236;&#x505C;&#x6B62;&#x8BE5;&#x51FD;&#x6570;&#x3002;&#x6216;&#x8005;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;<code>timeout</code>&#x53C2;&#x6570;&#x6765;&#x907F;&#x514D;&#x6B64;&#x95EE;&#x9898;&#x3002; &#x5F53; Scapy &#x5728;P ython &#x811A;&#x672C;&#x4E2D;&#x4F7F;&#x7528;&#x65F6;&#xFF0C;&#x8D85;&#x65F6;&#x7684;&#x4F7F;&#x7528;&#x5C06;&#x53D8;&#x5F97;&#x81F3;&#x5173;&#x91CD;&#x8981;&#x3002; &#x8981;&#x4F7F;&#x7528;&#x8D85;&#x65F6;&#xFF0C;&#x5E94;&#x5411;&#x53D1;&#x9001;/&#x63A5;&#x6536;&#x51FD;&#x6570;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x9644;&#x52A0;&#x53C2;&#x6570;&#xFF0C;&#x6307;&#x5B9A;&#x7B49;&#x5F85;&#x4F20;&#x5165;&#x54CD;&#x5E94;&#x7684;&#x79D2;&#x6570;&#xFF1A;</p>
<pre><code>&gt;&gt;&gt; arp_request.pdst = &quot;172.16.36.134&quot; 
&gt;&gt;&gt; sr1(arp_request, timeout=1) 
Begin emission: 
......................................................................... ............
Finished to send 1 packets. 
................................. ......................................................................... ........................................ 
Received 3285 packets, got 0 answers, remaining 1 packets 
&gt;&gt;&gt;
</code></pre><p>&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x8D85;&#x65F6;&#x529F;&#x80FD;&#xFF0C;&#x53D1;&#x9001;&#x5230;&#x975E;&#x54CD;&#x5E94;&#x4E3B;&#x673A;&#x7684;&#x8BF7;&#x6C42;&#x5C06;&#x5728;&#x6307;&#x5B9A;&#x7684;&#x65F6;&#x95F4;&#x4E4B;&#x540E;&#x8FD4;&#x56DE;&#xFF0C;&#x5E76;&#x663E;&#x793A;&#x6355;&#x83B7;&#x5230; 0 &#x4E2A;&#x5E94;&#x7B54;&#x3002; &#x6B64;&#x5916;&#xFF0C;&#x6B64;&#x51FD;&#x6570;&#x6536;&#x5230;&#x7684;&#x54CD;&#x5E94;&#x4E5F;&#x53EF;&#x4EE5;&#x8D4B;&#x7ED9;&#x53D8;&#x91CF;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8BBF;&#x95EE;&#x6B64;&#x53D8;&#x91CF;&#x5BF9;&#x54CD;&#x5E94;&#x6267;&#x884C;&#x540E;&#x7EED;&#x5904;&#x7406;&#xFF1A;</p>
<pre><code>&gt;&gt;&gt; response = sr1(arp_request, timeout=1) 
Begin emission: 
....................................*
Finished to send 1 packets.

Received 37 packets, got 1 answers, remaining 0 packets 
&gt;&gt;&gt; response.display() 
###[ ARP ]###  
  hwtype= 0x1
  ptype= 0x800
  hwlen= 6
  plen= 4
  op= is-at
  hwsrc= 00:0c:29:3d:84:32
  psrc= 172.16.36.135
  hwdst= 00:0c:29:65:fc:d2
  pdst= 172.16.36.132 
###[ Padding ]###
     load= &apos;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\ x00\x00\x00&apos;
</code></pre><p>Scapy&#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x4F5C; Python &#x811A;&#x672C;&#x8BED;&#x8A00;&#x4E2D;&#x7684;&#x5E93;&#x3002; &#x8FD9;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x9AD8;&#x6548;&#x81EA;&#x52A8;&#x6267;&#x884C; Scapy &#x4E2D;&#x6267;&#x884C;&#x7684;&#x5197;&#x4F59;&#x4EFB;&#x52A1;&#x3002; Python &#x548C; Scapy &#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x5FAA;&#x73AF;&#x904D;&#x5386;&#x672C;&#x5730;&#x5B50;&#x7F51;&#x5185;&#x7684;&#x6BCF;&#x4E2A;&#x53EF;&#x80FD;&#x7684;&#x4E3B;&#x673A;&#x5730;&#x5740;&#xFF0C;&#x5E76;&#x5411;&#x6BCF;&#x4E2A;&#x5B50;&#x7F51;&#x53D1;&#x9001; ARP &#x8BF7;&#x6C42;&#x3002; &#x4E0B;&#x9762;&#x7684;&#x793A;&#x4F8B;&#x811A;&#x672C;&#x53EF;&#x7528;&#x4E8E;&#x5728;&#x4E3B;&#x673A;&#x7684;&#x8FDE;&#x7EED;&#x5E8F;&#x5217;&#x4E0A;&#x6267;&#x884C;&#x7B2C;&#x4E8C;&#x5C42;&#x53D1;&#x73B0;&#xFF1A;</p>
<pre><code class="lang-py"><span class="hljs-comment">#!/usr/bin/python</span>

<span class="hljs-keyword">import</span> logging 
<span class="hljs-keyword">import</span> subprocess 
logging.getLogger(<span class="hljs-string">&quot;scapy.runtime&quot;</span>).setLevel(logging.ERROR) 
<span class="hljs-keyword">from</span> scapy.all <span class="hljs-keyword">import</span> *

<span class="hljs-keyword">if</span> len(sys.argv) != <span class="hljs-number">2</span>:   
    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Usage - ./arp_disc.py [interface]&quot;</span>   
    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Example - ./arp_disc.py eth0&quot;</span>   
    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Example will perform an ARP scan of the local subnet to which eth0 is assigned&quot;</span>   
    sys.exit()

interface = str(sys.argv[<span class="hljs-number">1</span>])

ip = subprocess.check_output(<span class="hljs-string">&quot;ifconfig &quot;</span> + interface + <span class="hljs-string">&quot; | grep &apos;inet addr&apos; | cut -d &apos;:&apos; -f 2 | cut -d &apos; &apos; -f 1&quot;</span>, shell=<span class="hljs-keyword">True</span>).strip() 
prefix = ip.split(<span class="hljs-string">&apos;.&apos;</span>)[<span class="hljs-number">0</span>] + <span class="hljs-string">&apos;.&apos;</span> + ip.split(<span class="hljs-string">&apos;.&apos;</span>)[<span class="hljs-number">1</span>] + <span class="hljs-string">&apos;.&apos;</span> + ip.split(<span class="hljs-string">&apos;.&apos;</span>)[<span class="hljs-number">2</span>] + <span class="hljs-string">&apos;.&apos;</span>

<span class="hljs-keyword">for</span> addr <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,<span class="hljs-number">254</span>):   
    answer=sr1(ARP(pdst=prefix+str(addr)),timeout=<span class="hljs-number">1</span>,verbose=<span class="hljs-number">0</span>)      
    <span class="hljs-keyword">if</span> answer == <span class="hljs-keyword">None</span>:        
        <span class="hljs-keyword">pass</span>    
    <span class="hljs-keyword">else</span>:    
        <span class="hljs-keyword">print</span> prefix+str(addr)
</code></pre>
<p>&#x811A;&#x672C;&#x7684;&#x7B2C;&#x4E00;&#x884C;&#x6807;&#x8BC6;&#x4E86; Python &#x89E3;&#x91CA;&#x5668;&#x6240;&#x5728;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x4EE5;&#x4FBF;&#x811A;&#x672C;&#x53EF;&#x4EE5;&#x5728;&#x4E0D;&#x4F20;&#x9012;&#x5230;&#x89E3;&#x91CA;&#x5668;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x6267;&#x884C;&#x3002; &#x7136;&#x540E;&#x811A;&#x672C;&#x5BFC;&#x5165;&#x6240;&#x6709; Scapy &#x51FD;&#x6570;&#xFF0C;&#x5E76;&#x5B9A;&#x4E49; Scapy &#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x7EA7;&#x522B;&#xFF0C;&#x4EE5;&#x6D88;&#x9664;&#x811A;&#x672C;&#x4E2D;&#x4E0D;&#x5FC5;&#x8981;&#x7684;&#x8F93;&#x51FA;&#x3002; &#x8FD8;&#x5BFC;&#x5165;&#x4E86;&#x5B50;&#x8FC7;&#x7A0B;&#x5E93;&#xFF0C;&#x4EE5;&#x4FBF;&#x4E8E;&#x4ECE;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E2D;&#x63D0;&#x53D6;&#x4FE1;&#x606F;&#x3002; &#x7B2C;&#x4E8C;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x662F;&#x6761;&#x4EF6;&#x6D4B;&#x8BD5;&#xFF0C;&#x7528;&#x4E8E;&#x8BC4;&#x4F30;&#x662F;&#x5426;&#x5411;&#x811A;&#x672C;&#x63D0;&#x4F9B;&#x4E86;&#x6240;&#x9700;&#x7684;&#x53C2;&#x6570;&#x3002; &#x5982;&#x679C;&#x5728;&#x6267;&#x884C;&#x65F6;&#x672A;&#x63D0;&#x4F9B;&#x6240;&#x9700;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x5219;&#x811A;&#x672C;&#x5C06;&#x8F93;&#x51FA;&#x4F7F;&#x7528;&#x60C5;&#x51B5;&#x7684;&#x8BF4;&#x660E;&#x3002; &#x8BE5;&#x8BF4;&#x660E;&#x5305;&#x62EC;&#x5DE5;&#x5177;&#x7684;&#x7528;&#x6CD5;&#xFF0C;&#x793A;&#x4F8B;&#x548C;&#x6240;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#x7684;&#x89E3;&#x91CA;&#x3002;</p>
<p>&#x5728;&#x8FD9;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x4E4B;&#x540E;&#xFF0C;&#x6709;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x4EE3;&#x7801;&#x884C;&#x5C06;&#x6240;&#x63D0;&#x4F9B;&#x7684;&#x53C2;&#x6570;&#x8D4B;&#x503C;&#x7ED9;<code>interface</code>&#x53D8;&#x91CF;&#x3002;&#x4E0B;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x4F7F;&#x7528;<code>check_output()</code>&#x5B50;&#x8FDB;&#x7A0B;&#x51FD;&#x6570;&#x6267;&#x884C;<code>ifconfig</code>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x8BE5;&#x8C03;&#x7528;&#x4E5F;&#x4F7F;&#x7528;<code>grep</code>&#x548C;<code>cut</code>&#x4ECE;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x63D0;&#x4F9B;&#x7684;&#x672C;&#x5730;&#x63A5;&#x53E3;&#x63D0;&#x53D6; IP &#x5730;&#x5740;&#x3002;&#x7136;&#x540E;&#x5C06;&#x6B64;&#x8F93;&#x51FA;&#x8D4B;&#x7ED9;<code>ip</code>&#x53D8;&#x91CF;&#x3002;&#x7136;&#x540E;&#x4F7F;&#x7528;<code>split</code>&#x51FD;&#x6570;&#x4ECE; IP &#x5730;&#x5740;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x63D0;&#x53D6;<code>/ 24</code>&#x7F51;&#x7EDC;&#x524D;&#x7F00;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;<code>ip</code>&#x53D8;&#x91CF;&#x5305;&#x542B;<code>192.168.11.4</code>&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5219;&#x503C;&#x4E3A;<code>192.168.11</code>&#x3002;&#x5B83;&#x5C06;&#x8D4B;&#x7ED9;<code>prefix</code>&#x53D8;&#x91CF;&#x3002;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x662F;&#x4E00;&#x4E2A;&#x7528;&#x4E8E;&#x6267;&#x884C;&#x5B9E;&#x9645;&#x626B;&#x63CF;&#x7684;<code>for</code>&#x5FAA;&#x73AF;&#x3002; <code>for</code>&#x5FAA;&#x73AF;&#x904D;&#x5386;&#x4ECB;&#x4E8E; 0 &#x548C; 254 &#x4E4B;&#x95F4;&#x7684;&#x6240;&#x6709;&#x503C;&#xFF0C;&#x5E76;&#x4E14;&#x5BF9;&#x4E8E;&#x6BCF;&#x6B21;&#x8FED;&#x4EE3;&#xFF0C;&#x8BE5;&#x503C;&#x968F;&#x540E;&#x9644;&#x52A0;&#x5230;&#x7F51;&#x7EDC;&#x524D;&#x7F00;&#x540E;&#x9762;&#x3002;&#x5728;&#x65E9;&#x5148;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x7684;&#x4E2D;&#xFF0C;&#x5C06;&#x9488;&#x5BF9;<code>192.168.11.0</code>&#x548C;<code>192.168.11.254</code>&#x4E4B;&#x95F4;&#x7684;&#x6BCF;&#x4E2A; IP &#x5730;&#x5740;&#x5E7F;&#x64AD; ARP &#x8BF7;&#x6C42;&#x3002;&#x7136;&#x540E;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x56DE;&#x590D;&#x7684;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#xFF0C;&#x5C06;&#x76F8;&#x5E94;&#x7684; IP &#x5730;&#x5740;&#x6253;&#x5370;&#x5230;&#x5C4F;&#x5E55;&#x4E0A;&#xFF0C;&#x4EE5;&#x8868;&#x660E;&#x4E3B;&#x673A;&#x5728; LAN &#x4E0A;&#x6D3B;&#x52A8;&#x3002;&#x4E00;&#x65E6;&#x811A;&#x672C;&#x88AB;&#x5199;&#x5165;&#x672C;&#x5730;&#x76EE;&#x5F55;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x7EC8;&#x7AEF;&#x4E2D;&#x4F7F;&#x7528;&#x53E5;&#x53F7;&#x548C;&#x659C;&#x6760;&#xFF0C;&#x7136;&#x540E;&#x662F;&#x53EF;&#x6267;&#x884C;&#x811A;&#x672C;&#x7684;&#x540D;&#x79F0;&#x6765;&#x6267;&#x884C;&#x5B83;&#x3002;&#x770B;&#x770B;&#x4EE5;&#x4E0B;&#x7528;&#x4E8E;&#x6267;&#x884C;&#x811A;&#x672C;&#x7684;&#x547D;&#x4EE4;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ./arp_disc.py 
Usage - ./arp_disc.py [interface] 
Example - ./arp_disc.py eth0 
Example will perform an ARP scan of the local subnet to which eth0 is assigned
</code></pre><p>&#x5982;&#x679C;&#x5728;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x4EFB;&#x4F55;&#x53C2;&#x6570;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x6267;&#x884C;&#x811A;&#x672C;&#xFF0C;&#x5219;&#x4F1A;&#x5C06;&#x4F7F;&#x7528;&#x60C5;&#x51B5;&#x8F93;&#x51FA;&#x5230;&#x5C4F;&#x5E55;&#x3002; &#x7528;&#x6CD5;&#x8F93;&#x51FA;&#x8868;&#x660E;&#x6B64;&#x811A;&#x672C;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x8BE5;&#x53C2;&#x6570;&#x5B9A;&#x4E49;&#x5E94;&#x4F7F;&#x7528;&#x54EA;&#x4E2A;&#x63A5;&#x53E3;&#x6267;&#x884C;&#x626B;&#x63CF;&#x3002; &#x5728;&#x4EE5;&#x4E0B;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528;<code>eth0</code>&#x63A5;&#x53E3;&#x6267;&#x884C;&#x811A;&#x672C;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ./arp_disc.py eth0 
172.16.36.1 
172.16.36.2 
172.16.36.132 
172.16.36.135 
172.16.36.254
</code></pre><p>&#x4E00;&#x65E6;&#x8FD0;&#x884C;&#xFF0C;&#x811A;&#x672C;&#x5C06;&#x786E;&#x5B9A;&#x63D0;&#x4F9B;&#x7684;&#x63A5;&#x53E3;&#x7684;&#x672C;&#x5730;&#x5B50;&#x7F51;; &#x5728;&#x6B64;&#x5B50;&#x7F51;&#x4E0A;&#x6267;&#x884C; ARP &#x626B;&#x63CF;&#xFF0C;&#x7136;&#x540E;&#x6839;&#x636E;&#x6765;&#x81EA;&#x8FD9;&#x4E9B; IP &#x7684;&#x4E3B;&#x673A;&#x7684;&#x54CD;&#x5E94;&#x8F93;&#x51FA; IP &#x5730;&#x6D3B;&#x52A8;&#x5740;&#x5217;&#x8868;&#x3002; &#x6B64;&#x5916;&#xFF0C;Wireshark &#x53EF;&#x4EE5;&#x540C;&#x65F6;&#x8FD0;&#x884C;&#xFF0C;&#x56E0;&#x4E3A;&#x811A;&#x672C;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x6765;&#x89C2;&#x5BDF;&#x5982;&#x4F55;&#x6309;&#x987A;&#x5E8F;&#x5E7F;&#x64AD;&#x6BCF;&#x4E2A;&#x5730;&#x5740;&#x7684;&#x8BF7;&#x6C42;&#xFF0C;&#x4EE5;&#x53CA;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x5982;&#x4F55;&#x54CD;&#x5E94;&#x8FD9;&#x4E9B;&#x8BF7;&#x6C42;&#xFF0C;&#x5982;&#x4EE5;&#x4E0B;&#x5C4F;&#x5E55;&#x622A;&#x56FE;&#x6240;&#x793A;&#xFF1A;</p>
<p><img src="img/2-1-1.jpg" alt=""></p>
<p>&#x6B64;&#x5916;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8F7B;&#x6613;&#x5C06;&#x811A;&#x672C;&#x7684;&#x8F93;&#x51FA;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x6587;&#x672C;&#x6587;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x968F;&#x540E;&#x7684;&#x5206;&#x6790;&#x3002; &#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5C16;&#x62EC;&#x53F7;&#x91CD;&#x5B9A;&#x5411;&#x8F93;&#x51FA;&#xFF0C;&#x540E;&#x8DDF;&#x6587;&#x672C;&#x6587;&#x4EF6;&#x7684;&#x540D;&#x79F0;&#x3002; &#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ./arp_disc.py eth0 &gt; output.txt 
root@KaliLinux:~# ls output.txt 
output.txt 
root@KaliLinux:~# cat output.txt 
172.16.36.1 
172.16.36.2 
172.16.36.132 
172.16.36.135 
172.16.36.254
</code></pre><p>&#x4E00;&#x65E6;&#x8F93;&#x51FA;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>ls</code>&#x547D;&#x4EE4;&#x9A8C;&#x8BC1;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x5DF2;&#x5199;&#x5165;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x6216;&#x8005;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>cat</code>&#x547D;&#x4EE4;&#x67E5;&#x770B;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#x3002; &#x6B64;&#x811A;&#x672C;&#x8FD8;&#x53EF;&#x4EE5;&#x8F7B;&#x677E;&#x5730;&#x4FEE;&#x6539;&#x4E3A;&#xFF0C;&#x4EC5;&#x5BF9;&#x6587;&#x672C;&#x6587;&#x4EF6;&#x4E2D;&#x5305;&#x542B;&#x7684;&#x67D0;&#x4E9B; IP &#x5730;&#x5740;&#x6267;&#x884C; ARP &#x8BF7;&#x6C42;&#x3002; &#x4E3A;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x9996;&#x5148;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6211;&#x4EEC;&#x5E0C;&#x671B;&#x626B;&#x63CF;&#x7684; IP &#x5730;&#x5740;&#x5217;&#x8868;&#x3002; &#x4E3A;&#x6B64;&#xFF0C;&#x6A21;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; Nano &#x6216; VIM &#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#x3002; &#x4E3A;&#x4E86;&#x8BC4;&#x4F30;&#x811A;&#x672C;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x8BF7;&#x5305;&#x542B;&#x5148;&#x4E4B;&#x524D;&#x53D1;&#x73B0;&#x7684;&#x4E00;&#x4E9B;&#x6D3B;&#x52A8;&#x5730;&#x5740;&#xFF0C;&#x4EE5;&#x53CA;&#x4F4D;&#x4E8E;&#x4E0D;&#x5BF9;&#x5E94;&#x4EFB;&#x4F55;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x7684;&#x76F8;&#x540C;&#x8303;&#x56F4;&#x5185;&#x7684;&#x4E00;&#x4E9B;&#x5176;&#x4ED6;&#x968F;&#x673A;&#x9009;&#x62E9;&#x7684;&#x5730;&#x5740;&#x3002; &#x4E3A;&#x4E86;&#x5728; VIM &#x6216; Nano &#x4E2D;&#x521B;&#x5EFA;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#x4E4B;&#x4E00;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# vim iplist.txt 
root@KaliLinux:~# nano iplist.txt
</code></pre><p>&#x521B;&#x5EFA;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>cat</code>&#x547D;&#x4EE4;&#x9A8C;&#x8BC1;&#x5176;&#x5185;&#x5BB9;&#x3002; &#x5047;&#x8BBE;&#x6587;&#x4EF6;&#x5DF2;&#x6B63;&#x786E;&#x521B;&#x5EFA;&#xFF0C;&#x4F60;&#x5E94;&#x8BE5;&#x4F1A;&#x770B;&#x5230;&#x4F60;&#x5728;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#x4E2D;&#x8F93;&#x5165;&#x7684; IP &#x5730;&#x5740;&#x5217;&#x8868;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# cat iplist.txt 
172.16.36.1 
172.16.36.2 
172.16.36.232 
172.16.36.135 
172.16.36.180 
172.16.36.203 
172.16.36.205 
172.16.36.254
</code></pre><p>&#x4E3A;&#x4E86;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5C06;&#x63A5;&#x53D7;&#x6587;&#x672C;&#x6587;&#x4EF6;&#x4F5C;&#x4E3A;&#x8F93;&#x5165;&#x7684;&#x811A;&#x672C;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x4E0A;&#x4E00;&#x4E2A;&#x7EC3;&#x4E60;&#x4E2D;&#x7684;&#x73B0;&#x6709;&#x811A;&#x672C;&#xFF0C;&#x6216;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x811A;&#x672C;&#x6587;&#x4EF6;&#x3002; &#x4E3A;&#x4E86;&#x5728;&#x6211;&#x4EEC;&#x7684;&#x811A;&#x672C;&#x4E2D;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A; IP &#x5730;&#x5740;&#x5217;&#x8868;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5728; Python &#x4E2D;&#x6267;&#x884C;&#x4E00;&#x4E9B;&#x6587;&#x4EF6;&#x5904;&#x7406;&#x3002; &#x5DE5;&#x4F5C;&#x811A;&#x672C;&#x7684;&#x793A;&#x4F8B;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
<pre><code class="lang-py"><span class="hljs-comment">#!/usr/bin/python</span>

<span class="hljs-keyword">import</span> logging 
logging.getLogger(<span class="hljs-string">&quot;scapy.runtime&quot;</span>).setLevel(logging.ERROR) 
<span class="hljs-keyword">from</span> scapy.all <span class="hljs-keyword">import</span> *

<span class="hljs-keyword">if</span> len(sys.argv) != <span class="hljs-number">2</span>:   
    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Usage - ./arp_disc.py [filename]&quot;</span>   
    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Example - ./arp_disc.py iplist.txt&quot;</span>   
    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Example will perform an ARP scan of the IP addresses listed in iplist.txt&quot;</span>   
    sys.exit()

filename = str(sys.argv[<span class="hljs-number">1</span>]) 
file = open(filename,<span class="hljs-string">&apos;r&apos;</span>)

<span class="hljs-keyword">for</span> addr <span class="hljs-keyword">in</span> file:   
    answer = sr1(ARP(pdst=addr.strip()),timeout=<span class="hljs-number">1</span>,verbose=<span class="hljs-number">0</span>)   
    <span class="hljs-keyword">if</span> answer == <span class="hljs-keyword">None</span>:      
        <span class="hljs-keyword">pass</span>   
    <span class="hljs-keyword">else</span>:      
        <span class="hljs-keyword">print</span> addr.strip()
</code></pre>
<p>&#x8FD9;&#x4E2A;&#x811A;&#x672C;&#x548C;&#x4EE5;&#x524D;&#x7528;&#x6765;&#x5FAA;&#x73AF;&#x904D;&#x5386;&#x8FDE;&#x7EED;&#x5E8F;&#x5217;&#x7684;&#x811A;&#x672C;&#x4E2D;&#x552F;&#x4E00;&#x7684;&#x771F;&#x6B63;&#x533A;&#x522B;&#x662F;&#xFF0C;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x79F0;&#x4E3A;<code>file</code>&#x800C;&#x4E0D;&#x662F;<code>interface</code>&#x7684;&#x53D8;&#x91CF;&#x3002; &#x7136;&#x540E;&#x4F7F;&#x7528;<code>open()</code>&#x51FD;&#x6570;&#xFF0C;&#x901A;&#x8FC7;&#x5728;&#x811A;&#x672C;&#x7684;&#x76F8;&#x540C;&#x76EE;&#x5F55;&#x4E2D;&#x6253;&#x5F00;<code>iplist.txt</code>&#x6587;&#x4EF6;&#xFF0C;&#x6765;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x3002; <code>r</code>&#x503C;&#x4E5F;&#x4F20;&#x9012;&#x7ED9;&#x51FD;&#x6570;&#x6765;&#x6307;&#x5B9A;&#x5BF9;&#x6587;&#x4EF6;&#x7684;&#x53EA;&#x8BFB;&#x8BBF;&#x95EE;&#x3002; <code>for</code>&#x5FAA;&#x73AF;&#x904D;&#x5386;&#x6587;&#x4EF6;&#x4E2D;&#x5217;&#x51FA;&#x7684;&#x6BCF;&#x4E2A; IP &#x5730;&#x5740;&#xFF0C;&#x7136;&#x540E;&#x8F93;&#x51FA;&#x56DE;&#x590D; ARP &#x5E7F;&#x64AD;&#x8BF7;&#x6C42;&#x7684; IP &#x5730;&#x5740;&#x3002; &#x6B64;&#x811A;&#x672C;&#x53EF;&#x4EE5;&#x4EE5;&#x4E0E;&#x524D;&#x9762;&#x8BA8;&#x8BBA;&#x7684;&#x76F8;&#x540C;&#x65B9;&#x5F0F;&#x6267;&#x884C;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ./arp_disc.py 
Usage - ./arp_disc.py [filename] 
Example - ./arp_disc.py iplist.txt 
Example will perform an ARP scan of the IP addresses listed in iplist.txt
</code></pre><p>&#x5982;&#x679C;&#x5728;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x4EFB;&#x4F55;&#x53C2;&#x6570;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x6267;&#x884C;&#x811A;&#x672C;&#xFF0C;&#x5219;&#x4F1A;&#x5C06;&#x4F7F;&#x7528;&#x60C5;&#x51B5;&#x8F93;&#x51FA;&#x5230;&#x5C4F;&#x5E55;&#x3002; &#x4F7F;&#x7528;&#x60C5;&#x51B5;&#x8F93;&#x51FA;&#x8868;&#x660E;&#xFF0C;&#x6B64;&#x811A;&#x672C;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x7528;&#x4E8E;&#x5B9A;&#x4E49;&#x8981;&#x626B;&#x63CF;&#x7684; IP &#x5730;&#x5740;&#x7684;&#x8F93;&#x5165;&#x5217;&#x8868;&#x3002; &#x5728;&#x4EE5;&#x4E0B;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528;&#x6267;&#x884C;&#x76EE;&#x5F55;&#x4E2D;&#x7684;<code>iplist.txt</code>&#x6587;&#x4EF6;&#x6267;&#x884C;&#x811A;&#x672C;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ./arp_disc.py iplist.txt 
172.16.36.2 
172.16.36.1 
172.16.36.132 
172.16.36.135 
172.16.36.254
</code></pre><p>&#x4E00;&#x65E6;&#x8FD0;&#x884C;&#xFF0C;&#x811A;&#x672C;&#x53EA;&#x4F1A;&#x8F93;&#x51FA;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#x4E2D;&#x7684; IP &#x5730;&#x5740;&#xFF0C;&#x5E76;&#x4E14;&#x4E5F;&#x54CD;&#x5E94; ARP &#x8BF7;&#x6C42;&#x6D41;&#x91CF;&#x3002; &#x8FD9;&#x4E9B;&#x5730;&#x5740;&#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x8868;&#x793A;&#x5728; LAN &#x4E0A;&#x7684;&#x6D3B;&#x52A8;&#x7CFB;&#x7EDF;&#x3002; &#x4F7F;&#x7528;&#x4E0E;&#x524D;&#x9762;&#x8BA8;&#x8BBA;&#x7684;&#x76F8;&#x540C;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x6B64;&#x811A;&#x672C;&#x7684;&#x8F93;&#x51FA;&#x53EF;&#x4EE5;&#x8F7B;&#x6613;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x4F7F;&#x7528;&#x5C16;1&#x62EC;&#x53F7;&#x540E;&#x8DDF;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x7684;&#x6240;&#x9700;&#x540D;&#x79F0;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ./arp_disc.py iplist.txt &gt; output.txt 
root@KaliLinux:~# ls output.txt 
output.txt 
root@KaliLinux:~# cat output.txt 
172.16.36.2 
172.16.36.1 
172.16.36.132 
172.16.36.135 
172.16.36.254
</code></pre><p>&#x4E00;&#x65E6;&#x5C06;&#x8F93;&#x51FA;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>ls</code>&#x547D;&#x4EE4;&#x9A8C;&#x8BC1;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x5DF2;&#x5199;&#x5165;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x6216;&#x8005;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>cat</code>&#x547D;&#x4EE4;&#x67E5;&#x770B;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#x3002;</p>
<h3 id="&#x5DE5;&#x4F5C;&#x539F;&#x7406;">&#x5DE5;&#x4F5C;&#x539F;&#x7406;</h3>
<p>&#x901A;&#x8FC7;&#x4F7F;&#x7528;<code>sr1()</code>&#xFF08;&#x53D1;&#x9001;/&#x63A5;&#x6536;&#x5355;&#x4E2A;&#xFF09;&#x529F;&#x80FD;&#xFF0C;&#x53EF;&#x4EE5;&#x5728; Scapy &#x4E2D;&#x8FDB;&#x884C; ARP &#x53D1;&#x73B0;&#x3002; &#x6B64;&#x51FD;&#x6570;&#x6CE8;&#x5165;&#x7531;&#x63D0;&#x4F9B;&#x7684;&#x53C2;&#x6570;&#x5B9A;&#x4E49;&#x7684;&#x6570;&#x636E;&#x5305;&#xFF0C;&#x7136;&#x540E;&#x7B49;&#x5F85;&#x63A5;&#x6536;&#x5355;&#x4E2A;&#x54CD;&#x5E94;&#x3002; &#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6211;&#x4EEC;&#x5E7F;&#x64AD;&#x4E86;&#x5355;&#x4E2A; ARP &#x8BF7;&#x6C42;&#xFF0C;&#x5E76;&#x4E14;&#x51FD;&#x6570;&#x5C06;&#x8FD4;&#x56DE;&#x54CD;&#x5E94;&#x3002; Scapy &#x5E93;&#x53EF;&#x4EE5;&#x5C06;&#x6B64;&#x6280;&#x672F;&#x8F7B;&#x6613;&#x96C6;&#x6210;&#x5230;&#x811A;&#x672C;&#x4E2D;&#xFF0C;&#x5E76;&#x53EF;&#x4EE5;&#x6D4B;&#x8BD5;&#x591A;&#x4E2A;&#x7CFB;&#x7EDF;&#x3002;</p>
<h2 id="22-&#x4F7F;&#x7528;-arping-&#x63A2;&#x7D22;&#x7B2C;&#x4E8C;&#x5C42;">2.2 &#x4F7F;&#x7528; ARPing &#x63A2;&#x7D22;&#x7B2C;&#x4E8C;&#x5C42;</h2>
<p>ARPing &#x662F;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#x884C;&#x7F51;&#x7EDC;&#x5DE5;&#x5177;&#xFF0C;&#x5177;&#x6709;&#x7C7B;&#x4F3C;&#x4E8E;&#x5E38;&#x7528;&#x7684;<code>ping</code>&#x5DE5;&#x5177;&#x7684;&#x529F;&#x80FD;&#x3002; &#x6B64;&#x5DE5;&#x5177;&#x53EF;&#x901A;&#x8FC7;&#x63D0;&#x4F9B;&#x8BE5; IP &#x5730;&#x5740;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#xFF0C;&#x6765;&#x8BC6;&#x522B;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x662F;&#x5426;&#x4F4D;&#x4E8E;&#x7ED9;&#x5B9A; IP &#x7684;&#x672C;&#x5730;&#x7F51;&#x7EDC;&#x4E0A;&#x3002; &#x8FD9;&#x4E2A;&#x79D8;&#x7C4D;&#x5C06;&#x8BA8;&#x8BBA;&#x5982;&#x4F55;&#x4F7F;&#x7528; ARPing &#x626B;&#x63CF;&#x7F51;&#x7EDC;&#x4E0A;&#x7684;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x3002;</p>
<h3 id="&#x51C6;&#x5907;">&#x51C6;&#x5907;</h3>
<p>&#x8981;&#x4F7F;&#x7528; ARPing &#x6267;&#x884C; ARP &#x53D1;&#x73B0;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x5728; LAN &#x4E0A;&#x81F3;&#x5C11;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x54CD;&#x5E94; ARP &#x8BF7;&#x6C42;&#x7684;&#x7CFB;&#x7EDF;&#x3002; &#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4F7F;&#x7528; Linux &#x548C; Windows &#x7CFB;&#x7EDF;&#x7684;&#x7EC4;&#x5408;&#x3002; &#x6709;&#x5173;&#x5728;&#x672C;&#x5730;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x8BBE;&#x7F6E;&#x7CFB;&#x7EDF;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x5165;&#x4E2D;&#x7684;&#x201C;&#x5B89;&#x88C5; Metasploitable2&#x201D;&#x548C;&#x201C;&#x5B89;&#x88C5; Windows Server&#x201D;&#x79D8;&#x7C4D;&#x3002;</p>
<p>&#x6B64;&#x5916;&#xFF0C;&#x672C;&#x8282;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#xFF08;&#x5982; VIM &#x6216; Nano&#xFF09;&#x5C06;&#x811A;&#x672C;&#x5199;&#x5165;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3002; &#x6709;&#x5173;&#x7F16;&#x5199;&#x811A;&#x672C;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x5165;&#x95E8;&#x4E2D;&#x7684;&#x201C;&#x4F7F;&#x7528;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#xFF08;VIM &#x548C; Nano&#xFF09;&#x201D;&#x79D8;&#x7C4D;&#x3002;</p>
<h3 id="&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;">&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;</h3>
<p>ARPing&#x662F;&#x4E00;&#x79CD;&#x5DE5;&#x5177;&#xFF0C;&#x53EF;&#x7528;&#x4E8E;&#x53D1;&#x9001; ARP &#x8BF7;&#x6C42;&#x5E76;&#x6807;&#x8BC6;&#x4E3B;&#x673A;&#x662F;&#x5426;&#x6D3B;&#x52A8;&#x548C;&#x54CD;&#x5E94;&#x3002; &#x8BE5;&#x5DE5;&#x5177;&#x4EC5;&#x901A;&#x8FC7;&#x5C06; IP &#x5730;&#x5740;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x7ED9;&#x5B83;&#x6765;&#x4F7F;&#x7528;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# arping 172.16.36.135 -c 1 
ARPING 172.16.36.135 
60 bytes from 00:0c:29:3d:84:32 (172.16.36.135): index=0 time=249.000 usec

--- 172.16.36.135 statistics --
1 packets transmitted, 1 packets received,   0% unanswered (0 extra)
</code></pre><p>&#x5728;&#x6240;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x5355;&#x4E2A; ARP &#x8BF7;&#x6C42;&#x88AB;&#x53D1;&#x9001;&#x7ED9;&#x5E7F;&#x64AD;&#x5730;&#x5740;&#xFF0C;&#x8BF7;&#x6C42;<code>172.16.36.135</code> IP &#x5730;&#x5740;&#x7684;&#x7269;&#x7406;&#x4F4D;&#x7F6E;&#x3002; &#x5982;&#x8F93;&#x51FA;&#x6240;&#x793A;&#xFF0C;&#x4E3B;&#x673A;&#x4ECE;<code>00&#xFF1A;0C&#xFF1A;29&#xFF1A;3D&#xFF1A;84&#xFF1A;32</code> MAC&#x5730;&#x5740;&#x63A5;&#x6536;&#x5230;&#x5355;&#x4E2A;&#x5E94;&#x7B54;&#x3002; &#x6B64;&#x5DE5;&#x5177;&#x53EF;&#x4EE5;&#x66F4;&#x6709;&#x6548;&#x5730;&#x7528;&#x4E8E;&#x7B2C;&#x4E8C;&#x5C42;&#x4E0A;&#x7684;&#x53D1;&#x73B0;&#xFF0C;&#x626B;&#x63CF;&#x662F;&#x5426;&#x4F7F;&#x7528; bash &#x811A;&#x672C;&#x5728;&#x591A;&#x4E2A;&#x4E3B;&#x673A;&#x4E0A;&#x540C;&#x65F6;&#x6267;&#x884C;&#x6B64;&#x64CD;&#x4F5C;&#x3002; &#x4E3A;&#x4E86;&#x6D4B;&#x8BD5; bash &#x4E2D;&#x6BCF;&#x4E2A;&#x5B9E;&#x4F8B;&#x7684;&#x54CD;&#x5E94;&#xFF0C;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x786E;&#x5B9A;&#x54CD;&#x5E94;&#x4E2D;&#x5305;&#x542B;&#x7684;&#x552F;&#x4E00;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5B83;&#x6807;&#x8BC6;&#x4E86;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#xFF0C;&#x4F46;&#x4E0D;&#x5305;&#x62EC;&#x6CA1;&#x6709;&#x6536;&#x5230;&#x54CD;&#x5E94;&#x65F6;&#x7684;&#x60C5;&#x51B5;&#x3002; &#x8981;&#x8BC6;&#x522B;&#x552F;&#x4E00;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5E94;&#x8BE5;&#x5BF9;&#x65E0;&#x54CD;&#x5E94;&#x7684; IP &#x5730;&#x5740;&#x8FDB;&#x884C; ARPing &#x8BF7;&#x6C42;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# arping 172.16.36.136 -c 1 
ARPING 172.16.36.136

--- 172.16.36.136 statistics --
1 packets transmitted, 0 packets received, 100% unanswered (0 extra)
</code></pre><p>&#x901A;&#x8FC7;&#x5206;&#x6790;&#x6765;&#x81EA;&#x6210;&#x529F;&#x548C;&#x5931;&#x8D25;&#x7684;&#x4E0D;&#x540C; ARP &#x54CD;&#x5E94;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x6CE8;&#x610F;&#x5230;&#xFF0C;&#x5982;&#x679C;&#x5B58;&#x5728;&#x6240;&#x63D0;&#x4F9B;&#x7684; IP &#x5730;&#x5740;&#x7684;&#x76F8;&#x5173;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#xFF0C;&#x5E76;&#x4E14;&#x5B83;&#x4E5F;&#x5728;&#x5305;&#x542B;&#x5728; IP &#x5730;&#x5740;&#x7684;&#x884C;&#x5185;&#xFF0C;&#x5219;&#x54CD;&#x5E94;&#x4E2D;&#x5B58;&#x5728;&#x6765;&#x81EA;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x552F;&#x4E00;&#x5B57;&#x8282;&#x3002; &#x901A;&#x8FC7;&#x5BF9;&#x6B64;&#x54CD;&#x5E94;&#x6267;&#x884C;<code>grep</code>&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x63D0;&#x53D6;&#x6BCF;&#x4E2A;&#x54CD;&#x5E94;&#x4E3B;&#x673A;&#x7684; IP &#x5730;&#x5740;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# arping -c 1 172.16.36.135 | grep &quot;bytes from&quot; 
60 bytes from 00:0c:29:3d:84:32 (172.16.36.135): index=0 time=10.000 usec 
root@KaliLinux:~# arping -c 1 172.16.36.135 | grep &quot;bytes from&quot; | cut -d &quot; &quot; -f 4 
00:0c:29:3d:84:32
</code></pre><p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4EC5;&#x4EC5;&#x901A;&#x8FC7;&#x5904;&#x7406;&#x63D0;&#x4F9B;&#x7ED9;<code>cut</code>&#x51FD;&#x6570;&#x7684;&#x5206;&#x9694;&#x7B26;&#x548C;&#x5B57;&#x6BB5;&#x503C;&#xFF0C;&#x4ECE;&#x8FD4;&#x56DE;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x8F7B;&#x677E;&#x5730;&#x63D0;&#x53D6; IP &#x5730;&#x5740;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# arping -c 1 172.16.36.135 | grep &quot;bytes from&quot; 
60 bytes from 00:0c:29:3d:84:32 (172.16.36.135): index=0 time=328.000 usec 
root@KaliLinux:~# arping -c 1 172.16.36.135 | grep &quot;bytes from&quot; | cut -d &quot; &quot; -f 5 (172.16.36.135): 
root@KaliLinux:~# arping -c 1 172.16.36.135 | grep &quot;bytes from&quot; | cut -d &quot; &quot; -f 5 | cut -d &quot;(&quot; -f 2 172.16.36.135): 
root@KaliLinux:~# arping -c 1 172.16.36.135 | grep &quot;bytes from&quot; | cut -d &quot; &quot; -f 5 | cut -d &quot;(&quot; -f 2 | cut -d &quot;)&quot; -f 1 
172.16.36.135
</code></pre><p>&#x5728;&#x8BC6;&#x522B;&#x5982;&#x4F55;&#x4ECE;&#x6B63;&#x9762; ARPing &#x54CD;&#x5E94;&#x4E2D;&#x63D0;&#x53D6; IP &#x5728; bash &#x811A;&#x672C;&#x4E2D;&#x8F7B;&#x6613;&#x5C06;&#x8BE5;&#x4EFB;&#x52A1;&#x4F20;&#x9012;&#x7ED9;&#x5FAA;&#x73AF;&#xFF0C;&#x5E76;&#x8F93;&#x51FA;&#x5B9E;&#x65F6; IP &#x5730;&#x5740;&#x5217;&#x8868;&#x3002; &#x4F7F;&#x7528;&#x6B64;&#x6280;&#x672F;&#x7684;&#x811A;&#x672C;&#x7684;&#x793A;&#x4F8B;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
<pre><code class="lang-sh"><span class="hljs-meta">#!/bin/bash
</span>
<span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$#</span>&quot;</span> <span class="hljs-_">-ne</span> 1 ]; <span class="hljs-keyword">then</span> 
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Usage - ./arping.sh [interface]&quot;</span> 
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Example - ./arping.sh eth0&quot;</span> 
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Example will perform an ARP scan of the local subnet to which eth0 is assigned&quot;</span> 
    <span class="hljs-built_in">exit</span> 
<span class="hljs-keyword">fi</span>

interface=<span class="hljs-variable">$1</span> 
prefix=$(ifconfig <span class="hljs-variable">$interface</span> | grep <span class="hljs-string">&apos;inet addr&apos;</span> | 
cut <span class="hljs-_">-d</span> <span class="hljs-string">&apos;:&apos;</span> <span class="hljs-_">-f</span> 2 | cut <span class="hljs-_">-d</span> <span class="hljs-string">&apos; &apos;</span> <span class="hljs-_">-f</span> 1 | cut <span class="hljs-_">-d</span> <span class="hljs-string">&apos;.&apos;</span> <span class="hljs-_">-f</span> 1-3)

<span class="hljs-keyword">for</span> addr <span class="hljs-keyword">in</span> $(seq 1 254); <span class="hljs-keyword">do</span> 
    arping -c 1 <span class="hljs-variable">$prefix</span>.<span class="hljs-variable">$addr</span> | grep <span class="hljs-string">&quot;bytes from&quot;</span> | cut <span class="hljs-_">-d</span> <span class="hljs-string">&quot; &quot;</span> <span class="hljs-_">-f</span> 5 | cut <span class="hljs-_">-d</span> <span class="hljs-string">&quot;(&quot;</span> <span class="hljs-_">-f</span> 2 | cut <span class="hljs-_">-d</span> <span class="hljs-string">&quot;)&quot;</span> <span class="hljs-_">-f</span> 1 &amp; 
<span class="hljs-keyword">done</span>
</code></pre>
<p>&#x5728;&#x63D0;&#x4F9B;&#x7684; bash &#x811A;&#x672C;&#x4E2D;&#xFF0C;&#x7B2C;&#x4E00;&#x884C;&#x5B9A;&#x4E49;&#x4E86; bash &#x89E3;&#x91CA;&#x5668;&#x7684;&#x4F4D;&#x7F6E;&#x3002;&#x63A5;&#x4E0B;&#x6765;&#x7684;&#x4EE3;&#x7801;&#x5757;&#x6267;&#x884C;&#x6D4B;&#x8BD5;&#xFF0C;&#x6765;&#x786E;&#x5B9A;&#x662F;&#x5426;&#x63D0;&#x4F9B;&#x4E86;&#x9884;&#x671F;&#x7684;&#x53C2;&#x6570;&#x3002;&#x8FD9;&#x901A;&#x8FC7;&#x8BC4;&#x4F30;&#x63D0;&#x4F9B;&#x7684;&#x53C2;&#x6570;&#x7684;&#x6570;&#x91CF;&#x662F;&#x5426;&#x4E0D;&#x7B49;&#x4E8E; 1 &#x6765;&#x786E;&#x5B9A;&#x3002;&#x5982;&#x679C;&#x672A;&#x63D0;&#x4F9B;&#x9884;&#x671F;&#x53C2;&#x6570;&#xFF0C;&#x5219;&#x8F93;&#x51FA;&#x811A;&#x672C;&#x7684;&#x7528;&#x6CD5;&#xFF0C;&#x5E76;&#x4E14;&#x9000;&#x51FA;&#x811A;&#x672C;&#x3002;&#x7528;&#x6CD5;&#x8F93;&#x51FA;&#x8868;&#x660E;&#xFF0C;&#x811A;&#x672C;&#x9884;&#x671F;&#x5C06;&#x672C;&#x5730;&#x63A5;&#x53E3;&#x540D;&#x79F0;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x3002;&#x4E0B;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x5C06;&#x63D0;&#x4F9B;&#x7684;&#x53C2;&#x6570;&#x8D4B;&#x7ED9;<code>interface</code>&#x53D8;&#x91CF;&#x3002;&#x7136;&#x540E;&#x5C06;&#x63A5;&#x53E3;&#x503C;&#x63D0;&#x4F9B;&#x7ED9;<code>ifconfig</code>&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;&#x8F93;&#x51FA;&#x63D0;&#x53D6;&#x7F51;&#x7EDC;&#x524D;&#x7F00;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x63D0;&#x4F9B;&#x7684;&#x63A5;&#x53E3;&#x7684; IP &#x5730;&#x5740;&#x662F;<code>192.168.11.4</code>&#xFF0C;&#x5219;&#x524D;&#x7F00;&#x53D8;&#x91CF;&#x5C06;&#x8D4B;&#x4E3A;<code>192.168.11</code>&#x3002;&#x7136;&#x540E;&#x4F7F;&#x7528;<code>for</code>&#x5FAA;&#x73AF;&#x904D;&#x5386;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x7684;&#x503C;&#xFF0C;&#x6765;&#x5728;&#x672C;&#x5730;<code>/ 24</code>&#x7F51;&#x7EDC;&#x4E2D;&#x751F;&#x6210;&#x6BCF;&#x4E2A;&#x53EF;&#x80FD;&#x7684; IP &#x5730;&#x5740;&#x3002;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x53EF;&#x80FD;&#x7684; IP &#x5730;&#x5740;&#xFF0C;&#x6267;&#x884C;&#x5355;&#x4E2A;<code>arping</code>&#x547D;&#x4EE4;&#x3002;&#x7136;&#x540E;&#x5BF9;&#x6BCF;&#x4E2A;&#x8BF7;&#x6C42;&#x7684;&#x54CD;&#x5E94;&#x901A;&#x8FC7;&#x7BA1;&#x9053;&#x8FDB;&#x884C;&#x4F20;&#x9012;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;<code>grep</code>&#x6765;&#x63D0;&#x53D6;&#x5E26;&#x6709;&#x77ED;&#x8BED;<code>bytes</code>&#x7684;&#x884C;&#x3002;&#x5982;&#x524D;&#x6240;&#x8FF0;&#xFF0C;&#x8FD9;&#x53EA;&#x4F1A;&#x63D0;&#x53D6;&#x5305;&#x542B;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x7684; IP &#x5730;&#x5740;&#x7684;&#x884C;&#x3002;&#x6700;&#x540E;&#xFF0C;&#x4F7F;&#x7528;&#x4E00;&#x7CFB;&#x5217;<code>cut</code>&#x51FD;&#x6570;&#x4ECE;&#x6B64;&#x8F93;&#x51FA;&#x4E2D;&#x63D0;&#x53D6; IP &#x5730;&#x5740;&#x3002;&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5728;<code>for</code>&#x5FAA;&#x73AF;&#x4EFB;&#x52A1;&#x7684;&#x672B;&#x5C3E;&#x4F7F;&#x7528;<code>&amp;</code>&#x7B26;&#x53F7;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5206;&#x53F7;&#x3002;&#x7B26;&#x53F7;&#x5141;&#x8BB8;&#x5E76;&#x884C;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x6309;&#x987A;&#x5E8F;&#x6267;&#x884C;&#x3002;&#x8FD9;&#x6781;&#x5927;&#x5730;&#x51CF;&#x5C11;&#x4E86;&#x626B;&#x63CF; IP &#x8303;&#x56F4;&#x6240;&#x9700;&#x7684;&#x65F6;&#x95F4;&#x3002;&#x770B;&#x770B;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x96C6;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ./arping.sh 
Usage - ./arping.sh [interface] 
Example - ./arping.sh eth0 
Example will perform an ARP scan of the local subnet to which eth0 is assigned

root@KaliLinux:~# ./arping.sh eth0 
172.16.36.1 
172.16.36.2 
172.16.36.132 
172.16.36.135 
172.16.36.254
</code></pre><p>&#x53EF;&#x4EE5;&#x8F7B;&#x6613;&#x5C06;&#x811A;&#x672C;&#x7684;&#x8F93;&#x51FA;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x6587;&#x672C;&#x6587;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x7528;&#x4E8E;&#x968F;&#x540E;&#x7684;&#x5206;&#x6790;&#x3002; &#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5C16;&#x62EC;&#x53F7;&#x91CD;&#x5B9A;&#x5411;&#x8F93;&#x51FA;&#xFF0C;&#x540E;&#x8DDF;&#x6587;&#x672C;&#x6587;&#x4EF6;&#x7684;&#x540D;&#x79F0;&#x3002; &#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ./arping.sh eth0 &gt; output.txt 
root@KaliLinux:~# ls output.txt 
output.txt 
root@KaliLinux:~# cat output.txt 
172.16.36.1 
172.16.36.2 
172.16.36.132 
172.16.36.135 
172.16.36.254
</code></pre><p>&#x4E00;&#x65E6;&#x8F93;&#x51FA;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#xFF0C;&#x4F60;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>ls</code>&#x547D;&#x4EE4;&#x9A8C;&#x8BC1;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x5DF2;&#x5199;&#x5165;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x6216;&#x8005;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>cat</code>&#x547D;&#x4EE4;&#x67E5;&#x770B;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#x3002; &#x6B64;&#x811A;&#x672C;&#x8FD8;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x4E3A;&#x4ECE;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#x8BFB;&#x53D6;&#xFF0C;&#x5E76;&#x4EC5;&#x9A8C;&#x8BC1;&#x6B64;&#x6587;&#x4EF6;&#x4E2D;&#x5217;&#x51FA;&#x7684;&#x4E3B;&#x673A;&#x662F;&#x5426;&#x5904;&#x4E8E;&#x6D3B;&#x52A8;&#x72B6;&#x6001;&#x3002; &#x5BF9;&#x4E8E;&#x4EE5;&#x4E0B;&#x811A;&#x672C;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x62E5;&#x6709; IP &#x5730;&#x5740;&#x5217;&#x8868;&#x7684;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#x3002; &#x4E3A;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E0E;&#x4E0A;&#x4E00;&#x4E2A;&#x79D8;&#x7C4D;&#x4E2D;&#x8BA8;&#x8BBA;&#x7684; Scapy &#x811A;&#x672C;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x76F8;&#x540C;&#x7684;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#xFF1A;</p>
<pre><code class="lang-sh"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$#</span>&quot;</span> <span class="hljs-_">-ne</span> 1 ]; <span class="hljs-keyword">then</span> 
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Usage - ./arping.sh [input file]&quot;</span> 
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Example - ./arping.sh iplist.txt&quot;</span> 
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Example will perform an ARP scan of all IP addresses defined in iplist.txt&quot;</span> 
    <span class="hljs-built_in">exit</span> 
<span class="hljs-keyword">fi</span>

file=<span class="hljs-variable">$1</span>

<span class="hljs-keyword">for</span> addr <span class="hljs-keyword">in</span> $(cat <span class="hljs-variable">$file</span>); <span class="hljs-keyword">do</span> 
    arping -c 1 <span class="hljs-variable">$addr</span> | grep <span class="hljs-string">&quot;bytes from&quot;</span> | cut <span class="hljs-_">-d</span> <span class="hljs-string">&quot; &quot;</span> <span class="hljs-_">-f</span> 5 | cut <span class="hljs-_">-d</span> <span class="hljs-string">&quot;(&quot;</span> <span class="hljs-_">-f</span> 2 | cut <span class="hljs-_">-d</span> <span class="hljs-string">&quot;)&quot;</span> <span class="hljs-_">-f</span> 1 &amp; 
<span class="hljs-keyword">done</span>
</code></pre>
<p>&#x8FD9;&#x4E2A;&#x811A;&#x672C;&#x548C;&#x524D;&#x4E00;&#x4E2A;&#x811A;&#x672C;&#x552F;&#x4E00;&#x7684;&#x4E3B;&#x8981;&#x533A;&#x522B;&#x662F;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x63A5;&#x53E3;&#x540D;&#xFF0C;&#x800C;&#x662F;&#x5728;&#x6267;&#x884C;&#x811A;&#x672C;&#x65F6;&#x63D0;&#x4F9B;&#x8F93;&#x5165;&#x5217;&#x8868;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x3002; &#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x88AB;&#x4F20;&#x9012;&#x7ED9;&#x6587;&#x4EF6;&#x53D8;&#x91CF;&#x3002; &#x7136;&#x540E;&#xFF0C;<code>for</code>&#x5FAA;&#x73AF;&#x7528;&#x4E8E;&#x5FAA;&#x73AF;&#x904D;&#x5386;&#x6B64;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x503C;&#xFF0C;&#x6765;&#x6267;&#x884C; ARPing &#x4EFB;&#x52A1;&#x3002; &#x4E3A;&#x4E86;&#x6267;&#x884C;&#x811A;&#x672C;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;&#x53E5;&#x53F7;&#x548C;&#x659C;&#x6760;&#xFF0C;&#x540E;&#x8DDF;&#x53EF;&#x6267;&#x884C;&#x811A;&#x672C;&#x7684;&#x540D;&#x79F0;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ./arping.sh 
Usage - ./arping.sh [input file] 
Example - ./arping.sh iplist.txt 
Example will perform an ARP scan of all IP addresses defined in iplist.txt 
root@KaliLinux:~# ./arping.sh iplist.txt 
172.16.36.1 
172.16.36.2 
172.16.36.132 
172.16.36.135 
172.16.36.254
</code></pre><p>&#x5728;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x4EFB;&#x4F55;&#x53C2;&#x6570;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x6267;&#x884C;&#x811A;&#x672C;&#x5C06;&#x8FD4;&#x56DE;&#x811A;&#x672C;&#x7684;&#x7528;&#x6CD5;&#x3002; &#x6B64;&#x7528;&#x6CD5;&#x8868;&#x793A;&#xFF0C;&#x5E94;&#x63D0;&#x4F9B;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x3002; &#x6B64;&#x64CD;&#x4F5C;&#x5B8C;&#x6210;&#x540E;&#x5C06;&#x6267;&#x884C;&#x811A;&#x672C;&#xFF0C;&#x5E76;&#x4ECE;&#x8F93;&#x5165;&#x7684; IP &#x5730;&#x5740;&#x5217;&#x8868;&#x8FD4;&#x56DE;&#x5B9E;&#x65F6; IP &#x5730;&#x5740;&#x5217;&#x8868;&#x3002; &#x4F7F;&#x7528;&#x4E0E;&#x524D;&#x9762;&#x8BA8;&#x8BBA;&#x7684;&#x76F8;&#x540C;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x6B64;&#x811A;&#x672C;&#x7684;&#x8F93;&#x51FA;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5C16;&#x62EC;&#x53F7;&#x8F7B;&#x6613;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x3002; &#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ./arping.sh iplist.txt &gt; output.txt 
root@KaliLinux:~# ls output.txt 
output.txt 
root@KaliLinux:~# cat output.txt 
172.16.36.1 
172.16.36.2 
172.16.36.132 
172.16.36.135 
172.16.36.254
</code></pre><p>&#x4E00;&#x65E6;&#x8F93;&#x51FA;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>ls</code>&#x547D;&#x4EE4;&#x9A8C;&#x8BC1;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x5DF2;&#x5199;&#x5165;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x6216;&#x8005;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>cat</code>&#x547D;&#x4EE4;&#x67E5;&#x770B;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#x3002;</p>
<h3 id="&#x5DE5;&#x4F5C;&#x539F;&#x7406;">&#x5DE5;&#x4F5C;&#x539F;&#x7406;</h3>
<p>ARPing &#x662F;&#x4E00;&#x4E2A;&#x5DE5;&#x5177;&#xFF0C;&#x7528;&#x4E8E;&#x9A8C;&#x8BC1;&#x5355;&#x4E2A;&#x4E3B;&#x673A;&#x662F;&#x5426;&#x5728;&#x7EBF;&#x3002; &#x7136;&#x800C;&#xFF0C;&#x5B83;&#x7684;&#x7B80;&#x5355;&#x7528;&#x6CD5;&#x7684;&#x4F7F;&#x6211;&#x4EEC;&#x5F88;&#x5BB9;&#x6613;&#x64CD;&#x4F5C;&#x5B83;&#x5728; bash &#x4E2D;&#x6309;&#x987A;&#x5E8F;&#x626B;&#x63CF;&#x591A;&#x4E2A;&#x4E3B;&#x673A;&#x3002; &#x8FD9;&#x662F;&#x901A;&#x8FC7;&#x5FAA;&#x73AF;&#x904D;&#x5386;&#x4E00;&#x7CFB;&#x5217; IP &#x5730;&#x5740;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x8FD9;&#x4E9B; IP &#x5730;&#x5740;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x63D0;&#x4F9B;&#x7ED9;&#x5DE5;&#x5177;&#x6765;&#x5B8C;&#x6210;&#x7684;&#x3002;</p>
<h2 id="23-&#x4F7F;&#x7528;-nmap-&#x63A2;&#x7D22;&#x7B2C;&#x4E8C;&#x5C42;">2.3 &#x4F7F;&#x7528; Nmap &#x63A2;&#x7D22;&#x7B2C;&#x4E8C;&#x5C42;</h2>
<p>&#x7F51;&#x7EDC;&#x6620;&#x5C04;&#x5668;&#xFF08;Nmap&#xFF09;&#x662F; Kali Linux &#x4E2D;&#x6700;&#x6709;&#x6548;&#x548C;&#x5F3A;&#x5927;&#x7684;&#x5DE5;&#x5177;&#x4E4B;&#x4E00;&#x3002; Nmap &#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x6267;&#x884C;&#x5927;&#x8303;&#x56F4;&#x7684;&#x591A;&#x79CD;&#x626B;&#x63CF;&#x6280;&#x672F;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x9AD8;&#x5EA6;&#x5B9A;&#x5236;&#x3002; &#x8FD9;&#x4E2A;&#x5DE5;&#x5177;&#x5728;&#x6574;&#x672C;&#x4E66;&#x4E2D;&#x4F1A;&#x7ECF;&#x5E38;&#x4F7F;&#x7528;&#x3002; &#x5728;&#x8FD9;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x79D8;&#x7C4D;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x8BA8;&#x8BBA;&#x5982;&#x4F55;&#x4F7F;&#x7528; Nmap &#x6267;&#x884C;&#x7B2C;2&#x5C42;&#x626B;&#x63CF;&#x3002;</p>
<h3 id="&#x51C6;&#x5907;">&#x51C6;&#x5907;</h3>
<p>&#x8981;&#x4F7F;&#x7528; ARPing &#x6267;&#x884C; ARP &#x53D1;&#x73B0;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x5728; LAN &#x4E0A;&#x81F3;&#x5C11;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x54CD;&#x5E94; ARP &#x8BF7;&#x6C42;&#x7684;&#x7CFB;&#x7EDF;&#x3002; &#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4F7F;&#x7528; Linux &#x548C; Windows &#x7CFB;&#x7EDF;&#x7684;&#x7EC4;&#x5408;&#x3002; &#x6709;&#x5173;&#x5728;&#x672C;&#x5730;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x8BBE;&#x7F6E;&#x7CFB;&#x7EDF;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x5165;&#x4E2D;&#x7684;&#x201C;&#x5B89;&#x88C5; Metasploitable2&#x201D;&#x548C;&#x201C;&#x5B89;&#x88C5; Windows Server&#x201D;&#x79D8;&#x7C4D;&#x3002;</p>
<h3 id="&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;">&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;</h3>
<p>Nmap &#x662F;&#x4F7F;&#x7528;&#x5355;&#x4E2A;&#x547D;&#x4EE4;&#x6267;&#x884C;&#x81EA;&#x52A8;&#x5316;&#x7B2C;&#x4E8C;&#x5C42;&#x53D1;&#x73B0;&#x626B;&#x63CF;&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x65B9;&#x6848;&#x3002; <code>-sn</code>&#x9009;&#x9879;&#x5728; Nmap &#x4E2D;&#x79F0;&#x4E3A;<code>ping</code>&#x626B;&#x63CF;&#x3002; &#x867D;&#x7136;&#x672F;&#x8BED;&#x201C;ping &#x626B;&#x63CF;&#x201D;&#x81EA;&#x7136;&#x4F1A;&#x5BFC;&#x81F4;&#x4F60;&#x8BA4;&#x4E3A;&#x6B63;&#x5728;&#x6267;&#x884C;&#x7B2C;&#x4E09;&#x5C42;&#x53D1;&#x73B0;&#xFF0C;&#x4F46;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x81EA;&#x9002;&#x5E94;&#x7684;&#x3002; &#x5047;&#x8BBE;&#x5C06;&#x540C;&#x4E00;&#x672C;&#x5730;&#x5B50;&#x7F51;&#x4E0A;&#x7684;&#x5730;&#x5740;&#x6307;&#x5B9A;&#x4E3A;&#x53C2;&#x6570;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#x6267;&#x884C;&#x7B2C;2&#x5C42;&#x626B;&#x63CF;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# nmap 172.16.36.135 -sn
Starting Nmap 6.25 ( http://nmap.org ) at 2013-12-16 15:40 EST 
Nmap scan report for 172.16.36.135 
Host is up (0.00038s latency). 
MAC Address: 00:0C:29:3D:84:32 (VMware) 

Nmap done: 1 IP address (1 host up) scanned in 0.17 seconds
</code></pre><p>&#x6B64;&#x547D;&#x4EE4;&#x5411; LAN &#x5E7F;&#x64AD;&#x5730;&#x5740;&#x53D1;&#x9001; ARP &#x8BF7;&#x6C42;&#xFF0C;&#x5E76;&#x6839;&#x636E;&#x63A5;&#x6536;&#x5230;&#x7684;&#x54CD;&#x5E94;&#x786E;&#x5B9A;&#x4E3B;&#x673A;&#x662F;&#x5426;&#x5904;&#x4E8E;&#x6D3B;&#x52A8;&#x72B6;&#x6001;&#x3002; &#x6216;&#x8005;&#xFF0C;&#x5982;&#x679C;&#x5BF9;&#x4E0D;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x7684; IP &#x5730;&#x5740;&#x4F7F;&#x7528;&#x8BE5;&#x547D;&#x4EE4;&#xFF0C;&#x5219;&#x54CD;&#x5E94;&#x4F1A;&#x8868;&#x793A;&#x4E3B;&#x673A;&#x5173;&#x95ED;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# nmap 172.16.36.136 -sn
Starting Nmap 6.25 ( http://nmap.org ) at 2013-12-16 15:51 EST 
Note: Host seems down. If it is really up, but blocking our ping probes, try -Pn 

Nmap done: 1 IP address (0 hosts up) scanned in 0.41 seconds
</code></pre><p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x6B64;&#x547D;&#x4EE4;&#xFF0C;&#x6765;&#x4F7F;&#x7528;&#x7834;&#x6298;&#x53F7;&#x7B26;&#x53F7;&#x5BF9;&#x4E00;&#x7CFB;&#x5217;&#x987A;&#x5E8F; IP &#x5730;&#x5740;&#x6267;&#x884C;&#x7B2C;2&#x5C42;&#x53D1;&#x73B0;&#x3002; &#x8981;&#x626B;&#x63CF;&#x5B8C;&#x6574;&#x7684;<code>/ 24</code>&#x8303;&#x56F4;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>0-255</code>&#xFF1A;</p>
<pre><code>root@KaliLinux:~# nmap 172.16.36.0-255 -sn
Starting 
Nmap 6.25 ( http://nmap.org ) at 2013-12-11 05:35 EST 
Nmap scan report for 172.16.36.1 
Host is up (0.00027s latency). 
MAC Address: 00:50:56:C0:00:08 (VMware) 
Nmap scan report for 172.16.36.2 
Host is up (0.00032s latency). 
MAC Address: 00:50:56:FF:2A:8E (VMware) 
Nmap scan report for 172.16.36.132 
Host is up. 
Nmap scan report for 172.16.36.135 
Host is up (0.00051s latency). 
MAC Address: 00:0C:29:3D:84:32 (VMware) 
Nmap scan report for 172.16.36.200 
Host is up (0.00026s latency). 
MAC Address: 00:0C:29:23:71:62 (VMware) 
Nmap scan report for 172.16.36.254 
Host is up (0.00015s latency). 
MAC Address: 00:50:56:EA:54:3A (VMware) 

Nmap done: 256 IP addresses (6 hosts up) scanned in 3.22 seconds
</code></pre><p>&#x4F7F;&#x7528;&#x6B64;&#x547D;&#x4EE4;&#x5C06;&#x5411;&#x8BE5;&#x8303;&#x56F4;&#x5185;&#x7684;&#x6240;&#x6709;&#x4E3B;&#x673A;&#x53D1;&#x9001; ARP &#x5E7F;&#x64AD;&#x8BF7;&#x6C42;&#xFF0C;&#x5E76;&#x786E;&#x5B9A;&#x6BCF;&#x4E2A;&#x4E3B;&#x52A8;&#x54CD;&#x5E94;&#x7684;&#x4E3B;&#x673A;&#x3002; &#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>-iL</code>&#x9009;&#x9879;&#x5BF9; IP &#x5730;&#x5740;&#x7684;&#x8F93;&#x5165;&#x5217;&#x8868;&#x6267;&#x884C;&#x6B64;&#x626B;&#x63CF;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# nmap -iL iplist.txt -sn

Starting Nmap 6.25 ( http://nmap.org ) at 2013-12-16 16:07 EST 
Nmap scan report for 172.16.36.2 
Host is up (0.00026s latency). 
MAC Address: 00:50:56:FF:2A:8E (VMware) 
Nmap scan report for 172.16.36.1

Host is up (0.00021s latency). 
MAC Address: 00:50:56:C0:00:08 (VMware) 
Nmap scan report for 172.16.36.132 
Host is up (0.00031s latency). 
MAC Address: 00:0C:29:65:FC:D2 (VMware) 
Nmap scan report for 172.16.36.135 
Host is up (0.00014s latency). 
MAC Address: 00:0C:29:3D:84:32 (VMware) 
Nmap scan report for 172.16.36.180 
Host is up. 
Nmap scan report for 172.16.36.254 
Host is up (0.00024s latency). 
MAC Address: 00:50:56:EF:B9:9C (VMware) 

Nmap done: 8 IP addresses (6 hosts up) scanned in 0.41 seconds
</code></pre><p>&#x5F53;&#x4F7F;&#x7528;<code>-sn</code>&#x9009;&#x9879;&#x65F6;&#xFF0C;Nmap &#x5C06;&#x9996;&#x5148;&#x5C1D;&#x8BD5;&#x4F7F;&#x7528;&#x7B2C;2&#x5C42; ARP &#x8BF7;&#x6C42;&#x5B9A;&#x4F4D;&#x4E3B;&#x673A;&#xFF0C;&#x5E76;&#x4E14;&#x5982;&#x679C;&#x4E3B;&#x673A;&#x4E0D;&#x4F4D;&#x4E8E; LAN &#x4E0A;&#xFF0C;&#x5B83;&#x5C06;&#x4EC5;&#x4F7F;&#x7528;&#x7B2C;3&#x5C42; ICMP &#x8BF7;&#x6C42;&#x3002; &#x6CE8;&#x610F;&#x5BF9;&#x672C;&#x5730;&#x7F51;&#x7EDC;&#xFF08;&#x5728;<code>172.16.36.0/24</code>&#x4E13;&#x7528;&#x8303;&#x56F4;&#xFF09;&#x4E0A;&#x7684;&#x4E3B;&#x673A;&#x6267;&#x884C;&#x7684; Nmap ping &#x626B;&#x63CF;&#x624D;&#x80FD;&#x8FD4;&#x56DE; MAC &#x5730;&#x5740;&#x3002; &#x8FD9;&#x662F;&#x56E0;&#x4E3A; MAC &#x5730;&#x5740;&#x7531;&#x6765;&#x81EA;&#x4E3B;&#x673A;&#x7684; ARP &#x54CD;&#x5E94;&#x8FD4;&#x56DE;&#x3002; &#x4F46;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x5BF9;&#x4E0D;&#x540C; LAN &#x4E0A;&#x7684;&#x8FDC;&#x7A0B;&#x4E3B;&#x673A;&#x6267;&#x884C;&#x76F8;&#x540C;&#x7684; Nmap ping &#x626B;&#x63CF;&#xFF0C;&#x5219;&#x54CD;&#x5E94;&#x4E0D;&#x4F1A;&#x5305;&#x62EC;&#x7CFB;&#x7EDF;&#x7684; MAC &#x5730;&#x5740;&#x3002;</p>
<pre><code>root@KaliLinux:~# nmap -sn 74.125.21.0-255
Starting Nmap 6.25 ( http://nmap.org ) at 2013-12-11 05:42 EST 
Nmap scan report for 74.125.21.0 
Host is up (0.0024s latency). 
Nmap scan report for 74.125.21.1 
Host is up (0.00017s latency). 
Nmap scan report for 74.125.21.2 
Host is up (0.00028s latency). 
Nmap scan report for 74.125.21.3 
Host is up (0.00017s latency).
</code></pre><p>&#x5F53;&#x5BF9;&#x8FDC;&#x7A0B;&#x7F51;&#x7EDC;&#x8303;&#x56F4;&#xFF08;&#x516C;&#x5171;&#x8303;&#x56F4;<code>74.125.21.0/24</code>&#xFF09;&#x6267;&#x884C;&#x65F6;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x4F7F;&#x7528;&#x4E86;&#x7B2C;&#x4E09;&#x5C42;&#x53D1;&#x73B0;&#xFF0C;&#x56E0;&#x4E3A;&#x6CA1;&#x6709;&#x8FD4;&#x56DE; MAC &#x5730;&#x5740;&#x3002; &#x8FD9;&#x8868;&#x660E;&#xFF0C;Nmap &#x4F1A;&#x5C3D;&#x53EF;&#x80FD;&#x81EA;&#x52A8;&#x5229;&#x7528;&#x7B2C;&#x4E8C;&#x5C42;&#x53D1;&#x73B0;&#x7684;&#x901F;&#x5EA6;&#xFF0C;&#x4F46;&#x5728;&#x5FC5;&#x8981;&#x65F6;&#xFF0C;&#x5B83;&#x5C06;&#x4F7F;&#x7528;&#x53EF;&#x8DEF;&#x7531;&#x7684; ICMP &#x8BF7;&#x6C42;&#xFF0C;&#x5728;&#x7B2C;&#x4E09;&#x5C42;&#x4E0A;&#x53D1;&#x73B0;&#x8FDC;&#x7A0B;&#x4E3B;&#x673A;&#x3002;&#x5982;&#x679C;&#x4F60;&#x4F7F;&#x7528; Wireshark &#x76D1;&#x63A7;&#x6D41;&#x91CF;&#xFF0C;&#x800C; Nmap &#x5BF9;&#x672C;&#x5730;&#x7F51;&#x7EDC;&#x4E0A;&#x7684;&#x4E3B;&#x673A;&#x6267;&#x884C; ping &#x626B;&#x63CF;&#x3002; &#x5728;&#x4EE5;&#x4E0B;&#x5C4F;&#x5E55;&#x622A;&#x56FE;&#x4E2D;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x770B;&#x5230; Nmap &#x5229;&#x7528; ARP &#x8BF7;&#x6C42;&#x6765;&#x8BC6;&#x522B;&#x672C;&#x5730;&#x6BB5;&#x8303;&#x56F4;&#x5185;&#x7684;&#x4E3B;&#x673A;&#xFF1A;</p>
<p><img src="img/2-3-1.jpg" alt=""></p>
<h3 id="&#x5DE5;&#x4F5C;&#x539F;&#x7406;">&#x5DE5;&#x4F5C;&#x539F;&#x7406;</h3>
<p>Nmap &#x5DF2;&#x7ECF;&#x9AD8;&#x5EA6;&#x529F;&#x80FD;&#x5316;&#xFF0C;&#x9700;&#x8981;&#x5F88;&#x5C11;&#x751A;&#x81F3;&#x65E0;&#x9700;&#x8C03;&#x6574;&#x5C31;&#x53EF;&#x4EE5;&#x8FD0;&#x884C;&#x6240;&#x9700;&#x7684;&#x626B;&#x63CF;&#x3002; &#x5E95;&#x5C42;&#x7684;&#x539F;&#x7406;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002; Nmap &#x5C06; ARP &#x8BF7;&#x6C42;&#x53D1;&#x9001;&#x5230;&#x4E00;&#x7CFB;&#x5217; IP &#x5730;&#x5740;&#x7684;&#x5E7F;&#x64AD;&#x5730;&#x5740;&#xFF0C;&#x5E76;&#x901A;&#x8FC7;&#x6807;&#x8BB0;&#x54CD;&#x5E94;&#x6765;&#x8BC6;&#x522B;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x3002; &#x4F46;&#x662F;&#xFF0C;&#x7531;&#x4E8E;&#x6B64;&#x529F;&#x80FD;&#x5DF2;&#x96C6;&#x6210;&#x5230; Nmap &#x4E2D;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x63D0;&#x4F9B;&#x9002;&#x5F53;&#x7684;&#x53C2;&#x6570;&#x6765;&#x6267;&#x884C;&#x3002;</p>
<h2 id="24-&#x4F7F;&#x7528;-netdiscover-&#x63A2;&#x7D22;&#x7B2C;&#x4E8C;&#x5C42;">2.4 &#x4F7F;&#x7528; NetDiscover &#x63A2;&#x7D22;&#x7B2C;&#x4E8C;&#x5C42;</h2>
<p>NetDiscover&#x662F;&#x4E00;&#x4E2A;&#x5DE5;&#x5177;&#xFF0C;&#x7528;&#x4E8E;&#x901A;&#x8FC7; ARP &#x4E3B;&#x52A8;&#x548C;&#x88AB;&#x52A8;&#x5206;&#x6790;&#x8BC6;&#x522B;&#x7F51;&#x7EDC;&#x4E3B;&#x673A;&#x3002; &#x5B83;&#x4E3B;&#x8981;&#x662F;&#x5728;&#x65E0;&#x7EBF;&#x63A5;&#x53E3;&#x4E0A;&#x4F7F;&#x7528;; &#x7136;&#x800C;&#xFF0C;&#x5B83;&#x5728;&#x5176;&#x5B83;&#x73AF;&#x5883;&#x4E2D;&#x4E0A;&#x4E5F;&#x5177;&#x6709;&#x529F;&#x80FD;&#x3002; &#x5728;&#x8FD9;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x79D8;&#x7C4D;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x8BA8;&#x8BBA;&#x5982;&#x4F55;&#x4F7F;&#x7528; NetDiscover &#x8FDB;&#x884C;&#x4E3B;&#x52A8;&#x548C;&#x88AB;&#x52A8;&#x626B;&#x63CF;&#x3002;</p>
<h3 id="&#x51C6;&#x5907;">&#x51C6;&#x5907;</h3>
<p>&#x8981;&#x4F7F;&#x7528; NetDiscover &#x6267;&#x884C; ARP &#x53D1;&#x73B0;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x5728; LAN &#x4E0A;&#x81F3;&#x5C11;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x54CD;&#x5E94; ARP &#x8BF7;&#x6C42;&#x7684;&#x7CFB;&#x7EDF;&#x3002; &#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4F7F;&#x7528; Linux &#x548C; Windows &#x7CFB;&#x7EDF;&#x7684;&#x7EC4;&#x5408;&#x3002; &#x6709;&#x5173;&#x5728;&#x672C;&#x5730;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x8BBE;&#x7F6E;&#x7CFB;&#x7EDF;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x5165;&#x4E2D;&#x7684;&#x201C;&#x5B89;&#x88C5; Metasploitable2&#x201D;&#x548C;&#x201C;&#x5B89;&#x88C5; Windows Server&#x201D;&#x79D8;&#x7C4D;&#x3002;</p>
<h3 id="&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;">&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;</h3>
<p>NetDiscover &#x662F;&#x4E13;&#x95E8;&#x4E3A;&#x6267;&#x884C;&#x7B2C;2&#x5C42;&#x53D1;&#x73B0;&#x800C;&#x8BBE;&#x8BA1;&#x7684;&#x5DE5;&#x5177;&#x3002; NetDiscover &#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x626B;&#x63CF;&#x4E00;&#x7CFB;&#x5217; IP &#x5730;&#x5740;&#xFF0C;&#x65B9;&#x6CD5;&#x662F;&#x4F7F;&#x7528;<code>-r</code>&#x9009;&#x9879;&#x4EE5; CIDR &#x8868;&#x793A;&#x6CD5;&#x4E2D;&#x7684;&#x7F51;&#x7EDC;&#x8303;&#x56F4;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x3002; &#x8F93;&#x51FA;&#x5C06;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x8868;&#x683C;&#xFF0C;&#x5176;&#x4E2D;&#x5217;&#x51FA;&#x4E86;&#x6D3B;&#x52A8; IP &#x5730;&#x5740;&#xFF0C;&#x76F8;&#x5E94;&#x7684; MAC &#x5730;&#x5740;&#xFF0C;&#x54CD;&#x5E94;&#x6570;&#x91CF;&#xFF0C;&#x54CD;&#x5E94;&#x7684;&#x957F;&#x5EA6;&#x548C; MAC &#x5382;&#x5546;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# netdiscover -r 172.16.36.0/24

Currently scanning: Finished!   |   Screen View: Unique Hosts
5 Captured ARP Req/Rep packets, from 5 hosts.   Total size: 300
________________________________________________________________________ _____   
IP            At MAC Address      Count  Len   MAC Vendor
----------------------------------------------------------------------------
172.16.36.1     00:50:56:c0:00:08    01    060   VMWare, Inc.
172.16.36.2     00:50:56:ff:2a:8e    01    060   VMWare, Inc.
172.16.36.132   00:0c:29:65:fc:d2    01    060   VMware, Inc.
172.16.36.135   00:0c:29:3d:84:32    01    060   VMware, Inc.
172.16.36.254   00:50:56:ef:b9:9c    01    060   VMWare, Inc.
</code></pre><p>NetDiscover &#x8FD8;&#x53EF;&#x7528;&#x4E8E;&#x626B;&#x63CF;&#x6765;&#x81EA;&#x8F93;&#x5165;&#x6587;&#x672C;&#x6587;&#x4EF6;&#x7684; IP &#x5730;&#x5740;&#x3002; &#x4E0D;&#x662F;&#x5C06; CIDR &#x8303;&#x56F4;&#x7B26;&#x53F7;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x9012;&#xFF0C;<code>-l</code>&#x9009;&#x9879;&#x53EF;&#x4EE5;&#x4E0E;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#x7684;&#x540D;&#x79F0;&#x6216;&#x8DEF;&#x5F84;&#x7ED3;&#x5408;&#x4F7F;&#x7528;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# netdiscover -l iplist.txt 

Currently scanning: 172.16.36.0/24   |   Screen View: Unique Hosts
39 Captured ARP Req/Rep packets, from 5 hosts.   Total size: 2340
________________________________________________________________________ _____
IP            At MAC Address      Count  Len   MAC Vendor                    ----------------------------------------------------------------------------
172.16.36.1     00:50:56:c0:00:08    08    480   VMWare, Inc.
172.16.36.2     00:50:56:ff:2a:8e    08    480   VMWare, Inc.
172.16.36.132   00:0c:29:65:fc:d2    08    480   VMware, Inc.
172.16.36.135   00:0c:29:3d:84:32    08    480   VMware, Inc.
172.16.36.254   00:50:56:ef:b9:9c    07    420   VMWare, Inc.
</code></pre><p>&#x5C06;&#x6B64;&#x5DE5;&#x5177;&#x4E0E;&#x5176;&#x4ED6;&#x5DE5;&#x5177;&#x533A;&#x5206;&#x5F00;&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x72EC;&#x7279;&#x529F;&#x80FD;&#x662F;&#x6267;&#x884C;&#x88AB;&#x52A8;&#x53D1;&#x73B0;&#x7684;&#x529F;&#x80FD;&#x3002; &#x5BF9;&#x6574;&#x4E2A;&#x5B50;&#x7F51;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A; IP &#x5730;&#x5740; ARP &#x5E7F;&#x64AD;&#x8BF7;&#x6C42;&#x6709;&#x65F6;&#x53EF;&#x4EE5;&#x89E6;&#x53D1;&#x6765;&#x81EA;&#x5B89;&#x5168;&#x8BBE;&#x5907;&#xFF08;&#x4F8B;&#x5982;&#x5165;&#x4FB5;&#x68C0;&#x6D4B;&#x7CFB;&#x7EDF;&#xFF08;IDS&#xFF09;&#x6216;&#x5165;&#x4FB5;&#x9632;&#x5FA1;&#x7CFB;&#x7EDF;&#xFF08;IPS&#xFF09;&#xFF09;&#x7684;&#x8B66;&#x62A5;&#x6216;&#x54CD;&#x5E94;&#x3002; &#x66F4;&#x9690;&#x79D8;&#x7684;&#x65B9;&#x6CD5;&#x662F;&#x4FA6;&#x542C; ARP &#x6D41;&#x91CF;&#xFF0C;&#x56E0;&#x4E3A;&#x626B;&#x63CF;&#x7CFB;&#x7EDF;&#x81EA;&#x7136;&#x4F1A;&#x4E0E;&#x7F51;&#x7EDC;&#x4E0A;&#x7684;&#x5176;&#x4ED6;&#x7CFB;&#x7EDF;&#x4EA4;&#x4E92;&#xFF0C;&#x7136;&#x540E;&#x8BB0;&#x5F55;&#x4ECE; ARP &#x54CD;&#x5E94;&#x6536;&#x96C6;&#x7684;&#x6570;&#x636E;&#x3002; &#x8FD9;&#x79CD;&#x88AB;&#x52A8;&#x626B;&#x63CF;&#x6280;&#x672F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>-p</code>&#x9009;&#x9879;&#x6267;&#x884C;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# netdiscover -p

Currently scanning: (passive)   |   Screen View: Unique Hosts
4 Captured ARP Req/Rep packets, from 2 hosts.   Total size: 240
________________________________________________________________________ _____
IP            At MAC Address      Count  Len   MAC Vendor                    
----------------------------------------------------------------------------
172.16.36.132   00:0c:29:65:fc:d2    02    120   VMware, Inc.
172.16.36.135   00:0c:29:3d:84:32    02    120   VMware, Inc.
</code></pre><p>&#x8FD9;&#x79CD;&#x6280;&#x672F;&#x5728;&#x6536;&#x96C6;&#x4FE1;&#x606F;&#x65B9;&#x9762;&#x660E;&#x663E;&#x66F4;&#x6162;&#xFF0C;&#x56E0;&#x4E3A;&#x8BF7;&#x6C42;&#x5FC5;&#x987B;&#x4F5C;&#x4E3A;&#x6B63;&#x5E38;&#x7F51;&#x7EDC;&#x4EA4;&#x4E92;&#x7684;&#x7ED3;&#x679C;&#x4EA7;&#x751F;&#xFF0C;&#x4F46;&#x662F;&#x5B83;&#x4E5F;&#x4E0D;&#x4F1A;&#x5F15;&#x8D77;&#x4EFB;&#x4F55;&#x4E0D;&#x5FC5;&#x8981;&#x7684;&#x6CE8;&#x610F;&#x3002; &#x5982;&#x679C;&#x5B83;&#x5728;&#x65E0;&#x7EBF;&#x7F51;&#x7EDC;&#x4E0A;&#x8FD0;&#x884C;&#xFF0C;&#x8FD9;&#x79CD;&#x6280;&#x672F;&#x66F4;&#x6709;&#x6548;&#xFF0C;&#x56E0;&#x4E3A;&#x6DF7;&#x6742;&#x6A21;&#x5F0F;&#x4E0B;&#xFF0C;&#x65E0;&#x7EBF;&#x9002;&#x914D;&#x5668;&#x4F1A;&#x63A5;&#x6536;&#x5230;&#x76EE;&#x6807;&#x662F;&#x5176;&#x4ED6;&#x8BBE;&#x5907;&#x7684; ARP &#x5E94;&#x7B54;&#x3002; &#x4E3A;&#x4E86;&#x5728;&#x4EA4;&#x6362;&#x73AF;&#x5883;&#x4E2D;&#x6709;&#x6548;&#x5DE5;&#x4F5C;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x8BBF;&#x95EE; SPAN &#x6216; TAP&#xFF0C;&#x6216;&#x8005;&#x9700;&#x8981;&#x91CD;&#x8F7D; CAM &#x8868;&#x6765;&#x5F3A;&#x5236;&#x4EA4;&#x6362;&#x673A;&#x5F00;&#x59CB;&#x5E7F;&#x64AD;&#x6240;&#x6709;&#x6D41;&#x91CF;&#x3002;</p>
<h3 id="&#x5DE5;&#x4F5C;&#x539F;&#x7406;">&#x5DE5;&#x4F5C;&#x539F;&#x7406;</h3>
<p>NetDiscover ARP &#x53D1;&#x73B0;&#x7684;&#x57FA;&#x672C;&#x539F;&#x7406;&#x4E0E;&#x6211;&#x4EEC;&#x4E4B;&#x524D;&#x6240;&#x8BA8;&#x8BBA;&#x7684;&#x7B2C;2&#x5C42;&#x53D1;&#x73B0;&#x65B9;&#x6CD5;&#x7684;&#x57FA;&#x672C;&#x76F8;&#x540C;&#x3002; &#x8FD9;&#x4E2A;&#x5DE5;&#x5177;&#x548C;&#x6211;&#x4EEC;&#x8BA8;&#x8BBA;&#x7684;&#x5176;&#x4ED6;&#x4E00;&#x4E9B;&#x5DE5;&#x5177;&#x7684;&#x4E3B;&#x8981;&#x533A;&#x522B;&#xFF0C;&#x5305;&#x62EC;&#x88AB;&#x52A8;&#x53D1;&#x73B0;&#x6A21;&#x5F0F;&#xFF0C;&#x4EE5;&#x53CA;&#x5728;&#x8F93;&#x51FA;&#x4E2D;&#x5305;&#x542B; MAC &#x5382;&#x5546;&#x3002; &#x5728;&#x5927;&#x591A;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x88AB;&#x52A8;&#x6A21;&#x5F0F;&#x5728;&#x4EA4;&#x6362;&#x7F51;&#x7EDC;&#x4E0A;&#x662F;&#x65E0;&#x7528;&#x7684;&#xFF0C;&#x56E0;&#x4E3A; ARP &#x54CD;&#x5E94;&#x7684;&#x63A5;&#x6536;&#x4ECD;&#x7136;&#x9700;&#x8981;&#x4E0E;&#x53D1;&#x73B0;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x6267;&#x884C;&#x4E00;&#x4E9B;&#x4EA4;&#x4E92;&#xFF0C;&#x5C3D;&#x7BA1;&#x5B83;&#x4EEC;&#x72EC;&#x7ACB;&#x4E8E; NetDiscover &#x5DE5;&#x5177;&#x3002; &#x7136;&#x800C;&#xFF0C;&#x91CD;&#x8981;&#x7684;&#x662F;&#x7406;&#x89E3;&#x8BE5;&#x7279;&#x5F81;&#xFF0C;&#x53CA;&#x5176;&#x5B83;&#x4EEC;&#x5728;&#x4F8B;&#x5982;&#x96C6;&#x7EBF;&#x5668;&#x6216;&#x65E0;&#x7EBF;&#x7F51;&#x7EDC;&#x7684;&#x5E7F;&#x64AD;&#x7F51;&#x7EDC;&#x4E2D;&#x53EF;&#x80FD;&#x4F1A;&#x6709;&#x7528;&#x3002; NetDiscover &#x901A;&#x8FC7;&#x8BC4;&#x4F30;&#x8FD4;&#x56DE;&#x7684; MAC &#x5730;&#x5740;&#x7684;&#x524D;&#x534A;&#x90E8;&#x5206;&#xFF08;&#x524D;3&#x4E2A;&#x5B57;&#x8282;/ 24&#x4F4D;&#xFF09;&#x6765;&#x8BC6;&#x522B; MAC &#x5382;&#x5546;&#x3002; &#x8FD9;&#x90E8;&#x5206;&#x5730;&#x5740;&#x6807;&#x8BC6;&#x7F51;&#x7EDC;&#x63A5;&#x53E3;&#x7684;&#x5236;&#x9020;&#x5546;&#xFF0C;&#x5E76;&#x4E14;&#x901A;&#x5E38;&#x662F;&#x8BBE;&#x5907;&#x5176;&#x4F59;&#x90E8;&#x5206;&#x7684;&#x786C;&#x4EF6;&#x5236;&#x9020;&#x5546;&#x7684;&#x826F;&#x597D;&#x6807;&#x8BC6;&#x3002;</p>
<h2 id="25-&#x4F7F;&#x7528;-metasploit-&#x63A2;&#x7D22;&#x7B2C;&#x4E8C;&#x5C42;">2.5 &#x4F7F;&#x7528; Metasploit &#x63A2;&#x7D22;&#x7B2C;&#x4E8C;&#x5C42;</h2>
<p>Metasploit &#x4E3B;&#x8981;&#x662F;&#x6F0F;&#x6D1E;&#x5229;&#x7528;&#x5DE5;&#x5177;&#xFF0C;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x5C06;&#x5728;&#x63A5;&#x4E0B;&#x6765;&#x7684;&#x7AE0;&#x8282;&#x4E2D;&#x8BE6;&#x7EC6;&#x8BA8;&#x8BBA;&#x3002; &#x7136;&#x800C;&#xFF0C;&#x9664;&#x4E86;&#x5176;&#x4E3B;&#x8981;&#x529F;&#x80FD;&#x4E4B;&#x5916;&#xFF0C;Metasploit &#x8FD8;&#x6709;&#x4E00;&#x4E9B;&#x8F85;&#x52A9;&#x6A21;&#x5757;&#xFF0C;&#x53EF;&#x7528;&#x4E8E;&#x5404;&#x79CD;&#x626B;&#x63CF;&#x548C;&#x4FE1;&#x606F;&#x6536;&#x96C6;&#x4EFB;&#x52A1;&#x3002; &#x7279;&#x522B;&#x662F;&#xFF0C;&#x7531;&#x4E00;&#x4E2A;&#x8F85;&#x52A9;&#x6A21;&#x5757;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x5728;&#x672C;&#x5730;&#x5B50;&#x7F51;&#x4E0A;&#x6267;&#x884C; ARP &#x626B;&#x63CF;&#x3002; &#x8FD9;&#x5BF9;&#x8BB8;&#x591A;&#x4EBA;&#x90FD;&#x6709;&#x5E2E;&#x52A9;&#xFF0C;&#x56E0;&#x4E3A; Metasploit &#x662F;&#x5927;&#x591A;&#x6570;&#x6E17;&#x900F;&#x6D4B;&#x8BD5;&#x4EBA;&#x5458;&#x719F;&#x6089;&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x5E76;&#x4E14;&#x5C06;&#x8BE5;&#x529F;&#x80FD;&#x96C6;&#x6210;&#x5230; Metasploit &#x4E2D;&#xFF0C;&#x51CF;&#x5C11;&#x4E86;&#x7ED9;&#x5B9A;&#x6D4B;&#x8BD5;&#x9636;&#x6BB5;&#x5185;&#x6240;&#x9700;&#x7684;&#x5DE5;&#x5177;&#x603B;&#x6570;&#x3002; &#x8FD9;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x79D8;&#x7C4D;&#x6F14;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x4F7F;&#x7528; Metasploit &#x6765;&#x6267;&#x884C; ARP &#x53D1;&#x73B0;&#x3002;</p>
<h3 id="&#x51C6;&#x5907;">&#x51C6;&#x5907;</h3>
<p>&#x8981;&#x4F7F;&#x7528; Metasploit &#x6267;&#x884C; ARP &#x53D1;&#x73B0;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x5728; LAN &#x4E0A;&#x81F3;&#x5C11;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x54CD;&#x5E94; ARP &#x8BF7;&#x6C42;&#x7684;&#x7CFB;&#x7EDF;&#x3002; &#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4F7F;&#x7528; Linux &#x548C; Windows &#x7CFB;&#x7EDF;&#x7684;&#x7EC4;&#x5408;&#x3002; &#x6709;&#x5173;&#x5728;&#x672C;&#x5730;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x8BBE;&#x7F6E;&#x7CFB;&#x7EDF;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x5165;&#x4E2D;&#x7684;&#x201C;&#x5B89;&#x88C5; Metasploitable2&#x201D;&#x548C;&#x201C;&#x5B89;&#x88C5; Windows Server&#x201D;&#x79D8;&#x7C4D;&#x3002;</p>
<h3 id="&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;">&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;</h3>
<p>&#x867D;&#x7136;&#x7ECF;&#x5E38;&#x88AB;&#x8BA4;&#x4E3A;&#x662F;&#x4E00;&#x4E2A;&#x5229;&#x7528;&#x6846;&#x67B6;&#xFF0C;Metasploit &#x4E5F;&#x6709;&#x5927;&#x91CF;&#x7684;&#x8F85;&#x52A9;&#x6A21;&#x5757;&#xFF0C;&#x53EF;&#x7528;&#x4E8E;&#x626B;&#x63CF;&#x548C;&#x4FE1;&#x606F;&#x6536;&#x96C6;&#x3002; &#x7279;&#x522B;&#x662F;&#x6709;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x6267;&#x884C;&#x7B2C;&#x4E8C;&#x5C42;&#x53D1;&#x73B0;&#x7684;&#x8F85;&#x52A9;&#x6A21;&#x5757;&#x3002; &#x8981;&#x542F;&#x52A8; Metasploit &#x6846;&#x67B6;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<code>msfconsole</code>&#x547D;&#x4EE4;&#x3002; &#x7136;&#x540E;&#xFF0C;&#x4F7F;&#x7528;&#x547D;&#x4EE4;&#x7ED3;&#x5408;&#x6240;&#x9700;&#x7684;&#x6A21;&#x5757;&#x6765;&#x914D;&#x7F6E;&#x626B;&#x63CF;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# msfconsole

MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM 
MMMMMMMMMMM                MMMMMMMMMM 
MMMN$                           vMMMM 
MMMNl  MMMMM             MMMMM  JMMMM 
MMMNl  MMMMMMMN       NMMMMMMM  JMMMM 
MMMNl  MMMMMMMMMNmmmNMMMMMMMMM  JMMMM 
MMMNI  MMMMMMMMMMMMMMMMMMMMMMM  jMMMM 
MMMNI  MMMMMMMMMMMMMMMMMMMMMMM  jMMMM 
MMMNI  MMMMM   MMMMMMM   MMMMM  jMMMM 
MMMNI  MMMMM   MMMMMMM   MMMMM  jMMMM 
MMMNI  MMMNM   MMMMMMM   MMMMM  jMMMM 
MMMNI  WMMMM   MMMMMMM   MMMM#  JMMMM 
MMMMR  ?MMNM             MMMMM .dMMMM 
MMMMNm `?MMM             MMMM` dMMMMM 
MMMMMMN  ?MM             MM?  NMMMMMN 
MMMMMMMMNe                 JMMMMMNMMM 
MMMMMMMMMMNm,            eMMMMMNMMNMM 
MMMMNNMNMMMMMNx        MMMMMMNMMNMMNM MMMMMMMMNMMNMMMMm+..+MMNMMNMNMMNMMNMM
        http://metasploit.pro

Frustrated with proxy pivoting? Upgrade to layer-2 VPN pivoting with Metasploit Pro -- type &apos;go_pro&apos; to launch it now.

       =[ metasploit v4.6.0-dev [core:4.6 api:1.0] 
+ -- --=[ 1053 exploits - 590 auxiliary - 174 post 
+ -- --=[ 275 payloads - 28 encoders - 8 nops

msf &gt; use auxiliary/scanner/discovery/arp_sweep 
msf  auxiliary(arp_sweep) &gt;
</code></pre><p>&#x9009;&#x62E9;&#x6A21;&#x5757;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>show options</code>&#x547D;&#x4EE4;&#x67E5;&#x770B;&#x53EF;&#x914D;&#x7F6E;&#x9009;&#x9879;&#xFF1A;</p>
<pre><code>msf  auxiliary(arp_sweep) &gt; show options

Module options (auxiliary/scanner/discovery/arp_sweep):

   Name       Current Setting  Required  Description   
   ----       ---------------  --------  ----------   
   INTERFACE                   no        The name of the interface   
   RHOSTS                      yes       The target address range or CIDR identifier   
   SHOST                       no        Source IP Address   
   SMAC                        no        Source MAC Address   
   THREADS    1                yes       The number of concurrent threads   
   TIMEOUT    5                yes       The number of seconds to wait for new data
</code></pre><p>&#x8FD9;&#x4E9B;&#x914D;&#x7F6E;&#x9009;&#x9879;&#x6307;&#x5B9A;&#x8981;&#x626B;&#x63CF;&#x7684;&#x76EE;&#x6807;&#xFF0C;&#x626B;&#x63CF;&#x7CFB;&#x7EDF;&#x548C;&#x626B;&#x63CF;&#x8BBE;&#x7F6E;&#x7684;&#x4FE1;&#x606F;&#x3002; &#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x68C0;&#x67E5;&#x626B;&#x63CF;&#x7CFB;&#x7EDF;&#x7684;&#x63A5;&#x53E3;&#x914D;&#x7F6E;&#x6765;&#x6536;&#x96C6;&#x7528;&#x4E8E;&#x8BE5;&#x7279;&#x5B9A;&#x626B;&#x63CF;&#x7684;&#x5927;&#x591A;&#x6570;&#x4FE1;&#x606F;&#x3002; &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5341;&#x5206;&#x65B9;&#x4FBF;&#x5730;&#x5728; Metasploit Framework &#x63A7;&#x5236;&#x53F0;&#x4E2D;&#x53EF;&#x4EE5;&#x4F20;&#x5165;&#x7CFB;&#x7EDF; shell &#x547D;&#x4EE4;&#x3002; &#x5728;&#x4EE5;&#x4E0B;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5728;&#x4E0D;&#x79BB;&#x5F00; Metasploit Framework &#x63A7;&#x5236;&#x53F0;&#x754C;&#x9762;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8FDB;&#x884C;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6765;&#x6267;&#x884C;<code>ifconfig</code>&#xFF1A;</p>
<pre><code>msf  auxiliary(arp_sweep) &gt; ifconfig eth1 

[*] exec: ifconfig eth1

eth1      Link encap:Ethernet  HWaddr 00:0c:29:09:c3:79            
          inet addr:172.16.36.180  Bcast:172.16.36.255  Mask:255.255.255.0          
          inet6 addr: fe80::20c:29ff:fe09:c379/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:1576971 errors:1 dropped:0 overruns:0 frame:0     
          TX packets:1157669 errors:0 dropped:0 overruns:0 carrier:0      
          collisions:0 txqueuelen:1000        
          RX bytes:226795966 (216.2 MiB)  TX bytes:109929055 (104.8 MiB)        
          Interrupt:19 Base address:0x2080
</code></pre><p>&#x7528;&#x4E8E;&#x6B64;&#x626B;&#x63CF;&#x7684;&#x63A5;&#x53E3;&#x662F;<code>eth1</code>&#x3002; &#x7531;&#x4E8E;&#x7B2C;&#x4E8C;&#x5C42;&#x626B;&#x63CF;&#x4EC5;&#x80FD;&#x591F;&#x6709;&#x6548;&#x5730;&#x8BC6;&#x522B;&#x672C;&#x5730;&#x5B50;&#x7F51;&#x4E0A;&#x7684;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x67E5;&#x770B;&#x626B;&#x63CF;&#x7CFB;&#x7EDF; IP &#x548C;&#x5B50;&#x7F51;&#x63A9;&#x7801;&#x4EE5;&#x786E;&#x5B9A;&#x8981;&#x626B;&#x63CF;&#x7684;&#x8303;&#x56F4;&#x3002; &#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;IP &#x5730;&#x5740;&#x548C;&#x5B50;&#x7F51;&#x63A9;&#x7801;&#x663E;&#x793A;&#xFF0C;&#x6211;&#x4EEC;&#x5E94;&#x626B;&#x63CF;<code>172.16.36.0/24</code>&#x8303;&#x56F4;&#x3002; &#x6B64;&#x5916;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x8FD9;&#x4E9B;&#x914D;&#x7F6E;&#x4E2D;&#x8BC6;&#x522B;&#x626B;&#x63CF;&#x7CFB;&#x7EDF;&#x7684;&#x6E90; IP &#x5730;&#x5740;&#x548C; MAC &#x5730;&#x5740;&#x3002; &#x8981;&#x5728; Metasploit &#x4E2D;&#x5B9A;&#x4E49;&#x914D;&#x7F6E;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<code>set</code>&#x547D;&#x4EE4;&#xFF0C;&#x7136;&#x540E;&#x662F;&#x8981;&#x5B9A;&#x4E49;&#x7684;&#x53D8;&#x91CF;&#xFF0C;&#x7136;&#x540E;&#x662F;&#x8981;&#x8D4B;&#x7684;&#x503C;&#xFF1A;</p>
<pre><code>msf  auxiliary(arp_sweep) &gt; set interface eth1 
interface =&gt; eth1 
msf  auxiliary(arp_sweep) &gt; set RHOSTS 172.16.36.0/24 
RHOSTS =&gt; 172.16.36.0/24 
msf  auxiliary(arp_sweep) &gt; set SHOST 172.16.36.180 
SHOST =&gt; 172.16.36.180 
msf  auxiliary(arp_sweep) &gt; set SMAC 00:0c:29:09:c3:79 
SMAC =&gt; 00:0c:29:09:c3:79 
msf  auxiliary(arp_sweep) &gt; set THREADS 20 
THREADS =&gt; 20 
msf  auxiliary(arp_sweep) &gt; set TIMEOUT 1 
TIMEOUT =&gt; 1
</code></pre><p>&#x8BBE;&#x7F6E;&#x626B;&#x63CF;&#x914D;&#x7F6E;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>show options</code>&#x547D;&#x4EE4;&#x518D;&#x6B21;&#x67E5;&#x770B;&#x8BBE;&#x7F6E;&#x3002; &#x73B0;&#x5728;&#x5E94;&#x663E;&#x793A;&#x4E4B;&#x524D;&#x8BBE;&#x7F6E;&#x7684;&#x6240;&#x6709;&#x503C;&#xFF1A;</p>
<pre><code>msf  auxiliary(arp_sweep) &gt; show options

Module options (auxiliary/scanner/discovery/arp_sweep):

   Name       Current Setting    Required  Description   
   ----       ---------------    --------  ----------   
   INTERFACE  eth1               no        The name of the interface   
   RHOSTS     172.16.36.0/24     yes       The target address range or CIDR identifier   
   SHOST      172.16.36.180      no        Source IP Address   
   SMAC       00:0c:29:09:c3:79  no        Source MAC Address   
   THREADS    20                 yes       The number of concurrent threads   
   TIMEOUT    1                  yes       The number of seconds to wait for new data
</code></pre><p>&#x5728;&#x9A8C;&#x8BC1;&#x6240;&#x6709;&#x8BBE;&#x7F6E;&#x914D;&#x7F6E;&#x6B63;&#x786E;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>run</code>&#x547D;&#x4EE4;&#x542F;&#x52A8;&#x626B;&#x63CF;&#x3002; &#x6B64;&#x7279;&#x5B9A;&#x6A21;&#x5757;&#x5C06;&#x6253;&#x5370;&#x51FA;&#x4F7F;&#x7528; ARP &#x53D1;&#x73B0;&#x7684;&#x4EFB;&#x4F55;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x3002; &#x5B83;&#x8FD8;&#x4F1A;&#x8BC6;&#x522B;&#x7F51;&#x5361;&#xFF08;NIC&#xFF09;&#x4F9B;&#x5E94;&#x5546;&#xFF0C;&#x5B83;&#x7531;&#x53D1;&#x73B0;&#x7684;&#x4E3B;&#x673A;&#x7684; MAC &#x5730;&#x5740;&#x4E2D;&#x7684;&#x524D;3&#x4E2A;&#x5B57;&#x8282;&#x5B9A;&#x4E49;&#xFF1A;</p>
<pre><code>msf  auxiliary(arp_sweep) &gt; run

[*] 172.16.36.1 appears to be up (VMware, Inc.). 
[*] 172.16.36.2 appears to be up (VMware, Inc.). 
[*] 172.16.36.132 appears to be up (VMware, Inc.). 
[*] 172.16.36.135 appears to be up (VMware, Inc.). 
[*] 172.16.36.254 appears to be up (VMware, Inc.). 
[*] Scanned 256 of 256 hosts (100% complete) 
[*] Auxiliary module execution completed
</code></pre><h3 id="&#x5DE5;&#x4F5C;&#x539F;&#x7406;">&#x5DE5;&#x4F5C;&#x539F;&#x7406;</h3>
<p>Metasploit &#x6267;&#x884C; ARP &#x53D1;&#x73B0;&#x7684;&#x57FA;&#x672C;&#x539F;&#x7406;&#x662F;&#x76F8;&#x540C;&#x7684;&#xFF1A;&#x5E7F;&#x64AD;&#x4E00;&#x7CFB;&#x5217; ARP &#x8BF7;&#x6C42;&#xFF0C;&#x8BB0;&#x5F55;&#x5E76;&#x8F93;&#x51FA; ARP &#x54CD;&#x5E94;&#x3002; Metasploit  &#x8F85;&#x52A9;&#x6A21;&#x5757;&#x7684;&#x8F93;&#x51FA;&#x63D0;&#x4F9B;&#x6240;&#x6709;&#x6D3B;&#x52A8;&#x7CFB;&#x7EDF;&#x7684; IP &#x5730;&#x5740;&#xFF0C;&#x7136;&#x540E;&#xFF0C;&#x5B83;&#x8FD8;&#x5728;&#x62EC;&#x53F7;&#x4E2D;&#x63D0;&#x4F9B; MAC &#x5382;&#x5546;&#x540D;&#x79F0;&#x3002;</p>
<h2 id="26-&#x4F7F;&#x7528;-icmp-&#x63A2;&#x7D22;&#x7B2C;&#x4E09;&#x5C42;">2.6 &#x4F7F;&#x7528; ICMP &#x63A2;&#x7D22;&#x7B2C;&#x4E09;&#x5C42;</h2>
<p>&#x7B2C;&#x4E09;&#x5C42;&#x7684;&#x53D1;&#x73B0;&#x53EF;&#x80FD;&#x662F;&#x7F51;&#x7EDC;&#x7BA1;&#x7406;&#x5458;&#x548C;&#x6280;&#x672F;&#x4EBA;&#x5458;&#x4E2D;&#x6700;&#x5E38;&#x7528;&#x7684;&#x5DE5;&#x5177;&#x3002; &#x7B2C;&#x4E09;&#x5C42;&#x7684;&#x53D1;&#x73B0;&#x4F7F;&#x7528;&#x8457;&#x540D;&#x7684; ICMP ping &#x6765;&#x8BC6;&#x522B;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x3002; &#x6B64;&#x79D8;&#x7C4D;&#x6F14;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x4F7F;&#x7528; ping &#x5DE5;&#x5177;&#x5728;&#x8FDC;&#x7A0B;&#x4E3B;&#x673A;&#x4E0A;&#x6267;&#x884C;&#x7B2C;&#x4E09;&#x5C42;&#x53D1;&#x73B0;&#x3002;</p>
<h3 id="&#x51C6;&#x5907;">&#x51C6;&#x5907;</h3>
<p>&#x4F7F;&#x7528;<code>ping</code>&#x6267;&#x884C;&#x7B2C;&#x4E09;&#x5C42;&#x53D1;&#x73B0;&#x4E0D;&#x9700;&#x8981;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#xFF0C;&#x56E0;&#x4E3A; Internet &#x4E0A;&#x7684;&#x8BB8;&#x591A;&#x7CFB;&#x7EDF;&#x90FD;&#x5C06;&#x56DE;&#x590D; ICMP &#x56DE;&#x663E;&#x8BF7;&#x6C42;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5F3A;&#x70C8;&#x5EFA;&#x8BAE;&#x4F60;&#x53EA;&#x5728;&#x60A8;&#x81EA;&#x5DF1;&#x7684;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x6267;&#x884C;&#x4EFB;&#x4F55;&#x7C7B;&#x578B;&#x7684;&#x7F51;&#x7EDC;&#x626B;&#x63CF;&#xFF0C;&#x9664;&#x975E;&#x4F60;&#x5B8C;&#x5168;&#x719F;&#x6089;&#x60A8;&#x53D7;&#x5230;&#x4EFB;&#x4F55;&#x7BA1;&#x7406;&#x673A;&#x6784;&#x65BD;&#x52A0;&#x7684;&#x6CD5;&#x5F8B;&#x6CD5;&#x89C4;&#x3002;&#x5982;&#x679C;&#x4F60;&#x5E0C;&#x671B;&#x5728;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x6267;&#x884C;&#x6B64;&#x6280;&#x672F;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x54CD;&#x5E94; ICMP &#x8BF7;&#x6C42;&#x7684;&#x7CFB;&#x7EDF;&#x3002;&#x5728;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528; Linux &#x548C; Windows &#x7CFB;&#x7EDF;&#x7684;&#x7EC4;&#x5408;&#x3002;&#x6709;&#x5173;&#x5728;&#x672C;&#x5730;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x8BBE;&#x7F6E;&#x7CFB;&#x7EDF;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x4E2D;&#x7684;&#x201C;&#x5B89;&#x88C5; Metasploitable2&#x201D;&#x548C;&#x201C;&#x5B89;&#x88C5; Windows Server&#x201D;&#x79D8;&#x7C4D;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x672C;&#x8282;&#x8FD8;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#xFF08;&#x5982; VIM &#x6216; Nano&#xFF09;&#x5C06;&#x811A;&#x672C;&#x5199;&#x5165;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3002;&#x6709;&#x5173;&#x7F16;&#x5199;&#x811A;&#x672C;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x4E2D;&#x7684;&#x201C;&#x4F7F;&#x7528;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#xFF08;VIM &#x548C; Nano&#xFF09;&#x201D;&#x79D8;&#x7C4D;&#x3002;</p>
<h3 id="&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;">&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;</h3>
<p>&#x5927;&#x591A;&#x6570;&#x5728; IT &#x884C;&#x4E1A;&#x5DE5;&#x4F5C;&#x7684;&#x4EBA;&#x90FD;&#x76F8;&#x5F53;&#x719F;&#x6089;<code>ping</code>&#x5DE5;&#x5177;&#x3002; &#x8981;&#x4F7F;&#x7528;<code>ping</code>&#x786E;&#x5B9A;&#x4E3B;&#x673A;&#x662F;&#x5426;&#x5904;&#x4E8E;&#x6D3B;&#x52A8;&#x72B6;&#x6001;&#xFF0C;&#x4F60;&#x53EA;&#x9700;&#x8981;&#x5411;&#x547D;&#x4EE4;&#x4F20;&#x9012;&#x53C2;&#x6570;&#x6765;&#x5B9A;&#x4E49;&#x8981;&#x6D4B;&#x8BD5;&#x7684; IP &#x5730;&#x5740;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ping 172.16.36.135 
PING 172.16.36.135 (172.16.36.135) 56(84) bytes of data. 
64 bytes from 172.16.36.135: icmp_req=1 ttl=64 time=1.35 ms 
64 bytes from 172.16.36.135: icmp_req=2 ttl=64 time=0.707 ms 
64 bytes from 172.16.36.135: icmp_req=3 ttl=64 time=0.369 ms 
^C 
--- 172.16.36.135 ping statistics --
3 packets transmitted, 3 received, 0% packet loss, time 2003ms 
rtt min/avg/max/mdev = 0.369/0.809/1.353/0.409 ms
</code></pre><p>&#x53D1;&#x51FA;&#x6B64;&#x547D;&#x4EE4;&#x65F6;&#xFF0C;ICMP &#x56DE;&#x663E;&#x8BF7;&#x6C42;&#x5C06;&#x76F4;&#x63A5;&#x53D1;&#x9001;&#x5230;&#x63D0;&#x4F9B;&#x7684; IP &#x5730;&#x5740;&#x3002; &#x4E3A;&#x4E86;&#x63A5;&#x6536;&#x5BF9;&#x6B64; ICMP &#x56DE;&#x663E;&#x8BF7;&#x6C42;&#x7684;&#x56DE;&#x590D;&#xFF0C;&#x5FC5;&#x987B;&#x6EE1;&#x8DB3;&#x51E0;&#x4E2A;&#x6761;&#x4EF6;&#x3002; &#x8FD9;&#x4E9B;&#x6761;&#x4EF6;&#x5982;&#x4E0B;&#xFF1A;</p>
<ul>
<li>&#x6D4B;&#x8BD5;&#x7684; IP &#x5730;&#x5740;&#x5FC5;&#x987B;&#x5206;&#x914D;&#x7ED9;&#x7CFB;&#x7EDF;</li>
<li>&#x7CFB;&#x7EDF;&#x5FC5;&#x987B;&#x5904;&#x4E8E;&#x6D3B;&#x52A8;&#x72B6;&#x6001;&#x5E76;&#x5728;&#x7EBF;</li>
<li>&#x5FC5;&#x987B;&#x5B58;&#x5728;&#x4ECE;&#x626B;&#x63CF;&#x7CFB;&#x7EDF;&#x5230;&#x76EE;&#x6807; IP &#x7684;&#x53EF;&#x7528;&#x8DEF;&#x7531;</li>
<li>&#x7CFB;&#x7EDF;&#x5FC5;&#x987B;&#x914D;&#x7F6E;&#x4E3A;&#x54CD;&#x5E94; ICMP &#x6D41;&#x91CF;</li>
<li>&#x626B;&#x63CF;&#x7CFB;&#x7EDF;&#x548C;&#x914D;&#x7F6E;&#x4E3A;&#x4E22;&#x5F03; ICMP &#x6D41;&#x91CF;&#x7684;&#x76EE;&#x6807; IP &#x4E4B;&#x95F4;&#x6CA1;&#x6709;&#x57FA;&#x4E8E;&#x4E3B;&#x673A;&#x6216;&#x7F51;&#x7EDC;&#x9632;&#x706B;&#x5899;</li>
</ul>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x6709;&#x5F88;&#x591A;&#x53D8;&#x91CF;&#x6210;&#x4E3A; ICMP &#x53D1;&#x73B0;&#x7684;&#x6210;&#x529F;&#x56E0;&#x7D20;&#x3002; &#x6B63;&#x662F;&#x7531;&#x4E8E;&#x8FD9;&#x4E2A;&#x539F;&#x56E0;&#xFF0C;ICMP &#x53EF;&#x80FD;&#x6709;&#x70B9;&#x4E0D;&#x53EF;&#x9760;&#xFF0C;&#x4F46;&#x4E0E; ARP &#x4E0D;&#x540C;&#xFF0C;&#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x53EF;&#x8DEF;&#x7531;&#x7684;&#x534F;&#x8BAE;&#xFF0C;&#x53EF;&#x7528;&#x4E8E;&#x53D1;&#x73B0;&#x5C40;&#x57DF;&#x7F51;&#x5916;&#x7684;&#x4E3B;&#x673A;&#x3002; &#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5728;&#x524D;&#x9762;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x5728;<code>ping</code>&#x547D;&#x4EE4;&#x663E;&#x793A;&#x7684;&#x8F93;&#x51FA;&#x4E2D;&#x51FA;&#x73B0;<code>^ C</code>&#x3002; &#x8FD9;&#x8868;&#x793A;&#x4F7F;&#x7528;&#x4E86;&#x8F6C;&#x4E49;&#x5E8F;&#x5217;&#xFF08;&#x5177;&#x4F53;&#x6765;&#x8BF4;&#xFF0C;<code>Ctrl + C</code>&#xFF09;&#x6765;&#x505C;&#x6B62;&#x8FDB;&#x7A0B;&#x3002; &#x4E0E; Windows &#x4E0D;&#x540C;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x96C6;&#x6210;&#x5230; Linux &#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;<code>ping</code>&#x547D;&#x4EE4;&#x4F1A;&#x65E0;&#x9650;<code>ping</code>&#x76EE;&#x6807;&#x4E3B;&#x673A;&#x3002; &#x4F46;&#x662F;&#xFF0C;<code>-c</code>&#x9009;&#x9879;&#x53EF;&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x8981;&#x53D1;&#x9001;&#x7684; ICMP &#x8BF7;&#x6C42;&#x6570;&#x3002; &#x4F7F;&#x7528;&#x6B64;&#x9009;&#x9879;&#xFF0C;&#x4E00;&#x65E6;&#x8FBE;&#x5230;&#x8D85;&#x65F6;&#x6216;&#x6BCF;&#x4E2A;&#x53D1;&#x9001;&#x7684;&#x6570;&#x636E;&#x5305;&#x7684;&#x56DE;&#x590D;&#x5DF2;&#x63A5;&#x6536;&#xFF0C;&#x8FC7;&#x7A0B;&#x5C06;&#x6B63;&#x5E38;&#x7ED3;&#x675F;&#x3002; &#x770B;&#x770B;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ping 172.16.36.135 -c 2 
PING 172.16.36.135 (172.16.36.135) 56(84) bytes of data. 
64 bytes from 172.16.36.135: icmp_req=1 ttl=64 time=0.611 ms
64 bytes from 172.16.36.135: icmp_req=2 ttl=64 time=0.395 ms
--- 172.16.36.135 ping statistics --
2 packets transmitted, 2 received, 0% packet loss, time 1000ms 
rtt min/avg/max/mdev = 0.395/0.503/0.611/0.108 ms
</code></pre><p>&#x4E0E; ARPing &#x76F8;&#x540C;&#x7684;&#x65B9;&#x5F0F;&#x53EF;&#x4EE5;&#x5728; bash &#x811A;&#x672C;&#x4E2D;&#x4F7F;&#x7528;&#xFF0C;&#x901A;&#x8FC7;&#x5E76;&#x884C;&#x5730;&#x5FAA;&#x73AF;&#x904D;&#x5386;&#x591A;&#x4E2A; IP&#xFF0C;<code>ping</code>&#x53EF;&#x4EE5;&#x4E0E; bash &#x811A;&#x672C;&#x7ED3;&#x5408;&#x4F7F;&#x7528;&#xFF0C;&#x6765;&#x5728;&#x591A;&#x4E2A;&#x4E3B;&#x673A;&#x4E0A;&#x5E76;&#x884C;&#x6267;&#x884C;&#x7B2C;&#x4E09;&#x5C42;&#x53D1;&#x73B0;&#x3002; &#x4E3A;&#x4E86;&#x7F16;&#x5199;&#x811A;&#x672C;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x786E;&#x5B9A;&#x4E0E;&#x6210;&#x529F;&#x548C;&#x5931;&#x8D25;&#x7684; ping &#x8BF7;&#x6C42;&#x76F8;&#x5173;&#x7684;&#x5404;&#x79CD;&#x54CD;&#x5E94;&#x3002; &#x4E3A;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x9996;&#x5148; ping &#x4E00;&#x4E2A;&#x6211;&#x4EEC;&#x77E5;&#x9053;&#x5B83;&#x6D3B;&#x52A8;&#x5E76;&#x54CD;&#x5E94; ICMP &#x7684;&#x4E3B;&#x673A;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528; ping &#x8BF7;&#x6C42;&#x8DDF;&#x8E2A;&#x4E00;&#x4E2A;&#x65E0;&#x54CD;&#x5E94;&#x7684;&#x5730;&#x5740;&#x3002; &#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#x6F14;&#x793A;&#x4E86;&#x8FD9;&#x4E00;&#x70B9;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ping 74.125.137.147 -c 1 
PING 74.125.137.147 (74.125.137.147) 56(84) bytes of data. 
64 bytes from 74.125.137.147: icmp_seq=1 ttl=128 time=31.3 ms
--- 74.125.137.147 ping statistics --
1 packets transmitted, 1 received, 0% packet loss, time 0ms 
rtt min/avg/max/mdev = 31.363/31.363/31.363/0.000 ms 
root@KaliLinux:~# ping 83.166.169.231 -c 1 
PING 83.166.169.231 (83.166.169.231) 56(84) bytes of data.
--- 83.166.169.231 ping statistics --
1 packets transmitted, 0 received, 100% packet loss, time 0ms
</code></pre><p>&#x4E0E; ARPing &#x8BF7;&#x6C42;&#x4E00;&#x6837;&#xFF0C;&#x6765;&#x81EA;&#x552F;&#x4E00;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5B57;&#x8282;&#x53EA;&#x5B58;&#x5728;&#x5728;&#x4E0E;&#x6D3B;&#x52A8; IP &#x5730;&#x5740;&#x76F8;&#x5173;&#x7684;&#x8F93;&#x51FA;&#x4E2D;&#xFF0C;&#x5E76;&#x4E14;&#x4E5F;&#x4F4D;&#x4E8E;&#x5305;&#x542B;&#x6B64;&#x5730;&#x5740;&#x7684;&#x884C;&#x4E0A;&#x3002; &#x4F7F;&#x7528;&#x540C;&#x6837;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>grep</code>&#x548C;<code>cut</code>&#x7684;&#x7EC4;&#x5408;,&#x4ECE;&#x4EFB;&#x4F55;&#x6210;&#x529F;&#x7684;<code>ping</code>&#x8BF7;&#x6C42;&#x4E2D;&#x63D0;&#x53D6; IP &#x5730;&#x5740;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ping 74.125.137.147 -c 1 | grep &quot;bytes from&quot; 
64 bytes from 74.125.137.147: icmp_seq=1 ttl=128 time=37.2 ms 
root@KaliLinux:~# ping 74.125.137.147 -c 1 | grep &quot;bytes from&quot; | cut -d &quot; &quot; -f 4 
74.125.137.147: 
root@KaliLinux:~# ping 74.125.137.147 -c 1 | grep &quot;bytes from&quot; | cut -d &quot; &quot; -f 4 | cut -d &quot;:&quot; -f 1 
74.125.137.147
</code></pre><p>&#x901A;&#x8FC7;&#x5728;&#x5305;&#x542B;&#x4E00;&#x7CFB;&#x5217;&#x76EE;&#x6807; IP &#x5730;&#x5740;&#x7684;&#x5FAA;&#x73AF;&#x4E2D;&#x4F7F;&#x7528;&#x6B64;&#x4EFB;&#x52A1;&#x5E8F;&#x5217;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5FEB;&#x901F;&#x8BC6;&#x522B;&#x54CD;&#x5E94; ICMP &#x56DE;&#x663E;&#x8BF7;&#x6C42;&#x7684;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x3002; &#x8F93;&#x51FA;&#x662F;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x7684;&#x6D3B;&#x52A8; IP &#x5730;&#x5740;&#x5217;&#x8868;&#x3002; &#x4F7F;&#x7528;&#x6B64;&#x6280;&#x672F;&#x7684;&#x793A;&#x4F8B;&#x811A;&#x672C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
<pre><code class="lang-sh"><span class="hljs-meta">#!/bin/bash
</span>
<span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$#</span>&quot;</span> <span class="hljs-_">-ne</span> 1 ]; <span class="hljs-keyword">then</span> 
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Usage - ./ping_sweep.sh [/24 network address]&quot;</span> 
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Example - ./ping_sweep.sh 172.16.36.0&quot;</span> 
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot; Example will perform an ICMP ping sweep of the 172.16.36.0/24 network&quot;</span> 
    <span class="hljs-built_in">exit</span> 
<span class="hljs-keyword">fi</span>

prefix=$(<span class="hljs-built_in">echo</span> <span class="hljs-variable">$1</span> | cut <span class="hljs-_">-d</span> <span class="hljs-string">&apos;.&apos;</span> <span class="hljs-_">-f</span> 1-3)

<span class="hljs-keyword">for</span> addr <span class="hljs-keyword">in</span> $(seq 1 254); <span class="hljs-keyword">do</span> 
    ping -c 1 <span class="hljs-variable">$prefix</span>.<span class="hljs-variable">$addr</span> | grep <span class="hljs-string">&quot;bytes from&quot;</span> | cut <span class="hljs-_">-d</span> <span class="hljs-string">&quot; &quot;</span> <span class="hljs-_">-f</span> 4 | cut <span class="hljs-_">-d</span> <span class="hljs-string">&quot;:&quot;</span> <span class="hljs-_">-f</span> 1 &amp; 
<span class="hljs-keyword">done</span>
</code></pre>
<p>&#x5728;&#x63D0;&#x4F9B;&#x7684;bash&#x811A;&#x672C;&#x4E2D;&#xFF0C;&#x7B2C;&#x4E00;&#x884C;&#x5B9A;&#x4E49;&#x4E86; bash &#x89E3;&#x91CA;&#x5668;&#x7684;&#x4F4D;&#x7F6E;&#x3002;&#x63A5;&#x4E0B;&#x6765;&#x7684;&#x4EE3;&#x7801;&#x5757;&#x6267;&#x884C;&#x6D4B;&#x8BD5;&#x6765;&#x786E;&#x5B9A;&#x662F;&#x5426;&#x63D0;&#x4F9B;&#x4E86;&#x9884;&#x671F;&#x7684;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x3002;&#x8FD9;&#x901A;&#x8FC7;&#x8BC4;&#x4F30;&#x63D0;&#x4F9B;&#x7684;&#x53C2;&#x6570;&#x7684;&#x6570;&#x91CF;&#x662F;&#x5426;&#x4E0D;&#x7B49;&#x4E8E; 1 &#x6765;&#x786E;&#x5B9A;&#x3002;&#x5982;&#x679C;&#x672A;&#x63D0;&#x4F9B;&#x9884;&#x671F;&#x53C2;&#x6570;&#xFF0C;&#x5219;&#x8F93;&#x51FA;&#x811A;&#x672C;&#x7684;&#x7528;&#x6CD5;&#xFF0C;&#x5E76;&#x4E14;&#x9000;&#x51FA;&#x811A;&#x672C;&#x3002;&#x7528;&#x6CD5;&#x8F93;&#x51FA;&#x8868;&#x660E;&#xFF0C;&#x811A;&#x672C;&#x63A5;&#x53D7;<code>/ 24</code>&#x7F51;&#x7EDC;&#x5730;&#x5740;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x3002;&#x4E0B;&#x4E00;&#x884C;&#x4EE3;&#x7801;&#x4ECE;&#x63D0;&#x4F9B;&#x7684;&#x7F51;&#x7EDC;&#x5730;&#x5740;&#x4E2D;&#x63D0;&#x53D6;&#x7F51;&#x7EDC;&#x524D;&#x7F00;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x63D0;&#x4F9B;&#x7684;&#x7F51;&#x7EDC;&#x5730;&#x5740;&#x662F;<code>192.168.11.0</code>&#xFF0C;&#x5219;&#x524D;&#x7F00;&#x53D8;&#x91CF;&#x5C06;&#x88AB;&#x8D4B;&#x503C;&#x4E3A;<code>192.168.11</code>&#x3002;&#x7136;&#x540E;&#x4F7F;&#x7528;<code>for</code>&#x5FAA;&#x73AF;&#x904D;&#x5386;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x7684;&#x503C;&#xFF0C;&#x6765;&#x5728;&#x672C;&#x5730;<code>/ 24</code>&#x7F51;&#x7EDC;&#x4E2D;&#x751F;&#x6210;&#x6BCF;&#x4E2A;&#x53EF;&#x80FD;&#x7684; IP &#x5730;&#x5740;&#x3002;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x53EF;&#x80FD;&#x7684; IP &#x5730;&#x5740;&#xFF0C;&#x6267;&#x884C;&#x5355;&#x4E2A;<code>ping</code>&#x547D;&#x4EE4;&#x3002;&#x7136;&#x540E;&#x901A;&#x8FC7;&#x7BA1;&#x9053;&#x4F20;&#x8F93;&#x6BCF;&#x4E2A;&#x8BF7;&#x6C42;&#x7684;&#x54CD;&#x5E94;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;<code>grep</code>&#x6765;&#x63D0;&#x53D6;&#x5E26;&#x6709;&#x77ED;&#x8BED;<code>bytes</code>&#x7684;&#x884C;&#x3002;&#x8FD9;&#x53EA;&#x4F1A;&#x63D0;&#x53D6;&#x5305;&#x542B;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x7684; IP &#x5730;&#x5740;&#x7684;&#x884C;&#x3002;&#x6700;&#x540E;&#xFF0C;&#x4F7F;&#x7528;&#x4E00;&#x7CFB;&#x5217;<code>cut</code>&#x51FD;&#x6570;&#x4ECE;&#x8BE5;&#x8F93;&#x51FA;&#x4E2D;&#x63D0;&#x53D6; IP &#x5730;&#x5740;&#x3002;&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5728;<code>for</code>&#x5FAA;&#x73AF;&#x4EFB;&#x52A1;&#x7684;&#x672B;&#x5C3E;&#x4F7F;&#x7528;<code>&amp;</code>&#x7B26;&#x53F7;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5206;&#x53F7;&#x3002;&#x8BE5;&#x7B26;&#x53F7;&#x80FD;&#x591F;&#x5E76;&#x884C;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x987A;&#x5E8F;&#x6267;&#x884C;&#x3002;&#x8FD9;&#x6781;&#x5927;&#x5730;&#x51CF;&#x5C11;&#x4E86;&#x626B;&#x63CF; IP &#x8303;&#x56F4;&#x6240;&#x9700;&#x7684;&#x65F6;&#x95F4;&#x3002;&#x7136;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x53E5;&#x53F7;&#x548C;&#x659C;&#x6760;&#xFF0C;&#x5E76;&#x5E26;&#x4E0A;&#x662F;&#x53EF;&#x6267;&#x884C;&#x811A;&#x672C;&#x7684;&#x540D;&#x79F0;&#x6765;&#x6267;&#x884C;&#x811A;&#x672C;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ./ping_sweep.sh 
Usage - ./ping_sweep.sh [/24 network address] 
Example - ./ping_sweep.sh 172.16.36.0
Example will perform an ICMP ping sweep of the 172.16.36.0/24 network 
root@KaliLinux:~# ./ping_sweep.sh 172.16.36.0 
172.16.36.2 
172.16.36.1 
172.16.36.232 
172.16.36.249
</code></pre><p>&#x5F53;&#x5728;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x4EFB;&#x4F55;&#x53C2;&#x6570;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x6267;&#x884C;&#x65F6;&#xFF0C;&#x811A;&#x672C;&#x4F1A;&#x8FD4;&#x56DE;&#x7528;&#x6CD5;&#x3002; &#x4F46;&#x662F;&#xFF0C;&#x5F53;&#x4F7F;&#x7528;&#x7F51;&#x7EDC;&#x5730;&#x5740;&#x503C;&#x6267;&#x884C;&#x65F6;&#xFF0C;&#x4EFB;&#x52A1;&#x5E8F;&#x5217;&#x5F00;&#x59CB;&#x6267;&#x884C;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x6D3B;&#x52A8; IP &#x5730;&#x5740;&#x7684;&#x5217;&#x8868;&#x3002; &#x5982;&#x524D;&#x9762;&#x7684;&#x811A;&#x672C;&#x4E2D;&#x6240;&#x8BA8;&#x8BBA;&#x7684;&#x90A3;&#x6837;&#xFF0C;&#x6B64;&#x811A;&#x672C;&#x7684;&#x8F93;&#x51FA;&#x4E5F;&#x53EF;&#x4EE5;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x6587;&#x672C;&#x6587;&#x4EF6;&#xFF0C;&#x6765;&#x4F9B;&#x5C06;&#x6765;&#x4F7F;&#x7528;&#x3002; &#x8FD9;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5C16;&#x62EC;&#x53F7;&#xFF0C;&#x540E;&#x8DDF;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x7684;&#x540D;&#x79F0;&#x6765;&#x5B9E;&#x73B0;&#x3002;</p>
<pre><code>root@KaliLinux:~# ./ping_sweep.sh 172.16.36.0 &gt; output.txt 
root@KaliLinux:~# ls output.txt output.txt 
root@KaliLinux:~# cat output.txt 172.16.36.2 
172.16.36.1 
172.16.36.232 
172.16.36.249
</code></pre><p>&#x5728;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;<code>ls</code>&#x547D;&#x4EE4;&#x7528;&#x4E8E;&#x786E;&#x8BA4;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x5DF2;&#x521B;&#x5EFA;&#x3002; &#x901A;&#x8FC7;&#x5C06;&#x6587;&#x4EF6;&#x540D;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x7ED9;<code>cat</code>&#x547D;&#x4EE4;&#xFF0C;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x6B64;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#x3002;</p>
<h3 id="&#x5DE5;&#x4F5C;&#x539F;&#x7406;">&#x5DE5;&#x4F5C;&#x539F;&#x7406;</h3>
<p>Ping &#x662F; IT &#x884C;&#x4E1A;&#x4E2D;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x5176;&#x73B0;&#x6709;&#x529F;&#x80FD;&#x80FD;&#x7528;&#x4E8E;&#x8BC6;&#x522B;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x3002; &#x7136;&#x800C;&#xFF0C;&#x5B83;&#x7684;&#x76EE;&#x7684;&#x662F;&#x4E3A;&#x4E86;&#x53D1;&#x73B0;&#x5355;&#x4E2A;&#x4E3B;&#x673A;&#x662F;&#x5426;&#x5B58;&#x6D3B;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4F5C;&#x4E3A;&#x626B;&#x63CF;&#x5DE5;&#x5177;&#x3002; &#x8FD9;&#x4E2A;&#x79D8;&#x7C4D;&#x4E2D;&#x7684; bash &#x811A;&#x672C;&#x57FA;&#x672C;&#x4E0A;&#x4E0E;&#x5728;<code>/ 24</code> CIDR&#x8303;&#x56F4;&#x4E2D;&#x5BF9;&#x6BCF;&#x4E2A;&#x53EF;&#x80FD;&#x7684; IP &#x5730;&#x5740;&#x4F7F;&#x7528; ping &#x76F8;&#x540C;&#x3002; &#x4F46;&#x662F;&#xFF0C;&#x6211;&#x4EEC;&#x4E0D;&#x9700;&#x8981;&#x624B;&#x52A8;&#x6267;&#x884C;&#x8FD9;&#x79CD;&#x7E41;&#x7410;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;bash &#x5141;&#x8BB8;&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x5FAA;&#x73AF;&#x4F20;&#x9012;&#x4EFB;&#x52A1;&#x5E8F;&#x5217;&#x6765;&#x5FEB;&#x901F;&#xFF0C;&#x8F7B;&#x677E;&#x5730;&#x6267;&#x884C;&#x6B64;&#x4EFB;&#x52A1;&#x3002;</p>
<h2 id="27-&#x4F7F;&#x7528;-scapy-&#x53D1;&#x73B0;&#x7B2C;&#x4E09;&#x5C42;">2.7 &#x4F7F;&#x7528; Scapy &#x53D1;&#x73B0;&#x7B2C;&#x4E09;&#x5C42;</h2>
<p>Scapy &#x662F;&#x4E00;&#x79CD;&#x5DE5;&#x5177;&#xFF0C;&#x5141;&#x8BB8;&#x7528;&#x6237;&#x5236;&#x4F5C;&#x5E76;&#x5411;&#x7F51;&#x7EDC;&#x4E2D;&#x6CE8;&#x5165;&#x81EA;&#x5B9A;&#x4E49;&#x6570;&#x636E;&#x5305;&#x3002; &#x6B64;&#x5DE5;&#x5177;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x6784;&#x5EFA; ICMP &#x534F;&#x8BAE;&#x8BF7;&#x6C42;&#xFF0C;&#x5E76;&#x5C06;&#x5B83;&#x4EEC;&#x6CE8;&#x5165;&#x7F51;&#x7EDC;&#x6765;&#x5206;&#x6790;&#x54CD;&#x5E94;&#x3002; &#x8FD9;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x79D8;&#x7C4D;&#x6F14;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x4F7F;&#x7528; Scapy &#x5728;&#x8FDC;&#x7A0B;&#x4E3B;&#x673A;&#x4E0A;&#x6267;&#x884C;&#x7B2C;3&#x5C42;&#x53D1;&#x73B0;&#x3002;</p>
<h3 id="&#x51C6;&#x5907;">&#x51C6;&#x5907;</h3>
<p>&#x4F7F;&#x7528; Scapy &#x6267;&#x884C;&#x7B2C;&#x4E09;&#x5C42;&#x53D1;&#x73B0;&#x4E0D;&#x9700;&#x8981;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#xFF0C;&#x56E0;&#x4E3A; Internet &#x4E0A;&#x7684;&#x8BB8;&#x591A;&#x7CFB;&#x7EDF;&#x90FD;&#x5C06;&#x56DE;&#x590D; ICMP &#x56DE;&#x663E;&#x8BF7;&#x6C42;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5F3A;&#x70C8;&#x5EFA;&#x8BAE;&#x4F60;&#x53EA;&#x5728;&#x60A8;&#x81EA;&#x5DF1;&#x7684;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x6267;&#x884C;&#x4EFB;&#x4F55;&#x7C7B;&#x578B;&#x7684;&#x7F51;&#x7EDC;&#x626B;&#x63CF;&#xFF0C;&#x9664;&#x975E;&#x4F60;&#x5B8C;&#x5168;&#x719F;&#x6089;&#x60A8;&#x53D7;&#x5230;&#x4EFB;&#x4F55;&#x7BA1;&#x7406;&#x673A;&#x6784;&#x65BD;&#x52A0;&#x7684;&#x6CD5;&#x5F8B;&#x6CD5;&#x89C4;&#x3002;&#x5982;&#x679C;&#x4F60;&#x5E0C;&#x671B;&#x5728;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x6267;&#x884C;&#x6B64;&#x6280;&#x672F;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x54CD;&#x5E94; ICMP &#x8BF7;&#x6C42;&#x7684;&#x7CFB;&#x7EDF;&#x3002;&#x5728;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528; Linux &#x548C; Windows &#x7CFB;&#x7EDF;&#x7684;&#x7EC4;&#x5408;&#x3002;&#x6709;&#x5173;&#x5728;&#x672C;&#x5730;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x8BBE;&#x7F6E;&#x7CFB;&#x7EDF;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x4E2D;&#x7684;&#x201C;&#x5B89;&#x88C5; Metasploitable2&#x201D;&#x548C;&#x201C;&#x5B89;&#x88C5; Windows Server&#x201D;&#x79D8;&#x7C4D;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x672C;&#x8282;&#x8FD8;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#xFF08;&#x5982; VIM &#x6216; Nano&#xFF09;&#x5C06;&#x811A;&#x672C;&#x5199;&#x5165;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3002;&#x6709;&#x5173;&#x7F16;&#x5199;&#x811A;&#x672C;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x4E2D;&#x7684;&#x201C;&#x4F7F;&#x7528;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#xFF08;VIM &#x548C; Nano&#xFF09;&#x201D;&#x79D8;&#x7C4D;&#x3002;</p>
<h3 id="&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;">&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;</h3>
<p>&#x4E3A;&#x4E86;&#x4F7F;&#x7528; Scapy &#x53D1;&#x9001; ICMP &#x56DE;&#x663E;&#x8BF7;&#x6C42;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5F00;&#x59CB;&#x5806;&#x53E0;&#x5C42;&#x7EA7;&#x6765;&#x53D1;&#x9001;&#x8BF7;&#x6C42;&#x3002; &#x5806;&#x53E0;&#x6570;&#x636E;&#x5305;&#x65F6;&#x7684;&#x4E00;&#x4E2A;&#x597D;&#x7684;&#x7ECF;&#x9A8C;&#x6CD5;&#x5219;&#x662F;,&#x901A;&#x8FC7; OSI &#x6309;&#x7167;&#x7684;&#x5404;&#x5C42;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x3002; &#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x659C;&#x6760;&#x5206;&#x9694;&#x6BCF;&#x4E2A;&#x5C42;&#x7EA7;&#x6765;&#x5806;&#x53E0;&#x591A;&#x4E2A;&#x5C42;&#x7EA7;&#x3002; &#x4E3A;&#x4E86;&#x751F;&#x6210; ICMP &#x56DE;&#x663E;&#x8BF7;&#x6C42;&#xFF0C;IP &#x5C42;&#x9700;&#x8981;&#x4E0E; ICMP &#x8BF7;&#x6C42;&#x5806;&#x53E0;&#x3002; &#x4E3A;&#x4E86;&#x5F00;&#x59CB;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<code>scapy</code>&#x547D;&#x4EE4;&#x6253;&#x5F00; Scapy &#x4EA4;&#x4E92;&#x5F0F;&#x63A7;&#x5236;&#x53F0;&#xFF0C;&#x7136;&#x540E;&#x5C06;<code>IP</code>&#x5BF9;&#x8C61;&#x8D4B;&#x7ED9;&#x53D8;&#x91CF;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# scapy Welcome to Scapy (2.2.0) 
&gt;&gt;&gt; ip = IP() 
&gt;&gt;&gt; ip.display() 
###[ IP ]###
  version= 4
  ihl= None
  tos= 0x0
  len= None
  id= 1
  flags=
  frag= 0
  ttl= 64
  proto= ip
  chksum= None
  src= 127.0.0.1
  dst= 127.0.0.1
  \options\
</code></pre><p>&#x5C06;&#x65B0;&#x503C;&#x8D4B;&#x7ED9;&#x76EE;&#x6807;&#x5730;&#x5740;&#x5C5E;&#x6027;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x518D;&#x6B21;&#x8C03;&#x7528;<code>display()</code>&#x51FD;&#x6570;&#x6765;&#x9A8C;&#x8BC1;&#x66F4;&#x6539;&#x3002; &#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5F53;&#x76EE;&#x6807; IP &#x5730;&#x5740;&#x503C;&#x66F4;&#x6539;&#x4E3A;&#x4EFB;&#x4F55;&#x5176;&#x4ED6;&#x503C;&#x65F6;&#xFF0C;&#x6E90;&#x5730;&#x5740;&#x4E5F;&#x4F1A;&#x4ECE;&#x56DE;&#x9001;&#x5730;&#x5740;&#x81EA;&#x52A8;&#x66F4;&#x65B0;&#x4E3A;&#x4E0E;&#x9ED8;&#x8BA4;&#x63A5;&#x53E3;&#x5173;&#x8054;&#x7684; IP &#x5730;&#x5740;&#x3002; &#x73B0;&#x5728; <code>IP</code> &#x5BF9;&#x8C61;&#x7684;&#x5C5E;&#x6027;&#x5DF2;&#x7ECF;&#x9002;&#x5F53;&#x4FEE;&#x6539;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x9700;&#x8981;&#x5728;&#x6211;&#x4EEC;&#x7684;&#x5C01;&#x5305;&#x6808;&#x4E2D;&#x521B;&#x5EFA;&#x7B2C;&#x4E8C;&#x5C42;&#x3002; &#x8981;&#x6DFB;&#x52A0;&#x5230;&#x6808;&#x7684;&#x4E0B;&#x4E00;&#x4E2A;&#x5C42;&#x662F; ICMP &#x5C42;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x5176;&#x8D4B;&#x7ED9;&#x5355;&#x72EC;&#x7684;&#x53D8;&#x91CF;&#xFF1A;</p>
<pre><code>&gt;&gt;&gt; ping = ICMP() 
&gt;&gt;&gt; ping.display() 
###[ ICMP ]###
  type= echo-request  
  code= 0  
  chksum= None  
  id= 0x0  
  seq= 0x0
</code></pre><p>&#x5728;&#x6240;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;ICMP &#x5BF9;&#x8C61;&#x4F7F;&#x7528;<code>ping</code>&#x53D8;&#x91CF;&#x540D;&#x79F0;&#x521D;&#x59CB;&#x5316;&#x3002; &#x7136;&#x540E;&#x53EF;&#x4EE5;&#x8C03;&#x7528;<code>display()</code>&#x51FD;&#x6570;&#x6765;&#x663E;&#x793A; ICMP &#x5C5E;&#x6027;&#x7684;&#x9ED8;&#x8BA4;&#x914D;&#x7F6E;&#x3002; &#x4E3A;&#x4E86;&#x6267;&#x884C; ICMP &#x56DE;&#x663E;&#x8BF7;&#x6C42;&#xFF0C;&#x9ED8;&#x8BA4;&#x914D;&#x7F6E;&#x5C31;&#x8DB3;&#x591F;&#x4E86;&#x3002; &#x73B0;&#x5728;&#x4E24;&#x4E2A;&#x5C42;&#x90FD;&#x5DF2;&#x6B63;&#x786E;&#x914D;&#x7F6E;&#xFF0C;&#x5B83;&#x4EEC;&#x53EF;&#x4EE5;&#x5806;&#x53E0;&#x6765;&#x51C6;&#x5907;&#x53D1;&#x9001;&#x3002; &#x5728; Scapy &#x4E2D;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x659C;&#x6760;&#x5206;&#x9694;&#x6BCF;&#x4E2A;&#x5C42;&#x7EA7;&#x6765;&#x5806;&#x53E0;&#x5C42;&#x7EA7;&#x3002; &#x770B;&#x770B;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x96C6;&#xFF1A;</p>
<pre><code>&gt;&gt;&gt; ping_request = (ip/ping) 
&gt;&gt;&gt; ping_request.display() 
###[ IP ]###
  version= 4
  ihl= None
  tos= 0x0
  len= None
  id= 1
  flags=
  frag= 0
  ttl= 64
  proto= icmp
  chksum= None
  src= 172.16.36.180
  dst= 172.16.36.135
  \options\
###[ ICMP ]###
     type= echo-request
     code= 0
     chksum= None
     id= 0x0
     seq= 0x0
</code></pre><p>&#x4E00;&#x65E6;&#x5806;&#x53E0;&#x5C42;&#x7EA7;&#x88AB;&#x8D4B;&#x7ED9;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#xFF0C;<code>display()</code>&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x663E;&#x793A;&#x6574;&#x4E2A;&#x6808;&#x3002; &#x4EE5;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x5806;&#x53E0;&#x5C42;&#x7684;&#x8FC7;&#x7A0B;&#x901A;&#x5E38;&#x88AB;&#x79F0;&#x4E3A;&#x6570;&#x636E;&#x62A5;&#x5C01;&#x88C5;&#x3002; &#x73B0;&#x5728;&#x5DF2;&#x7ECF;&#x5806;&#x53E0;&#x4E86;&#x5C42;&#x7EA7;&#xFF0C;&#x5E76;&#x5DF2;&#x7ECF;&#x51C6;&#x5907;&#x597D;&#x53D1;&#x9001;&#x8BF7;&#x6C42;&#x3002; &#x8FD9;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; Scapy &#x4E2D;&#x7684;<code>sr1()</code>&#x51FD;&#x6570;&#x6765;&#x5B8C;&#x6210;&#xFF1A;</p>
<pre><code>&gt;&gt;&gt; ping_reply = sr1(ping_request) 
..Begin emission:
.........
Finished to send 1 packets. 
...* 
Received 15 packets, got 1 answers, remaining 0 packets 
&gt;&gt;&gt; ping_reply.display() 
###[ IP ]###
  version= 4L
  ihl= 5L
  tos= 0x0
  len= 28
  id= 62577
  flags=
  frag= 0L
  ttl= 64
  proto= icmp
  chksum= 0xe513
  src= 172.16.36.135
  dst= 172.16.36.180
  \options\ 
###[ ICMP ]###
     type= echo-reply
     code= 0
     chksum= 0xffff
     id= 0x0
     seq= 0x0 
###[ Padding ]###
        load= &apos;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\ x00\x00\x00\x00&apos;
</code></pre><p>&#x5728;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;<code>sr1()</code>&#x51FD;&#x6570;&#x8D4B;&#x7ED9;&#x4E86;<code>ping_reply</code>&#x53D8;&#x91CF;&#x3002; &#x8FD9;&#x5C06;&#x6267;&#x884C;&#x8BE5;&#x51FD;&#x6570;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x7ED3;&#x679C;&#x4F20;&#x9012;&#x7ED9;&#x6B64;&#x53D8;&#x91CF;&#x3002; &#x5728;&#x63A5;&#x6536;&#x5230;&#x54CD;&#x5E94;&#x540E;&#xFF0C;&#x5728;<code>ping_reply</code>&#x53D8;&#x91CF;&#x4E0A;&#x8C03;&#x7528;<code>display()</code>&#x51FD;&#x6570;&#x6765;&#x67E5;&#x770B;&#x54CD;&#x5E94;&#x7684;&#x5185;&#x5BB9;&#x3002;&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x6B64;&#x6570;&#x636E;&#x5305;&#x662F;&#x4ECE;&#x6211;&#x4EEC;&#x53D1;&#x9001;&#x521D;&#x59CB;&#x8BF7;&#x6C42;&#x7684;&#x4E3B;&#x673A;&#x53D1;&#x9001;&#x7684;&#xFF0C;&#x76EE;&#x6807;&#x5730;&#x5740;&#x662F; Kali &#x7CFB;&#x7EDF;&#x7684; IP &#x5730;&#x5740;&#x3002; &#x53E6;&#x5916;&#xFF0C;&#x6CE8;&#x610F;&#x54CD;&#x5E94;&#x7684; ICMP &#x7C7B;&#x578B;&#x662F;&#x56DE;&#x5E94;&#x5E94;&#x7B54;&#x3002; &#x57FA;&#x4E8E;&#x6B64;&#x793A;&#x4F8B;&#xFF0C;&#x4F7F;&#x7528; Scapy &#x53D1;&#x9001;&#x548C;&#x63A5;&#x6536; ICMP &#x7684;&#x8FC7;&#x7A0B;&#x770B;&#x8D77;&#x6765;&#x5F88;&#x6709;&#x7528;&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x4F60;&#x5C1D;&#x8BD5;&#x5BF9;&#x975E;&#x54CD;&#x5E94;&#x7684;&#x76EE;&#x6807;&#x5730;&#x5740;&#x4F7F;&#x7528;&#x76F8;&#x540C;&#x7684;&#x6B65;&#x9AA4;&#xFF0C;&#x4F60;&#x4F1A;&#x5F88;&#x5FEB;&#x6CE8;&#x610F;&#x5230;&#x95EE;&#x9898;&#xFF1A;</p>
<pre><code>&gt;&gt;&gt; ip.dst = &quot;172.16.36.136&quot; 
&gt;&gt;&gt; ping_request = (ip/ping) 
&gt;&gt;&gt; ping_reply = sr1(ping_request) 
.Begin emission: 
......................................................................... ......................................................................... ........... 
Finished to send 1 packets 
.................................. .................................................................... 
                        *** {TRUNCATED} ***
</code></pre><p>&#x793A;&#x4F8B;&#x8F93;&#x51FA;&#x88AB;&#x622A;&#x65AD;&#xFF0C;&#x4F46;&#x6B64;&#x8F93;&#x51FA;&#x5E94;&#x8BE5;&#x65E0;&#x9650;&#x7EE7;&#x7EED;&#xFF0C;&#x76F4;&#x5230;&#x4F60;&#x4F7F;&#x7528;<code>Ctrl + C</code>&#x5F3A;&#x5236;&#x5173;&#x95ED;&#x3002;&#x4E0D;&#x5411;&#x51FD;&#x6570;&#x63D0;&#x4F9B;&#x8D85;&#x65F6;&#x503C;&#xFF0C;<code>sr1()</code>&#x51FD;&#x6570;&#x4F1A;&#x7EE7;&#x7EED;&#x76D1;&#x542C;&#xFF0C;&#x76F4;&#x5230;&#x63A5;&#x6536;&#x5230;&#x54CD;&#x5E94;&#x3002; &#x5982;&#x679C;&#x4E3B;&#x673A;&#x4E0D;&#x662F;&#x6D3B;&#x52A8;&#x7684;&#xFF0C;&#x6216;&#x8005;&#x5982;&#x679C; IP &#x5730;&#x5740;&#x6CA1;&#x6709;&#x4E0E;&#x4EFB;&#x4F55;&#x4E3B;&#x673A;&#x5173;&#x8054;&#xFF0C;&#x5219;&#x4E0D;&#x4F1A;&#x53D1;&#x9001;&#x54CD;&#x5E94;&#xFF0C;&#x5E76;&#x4E14;&#x8BE5;&#x529F;&#x80FD;&#x4E5F;&#x4E0D;&#x4F1A;&#x9000;&#x51FA;&#x3002; &#x4E3A;&#x4E86;&#x5728;&#x811A;&#x672C;&#x4E2D;&#x6709;&#x6548;&#x4F7F;&#x7528;&#x6B64;&#x51FD;&#x6570;&#xFF0C;&#x5E94;&#x5B9A;&#x4E49;&#x8D85;&#x65F6;&#x503C;&#xFF1A;</p>
<pre><code>&gt;&gt;&gt; ping_reply = sr1(ping_request, timeout=1) 
.Begin emission: 
....................................................................... ....................................................................... 
Finished to send 1 packets. 
.................................... 
Received 3982 packets, got 0 answers, remaining 1 packets
</code></pre><p>&#x901A;&#x8FC7;&#x63D0;&#x4F9B;&#x8D85;&#x65F6;&#x503C;&#x4F5C;&#x4E3A;&#x4F20;&#x9012;&#x7ED9;<code>sr1()</code>&#x51FD;&#x6570;&#x7684;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x6307;&#x5B9A;&#x7684;&#x79D2;&#x6570;&#x5185;&#x6CA1;&#x6709;&#x6536;&#x5230;&#x54CD;&#x5E94;&#xFF0C;&#x8FDB;&#x7A0B;&#x5C06;&#x9000;&#x51FA;&#x3002; &#x5728;&#x6240;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;<code>sr1()</code>&#x51FD;&#x6570;&#x7528;&#x4E8E;&#x5C06; ICMP &#x8BF7;&#x6C42;&#x53D1;&#x9001;&#x5230;&#x65E0;&#x54CD;&#x5E94;&#x5730;&#x5740;&#xFF0C;&#x56E0;&#x4E3A;&#x672A;&#x6536;&#x5230;&#x54CD;&#x5E94;&#xFF0C;&#x4F1A;&#x5728; 1 &#x79D2;&#x540E;&#x9000;&#x51FA;&#x3002; &#x5230;&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x51FD;&#x6570;&#x8D4B;&#x503C;&#x7ED9;&#x53D8;&#x91CF;&#xFF0C;&#x6765;&#x521B;&#x5EFA;&#x6301;&#x4E45;&#x5316;&#x548C;&#x53EF;&#x64CD;&#x4F5C;&#x7684;&#x5BF9;&#x8C61;&#x3002; &#x4F46;&#x662F;&#xFF0C;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x4E0D;&#x5FC5;&#x590D;&#x5236;&#x7ED9;&#x53D8;&#x91CF;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x751F;&#x6210;&#x3002;</p>
<pre><code>&gt;&gt;&gt; answer = sr1(IP(dst=&quot;172.16.36.135&quot;)/ICMP(),timeout=1) 
.Begin emission:
...*
Finished to send 1 packets.
Received 5 packets, got 1 answers, remaining 0 packets 
&gt;&gt;&gt; response.display() 
###[ IP ]###
  version= 4L
  ihl= 5L
  tos= 0x0
  len= 28
  id= 62578
  flags=
  frag= 0L
  ttl= 64
  proto= icmp
  chksum= 0xe512
  src= 172.16.36.135
  dst= 172.16.36.180
  \options\ 
###[ ICMP ]###
     type= echo-reply
     code= 0
     chksum= 0xffff
     id= 0x0
     seq= 0x0 
###[ Padding ]###
        load= &apos;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\ x00\x00\x00\x00&apos;
</code></pre><p>&#x5728;&#x8FD9;&#x91CC;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x4E4B;&#x524D;&#x4F7F;&#x7528;&#x56DB;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x547D;&#x4EE4;&#x5B8C;&#x6210;&#x7684;&#x6240;&#x6709;&#x5DE5;&#x4F5C;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x7684;&#x5355;&#x4E2A;&#x547D;&#x4EE4;&#x6765;&#x5B8C;&#x6210;&#x3002; &#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x8D85;&#x65F6;&#x503C;&#x6307;&#x5B9A;&#x7684;&#x65F6;&#x95F4;&#x8303;&#x56F4;&#x5185;&#xFF0C; ICMP &#x8BF7;&#x6C42;&#x6CA1;&#x6709;&#x6536;&#x5230; IP &#x5730;&#x5740;&#x7684;&#x56DE;&#x590D;&#xFF0C;&#x8C03;&#x7528;&#x5BF9;&#x8C61;&#x4F1A;&#x4EA7;&#x751F;&#x5F02;&#x5E38;&#x3002; &#x7531;&#x4E8E;&#x672A;&#x6536;&#x5230;&#x54CD;&#x5E94;&#xFF0C;&#x56E0;&#x6B64;&#x6B64;&#x793A;&#x4F8B;&#x4E2D;&#x8D4B;&#x503C;&#x4E3A;&#x54CD;&#x5E94;&#x7684;&#x5E94;&#x7B54;&#x53D8;&#x91CF;&#x4E0D;&#x4F1A;&#x521D;&#x59CB;&#x5316;&#xFF1A;</p>
<pre><code>&gt;&gt;&gt; answer = sr1(IP(dst=&quot;83.166.169.231&quot;)/ICMP(),timeout=1) 
Begin emission: 
..........................................
Finished to send 1 packets. 
......................................................................... ..........................
Received 1180 packets, got 0 answers, remaining 1 packets 
&gt;&gt;&gt; answer.display() 
Traceback (most recent call last):  File &quot;&lt;console&gt;&quot;, line 1, in &lt;module&gt; AttributeError: &apos;NoneType&apos; object has no attribute &apos;display&apos;
</code></pre><p>&#x6709;&#x5173;&#x8FD9;&#x4E9B;&#x4E0D;&#x540C;&#x54CD;&#x5E94;&#x7684;&#x77E5;&#x8BC6;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x751F;&#x6210;&#x5728;&#x591A;&#x4E2A; IP &#x5730;&#x5740;&#x4E0A;&#x6309;&#x987A;&#x5E8F;&#x6267;&#x884C; ICMP &#x8BF7;&#x6C42;&#x7684;&#x811A;&#x672C;&#x3002; &#x811A;&#x672C;&#x4F1A;&#x5FAA;&#x73AF;&#x904D;&#x5386;&#x76EE;&#x6807; IP &#x5730;&#x5740;&#x4E2D;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x516B;&#x4F4D;&#x5B57;&#x8282;&#x7684;&#x6240;&#x6709;&#x53EF;&#x80FD;&#x503C;&#xFF0C;&#x5E76;&#x4E3A;&#x6BCF;&#x4E2A;&#x503C;&#x53D1;&#x9001;&#x4E00;&#x4E2A; ICMP &#x8BF7;&#x6C42;&#x3002; &#x5F53;&#x4ECE;&#x6BCF;&#x4E2A;<code>sr1()</code>&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x65F6;&#xFF0C;&#x5C06;&#x8BC4;&#x4F30;&#x54CD;&#x5E94;&#x6765;&#x786E;&#x5B9A;&#x662F;&#x5426;&#x63A5;&#x6536;&#x5230;&#x5E94;&#x7B54;&#x7684;&#x54CD;&#x5E94;&#xFF1A;</p>
<pre><code class="lang-py"><span class="hljs-comment">#!/usr/bin/python</span>

<span class="hljs-keyword">import</span> logging 
logging.getLogger(<span class="hljs-string">&quot;scapy.runtime&quot;</span>).setLevel(logging.ERROR) 
<span class="hljs-keyword">from</span> scapy.all <span class="hljs-keyword">import</span> *

<span class="hljs-keyword">if</span> len(sys.argv) != <span class="hljs-number">2</span>:   
    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Usage - ./pinger.py [/24 network address]&quot;</span>   
    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Example - ./pinger.py 172.16.36.0&quot;</span>   
    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Example will perform an ICMP scan of the 172.16.36.0/24 range&quot;</span>   
    sys.exit()

address = str(sys.argv[<span class="hljs-number">1</span>]) 
prefix = address.split(<span class="hljs-string">&apos;.&apos;</span>)[<span class="hljs-number">0</span>] + <span class="hljs-string">&apos;.&apos;</span> + address.split(<span class="hljs-string">&apos;.&apos;</span>)[<span class="hljs-number">1</span>] + <span class="hljs-string">&apos;.&apos;</span> + address.split(<span class="hljs-string">&apos;.&apos;</span>)[<span class="hljs-number">2</span>] + <span class="hljs-string">&apos;.&apos;</span>

<span class="hljs-keyword">for</span> addr <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,<span class="hljs-number">254</span>):   
    answer=sr1(ARP(pdst=prefix+str(addr)),timeout=<span class="hljs-number">1</span>,verbose=<span class="hljs-number">0</span>)   
    <span class="hljs-keyword">if</span> answer == <span class="hljs-keyword">None</span>:      
        <span class="hljs-keyword">pass</span>   
    <span class="hljs-keyword">else</span>:      
        <span class="hljs-keyword">print</span> prefix+str(addr)
</code></pre>
<p>&#x811A;&#x672C;&#x7684;&#x7B2C;&#x4E00;&#x884C;&#x6807;&#x8BC6;&#x4E86; Python &#x89E3;&#x91CA;&#x5668;&#x6240;&#x5728;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x4EE5;&#x4FBF;&#x811A;&#x672C;&#x53EF;&#x4EE5;&#x5728;&#x4E0D;&#x4F20;&#x9012;&#x5230;&#x89E3;&#x91CA;&#x5668;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x6267;&#x884C;&#x3002; &#x7136;&#x540E;&#x811A;&#x672C;&#x5BFC;&#x5165;&#x6240;&#x6709; Scapy &#x51FD;&#x6570;&#xFF0C;&#x5E76;&#x5B9A;&#x4E49; Scapy &#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x7EA7;&#x522B;&#xFF0C;&#x4EE5;&#x6D88;&#x9664;&#x811A;&#x672C;&#x4E2D;&#x4E0D;&#x5FC5;&#x8981;&#x7684;&#x8F93;&#x51FA;&#x3002; &#x8FD8;&#x5BFC;&#x5165;&#x4E86;&#x5B50;&#x8FC7;&#x7A0B;&#x5E93;&#xFF0C;&#x4EE5;&#x4FBF;&#x4E8E;&#x4ECE;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E2D;&#x63D0;&#x53D6;&#x4FE1;&#x606F;&#x3002; &#x7B2C;&#x4E8C;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x662F;&#x6761;&#x4EF6;&#x6D4B;&#x8BD5;&#xFF0C;&#x7528;&#x4E8E;&#x8BC4;&#x4F30;&#x662F;&#x5426;&#x5411;&#x811A;&#x672C;&#x63D0;&#x4F9B;&#x4E86;&#x6240;&#x9700;&#x7684;&#x53C2;&#x6570;&#x3002; &#x5982;&#x679C;&#x5728;&#x6267;&#x884C;&#x65F6;&#x672A;&#x63D0;&#x4F9B;&#x6240;&#x9700;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x5219;&#x811A;&#x672C;&#x5C06;&#x8F93;&#x51FA;&#x4F7F;&#x7528;&#x60C5;&#x51B5;&#x7684;&#x8BF4;&#x660E;&#x3002; &#x8BE5;&#x8BF4;&#x660E;&#x5305;&#x62EC;&#x5DE5;&#x5177;&#x7684;&#x7528;&#x6CD5;&#xFF0C;&#x793A;&#x4F8B;&#x548C;&#x6240;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#x7684;&#x89E3;&#x91CA;&#x3002;</p>
<p>&#x5728;&#x8FD9;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x4E4B;&#x540E;&#xFF0C;&#x6709;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x4EE3;&#x7801;&#x884C;&#x5C06;&#x6240;&#x63D0;&#x4F9B;&#x7684;&#x53C2;&#x6570;&#x8D4B;&#x503C;&#x7ED9;<code>interface</code>&#x53D8;&#x91CF;&#x3002;&#x4E0B;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x4F7F;&#x7528;<code>check_output()</code>&#x5B50;&#x8FDB;&#x7A0B;&#x51FD;&#x6570;&#x6267;&#x884C;<code>ifconfig</code>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x8BE5;&#x8C03;&#x7528;&#x4E5F;&#x4F7F;&#x7528;<code>grep</code>&#x548C;<code>cut</code>&#x4ECE;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x63D0;&#x4F9B;&#x7684;&#x672C;&#x5730;&#x63A5;&#x53E3;&#x63D0;&#x53D6; IP &#x5730;&#x5740;&#x3002;&#x7136;&#x540E;&#x5C06;&#x6B64;&#x8F93;&#x51FA;&#x8D4B;&#x7ED9;<code>ip</code>&#x53D8;&#x91CF;&#x3002;&#x7136;&#x540E;&#x4F7F;&#x7528;<code>split</code>&#x51FD;&#x6570;&#x4ECE; IP &#x5730;&#x5740;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x63D0;&#x53D6;<code>/ 24</code>&#x7F51;&#x7EDC;&#x524D;&#x7F00;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;<code>ip</code>&#x53D8;&#x91CF;&#x5305;&#x542B;<code>192.168.11.4</code>&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5219;&#x503C;&#x4E3A;<code>192.168.11</code>&#x3002;&#x5B83;&#x5C06;&#x8D4B;&#x7ED9;<code>prefix</code>&#x53D8;&#x91CF;&#x3002;</p>
<p>&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x662F;&#x4E00;&#x4E2A;&#x7528;&#x4E8E;&#x6267;&#x884C;&#x5B9E;&#x9645;&#x626B;&#x63CF;&#x7684;<code>for</code>&#x5FAA;&#x73AF;&#x3002; <code>for</code>&#x5FAA;&#x73AF;&#x904D;&#x5386;&#x4ECB;&#x4E8E; 0 &#x548C; 254 &#x4E4B;&#x95F4;&#x7684;&#x6240;&#x6709;&#x503C;&#xFF0C;&#x5E76;&#x4E14;&#x5BF9;&#x4E8E;&#x6BCF;&#x6B21;&#x8FED;&#x4EE3;&#xFF0C;&#x8BE5;&#x503C;&#x968F;&#x540E;&#x9644;&#x52A0;&#x5230;&#x7F51;&#x7EDC;&#x524D;&#x7F00;&#x540E;&#x9762;&#x3002;&#x5728;&#x65E9;&#x5148;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x7684;&#x4E2D;&#xFF0C;&#x5C06;&#x9488;&#x5BF9;<code>192.168.11.0</code>&#x548C;<code>192.168.11.254</code>&#x4E4B;&#x95F4;&#x7684;&#x6BCF;&#x4E2A; IP &#x5730;&#x5740;&#x53D1;&#x9001; ICMP &#x56DE;&#x663E;&#x8BF7;&#x6C42;&#x3002;&#x7136;&#x540E;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x56DE;&#x590D;&#x7684;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#xFF0C;&#x5C06;&#x76F8;&#x5E94;&#x7684; IP &#x5730;&#x5740;&#x6253;&#x5370;&#x5230;&#x5C4F;&#x5E55;&#x4E0A;&#xFF0C;&#x4EE5;&#x8868;&#x660E;&#x4E3B;&#x673A;&#x5728; LAN &#x4E0A;&#x6D3B;&#x52A8;&#x3002;&#x4E00;&#x65E6;&#x811A;&#x672C;&#x88AB;&#x5199;&#x5165;&#x672C;&#x5730;&#x76EE;&#x5F55;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x7EC8;&#x7AEF;&#x4E2D;&#x4F7F;&#x7528;&#x53E5;&#x53F7;&#x548C;&#x659C;&#x6760;&#xFF0C;&#x7136;&#x540E;&#x662F;&#x53EF;&#x6267;&#x884C;&#x811A;&#x672C;&#x7684;&#x540D;&#x79F0;&#x6765;&#x6267;&#x884C;&#x5B83;&#x3002;&#x770B;&#x770B;&#x4EE5;&#x4E0B;&#x7528;&#x4E8E;&#x6267;&#x884C;&#x811A;&#x672C;&#x7684;&#x547D;&#x4EE4;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ./pinger.py 
Usage - ./pinger.py [/24 network address] 
Example - ./pinger.py 172.16.36.0 
Example will perform an ICMP scan of the 172.16.36.0/24 range 
root@KaliLinux:~# ./pinger.py 
172.16.36.0 
172.16.36.2 
172.16.36.1 
172.16.36.132 
172.16.36.135
</code></pre><p>&#x5982;&#x679C;&#x5728;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x4EFB;&#x4F55;&#x53C2;&#x6570;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x6267;&#x884C;&#x811A;&#x672C;&#xFF0C;&#x5219;&#x4F1A;&#x5C06;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#x8F93;&#x51FA;&#x5230;&#x5C4F;&#x5E55;&#x3002; &#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#x8F93;&#x51FA;&#x8868;&#x660E;&#xFF0C;&#x6B64;&#x811A;&#x672C;&#x9700;&#x8981;&#x7528;&#x4E8E;&#x5B9A;&#x4E49;&#x8981;&#x626B;&#x63CF;&#x7684;<code>/ 24</code>&#x7F51;&#x7EDC;&#x7684;&#x5355;&#x4E2A;&#x53C2;&#x6570;&#x3002; &#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4F7F;&#x7528;<code>172.16.36.0</code>&#x7F51;&#x7EDC;&#x5730;&#x5740;&#x6765;&#x6267;&#x884C;&#x811A;&#x672C;&#x3002; &#x8BE5;&#x811A;&#x672C;&#x7136;&#x540E;&#x8F93;&#x51FA;&#x5728;<code>/ 24</code>&#x7F51;&#x7EDC;&#x8303;&#x56F4;&#x4E0A;&#x7684;&#x6D3B;&#x52A8; IP &#x5730;&#x5740;&#x7684;&#x5217;&#x8868;&#x3002; &#x6B64;&#x8F93;&#x51FA;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5C16;&#x62EC;&#x53F7;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x8F93;&#x51FA;&#x6587;&#x672C;&#x6587;&#x4EF6;&#xFF0C;&#x540E;&#x8DDF;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x540D;&#x3002; &#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ./pinger.py 172.16.36.0 &gt; output.txt 
root@KaliLinux:~# ls output.txt 
output.txt 
root@KaliLinux:~# cat output.txt 
172.16.36.1 
172.16.36.2 
172.16.36.132 
172.16.36.135
</code></pre><p>&#x7136;&#x540E;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>ls</code>&#x547D;&#x4EE4;&#x6765;&#x9A8C;&#x8BC1;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x5DF2;&#x5199;&#x5165;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x6216;&#x8005;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>cat</code>&#x547D;&#x4EE4;&#x67E5;&#x770B;&#x5176;&#x5185;&#x5BB9;&#x3002; &#x4E5F;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x6B64;&#x811A;&#x672C;&#xFF0C;&#x6765;&#x63A5;&#x53D7; IP &#x5730;&#x5740;&#x5217;&#x8868;&#x4F5C;&#x4E3A;&#x8F93;&#x5165;&#x3002; &#x4E3A;&#x6B64;&#xFF0C;&#x5FC5;&#x987B;&#x66F4;&#x6539;<code>for</code>&#x5FAA;&#x73AF;&#x6765;&#x5FAA;&#x73AF;&#x904D;&#x5386;&#x4ECE;&#x6307;&#x5B9A;&#x7684;&#x6587;&#x672C;&#x6587;&#x4EF6;&#x8BFB;&#x53D6;&#x7684;&#x884C;&#x3002; &#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-py"><span class="hljs-comment">#!/usr/bin/python</span>

<span class="hljs-keyword">import</span> logging 
logging.getLogger(<span class="hljs-string">&quot;scapy.runtime&quot;</span>).setLevel(logging.ERROR) 
<span class="hljs-keyword">from</span> scapy.all <span class="hljs-keyword">import</span> *

<span class="hljs-keyword">if</span> len(sys.argv) != <span class="hljs-number">2</span>:   
    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Usage - ./pinger.py [filename]&quot;</span>   
    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Example - ./pinger.py iplist.txt&quot;</span>   
    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Example will perform an ICMP ping scan of the IP addresses listed in iplist.txt&quot;</span>   
    sys.exit()

filename = str(sys.argv[<span class="hljs-number">1</span>]) 
file = open(filename,<span class="hljs-string">&apos;r&apos;</span>)

<span class="hljs-keyword">for</span> addr <span class="hljs-keyword">in</span> file:   
    ans=sr1(IP(dst=addr.strip())/ICMP(),timeout=<span class="hljs-number">1</span>,verbose=<span class="hljs-number">0</span>)   
    <span class="hljs-keyword">if</span> ans == <span class="hljs-keyword">None</span>:      
        <span class="hljs-keyword">pass</span>   
    <span class="hljs-keyword">else</span>:      
        <span class="hljs-keyword">print</span> addr.strip()
</code></pre>
<p>&#x4E0E;&#x4E4B;&#x524D;&#x7684;&#x811A;&#x672C;&#x552F;&#x4E00;&#x7684;&#x4E3B;&#x8981;&#x533A;&#x522B;&#x662F;&#xFF0C;&#x5B83;&#x63A5;&#x53D7;&#x4E00;&#x4E2A;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#x540D;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#xFF0C;&#x7136;&#x540E;&#x5FAA;&#x73AF;&#x904D;&#x5386;&#x6B64;&#x6587;&#x4EF6;&#x4E2D;&#x5217;&#x51FA;&#x7684;&#x6BCF;&#x4E2A; IP &#x5730;&#x5740;&#x8FDB;&#x884C;&#x626B;&#x63CF;&#x3002; &#x4E0E;&#x5176;&#x4ED6;&#x811A;&#x672C;&#x7C7B;&#x4F3C;&#xFF0C;&#x751F;&#x6210;&#x7684;&#x8F93;&#x51FA;&#x5305;&#x62EC;&#x54CD;&#x5E94; ICMP &#x56DE;&#x663E;&#x8BF7;&#x6C42;&#x7684;&#x7CFB;&#x7EDF;&#x7684;&#x76F8;&#x5173; IP &#x5730;&#x5740;&#x7684;&#x7B80;&#x5355;&#x5217;&#x8868;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x542B; ICMP &#x56DE;&#x663E;&#x54CD;&#x5E94;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ./pinger.py 
Usage - ./pinger.py [filename] 
Example - ./pinger.py iplist.txt 
Example will perform an 
ICMP ping scan of the IP addresses listed in iplist.txt 
root@KaliLinux:~# ./pinger.py iplist.txt 
172.16.36.1 
172.16.36.2 
172.16.36.132 
172.16.36.135
</code></pre><p>&#x6B64;&#x811A;&#x672C;&#x7684;&#x8F93;&#x51FA;&#x53EF;&#x4EE5;&#x4EE5;&#x76F8;&#x540C;&#x7684;&#x65B9;&#x5F0F;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x3002; &#x4F7F;&#x7528;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x63D0;&#x4F9B;&#x7684;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#x6765;&#x6267;&#x884C;&#x811A;&#x672C;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;&#x5C16;&#x62EC;&#x53F7;&#x91CD;&#x5B9A;&#x5411;&#x8F93;&#x51FA;&#xFF0C;&#x540E;&#x8DDF;&#x8F93;&#x51FA;&#x6587;&#x672C;&#x6587;&#x4EF6;&#x7684;&#x540D;&#x79F0;&#x3002; &#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ./pinger.py iplist.txt &gt; output.txt 
root@KaliLinux:~# ls output.txt 
output.txt 
root@KaliLinux:~# cat output.txt 
172.16.36.1 
172.16.36.2 
172.16.36.132 
172.16.36.135
</code></pre><h3 id="&#x5DE5;&#x4F5C;&#x539F;&#x7406;">&#x5DE5;&#x4F5C;&#x539F;&#x7406;</h3>
<p>&#x6B64;&#x5904;&#x4F7F;&#x7528; Scapy &#x901A;&#x8FC7;&#x6784;&#x9020;&#x5305;&#x62EC; IP &#x5C42;&#x548C;&#x9644;&#x52A0;&#x7684; ICMP &#x8BF7;&#x6C42;&#x7684;&#x8BF7;&#x6C42;&#x6765;&#x6267;&#x884C; ICMP &#x7B2C;&#x4E09;&#x5C42;&#x53D1;&#x73B0;&#x3002; IP &#x5C42;&#x80FD;&#x591F;&#x5C06;&#x5C01;&#x5305;&#x8DEF;&#x7531;&#x5230;&#x672C;&#x5730;&#x7F51;&#x7EDC;&#x4E4B;&#x5916;&#xFF0C;&#x5E76;&#x4E14; ICMP &#x8BF7;&#x6C42;&#x7528;&#x4E8E;&#x4ECE;&#x8FDC;&#x7A0B;&#x7CFB;&#x7EDF;&#x8BF7;&#x6C42;&#x54CD;&#x5E94;&#x3002; &#x5728; Python &#x811A;&#x672C;&#x4E2D;&#x4F7F;&#x7528;&#x6B64;&#x6280;&#x672F;&#xFF0C;&#x53EF;&#x4EE5;&#x6309;&#x987A;&#x5E8F;&#x6267;&#x884C;&#x6B64;&#x4EFB;&#x52A1;&#xFF0C;&#x6765;&#x626B;&#x63CF;&#x591A;&#x4E2A;&#x7CFB;&#x7EDF;&#x6216;&#x6574;&#x4E2A;&#x7F51;&#x7EDC;&#x8303;&#x56F4;&#x3002;</p>
<h2 id="28-&#x4F7F;&#x7528;-nmap-&#x53D1;&#x73B0;&#x7B2C;&#x4E09;&#x5C42;">2.8 &#x4F7F;&#x7528; Nmap &#x53D1;&#x73B0;&#x7B2C;&#x4E09;&#x5C42;</h2>
<p>Nmap &#x662F; Kali Linux &#x4E2D;&#x6700;&#x5F3A;&#x5927;&#x548C;&#x6700;&#x901A;&#x7528;&#x7684;&#x626B;&#x63CF;&#x5DE5;&#x5177;&#x4E4B;&#x4E00;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x6BEB;&#x4E0D;&#x5947;&#x602A;&#xFF0C;Nmap &#x4E5F;&#x652F;&#x6301; ICMP &#x53D1;&#x73B0;&#x626B;&#x63CF;&#x3002; &#x8BE5;&#x79D8;&#x7C4D;&#x6F14;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x4F7F;&#x7528; Nmap &#x5728;&#x8FDC;&#x7A0B;&#x4E3B;&#x673A;&#x4E0A;&#x6267;&#x884C;&#x7B2C;&#x4E09;&#x5C42;&#x53D1;&#x73B0;&#x3002;</p>
<h3 id="&#x51C6;&#x5907;">&#x51C6;&#x5907;</h3>
<p>&#x4F7F;&#x7528; Nmap &#x6267;&#x884C;&#x7B2C;&#x4E09;&#x5C42;&#x53D1;&#x73B0;&#x4E0D;&#x9700;&#x8981;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#xFF0C;&#x56E0;&#x4E3A; Internet &#x4E0A;&#x7684;&#x8BB8;&#x591A;&#x7CFB;&#x7EDF;&#x90FD;&#x5C06;&#x56DE;&#x590D; ICMP &#x56DE;&#x663E;&#x8BF7;&#x6C42;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5F3A;&#x70C8;&#x5EFA;&#x8BAE;&#x4F60;&#x53EA;&#x5728;&#x60A8;&#x81EA;&#x5DF1;&#x7684;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x6267;&#x884C;&#x4EFB;&#x4F55;&#x7C7B;&#x578B;&#x7684;&#x7F51;&#x7EDC;&#x626B;&#x63CF;&#xFF0C;&#x9664;&#x975E;&#x4F60;&#x5B8C;&#x5168;&#x719F;&#x6089;&#x60A8;&#x53D7;&#x5230;&#x4EFB;&#x4F55;&#x7BA1;&#x7406;&#x673A;&#x6784;&#x65BD;&#x52A0;&#x7684;&#x6CD5;&#x5F8B;&#x6CD5;&#x89C4;&#x3002;&#x5982;&#x679C;&#x4F60;&#x5E0C;&#x671B;&#x5728;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x6267;&#x884C;&#x6B64;&#x6280;&#x672F;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x54CD;&#x5E94; ICMP &#x8BF7;&#x6C42;&#x7684;&#x7CFB;&#x7EDF;&#x3002;&#x5728;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528; Linux &#x548C; Windows &#x7CFB;&#x7EDF;&#x7684;&#x7EC4;&#x5408;&#x3002;&#x6709;&#x5173;&#x5728;&#x672C;&#x5730;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x8BBE;&#x7F6E;&#x7CFB;&#x7EDF;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x4E2D;&#x7684;&#x201C;&#x5B89;&#x88C5; Metasploitable2&#x201D;&#x548C;&#x201C;&#x5B89;&#x88C5; Windows Server&#x201D;&#x79D8;&#x7C4D;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x672C;&#x8282;&#x8FD8;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#xFF08;&#x5982; VIM &#x6216; Nano&#xFF09;&#x5C06;&#x811A;&#x672C;&#x5199;&#x5165;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3002;&#x6709;&#x5173;&#x7F16;&#x5199;&#x811A;&#x672C;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x4E2D;&#x7684;&#x201C;&#x4F7F;&#x7528;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#xFF08;VIM &#x548C; Nano&#xFF09;&#x201D;&#x79D8;&#x7C4D;&#x3002;</p>
<h3 id="&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;">&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;</h3>
<p>Nmap&#x662F;&#x4E00;&#x79CD;&#x81EA;&#x9002;&#x5E94;&#x5DE5;&#x5177;&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x6309;&#x9700;&#x81EA;&#x52A8;&#x8C03;&#x6574;&#xFF0C;&#x5E76;&#x6267;&#x884C;&#x7B2C;2&#x5C42;&#xFF0C;&#x7B2C;3&#x5C42;&#x6216;&#x7B2C;4&#x5C42;&#x53D1;&#x73B0;&#x3002; &#x5982;&#x679C;<code>-sn</code>&#x9009;&#x9879;&#x5728; Nmap &#x4E2D;&#x7528;&#x4E8E;&#x626B;&#x63CF;&#x672C;&#x5730;&#x7F51;&#x6BB5;&#x4E0A;&#x4E0D;&#x5B58;&#x5728;&#x7684; IP &#x5730;&#x5740;&#xFF0C;&#x5219; ICMP &#x56DE;&#x663E;&#x8BF7;&#x6C42;&#x5C06;&#x7528;&#x4E8E;&#x786E;&#x5B9A;&#x4E3B;&#x673A;&#x662F;&#x5426;&#x5904;&#x4E8E;&#x6D3B;&#x52A8;&#x72B6;&#x6001;&#x548C;&#x662F;&#x5426;&#x54CD;&#x5E94;&#x3002; &#x4E3A;&#x4E86;&#x5BF9;&#x5355;&#x4E2A;&#x76EE;&#x6807;&#x6267;&#x884C; ICMP &#x626B;&#x63CF;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;&#x5E26;&#x6709;<code>-sn</code>&#x9009;&#x9879;&#x7684;Nmap&#xFF0C;&#x5E76;&#x4F20;&#x9012;&#x8981;&#x626B;&#x63CF;&#x7684; IP &#x5730;&#x5740;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# nmap -sn 74.125.228.1
Starting Nmap 6.25 ( http://nmap.org ) at 2013-12-16 23:05 EST 
Nmap scan report for iad23s05-in-f1.1e100.net (74.125.228.1) 
Host is up (0.00013s latency). 
Nmap done: 1 IP address (1 host up) scanned in 0.02 seconds
</code></pre><p>&#x6B64;&#x547D;&#x4EE4;&#x7684;&#x8F93;&#x51FA;&#x8868;&#x660E;&#x4E86;&#x8BBE;&#x5907;&#x662F;&#x5426;&#x5DF2;&#x542F;&#x52A8;&#xFF0C;&#x8FD8;&#x4F1A;&#x63D0;&#x4F9B;&#x6709;&#x5173;&#x6240;&#x6267;&#x884C;&#x626B;&#x63CF;&#x7684;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#x3002; &#x6B64;&#x5916;&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x7CFB;&#x7EDF;&#x540D;&#x79F0;&#x4E5F;&#x5DF2;&#x786E;&#x5B9A;&#x3002; Nmap &#x8FD8;&#x6267;&#x884C; DNS &#x89E3;&#x6790;&#x6765;&#x5728;&#x626B;&#x63CF;&#x8F93;&#x51FA;&#x4E2D;&#x63D0;&#x4F9B;&#x6B64;&#x4FE1;&#x606F;&#x3002; &#x5B83;&#x8FD8;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x4F7F;&#x7528;&#x7834;&#x6298;&#x53F7;&#x7B26;&#x53F7;&#x626B;&#x63CF; IP &#x5730;&#x5740;&#x8FDE;&#x7EED;&#x8303;&#x56F4;&#x3002; Nmap &#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x662F;&#x591A;&#x7EBF;&#x7A0B;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x5E76;&#x884C;&#x8FD0;&#x884C;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x3002; &#x56E0;&#x6B64;&#xFF0C;Nmap &#x5728;&#x8FD4;&#x56DE;&#x626B;&#x63CF;&#x7ED3;&#x679C;&#x65F6;&#x975E;&#x5E38;&#x5FEB;&#x3002; &#x770B;&#x770B;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# nmap -sn 74.125.228.1-255
Starting Nmap 6.25 ( http://nmap.org ) at 2013-12-16 23:14 EST 
Nmap scan report for iad23s05-in-f1.1e100.net (74.125.228.1) 
Host is up (0.00012s latency). 
Nmap scan report for iad23s05-in-f2.1e100.net (74.125.228.2) 
Host is up (0.0064s latency). 
Nmap scan report for iad23s05-in-f3.1e100.net (74.125.228.3) 
Host is up (0.0070s latency). 
Nmap scan report for iad23s05-in-f4.1e100.net (74.125.228.4) 
Host is up (0.00015s latency). 
Nmap scan report for iad23s05-in-f5.1e100.net (74.125.228.5) 
Host is up (0.00013s latency). 
Nmap scan report for iad23s05-in-f6.1e100.net (74.125.228.6) 
Host is up (0.00012s latency). 
Nmap scan report for iad23s05-in-f7.1e100.net (74.125.228.7) 
Host is up (0.00012s latency). 
Nmap scan report for iad23s05-in-f8.1e100.net (74.125.228.8) 
Host is up (0.00012s latency). 
                    *** {TRUNCATED} ***
</code></pre><p>&#x5728;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;Nmap &#x7528;&#x4E8E;&#x626B;&#x63CF;&#x6574;&#x4E2A;<code>/ 24</code>&#x7F51;&#x7EDC;&#x8303;&#x56F4;&#x3002; &#x4E3A;&#x4E86;&#x65B9;&#x4FBF;&#x67E5;&#x770B;&#xFF0C;&#x6B64;&#x547D;&#x4EE4;&#x7684;&#x8F93;&#x51FA;&#x88AB;&#x622A;&#x65AD;&#x3002; &#x901A;&#x8FC7;&#x4F7F;&#x7528; Wireshark &#x5206;&#x6790;&#x901A;&#x8FC7;&#x63A5;&#x53E3;&#x7684;&#x6D41;&#x91CF;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x6CE8;&#x610F;&#x5230;&#x8FD9;&#x4E9B;&#x5730;&#x5740;&#x6CA1;&#x6709;&#x6309;&#x987A;&#x5E8F;&#x626B;&#x63CF;&#x3002; &#x8FD9;&#x53EF;&#x4EE5;&#x5728;&#x4EE5;&#x4E0B;&#x5C4F;&#x5E55;&#x622A;&#x56FE;&#x4E2D;&#x770B;&#x5230;&#x3002; &#x8FD9;&#x662F; Nmap &#x7684;&#x591A;&#x7EBF;&#x7A0B;&#x7279;&#x6027;&#x7684;&#x8FDB;&#x4E00;&#x6B65;&#x8BC1;&#x636E;&#xFF0C;&#x5E76;&#x5C55;&#x793A;&#x4E86;&#x5F53;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x5B8C;&#x6210;&#x65F6;&#xFF0C;&#x5982;&#x4F55;&#x4ECE;&#x961F;&#x5217;&#x4E2D;&#x7684;&#x5730;&#x5740;&#x542F;&#x52A8;&#x8FDB;&#x7A0B;&#xFF1A;</p>
<p><img src="img/2-8-1.jpg" alt=""></p>
<p>&#x6216;&#x8005;&#xFF0C;Nmap &#x4E5F;&#x53EF;&#x7528;&#x4E8E;&#x626B;&#x63CF;&#x8F93;&#x5165;&#x6587;&#x672C;&#x6587;&#x4EF6;&#x4E2D;&#x7684; IP &#x5730;&#x5740;&#x3002; &#x8FD9;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>-iL</code>&#x9009;&#x9879;&#xFF0C;&#x540E;&#x8DDF;&#x6587;&#x4EF6;&#x6216;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;&#x7684;&#x540D;&#x79F0;&#x6765;&#x5B8C;&#x6210;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# cat iplist.txt 
74.125.228.13 74.125.228.28 
74.125.228.47 74.125.228.144 
74.125.228.162 74.125.228.211 
root@KaliLinux:~# nmap -iL iplist.txt -sn
Starting Nmap 6.25 ( http://nmap.org ) at 2013-12-16 23:14 EST 
Nmap scan report for iad23s05-in-f13.1e100.net (74.125.228.13) 
Host is up (0.00010s latency). 
Nmap scan report for iad23s05-in-f28.1e100.net (74.125.228.28) 
Host is up (0.0069s latency). 
Nmap scan report for iad23s06-in-f15.1e100.net (74.125.228.47) 
Host is up (0.0068s latency). 
Nmap scan report for iad23s17-in-f16.1e100.net (74.125.228.144) 
Host is up (0.00010s latency). 
Nmap scan report for iad23s18-in-f2.1e100.net (74.125.228.162) 
Host is up (0.0077s latency). 
Nmap scan report for 74.125.228.211 
Host is up (0.00022s latency). 
Nmap done: 6 IP addresses (6 hosts up) scanned in 0.04 seconds
</code></pre><p>&#x5728;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x6267;&#x884C;&#x76EE;&#x5F55;&#x4E2D;&#x5B58;&#x5728;&#x516D;&#x4E2A; IP &#x5730;&#x5740;&#x7684;&#x5217;&#x8868;&#x3002; &#x7136;&#x540E;&#x5C06;&#x6B64;&#x5217;&#x8868;&#x8F93;&#x5165;&#x5230; Nmap &#x4E2D;&#xFF0C;&#x5E76;&#x626B;&#x63CF;&#x6BCF;&#x4E2A;&#x5217;&#x51FA;&#x7684;&#x5730;&#x5740;&#x6765;&#x5C1D;&#x8BD5;&#x8BC6;&#x522B;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x3002;</p>
<h3 id="&#x5DE5;&#x4F5C;&#x539F;&#x7406;">&#x5DE5;&#x4F5C;&#x539F;&#x7406;</h3>
<p>Nmap &#x901A;&#x8FC7;&#x5BF9;&#x63D0;&#x4F9B;&#x7684;&#x8303;&#x56F4;&#x6216;&#x6587;&#x672C;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A; IP &#x5730;&#x5740;&#x53D1;&#x51FA; ICMP &#x56DE;&#x663E;&#x8BF7;&#x6C42;&#xFF0C;&#x6765;&#x6267;&#x884C;&#x7B2C;3&#x5C42;&#x626B;&#x63CF;&#x3002; &#x7531;&#x4E8E; Nmap &#x662F;&#x4E00;&#x4E2A;&#x591A;&#x7EBF;&#x7A0B;&#x5DE5;&#x5177;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x4F1A;&#x5E76;&#x884C;&#x53D1;&#x9001;&#x591A;&#x4E2A;&#x8BF7;&#x6C42;&#xFF0C;&#x7ED3;&#x679C;&#x4F1A;&#x5F88;&#x5FEB;&#x8FD4;&#x56DE;&#x7ED9;&#x7528;&#x6237;&#x3002; &#x7531;&#x4E8E; Nmap &#x7684;&#x53D1;&#x73B0;&#x529F;&#x80FD;&#x662F;&#x81EA;&#x9002;&#x5E94;&#x7684;&#xFF0C;&#x5B83;&#x53EA;&#x4F1A;&#x4F7F;&#x7528; ICMP &#x53D1;&#x73B0;&#xFF0C;&#x5982;&#x679C; ARP &#x53D1;&#x73B0;&#x65E0;&#x6CD5;&#x6709;&#x6548;&#x5B9A;&#x4F4D;&#x672C;&#x5730;&#x5B50;&#x7F51;&#x4E0A;&#x7684;&#x4E3B;&#x673A;&#x3002; &#x6216;&#x8005;&#xFF0C;&#x5982;&#x679C; ARP &#x53D1;&#x73B0;&#x6216; ICMP &#x53D1;&#x73B0;&#x90FD;&#x4E0D;&#x80FD;&#x6709;&#x6548;&#x8BC6;&#x522B;&#x7ED9;&#x5B9A; IP &#x5730;&#x5740;&#x4E0A;&#x7684;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x65F6;&#xFF0C;&#x90A3;&#x4E48;&#x5C06;&#x91C7;&#x7B2C;&#x56DB;&#x5C42;&#x53D1;&#x73B0;&#x6280;&#x672F;&#x3002;</p>
<h2 id="29-&#x4F7F;&#x7528;-fping-&#x63A2;&#x7D22;&#x7B2C;&#x4E09;&#x5C42;">2.9 &#x4F7F;&#x7528; fping &#x63A2;&#x7D22;&#x7B2C;&#x4E09;&#x5C42;</h2>
<p><code>fping</code>&#x5DE5;&#x5177;&#x8D39;&#x957F;&#x7C7B;&#x4F3C;&#x4E8E;&#x8457;&#x540D;&#x7684;<code>ping</code>&#x5DE5;&#x5177;&#x3002; &#x4F46;&#x662F;&#xFF0C;&#x5B83;&#x4E5F;&#x5185;&#x5EFA;&#x4E86;&#x5728;<code>ping</code>&#x4E2D;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x8BB8;&#x591A;&#x9644;&#x52A0;&#x529F;&#x80FD;&#x3002; &#x8FD9;&#x4E9B;&#x9644;&#x52A0;&#x529F;&#x80FD;&#x8BA9;<code>fping</code>&#x80FD;&#x591F;&#x7528;&#x4F5C;&#x529F;&#x80FD;&#x626B;&#x63CF;&#x5DE5;&#x5177;&#xFF0C;&#x65E0;&#x9700;&#x989D;&#x5916;&#x4FEE;&#x6539;&#x3002; &#x8BE5;&#x79D8;&#x7C4D;&#x6F14;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x4F7F;&#x7528;<code>fping</code>&#x5728;&#x8FDC;&#x7A0B;&#x4E3B;&#x673A;&#x4E0A;&#x6267;&#x884C;&#x7B2C;3&#x5C42;&#x53D1;&#x73B0;&#x3002;</p>
<h3 id="&#x51C6;&#x5907;">&#x51C6;&#x5907;</h3>
<p>&#x4F7F;&#x7528;<code>fping</code>&#x6267;&#x884C;&#x7B2C;&#x4E09;&#x5C42;&#x53D1;&#x73B0;&#x4E0D;&#x9700;&#x8981;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#xFF0C;&#x56E0;&#x4E3A; Internet &#x4E0A;&#x7684;&#x8BB8;&#x591A;&#x7CFB;&#x7EDF;&#x90FD;&#x5C06;&#x56DE;&#x590D; ICMP &#x56DE;&#x663E;&#x8BF7;&#x6C42;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5F3A;&#x70C8;&#x5EFA;&#x8BAE;&#x4F60;&#x53EA;&#x5728;&#x60A8;&#x81EA;&#x5DF1;&#x7684;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x6267;&#x884C;&#x4EFB;&#x4F55;&#x7C7B;&#x578B;&#x7684;&#x7F51;&#x7EDC;&#x626B;&#x63CF;&#xFF0C;&#x9664;&#x975E;&#x4F60;&#x5B8C;&#x5168;&#x719F;&#x6089;&#x60A8;&#x53D7;&#x5230;&#x4EFB;&#x4F55;&#x7BA1;&#x7406;&#x673A;&#x6784;&#x65BD;&#x52A0;&#x7684;&#x6CD5;&#x5F8B;&#x6CD5;&#x89C4;&#x3002;&#x5982;&#x679C;&#x4F60;&#x5E0C;&#x671B;&#x5728;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x6267;&#x884C;&#x6B64;&#x6280;&#x672F;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x54CD;&#x5E94; ICMP &#x8BF7;&#x6C42;&#x7684;&#x7CFB;&#x7EDF;&#x3002;&#x5728;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528; Linux &#x548C; Windows &#x7CFB;&#x7EDF;&#x7684;&#x7EC4;&#x5408;&#x3002;&#x6709;&#x5173;&#x5728;&#x672C;&#x5730;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x8BBE;&#x7F6E;&#x7CFB;&#x7EDF;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x4E2D;&#x7684;&#x201C;&#x5B89;&#x88C5; Metasploitable2&#x201D;&#x548C;&#x201C;&#x5B89;&#x88C5; Windows Server&#x201D;&#x79D8;&#x7C4D;&#x3002;</p>
<h3 id="&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;">&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;</h3>
<p><code>fping</code>&#x975E;&#x5E38;&#x7C7B;&#x4F3C;&#x4E8E;&#x6DFB;&#x52A0;&#x4E86;&#x4E00;&#x4E9B;&#x989D;&#x5916;&#x529F;&#x80FD;&#x7684;<code>ping</code>&#x5DE5;&#x5177;&#x3002; &#x5B83;&#x53EF;&#x4EE5;&#x4EE5;<code>ping</code>&#x7684;&#x76F8;&#x540C;&#x65B9;&#x5F0F;&#xFF0C;&#x5411;&#x5355;&#x4E2A;&#x76EE;&#x6807;&#x53D1;&#x9001; ICMP &#x56DE;&#x663E;&#x8BF7;&#x6C42;&#xFF0C;&#x4EE5;&#x786E;&#x5B9A;&#x5B83;&#x662F;&#x5426;&#x6D3B;&#x52A8;&#x3002; &#x8FD9;&#x901A;&#x8FC7;&#x5C06; IP &#x5730;&#x5740;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x7ED9;<code>fping</code>&#x5B9E;&#x7528;&#x7A0B;&#x5E8F;&#x6765;&#x5B8C;&#x6210;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# fping 172.16.36.135 
172.16.36.135 is alive
</code></pre><p>&#x4E0E;&#x6807;&#x51C6;<code>ping</code>&#x5DE5;&#x5177;&#x4E0D;&#x540C;&#xFF0C;<code>fping</code>&#x4F1A;&#x5728;&#x6536;&#x5230;&#x5355;&#x4E2A;&#x5E94;&#x7B54;&#x540E;&#x505C;&#x6B62;&#x53D1;&#x9001; ICMP &#x56DE;&#x663E;&#x8BF7;&#x6C42;&#x3002; &#x5728;&#x63A5;&#x6536;&#x5230;&#x56DE;&#x590D;&#x65F6;&#xFF0C;&#x5B83;&#x5C06;&#x663E;&#x793A;&#x5BF9;&#x5E94;&#x8BE5;&#x5730;&#x5740;&#x7684;&#x4E3B;&#x673A;&#x662F;&#x6D3B;&#x52A8;&#x7684;&#x3002; &#x6216;&#x8005;&#xFF0C;&#x5982;&#x679C;&#x672A;&#x4ECE;&#x5730;&#x5740;&#x63A5;&#x6536;&#x5230;&#x54CD;&#x5E94;&#xFF0C;&#x5219;&#x5728;&#x786E;&#x5B9A;&#x4E3B;&#x673A;&#x4E0D;&#x53EF;&#x8FBE;&#x4E4B;&#x524D;&#xFF0C;<code>fping</code>&#x901A;&#x5E38;&#x5C1D;&#x8BD5;&#x8054;&#x7CFB;&#x7CFB;&#x7EDF;&#x56DB;&#x6B21;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# fping 172.16.36.136 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.136 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.136 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.136 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 
172.16.36.136 172.16.36.136 is unreachable
</code></pre><p>&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>-c count</code>&#x9009;&#x9879;&#x4FEE;&#x6539;&#x6B64;&#x9ED8;&#x8BA4;&#x8FDE;&#x63A5;&#x5C1D;&#x8BD5;&#x6B21;&#x6570;&#xFF0C;&#x5E76;&#x5411;&#x5176;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x5B9A;&#x4E49;&#x5C1D;&#x8BD5;&#x6B21;&#x6570;&#x7684;&#x6574;&#x6570;&#x503C;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# fping 172.16.36.135 -c 1 
172.16.36.135 : [0], 84 bytes, 0.67 ms (0.67 avg, 0% loss)

172.16.36.135 : xmt/rcv/%loss = 1/1/0%, min/avg/max = 0.67/0.67/0.67 
root@KaliLinux:~# fping 172.16.36.136 -c 1

172.16.36.136 : xmt/rcv/%loss = 1/0/100%
</code></pre><p>&#x5F53;&#x4EE5;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x6267;&#x884C;&#x65F6;&#xFF0C;&#x8F93;&#x51FA;&#x66F4;&#x52A0;&#x9690;&#x853D;&#x4E00;&#x4E9B;&#xFF0C;&#x4F46;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4ED4;&#x7EC6;&#x5206;&#x6790;&#x6765;&#x7406;&#x89E3;&#x3002; &#x4EFB;&#x4F55;&#x4E3B;&#x673A;&#x7684;&#x8F93;&#x51FA;&#x5305;&#x62EC; IP &#x5730;&#x5740;&#xFF0C;&#x5C1D;&#x8BD5;&#x6B21;&#x6570;&#xFF08;<code>xmt</code>&#xFF09;&#xFF0C;&#x63A5;&#x6536;&#x7684;&#x56DE;&#x590D;&#x6570;&#xFF08;<code>rcv</code>&#xFF09;&#x548C;&#x4E22;&#x5931;&#x767E;&#x5206;&#x6BD4;&#xFF08;<code>%loss</code>&#xFF09;&#x3002; &#x5728;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;<code>fping</code>&#x53D1;&#x73B0;&#x7B2C;&#x4E00;&#x4E2A;&#x5730;&#x5740;&#x5904;&#x4E8E;&#x8054;&#x673A;&#x72B6;&#x6001;&#x3002; &#x8FD9;&#x53EF;&#x4EE5;&#x7531;&#x63A5;&#x6536;&#x7684;&#x5B57;&#x8282;&#x6570;&#x548C;&#x5E94;&#x7B54;&#x7684;&#x7B49;&#x5F85;&#x65F6;&#x95F4;&#x90FD;&#x88AB;&#x8FD4;&#x56DE;&#x7684;&#x4E8B;&#x5B9E;&#x6765;&#x8BC1;&#x660E;&#x3002; &#x4F60;&#x8FD8;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x68C0;&#x67E5;&#x767E;&#x5206;&#x6BD4;&#x635F;&#x5931;&#xFF0C;&#x6765;&#x8F7B;&#x677E;&#x786E;&#x5B9A;&#x662F;&#x5426;&#x5B58;&#x5728;&#x4E0E;&#x63D0;&#x4F9B;&#x7684; IP &#x5730;&#x5740;&#x5173;&#x8054;&#x7684;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x3002; &#x5982;&#x679C;&#x767E;&#x5206;&#x6BD4;&#x635F;&#x5931;&#x4E3A; 100&#xFF0C;&#x5219;&#x672A;&#x6536;&#x5230;&#x56DE;&#x590D;&#x3002;</p>
<p>&#x4E0E;<code>ping</code>&#xFF08;&#x6700;&#x5E38;&#x7528;&#x4F5C;&#x6545;&#x969C;&#x6392;&#x9664;&#x5DE5;&#x5177;&#xFF09;&#x4E0D;&#x540C;&#xFF0C;<code>fping</code>&#x5185;&#x5EFA;&#x4E86;&#x96C6;&#x6210;&#x529F;&#x80FD;&#xFF0C;&#x53EF;&#x626B;&#x63CF;&#x591A;&#x4E2A;&#x4E3B;&#x673A;&#x3002; &#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>fping</code>&#x626B;&#x63CF;&#x4E3B;&#x673A;&#x5E8F;&#x5217;&#xFF0C;&#x4F7F;&#x7528;<code>-g</code>&#x9009;&#x9879;&#x52A8;&#x6001;&#x751F;&#x6210; IP &#x5730;&#x5740;&#x5217;&#x8868;&#x3002; &#x8981;&#x6307;&#x5B9A;&#x626B;&#x63CF;&#x8303;&#x56F4;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;&#x8BE5;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x6240;&#x9700;&#x5E8F;&#x5217;&#x8303;&#x56F4;&#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x548C;&#x6700;&#x540E;&#x4E00;&#x4E2A; IP &#x5730;&#x5740;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# fping -g 172.16.36.1 172.16.36.4 
172.16.36.1 is alive 
172.16.36.2 is alive 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.3
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.3 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.3 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.3 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.4 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.4 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.4 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.4 172.16.36.3 is unreachable 
172.16.36.4 is unreachable
</code></pre><p>&#x751F;&#x6210;&#x5217;&#x8868;&#x9009;&#x9879;&#x4E5F;&#x53EF;&#x7528;&#x4E8E;&#x57FA;&#x4E8E; CIDR &#x8303;&#x56F4;&#x7B26;&#x53F7;&#x751F;&#x6210;&#x5217;&#x8868;&#x3002; &#x4EE5;&#x76F8;&#x540C;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;<code>fping</code>&#x5C06;&#x5FAA;&#x73AF;&#x904D;&#x5386;&#x8FD9;&#x4E2A;&#x52A8;&#x6001;&#x751F;&#x6210;&#x7684;&#x5217;&#x8868;&#x5E76;&#x626B;&#x63CF;&#x6BCF;&#x4E2A;&#x5730;&#x5740;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# fping -g 172.16.36.0/24 
172.16.36.1 is alive 
172.16.36.2 is alive 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.3 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.4 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.5 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.6 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.7 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.8 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.9 
                    *** {TRUNCATED} ***
</code></pre><p>&#x6700;&#x540E;&#xFF0C;<code>fping</code>&#x8FD8;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x626B;&#x63CF;&#x7531;&#x8F93;&#x5165;&#x6587;&#x672C;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#x6307;&#x5B9A;&#x7684;&#x4E00;&#x7CFB;&#x5217;&#x5730;&#x5740;&#x3002; &#x8981;&#x4F7F;&#x7528;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<code>-f</code>&#x6587;&#x4EF6;&#x9009;&#x9879;&#xFF0C;&#x7136;&#x540E;&#x63D0;&#x4F9B;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x6216;&#x8DEF;&#x5F84;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# fping -f iplist.txt 172.16.36.2 is alive 172.16.36.1 is alive 172.16.36.132 is alive 172.16.36.135 is alive 172.16.36.180 is alive 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.203 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.203 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.203 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.203 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.205 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.205 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.205 
ICMP Host Unreachable from 172.16.36.180 for ICMP Echo sent to 172.16.36.205 
172.16.36.203 is unreachable 
172.16.36.205 is unreachable 
172.16.36.254 is unreachable
</code></pre><h3 id="&#x5DE5;&#x4F5C;&#x539F;&#x7406;">&#x5DE5;&#x4F5C;&#x539F;&#x7406;</h3>
<p><code>fping</code>&#x5DE5;&#x5177;&#x6267;&#x884C;ICMP&#x53D1;&#x73B0;&#x7684;&#x65B9;&#x5F0F;&#x4E0E;&#x6211;&#x4EEC;&#x4E4B;&#x524D;&#x8BA8;&#x8BBA;&#x7684;&#x5176;&#x4ED6;&#x5DE5;&#x5177;&#x76F8;&#x540C;&#x3002; &#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A; IP &#x5730;&#x5740;&#xFF0C;<code>fping</code>&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A; ICMP &#x56DE;&#x663E;&#x8BF7;&#x6C42;&#xFF0C;&#x7136;&#x540E;&#x8BC4;&#x4F30;&#x6240;&#x63A5;&#x6536;&#x7684;&#x54CD;&#x5E94;&#x4EE5;&#x8BC6;&#x522B;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x3002; <code>fping</code>&#x8FD8;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x901A;&#x8FC7;&#x63D0;&#x4F9B;&#x9002;&#x5F53;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x6765;&#x626B;&#x63CF;&#x4E00;&#x7CFB;&#x5217;&#x7CFB;&#x7EDF;&#x6216; IP &#x5730;&#x5740;&#x7684;&#x8F93;&#x5165;&#x5217;&#x8868;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x4E0D;&#x5FC5;&#x4F7F;&#x7528;<code>bash</code>&#x811A;&#x672C;&#x6765;&#x64CD;&#x4F5C;&#x5DE5;&#x5177;&#xFF0C;&#x5C31;&#x50CF;&#x4F7F;&#x7528;<code>ping</code>&#x64CD;&#x4F5C;&#x4E00;&#x6837;&#xFF0C;&#x4F7F;&#x5176;&#x6210;&#x4E3A;&#x6709;&#x6548;&#x7684;&#x626B;&#x63CF;&#x5DE5;&#x5177;&#x3002;</p>
<h2 id="210-&#x4F7F;&#x7528;-hping3-&#x63A2;&#x7D22;&#x7B2C;&#x4E09;&#x5C42;">2.10 &#x4F7F;&#x7528; hping3 &#x63A2;&#x7D22;&#x7B2C;&#x4E09;&#x5C42;</h2>
<p><code>hping3</code>&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x4EE5;&#x591A;&#x79CD;&#x4E0D;&#x540C;&#x65B9;&#x5F0F;&#x6267;&#x884C;&#x4E3B;&#x673A;&#x53D1;&#x73B0;&#x7684;&#x66F4;&#x591A;&#x529F;&#x80FD;&#x3002; &#x5B83;&#x6BD4;<code>fping</code>&#x66F4;&#x5F3A;&#x5927;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x591A;&#x79CD;&#x4E0D;&#x540C;&#x7C7B;&#x578B;&#x7684;&#x53D1;&#x73B0;&#x6280;&#x672F;&#xFF0C;&#x4F46;&#x4F5C;&#x4E3A;&#x626B;&#x63CF;&#x5DE5;&#x5177;&#x4E0D;&#x592A;&#x6709;&#x7528;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x53EA;&#x80FD;&#x7528;&#x4E8E;&#x5B9A;&#x4F4D;&#x5355;&#x4E2A;&#x4E3B;&#x673A;&#x3002; &#x7136;&#x800C;&#xFF0C;&#x8FD9;&#x4E2A;&#x7F3A;&#x70B9;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; bash &#x811A;&#x672C;&#x514B;&#x670D;&#x3002; &#x8BE5;&#x79D8;&#x7C4D;&#x6F14;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x4F7F;&#x7528;<code>hping3</code>&#x5728;&#x8FDC;&#x7A0B;&#x4E3B;&#x673A;&#x4E0A;&#x6267;&#x884C;&#x7B2C;3&#x5C42;&#x53D1;&#x73B0;&#x3002;</p>
<h3 id="&#x51C6;&#x5907;">&#x51C6;&#x5907;</h3>
<p>&#x4F7F;&#x7528;<code>hping3</code>&#x6267;&#x884C;&#x7B2C;&#x4E09;&#x5C42;&#x53D1;&#x73B0;&#x4E0D;&#x9700;&#x8981;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#xFF0C;&#x56E0;&#x4E3A; Internet &#x4E0A;&#x7684;&#x8BB8;&#x591A;&#x7CFB;&#x7EDF;&#x90FD;&#x5C06;&#x56DE;&#x590D; ICMP &#x56DE;&#x663E;&#x8BF7;&#x6C42;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5F3A;&#x70C8;&#x5EFA;&#x8BAE;&#x4F60;&#x53EA;&#x5728;&#x60A8;&#x81EA;&#x5DF1;&#x7684;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x6267;&#x884C;&#x4EFB;&#x4F55;&#x7C7B;&#x578B;&#x7684;&#x7F51;&#x7EDC;&#x626B;&#x63CF;&#xFF0C;&#x9664;&#x975E;&#x4F60;&#x5B8C;&#x5168;&#x719F;&#x6089;&#x60A8;&#x53D7;&#x5230;&#x4EFB;&#x4F55;&#x7BA1;&#x7406;&#x673A;&#x6784;&#x65BD;&#x52A0;&#x7684;&#x6CD5;&#x5F8B;&#x6CD5;&#x89C4;&#x3002;&#x5982;&#x679C;&#x4F60;&#x5E0C;&#x671B;&#x5728;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x6267;&#x884C;&#x6B64;&#x6280;&#x672F;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x54CD;&#x5E94; ICMP &#x8BF7;&#x6C42;&#x7684;&#x7CFB;&#x7EDF;&#x3002;&#x5728;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528; Linux &#x548C; Windows &#x7CFB;&#x7EDF;&#x7684;&#x7EC4;&#x5408;&#x3002;&#x6709;&#x5173;&#x5728;&#x672C;&#x5730;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x8BBE;&#x7F6E;&#x7CFB;&#x7EDF;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x4E2D;&#x7684;&#x201C;&#x5B89;&#x88C5; Metasploitable2&#x201D;&#x548C;&#x201C;&#x5B89;&#x88C5; Windows Server&#x201D;&#x79D8;&#x7C4D;&#x3002;</p>
<p><code>hping3</code>&#x662F;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x5F3A;&#x5927;&#x7684;&#x53D1;&#x73B0;&#x5DE5;&#x5177;&#xFF0C;&#x5177;&#x6709;&#x5927;&#x91CF;&#x53EF;&#x64CD;&#x4F5C;&#x7684;&#x9009;&#x9879;&#x548C;&#x6A21;&#x5F0F;&#x3002;&#x5B83;&#x80FD;&#x591F;&#x5728;&#x7B2C;3&#x5C42;&#x548C;&#x7B2C;4&#x5C42;&#x4E0A;&#x6267;&#x884C;&#x53D1;&#x73B0;&#x3002;&#x4E3A;&#x4E86;&#x4F7F;&#x7528;<code>hping3</code>&#x5BF9;&#x5355;&#x4E2A;&#x4E3B;&#x673A;&#x5730;&#x5740;&#x6267;&#x884C;&#x57FA;&#x672C;&#x7684; ICMP &#x53D1;&#x73B0;&#xFF0C; &#x53EA;&#x9700;&#x8981;&#x5C06;&#x8981;&#x6D4B;&#x8BD5;&#x7684; IP &#x5730;&#x5740;&#x548C;&#x6240;&#x9700;&#x7684; ICMP &#x626B;&#x63CF;&#x6A21;&#x5F0F;&#x4F20;&#x9012;&#x7ED9;&#x5B83;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# hping3 172.16.36.1 --icmp 
HPING 172.16.36.1 (eth1 172.16.36.1): icmp mode set, 28 headers + 0 data bytes 
len=46 ip=172.16.36.1 ttl=64 id=41835 icmp_seq=0 rtt=0.3 ms 
len=46 ip=172.16.36.1 ttl=64 id=5039 icmp_seq=1 rtt=0.3 ms 
len=46 ip=172.16.36.1 ttl=64 id=54056 icmp_seq=2 rtt=0.6 ms 
len=46 ip=172.16.36.1 ttl=64 id=50519 icmp_seq=3 rtt=0.5 ms 
len=46 ip=172.16.36.1 ttl=64 id=47642 icmp_seq=4 rtt=0.4 ms 
^C 
--- 172.16.36.1 hping statistic --5 packets transmitted, 
5 packets received, 0% packet loss 
round-trip min/avg/max = 0.3/0.4/0.6 ms
</code></pre><p>&#x63D0;&#x4F9B;&#x7684;&#x6F14;&#x793A;&#x4F7F;&#x7528;<code>Ctrl + C</code>&#x505C;&#x6B62;&#x8FDB;&#x7A0B;&#x3002;&#x4E0E;&#x6807;&#x51C6;<code>ping</code>&#x5DE5;&#x5177;&#x7C7B;&#x4F3C;&#xFF0C;<code>hping3</code> ICMP &#x6A21;&#x5F0F;&#x5C06;&#x65E0;&#x9650;&#x7EE7;&#x7EED;&#xFF0C;&#x9664;&#x975E;&#x5728;&#x521D;&#x59CB;&#x547D;&#x4EE4;&#x4E2D;&#x6307;&#x5B9A;&#x4E86;&#x7279;&#x5B9A;&#x6570;&#x91CF;&#x7684;&#x6570;&#x636E;&#x5305;&#x3002; &#x4E3A;&#x4E86;&#x5B9A;&#x4E49;&#x8981;&#x53D1;&#x9001;&#x7684;&#x5C1D;&#x8BD5;&#x6B21;&#x6570;&#xFF0C;&#x5E94;&#x5305;&#x542B;<code>-c</code>&#x9009;&#x9879;&#x548C;&#x4E00;&#x4E2A;&#x8868;&#x793A;&#x6240;&#x9700;&#x5C1D;&#x8BD5;&#x6B21;&#x6570;&#x7684;&#x6574;&#x6570;&#x503C;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# hping3 172.16.36.1 --icmp -c 2 
HPING 172.16.36.1 (eth1 172.16.36.1): icmp mode set, 28 headers + 0 data bytes 
len=46 ip=172.16.36.1 ttl=64 id=40746 icmp_seq=0 rtt=0.3 ms 
len=46 ip=172.16.36.1 ttl=64 id=12231 icmp_seq=1 rtt=0.5 ms
--- 
172.16.36.1 hping statistic --
2 packets transmitted, 2 packets received, 0% packet loss 
round-trip min/avg/max = 0.3/0.4/0.5 ms
</code></pre><p>&#x867D;&#x7136;<code>hping3</code>&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x4E0D;&#x652F;&#x6301;&#x626B;&#x63CF;&#x591A;&#x4E2A;&#x7CFB;&#x7EDF;&#xFF0C;&#x4F46;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; bash &#x811A;&#x672C;&#x8F7B;&#x6613;&#x7F16;&#x5199;&#x811A;&#x672C;&#x3002; &#x4E3A;&#x4E86;&#x505A;&#x5230;&#x8FD9;&#x4E00;&#x70B9;&#xFF0C;&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x9996;&#x5148;&#x786E;&#x5B9A;&#x4E0E;&#x6D3B;&#x52A8;&#x5730;&#x5740;&#x76F8;&#x5173;&#x8054;&#x7684;&#x8F93;&#x51FA;&#xFF0C;&#x4EE5;&#x53CA;&#x4E0E;&#x975E;&#x54CD;&#x5E94;&#x5730;&#x5740;&#x76F8;&#x5173;&#x8054;&#x7684;&#x8F93;&#x51FA;&#x4E4B;&#x95F4;&#x7684;&#x533A;&#x522B;&#x3002; &#x4E3A;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x5728;&#x672A;&#x5206;&#x914D;&#x4E3B;&#x673A;&#x7684; IP &#x5730;&#x5740;&#x4E0A;&#x4F7F;&#x7528;&#x76F8;&#x540C;&#x7684;&#x547D;&#x4EE4;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# hping3 172.16.36.4 --icmp -c 2 
HPING 172.16.36.4 (eth1 172.16.36.4): icmp mode set, 28 headers + 0 data bytes
--- 
172.16.36.4 hping statistic --
2 packets transmitted, 0 packets received, 100% packet loss 
round-trip min/avg/max = 0.0/0.0/0.0 ms 
1 packets transmitted, 1 packets received, 0% packet loss 
round-trip min/avg/max = 0.2/0.2/0.2 ms
--- 172.16.36.4 hping statistic --
1 packets transmitted, 0 packets received, 100% packet loss 
round-trip min/avg/max = 0.0/0.0/0.0 ms
</code></pre><p>&#x5C3D;&#x7BA1;&#x4EA7;&#x751F;&#x4E86;&#x671F;&#x671B;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;<code>grep</code>&#x51FD;&#x6570;&#x4F3C;&#x4E4E;&#x4E0D;&#x80FD;&#x6709;&#x6548;&#x7528;&#x4E8E;&#x8F93;&#x51FA;&#x3002; &#x7531;&#x4E8E;<code>hping3</code>&#x4E2D;&#x7684;&#x8F93;&#x51FA;&#x663E;&#x793A;&#x5904;&#x7406;&#xFF0C;&#x5B83;&#x96BE;&#x4EE5;&#x901A;&#x8FC7;&#x7BA1;&#x9053;&#x4F20;&#x9012;&#x5230;<code>grep</code>&#x51FD;&#x6570;&#xFF0C;&#x5E76;&#x53EA;&#x63D0;&#x53D6;&#x6240;&#x9700;&#x7684;&#x884C;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x901A;&#x8FC7;&#x5176;&#x4ED6;&#x65B9;&#x5F0F;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x3002; &#x5177;&#x4F53;&#x6765;&#x8BF4;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x5C1D;&#x8BD5;&#x786E;&#x5B9A;&#x8F93;&#x51FA;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4ECE;&#x6587;&#x4EF6;&#x4E2D;<code>grep</code>&#x3002; &#x4E3A;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x5C1D;&#x8BD5;&#x5C06;&#x5148;&#x524D;&#x4F7F;&#x7528;&#x7684;&#x4E24;&#x4E2A;&#x547D;&#x4EE4;&#x7684;&#x8F93;&#x51FA;&#x4F20;&#x9012;&#x7ED9;<code>handle.txt</code>&#x6587;&#x4EF6;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# hping3 172.16.36.1 --icmp -c 1 &gt;&gt; handle.txt

--- 172.16.36.1 hping statistic --
1 packets transmitted, 1 packets received, 0% packet loss 
round-trip min/avg/max = 0.4/0.4/0.4 ms 
root@KaliLinux:~# hping3 172.16.36.4 --icmp -c 1 &gt;&gt; handle.txt

--- 172.16.36.4 hping statistic --
1 packets transmitted, 0 packets received, 100% packet loss 
round-trip min/avg/max = 0.0/0.0/0.0 ms 
root@KaliLinux:~# cat handle.txt 
HPING 172.16.36.1 (eth1 172.16.36.1): icmp mode set, 28 headers + 0 data bytes 
len=46 ip=172.16.36.1 ttl=64 id=56022 icmp_seq=0 rtt=0.4 ms 
HPING 172.16.36.4 (eth1 172.16.36.4): icmp mode set, 28 headers + 0 data bytes
</code></pre><p>&#x867D;&#x7136;&#x8FD9;&#x79CD;&#x5C1D;&#x8BD5;&#x5E76;&#x4E0D;&#x5B8C;&#x5168;&#x6210;&#x529F;&#xFF0C;&#x56E0;&#x4E3A;&#x8F93;&#x51FA;&#x6CA1;&#x6709;&#x5B8C;&#x5168;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x6587;&#x4EF6;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x901A;&#x8FC7;&#x8BFB;&#x53D6;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x8F93;&#x51FA;&#xFF0C;&#x8DB3;&#x4EE5;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6709;&#x6548;&#x7684;&#x811A;&#x672C;&#x3002; &#x5177;&#x4F53;&#x6765;&#x8BF4;&#xFF0C;&#x6211;&#x4EEC;&#x80FD;&#x591F;&#x91CD;&#x5B9A;&#x5411;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x7684;&#x884C;&#xFF0C;&#x8BE5;&#x884C;&#x53EA;&#x4E0E;&#x6210;&#x529F;&#x7684;<code>ping</code>&#x5C1D;&#x8BD5;&#x76F8;&#x5173;&#x8054;&#xFF0C;&#x5E76;&#x4E14;&#x5305;&#x542B;&#x8BE5;&#x884C;&#x4E2D;&#x76F8;&#x5E94;&#x7684; IP &#x5730;&#x5740;&#x3002; &#x8981;&#x9A8C;&#x8BC1;&#x6B64;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#x662F;&#x5426;&#x53EF;&#x884C;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5C1D;&#x8BD5;&#x5FAA;&#x73AF;&#x8BBF;&#x95EE;<code>/ 24</code>&#x8303;&#x56F4;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x5730;&#x5740;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x7ED3;&#x679C;&#x4F20;&#x9012;&#x5230;<code>handle.txt</code>&#x6587;&#x4EF6;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# for addr in $(seq 1 254); do hping3 172.16.36.$addr --icmp -c 1 &gt;&gt; handle.txt &amp; done

--- 172.16.36.2 hping statistic --
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 6.6/6.6/6.6 ms

--- 172.16.36.1 hping statistic --
1 packets transmitted, 1 packets received, 0% packet loss 
round-trip min/avg/max = 55.2/55.2/55.2 ms

--- 172.16.36.8 hping statistic --
1 packets transmitted, 0 packets received, 100% packet loss 
round-trip min/avg/max = 0.0/0.0/0.0 ms 
                    *** {TRUNCATED} ***
</code></pre><p>&#x901A;&#x8FC7;&#x8FD9;&#x6837;&#x505A;&#xFF0C;&#x4ECD;&#x7136;&#x6709;&#x5927;&#x91CF;&#x7684;&#x8F93;&#x51FA;&#xFF08;&#x63D0;&#x4F9B;&#x7684;&#x8F93;&#x51FA;&#x4E3A;&#x4E86;&#x65B9;&#x4FBF;&#x800C;&#x88AB;&#x622A;&#x65AD;&#xFF09;&#x5305;&#x542B;&#x672A;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x6587;&#x4EF6;&#x7684;&#x8F93;&#x51FA;&#x3002; &#x4F46;&#x662F;&#xFF0C;&#x4EE5;&#x4E0B;&#x811A;&#x672C;&#x7684;&#x6210;&#x529F;&#x4E0D;&#x53D6;&#x51B3;&#x4E8E;&#x521D;&#x59CB;&#x5FAA;&#x73AF;&#x7684;&#x8FC7;&#x591A;&#x8F93;&#x51FA;&#xFF0C;&#x800C;&#x662F;&#x53D6;&#x51B3;&#x4E8E;&#x4ECE;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x4E2D;&#x63D0;&#x53D6;&#x5FC5;&#x8981;&#x4FE1;&#x606F;&#x7684;&#x80FD;&#x529B;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ls 
Desktop  handle.txt  pinger.sh 
root@KaliLinux:~# grep len handle.txt 
len=46 ip=172.16.36.2 ttl=128 id=7537 icmp_seq=0 rtt=6.6 ms 
len=46 ip=172.16.36.1 ttl=64 id=56312 icmp_seq=0 rtt=55.2 ms 
len=46 ip=172.16.36.132 ttl=64 id=47801 icmp_seq=0 rtt=27.3 ms 
len=46 ip=172.16.36.135 ttl=64 id=62601 icmp_seq=0 rtt=77.9 ms
root@KaliLinux:~# grep len handle.txt | cut -d &quot; &quot; -f 2 
ip=172.16.36.2 
ip=172.16.36.1 
ip=172.16.36.132 
ip=172.16.36.135
root@KaliLinux:~# grep len handle.txt | cut -d &quot; &quot; -f 2 | cut -d &quot;=&quot; -f 2 
172.16.36.2 
172.16.36.1 
172.16.36.132
172.16.36.135
</code></pre><p>&#x901A;&#x8FC7;&#x5C06;&#x8F93;&#x51FA;&#x4F7F;&#x7528;&#x7BA1;&#x9053;&#x8FDE;&#x63A5;&#x5230;&#x4E00;&#x7CFB;&#x5217;<code>cut</code>&#x51FD;&#x6570;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4ECE;&#x8F93;&#x51FA;&#x4E2D;&#x63D0;&#x53D6; IP &#x5730;&#x5740;&#x3002; &#x73B0;&#x5728;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x6210;&#x529F;&#x5730;&#x786E;&#x5B9A;&#x4E86;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#xFF0C;&#x6765;&#x626B;&#x63CF;&#x591A;&#x4E2A;&#x4E3B;&#x673A;&#x5E76;&#x8F7B;&#x6613;&#x8BC6;&#x522B;&#x7ED3;&#x679C;&#xFF0C;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x5C06;&#x5176;&#x96C6;&#x6210;&#x5230;&#x4E00;&#x4E2A;&#x811A;&#x672C;&#x4E2D;&#x3002; &#x5C06;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;&#x7EC4;&#x5408;&#x5728;&#x4E00;&#x8D77;&#x7684;&#x529F;&#x80FD;&#x811A;&#x672C;&#x7684;&#x793A;&#x4F8B;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-sh"><span class="hljs-meta">#!/bin/bash
</span>
<span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$#</span>&quot;</span> <span class="hljs-_">-ne</span> 1 ]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Usage - ./ping_sweep.sh [/24 network address]&quot;</span> 
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Example - ./ping_sweep.sh 172.16.36.0&quot;</span> 
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Example will perform an ICMP ping sweep of the 172.16.36.0/24 network and output to an output.txt file&quot;</span> 
    <span class="hljs-built_in">exit</span> 
<span class="hljs-keyword">fi</span>

prefix=$(<span class="hljs-built_in">echo</span> <span class="hljs-variable">$1</span> | cut <span class="hljs-_">-d</span> <span class="hljs-string">&apos;.&apos;</span> <span class="hljs-_">-f</span> 1-3)

<span class="hljs-keyword">for</span> addr <span class="hljs-keyword">in</span> $(seq 1 254); <span class="hljs-keyword">do</span> 
    hping3 <span class="hljs-variable">$prefix</span>.<span class="hljs-variable">$addr</span> --icmp -c 1 &gt;&gt; handle.txt; 
<span class="hljs-keyword">done</span>

grep len handle.txt | cut <span class="hljs-_">-d</span> <span class="hljs-string">&quot; &quot;</span> <span class="hljs-_">-f</span> 2 | cut <span class="hljs-_">-d</span> <span class="hljs-string">&quot;=&quot;</span> <span class="hljs-_">-f</span> 2 &gt;&gt; output.txt 
rm handle.txt
</code></pre>
<p>&#x5728;&#x63D0;&#x4F9B;&#x7684; bash &#x811A;&#x672C;&#x4E2D;&#xFF0C;&#x7B2C;&#x4E00;&#x884C;&#x5B9A;&#x4E49;&#x4E86; bash &#x89E3;&#x91CA;&#x5668;&#x7684;&#x4F4D;&#x7F6E;&#x3002; &#x63A5;&#x4E0B;&#x6765;&#x7684;&#x4EE3;&#x7801;&#x5757;&#x6267;&#x884C;&#x6D4B;&#x8BD5;&#x6765;&#x786E;&#x5B9A;&#x662F;&#x5426;&#x63D0;&#x4F9B;&#x4E86;&#x9884;&#x671F;&#x7684;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x3002; &#x8FD9;&#x901A;&#x8FC7;&#x8BC4;&#x4F30;&#x63D0;&#x4F9B;&#x7684;&#x53C2;&#x6570;&#x7684;&#x6570;&#x91CF;&#x662F;&#x5426;&#x4E0D;&#x7B49;&#x4E8E; 1 &#x6765;&#x786E;&#x5B9A;&#x3002;&#x5982;&#x679C;&#x672A;&#x63D0;&#x4F9B;&#x9884;&#x671F;&#x53C2;&#x6570;&#xFF0C;&#x5219;&#x8F93;&#x51FA;&#x811A;&#x672C;&#x7684;&#x7528;&#x6CD5;&#xFF0C;&#x5E76;&#x4E14;&#x9000;&#x51FA;&#x811A;&#x672C;&#x3002; &#x7528;&#x6CD5;&#x8F93;&#x51FA;&#x8868;&#x660E;&#xFF0C;&#x811A;&#x672C;&#x9700;&#x8981;&#x63A5;&#x53D7;<code>/ 24</code>&#x7F51;&#x7EDC;&#x5730;&#x5740;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x3002; &#x4E0B;&#x4E00;&#x884C;&#x4EE3;&#x7801;&#x4ECE;&#x63D0;&#x4F9B;&#x7684;&#x7F51;&#x7EDC;&#x5730;&#x5740;&#x4E2D;&#x63D0;&#x53D6;&#x7F51;&#x7EDC;&#x524D;&#x7F00;&#x3002; &#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x63D0;&#x4F9B;&#x7684;&#x7F51;&#x7EDC;&#x5730;&#x5740;&#x662F;<code>192.168.11.0</code>&#xFF0C;&#x5219;&#x524D;&#x7F00;&#x53D8;&#x91CF;&#x5C06;&#x88AB;&#x8D4B;&#x503C;&#x4E3A;<code>192.168.11</code>&#x3002; &#x7136;&#x540E;&#x5BF9;<code>/ 24</code>&#x8303;&#x56F4;&#x5185;&#x7684;&#x6BCF;&#x4E2A;&#x5730;&#x5740;&#x6267;&#x884C;<code>hping3</code>&#x64CD;&#x4F5C;&#xFF0C;&#x5E76;&#x5C06;&#x6BCF;&#x4E2A;&#x4EFB;&#x52A1;&#x7684;&#x7ED3;&#x679C;&#x8F93;&#x51FA;&#x653E;&#x5165;<code>handle.txt</code>&#x6587;&#x4EF6;&#x4E2D;&#x3002;</p>
<p>&#x4E00;&#x65E6;&#x5B8C;&#x6210;&#xFF0C;<code>grep</code>&#x7528;&#x4E8E;&#x4ECE;<code>handle</code>&#x6587;&#x4EF6;&#x4E2D;&#x63D0;&#x53D6;&#x4E0E;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x54CD;&#x5E94;&#x76F8;&#x5173;&#x8054;&#x7684;&#x884C;&#xFF0C;&#x7136;&#x540E;&#x4ECE;&#x8FD9;&#x4E9B;&#x884C;&#x4E2D;&#x63D0;&#x53D6; IP &#x5730;&#x5740;&#x3002; &#x7136;&#x540E;&#x5C06;&#x751F;&#x6210;&#x7684; IP &#x5730;&#x5740;&#x4F20;&#x9012;&#x5230;<code>output.txt</code>&#x6587;&#x4EF6;&#xFF0C;&#x5E76;&#x4ECE;&#x76EE;&#x5F55;&#x4E2D;&#x5220;&#x9664;<code>handle.txt</code>&#x4E34;&#x65F6;&#x6587;&#x4EF6;&#x3002; &#x6B64;&#x811A;&#x672C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x53E5;&#x53F7;&#x548C;&#x659C;&#x6760;&#xFF0C;&#x540E;&#x8DDF;&#x53EF;&#x6267;&#x884C;&#x811A;&#x672C;&#x7684;&#x540D;&#x79F0;&#x6267;&#x884C;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ./ping_sweep.sh 
Usage - ./ping_sweep.sh [/24 network address] 
Example - ./ping_sweep.sh 172.16.36.0 
Example will perform an ICMP ping sweep of the 172.16.36.0/24 network and output to an output.txt file 
root@KaliLinux:~# ./ping_sweep.sh 172.16.36.0
--- 172.16.36.1 hping statistic --
1 packets transmitted, 1 packets received, 0% packet loss 
round-trip min/avg/max = 0.4/0.4/0.4 ms
--- 172.16.36.2 hping statistic --
1 packets transmitted, 1 packets received, 0% packet loss 
round-trip min/avg/max = 0.5/0.5/0.5 ms
--- 172.16.36.3 hping statistic --
1 packets transmitted, 0 packets received, 100% packet loss 
round-trip min/avg/max = 0.0/0.0/0.0 ms
                        *** {TRUNCATED} ***
</code></pre><p>&#x4E00;&#x65E6;&#x5B8C;&#x6210;&#xFF0C;&#x811A;&#x672C;&#x5E94;&#x8BE5;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;<code>output.txt</code>&#x6587;&#x4EF6;&#x5230;&#x6267;&#x884C;&#x76EE;&#x5F55;&#x3002; &#x8FD9;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>ls</code>&#x9A8C;&#x8BC1;&#xFF0C;&#x5E76;&#x4E14;<code>cat</code>&#x547D;&#x4EE4;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x67E5;&#x770B;&#x6B64;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ls output.txt 
output.txt 
root@KaliLinux:~# cat output.txt 
172.16.36.1 
172.16.36.2 
172.16.36.132 
172.16.36.135 
172.16.36.253
</code></pre><p>&#x5F53;&#x811A;&#x672C;&#x8FD0;&#x884C;&#x65F6;&#xFF0C;&#x4F60;&#x4ECD;&#x7136;&#x4F1A;&#x770B;&#x5230;&#x5728;&#x521D;&#x59CB;&#x5FAA;&#x73AF;&#x4EFB;&#x52A1;&#x65F6;&#x770B;&#x5230;&#x7684;&#x5927;&#x91CF;&#x8F93;&#x51FA;&#x3002; &#x5E78;&#x8FD0;&#x7684;&#x662F;&#xFF0C;&#x4F60;&#x53D1;&#x73B0;&#x7684;&#x4E3B;&#x673A;&#x5217;&#x8868;&#x4E0D;&#x4F1A;&#x5728;&#x6B64;&#x8F93;&#x51FA;&#x4E2D;&#x6D88;&#x5931;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x6BCF;&#x6B21;&#x90FD;&#x4F1A;&#x5199;&#x5165;&#x4F60;&#x7684;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x3002;</p>
<h3 id="&#x5DE5;&#x4F5C;&#x539F;&#x7406;">&#x5DE5;&#x4F5C;&#x539F;&#x7406;</h3>
<p>&#x6211;&#x4EEC;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x4E00;&#x4E9B;&#x8C03;&#x6574;&#xFF0C;&#x624D;&#x80FD;&#x4F7F;&#x7528;<code>hping3</code>&#x5BF9;&#x591A;&#x4E2A;&#x4E3B;&#x673A;&#x6216;&#x5730;&#x5740;&#x8303;&#x56F4;&#x6267;&#x884C;&#x4E3B;&#x673A;&#x53D1;&#x73B0;&#x3002; &#x63D0;&#x4F9B;&#x7684;&#x79D8;&#x7C4D;&#x4F7F;&#x7528; bash &#x811A;&#x672C;&#x987A;&#x5E8F;&#x6267;&#x884C; ICMP &#x56DE;&#x5E94;&#x8BF7;&#x6C42;&#x3002; &#x8FD9;&#x662F;&#x53EF;&#x6027;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x6210;&#x529F;&#x548C;&#x4E0D;&#x6210;&#x529F;&#x7684;&#x8BF7;&#x6C42;&#x80FD;&#x591F;&#x751F;&#x6210;&#x552F;&#x4E00;&#x54CD;&#x5E94;&#x3002; &#x901A;&#x8FC7;&#x5C06;&#x51FD;&#x6570;&#x4F20;&#x9012;&#x7ED9;&#x4E00;&#x4E2A;&#x5FAA;&#x73AF;&#xFF0C;&#x5E76;&#x5C06;&#x552F;&#x4E00;&#x54CD;&#x5E94;&#x4F20;&#x9012;&#x7ED9;<code>grep</code>&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x9AD8;&#x6548;&#x5F00;&#x53D1;&#x51FA;&#x4E00;&#x4E2A;&#x811A;&#x672C;&#xFF0C;&#x5BF9;&#x591A;&#x4E2A;&#x7CFB;&#x7EDF;&#x4F9D;&#x6B21;&#x6267;&#x884C; ICMP &#x53D1;&#x73B0;&#xFF0C;&#x7136;&#x540E;&#x8F93;&#x51FA;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x5217;&#x8868;&#x3002;</p>
<h2 id="211-&#x4F7F;&#x7528;-scapy-&#x63A2;&#x7D22;&#x7B2C;&#x56DB;&#x5C42;">2.11 &#x4F7F;&#x7528; Scapy &#x63A2;&#x7D22;&#x7B2C;&#x56DB;&#x5C42;</h2>
<p>&#x591A;&#x79CD;&#x4E0D;&#x540C;&#x65B9;&#x5F0F;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x5728;&#x7B2C;&#x56DB;&#x5C42;&#x6267;&#x884C;&#x76EE;&#x6807;&#x53D1;&#x73B0;&#x3002;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7528;&#x6237;&#x6570;&#x636E;&#x62A5;&#x534F;&#x8BAE;&#xFF08;UDP&#xFF09;&#x6216;&#x4F20;&#x8F93;&#x63A7;&#x5236;&#x534F;&#x8BAE;&#xFF08;TCP&#xFF09;&#x6765;&#x6267;&#x884C;&#x626B;&#x63CF;&#x3002; Scapy &#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x4F7F;&#x7528;&#x8FD9;&#x4E24;&#x79CD;&#x4F20;&#x8F93;&#x534F;&#x8BAE;&#x6765;&#x5236;&#x4F5C;&#x81EA;&#x5B9A;&#x4E49;&#x8BF7;&#x6C42;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x4E0E; Python &#x811A;&#x672C;&#x7ED3;&#x5408;&#x4F7F;&#x7528;&#x4EE5;&#x5F00;&#x53D1;&#x5B9E;&#x7528;&#x7684;&#x53D1;&#x73B0;&#x5DE5;&#x5177;&#x3002; &#x6B64;&#x79D8;&#x7C4D;&#x6F14;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x4F7F;&#x7528; Scapy &#x6267;&#x884C; TCP &#x548C; UDP &#x7684;&#x7B2C;&#x56DB;&#x5C42;&#x53D1;&#x73B0;&#x3002;</p>
<h3 id="&#x51C6;&#x5907;">&#x51C6;&#x5907;</h3>
<p>&#x4F7F;&#x7528; Scapy &#x6267;&#x884C;&#x7B2C;&#x56DB;&#x5C42;&#x53D1;&#x73B0;&#x4E0D;&#x9700;&#x8981;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#xFF0C;&#x56E0;&#x4E3A; Internet &#x4E0A;&#x7684;&#x8BB8;&#x591A;&#x7CFB;&#x7EDF;&#x90FD;&#x5C06;&#x56DE;&#x590D; TCP &#x548C; UDP &#x8BF7;&#x6C42;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5F3A;&#x70C8;&#x5EFA;&#x8BAE;&#x4F60;&#x53EA;&#x5728;&#x60A8;&#x81EA;&#x5DF1;&#x7684;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x6267;&#x884C;&#x4EFB;&#x4F55;&#x7C7B;&#x578B;&#x7684;&#x7F51;&#x7EDC;&#x626B;&#x63CF;&#xFF0C;&#x9664;&#x975E;&#x4F60;&#x5B8C;&#x5168;&#x719F;&#x6089;&#x60A8;&#x53D7;&#x5230;&#x4EFB;&#x4F55;&#x7BA1;&#x7406;&#x673A;&#x6784;&#x65BD;&#x52A0;&#x7684;&#x6CD5;&#x5F8B;&#x6CD5;&#x89C4;&#x3002;&#x5982;&#x679C;&#x4F60;&#x5E0C;&#x671B;&#x5728;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x6267;&#x884C;&#x6B64;&#x6280;&#x672F;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x54CD;&#x5E94; TCP/UDP &#x8BF7;&#x6C42;&#x7684;&#x7CFB;&#x7EDF;&#x3002;&#x5728;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528; Linux &#x548C; Windows &#x7CFB;&#x7EDF;&#x7684;&#x7EC4;&#x5408;&#x3002;&#x6709;&#x5173;&#x5728;&#x672C;&#x5730;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x8BBE;&#x7F6E;&#x7CFB;&#x7EDF;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x4E2D;&#x7684;&#x201C;&#x5B89;&#x88C5; Metasploitable2&#x201D;&#x548C;&#x201C;&#x5B89;&#x88C5; Windows Server&#x201D;&#x79D8;&#x7C4D;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x672C;&#x8282;&#x8FD8;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#xFF08;&#x5982; VIM &#x6216; Nano&#xFF09;&#x5C06;&#x811A;&#x672C;&#x5199;&#x5165;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3002;&#x6709;&#x5173;&#x7F16;&#x5199;&#x811A;&#x672C;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x4E2D;&#x7684;&#x201C;&#x4F7F;&#x7528;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#xFF08;VIM &#x548C; Nano&#xFF09;&#x201D;&#x79D8;&#x7C4D;&#x3002;</p>
<h3 id="&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;">&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;</h3>
<p>&#x4E3A;&#x4E86;&#x9A8C;&#x8BC1;&#x4ECE;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x63A5;&#x6536;&#x5230;&#x7684; RST &#x54CD;&#x5E94;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; Scapy &#x5411;&#x5DF2;&#x77E5;&#x7684;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x53D1;&#x9001; TCP ACK &#x6570;&#x636E;&#x5305;&#x3002; &#x5728;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;ACK &#x6570;&#x636E;&#x5305;&#x5C06;&#x53D1;&#x9001;&#x5230; TCP &#x76EE;&#x6807;&#x7AEF;&#x53E3; 80&#x3002;&#x6B64;&#x7AEF;&#x53E3;&#x901A;&#x5E38;&#x7528;&#x4E8E;&#x8FD0;&#x884C; HTTP Web &#x670D;&#x52A1;&#x3002; &#x6F14;&#x793A;&#x4E2D;&#x4F7F;&#x7528;&#x7684;&#x4E3B;&#x673A;&#x5F53;&#x524D;&#x62E5;&#x6709;&#x5728;&#x6B64;&#x7AEF;&#x53E3;&#x4E0A;&#x8FD0;&#x884C;&#x7684; Apache &#x670D;&#x52A1;&#x3002; &#x4E3A;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x6784;&#x5EFA;&#x6211;&#x4EEC;&#x7684;&#x8BF7;&#x6C42;&#x7684;&#x6BCF;&#x4E2A;&#x5C42;&#x7EA7;&#x3002; &#x8981;&#x6784;&#x5EFA;&#x7684;&#x7B2C;&#x4E00;&#x5C42;&#x662F;IP&#x5C42;&#x3002; &#x770B;&#x770B;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# scapy Welcome to Scapy (2.2.0) 
&gt;&gt;&gt; i = IP() 
&gt;&gt;&gt; i.display() 
###[ IP ]###
  version= 4
  ihl= None
  tos= 0x0
  len= None
  id= 1
  flags=
  frag= 0
  ttl= 64
  proto= ip
  chksum= None
  src= 127.0.0.1
  dst= 127.0.0.1
  \options\ 
&gt;&gt;&gt; i.dst=&quot;172.16.36.135&quot; 
&gt;&gt;&gt; i.display() 
###[ IP ]###
  version= 4
  ihl= None
  tos= 0x0
  len= None
  id= 1
  flags=
  frag= 0
  ttl= 64
  proto= ip
  chksum= None
  src= 172.16.36.180
  dst= 172.16.36.135
  \options\
</code></pre><p>&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;<code>i</code>&#x53D8;&#x91CF;&#x521D;&#x59CB;&#x5316;&#x4E3A;<code>IP</code>&#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x540E;&#x91CD;&#x65B0;&#x914D;&#x7F6E;&#x6807;&#x51C6;&#x914D;&#x7F6E;&#xFF0C;&#x5C06;&#x76EE;&#x6807;&#x5730;&#x5740;&#x8BBE;&#x7F6E;&#x4E3A;&#x76EE;&#x6807;&#x670D;&#x52A1;&#x5668;&#x7684; IP &#x5730;&#x5740;&#x3002; &#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5F53;&#x4E3A;&#x76EE;&#x6807;&#x5730;&#x5740;&#x63D0;&#x4F9B;&#x9664;&#x56DE;&#x9001;&#x5730;&#x5740;&#x4E4B;&#x5916;&#x7684;&#x4EFB;&#x4F55; IP &#x5730;&#x5740;&#x65F6;&#xFF0C;&#x6E90; IP &#x5730;&#x5740;&#x4F1A;&#x81EA;&#x52A8;&#x66F4;&#x65B0;&#x3002; &#x6211;&#x4EEC;&#x9700;&#x8981;&#x6784;&#x5EFA;&#x7684;&#x4E0B;&#x4E00;&#x5C42;&#x662F;&#x6211;&#x4EEC;&#x7684; TCP &#x5C42;&#x3002; &#x8FD9;&#x53EF;&#x4EE5;&#x5728;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#x4E2D;&#x770B;&#x5230;&#xFF1A;</p>
<pre><code>&gt;&gt;&gt; t = TCP() 
&gt;&gt;&gt; t.display()
###[ TCP ]###
  sport= ftp_data
  dport= http
  seq= 0
  ack= 0
  dataofs= None
  reserved= 0
  flags= S
  window= 8192
  chksum= None
  urgptr= 0
  options= {} 
&gt;&gt;&gt; t.flags=&apos;A&apos; 
&gt;&gt;&gt; t.display() 
###[ TCP ]###
  sport= ftp_data
  dport= http
  seq= 0
  ack= 0
  dataofs= None
  reserved= 0
  flags= A
  window= 8192
  chksum= None
  urgptr= 0
  options= {}
</code></pre><p>&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;<code>t</code>&#x53D8;&#x91CF;&#x521D;&#x59CB;&#x5316;&#x4E3A;<code>TCP</code>&#x5BF9;&#x8C61;&#x3002; &#x6CE8;&#x610F;&#xFF0C;&#x5BF9;&#x8C61;&#x7684;&#x9ED8;&#x8BA4;&#x914D;&#x7F6E;&#x5DF2;&#x7ECF;&#x5C06;&#x76EE;&#x6807;&#x7AEF;&#x53E3;&#x8BBE;&#x7F6E;&#x4E3A; HTTP &#x6216;&#x7AEF;&#x53E3; 80&#x3002;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x5C06; TCP &#x6807;&#x5FD7;&#x4ECE;<code>S</code>&#xFF08;SYN&#xFF09;&#x66F4;&#x6539;&#x4E3A;<code>A</code>&#xFF08;ACK&#xFF09;&#x3002; &#x73B0;&#x5728;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x659C;&#x6760;&#x5206;&#x9694;&#x6BCF;&#x4E2A;&#x5C42;&#x7EA7;&#x6765;&#x6784;&#x5EFA;&#x6808;&#xFF0C;&#x5982;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#x4E2D;&#x6240;&#x793A;&#xFF1A;</p>
<pre><code>&gt;&gt;&gt; request = (i/t) 
&gt;&gt;&gt; request.display() 
###[ IP ]###
  version= 4
  ihl= None
  tos= 0x0
  len= None
  id= 1
  flags=
  frag= 0
  ttl= 64
  proto= tcp
  chksum= None
  src= 172.16.36.180
  dst= 172.16.36.135
  \options\ 
###[ TCP ]###
     sport= ftp_data
     dport= http
     seq= 0
     ack= 0
     dataofs= None
     reserved= 0
     flags= A
     window= 8192
     chksum= None
     urgptr= 0
     options= {}
</code></pre><p>&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x6574;&#x4E2A;&#x8BF7;&#x6C42;&#x6808;&#x8D4B;&#x7ED9;<code>request</code>&#x53D8;&#x91CF;&#x3002; &#x73B0;&#x5728;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>send</code>&#x548C;<code>recieve</code>&#x51FD;&#x6570;&#x8DE8;&#x7EBF;&#x8DEF;&#x53D1;&#x9001;&#x8BF7;&#x6C42;&#xFF0C;&#x7136;&#x540E;&#x53EF;&#x4EE5;&#x8BC4;&#x4F30;&#x54CD;&#x5E94;&#x6765;&#x786E;&#x5B9A;&#x76EE;&#x6807;&#x5730;&#x5740;&#x7684;&#x72B6;&#x6001;&#xFF1A;</p>
<pre><code>&gt;&gt;&gt; response = sr1(request) 
Begin emission: 
.......Finished to send 1 packets. 
....* 
Received 12 packets, got 1 answers, remaining 0 packets 
&gt;&gt;&gt; response.display() 
###[ IP ]###
  version= 4L
  ihl= 5L
  tos= 0x0
  len= 40
  id= 0
  flags= DF
  frag= 0L
  ttl= 64
  proto= tcp
  chksum= 0x9974
  src= 172.16.36.135
  dst= 172.16.36.180
  \options\ 
###[ TCP ]###
     sport= http
     dport= ftp_data
     seq= 0
     ack= 0
     dataofs= 5L
     reserved= 0L
     flags= R
     window= 0
     chksum= 0xe21
     urgptr= 0
     options= {} 
###[ Padding ]###
        load= &apos;\x00\x00\x00\x00\x00\x00&apos;
</code></pre><p>&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x8FDC;&#x7A0B;&#x7CFB;&#x7EDF;&#x4F7F;&#x7528;&#x8BBE;&#x7F6E;&#x4E86; RST &#x6807;&#x5FD7;&#x7684; TCP &#x6570;&#x636E;&#x5305;&#x8FDB;&#x884C;&#x54CD;&#x5E94;&#x3002; &#x8FD9;&#x7531;&#x5206;&#x914D;&#x7ED9;<code>flags</code>&#x5C5E;&#x6027;&#x7684;<code>R</code>&#x503C;&#x8868;&#x793A;&#x3002; &#x901A;&#x8FC7;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x51FD;&#x6570;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x5806;&#x53E0;&#x8BF7;&#x6C42;&#x548C;&#x53D1;&#x9001;&#x548C;&#x63A5;&#x6536;&#x54CD;&#x5E94;&#x7684;&#x6574;&#x4E2A;&#x8FC7;&#x7A0B;&#x538B;&#x7F29;&#x4E3A;&#x5355;&#x4E2A;&#x547D;&#x4EE4;&#xFF1A;</p>
<pre><code>&gt;&gt;&gt; response = sr1(IP(dst=&quot;172.16.36.135&quot;)/TCP(flags=&apos;A&apos;)) 
.Begin emission: 
................
Finished to send 1 packets. 
....* 
Received 22 packets, got 1 answers, remaining 0 packets 
&gt;&gt;&gt; response.display() 
###[ IP ]###
  version= 4L
  ihl= 5L
  tos= 0x0
  len= 40
  id= 0
  flags= DF
  frag= 0L
  ttl= 64
  proto= tcp
  chksum= 0x9974
  src= 172.16.36.135
  dst= 172.16.36.180
  \options\ 
###[ TCP ]###
     sport= http
     dport= ftp_data
     seq= 0
     ack= 0
     dataofs= 5L
     reserved= 0L
     flags= R
     window= 0
     chksum= 0xe21
     urgptr= 0
     options= {} 
###[ Padding ]###
        load= &apos;\x00\x00\x00\x00\x00\x00&apos;
</code></pre><p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x786E;&#x5B9A;&#x4E86;&#x4E0E;&#x53D1;&#x9001;&#x5230;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x4E0A;&#x7684;&#x6253;&#x5F00;&#x7AEF;&#x53E3;&#x7684; ACK &#x6570;&#x636E;&#x5305;&#x76F8;&#x5173;&#x8054;&#x7684;&#x54CD;&#x5E94;&#xFF0C;&#x8BA9;&#x6211;&#x4EEC;&#x5C1D;&#x8BD5;&#x5411;&#x6D3B;&#x52A8;&#x7CFB;&#x7EDF;&#x4E0A;&#x7684;&#x5DF2;&#x5173;&#x95ED;&#x7AEF;&#x53E3;&#x53D1;&#x9001;&#x7C7B;&#x4F3C;&#x7684;&#x8BF7;&#x6C42;&#xFF0C;&#x5E76;&#x786E;&#x5B9A;&#x54CD;&#x5E94;&#x662F;&#x5426;&#x6709;&#x4EFB;&#x4F55;&#x53D8;&#x5316;&#xFF1A;</p>
<pre><code>&gt;&gt;&gt; response = sr1(IP(dst=&quot;172.16.36.135&quot;)/TCP(dport=1111,flags=&apos;A&apos;)) 
.Begin emission: 
.........
Finished to send 1 packets. 
....* 
Received 15 packets, got 1 answers, remaining 0 packets 
&gt;&gt;&gt; response.display() 
###[ IP ]###
  version= 4L
  ihl= 5L
  tos= 0x0
  len= 40
  id= 0
  flags= DF
  frag= 0L
  ttl= 64
  proto= tcp
  chksum= 0x9974
  src= 172.16.36.135
  dst= 172.16.36.180
  \options\ 
###[ TCP ]###
     sport= 1111
     dport= ftp_data
     seq= 0
     ack= 0
     dataofs= 5L
     reserved= 0L
     flags= R
     window= 0
     chksum= 0xa1a
     urgptr= 0
     options= {} 
###[ Padding ]###
        load= &apos;\x00\x00\x00\x00\x00\x00&apos;
</code></pre><p>&#x5728;&#x6B64;&#x8BF7;&#x6C42;&#x4E2D;&#xFF0C;&#x76EE;&#x6807; TCP &#x7AEF;&#x53E3;&#x5DF2;&#x4ECE;&#x9ED8;&#x8BA4;&#x7AEF;&#x53E3; 80 &#x66F4;&#x6539;&#x4E3A;&#x7AEF;&#x53E3; 1111&#xFF08;&#x672A;&#x5728;&#x5176;&#x4E0A;&#x8FD0;&#x884C;&#x670D;&#x52A1;&#x7684;&#x7AEF;&#x53E3;&#xFF09;&#x3002; &#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x4ECE;&#x6D3B;&#x52A8;&#x7CFB;&#x7EDF;&#x4E0A;&#x7684;&#x6253;&#x5F00;&#x7AEF;&#x53E3;&#x548C;&#x5173;&#x95ED;&#x7AEF;&#x53E3;&#x8FD4;&#x56DE;&#x7684;&#x54CD;&#x5E94;&#x662F;&#x76F8;&#x540C;&#x7684;&#x3002; &#x65E0;&#x8BBA;&#x8FD9;&#x662F;&#x5426;&#x662F;&#x5728;&#x626B;&#x63CF;&#x7AEF;&#x53E3;&#x4E0A;&#x4E3B;&#x52A8;&#x8FD0;&#x884C;&#x7684;&#x670D;&#x52A1;&#xFF0C;&#x6D3B;&#x52A8;&#x7CFB;&#x7EDF;&#x90FD;&#x4F1A;&#x8FD4;&#x56DE; RST &#x54CD;&#x5E94;&#x3002; &#x53E6;&#x5916;&#xFF0C;&#x5E94;&#x5F53;&#x6CE8;&#x610F;&#xFF0C;&#x5982;&#x679C;&#x5C06;&#x7C7B;&#x4F3C;&#x7684;&#x626B;&#x63CF;&#x53D1;&#x9001;&#x5230;&#x4E0E;&#x6D3B;&#x52A8;&#x7CFB;&#x7EDF;&#x65E0;&#x5173;&#x7684; IP &#x5730;&#x5740;&#xFF0C;&#x5219;&#x4E0D;&#x4F1A;&#x8FD4;&#x56DE;&#x54CD;&#x5E94;&#x3002; &#x8FD9;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5C06;&#x8BF7;&#x6C42;&#x4E2D;&#x7684;&#x76EE;&#x6807; IP &#x5730;&#x5740;&#x4FEE;&#x6539;&#x4E3A;&#x4E0E;&#x5B9E;&#x9645;&#x7CFB;&#x7EDF;&#x65E0;&#x5173;&#x7684; IP &#x5730;&#x5740;&#x6765;&#x9A8C;&#x8BC1;&#xFF1A;</p>
<pre><code>&gt;&gt;&gt; response = sr1(IP(dst=&quot;172.16.36.136&quot;)/TCP(dport=80,flags=&apos;A&apos;),timeo ut=1) 
Begin emission:
......................................................................... ......................................................................... ......
Finished to send 1 packets. 
..................... 
Received 3559 packets, got 0 answers, remaining 1 packets
</code></pre><p>&#x56E0;&#x6B64;&#xFF0C;&#x901A;&#x8FC7;&#x67E5;&#x770B;&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x5BF9;&#x4E8E;&#x53D1;&#x9001;&#x5230;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x4EFB;&#x4F55;&#x7AEF;&#x53E3;&#x7684; ACK &#x6570;&#x636E;&#x5305;&#xFF0C;&#x65E0;&#x8BBA;&#x7AEF;&#x53E3;&#x72B6;&#x6001;&#x5982;&#x4F55;&#xFF0C;&#x90FD;&#x5C06;&#x8FD4;&#x56DE; RST &#x6570;&#x636E;&#x5305;&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x4E0E;&#x4E4B;&#x76F8;&#x5173;&#xFF0C;&#x5219;&#x4E0D;&#x4F1A;&#x4ECE; IP &#x63A5;&#x6536;&#x5230;&#x54CD;&#x5E94;&#x3002; &#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x597D;&#x6D88;&#x606F;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x610F;&#x5473;&#x7740;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x53EA;&#x4E0E;&#x6BCF;&#x4E2A;&#x7CFB;&#x7EDF;&#x4E0A;&#x7684;&#x5355;&#x4E2A;&#x7AEF;&#x53E3;&#x8FDB;&#x884C;&#x4EA4;&#x4E92;&#xFF0C;&#x5728;&#x5927;&#x91CF;&#x7CFB;&#x7EDF;&#x4E0A;&#x6267;&#x884C;&#x53D1;&#x73B0;&#x626B;&#x63CF;&#x3002; &#x5C06; Scapy &#x4E0E; Python &#x7ED3;&#x5408;&#x4F7F;&#x7528;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5FEB;&#x901F;&#x5FAA;&#x73AF;&#x8BBF;&#x95EE;<code>/ 24</code>&#x7F51;&#x7EDC;&#x8303;&#x56F4;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x5730;&#x5740;&#xFF0C;&#x5E76;&#x5411;&#x6BCF;&#x4E2A;&#x7CFB;&#x7EDF;&#x4E0A;&#x7684;&#x4EC5;&#x4E00;&#x4E2A; TCP &#x7AEF;&#x53E3;&#x53D1;&#x9001;&#x5355;&#x4E2A; ACK &#x6570;&#x636E;&#x5305;&#x3002; &#x901A;&#x8FC7;&#x8BC4;&#x4F30;&#x6BCF;&#x4E2A;&#x4E3B;&#x673A;&#x8FD4;&#x56DE;&#x7684;&#x54CD;&#x5E94;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8F7B;&#x6613;&#x8F93;&#x51FA;&#x6D3B;&#x52A8; IP &#x5730;&#x5740;&#x5217;&#x8868;&#x3002;</p>
<pre><code class="lang-py"><span class="hljs-comment">#!/usr/bin/python</span>

<span class="hljs-keyword">import</span> logging 
logging.getLogger(<span class="hljs-string">&quot;scapy.runtime&quot;</span>).setLevel(logging.ERROR) 
<span class="hljs-keyword">from</span> scapy.all <span class="hljs-keyword">import</span> *

<span class="hljs-keyword">if</span> len(sys.argv) != <span class="hljs-number">2</span>:   
    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Usage - ./ACK_Ping.py [/24 network address]&quot;</span>   
    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Example - ./ACK_Ping.py 172.16.36.0&quot;</span>   
    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Example will perform a TCP ACK ping scan of the 172.16.36.0/24 range&quot;</span>  
    sys.exit()

address = str(sys.argv[<span class="hljs-number">1</span>]) 
prefix = address.split(<span class="hljs-string">&apos;.&apos;</span>)[<span class="hljs-number">0</span>] + <span class="hljs-string">&apos;.&apos;</span> + address.split(<span class="hljs-string">&apos;.&apos;</span>)[<span class="hljs-number">1</span>] + <span class="hljs-string">&apos;.&apos;</span> + address.split(<span class="hljs-string">&apos;.&apos;</span>)[<span class="hljs-number">2</span>] + <span class="hljs-string">&apos;.&apos;</span>

<span class="hljs-keyword">for</span> addr <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,<span class="hljs-number">254</span>):
    response = sr1(IP(dst=prefix+str(addr))/TCP(dport=<span class="hljs-number">80</span>,flags=<span class="hljs-string">&apos;A&apos;</span>), timeout=<span class="hljs-number">1</span>,verbose=<span class="hljs-number">0</span>)  
    <span class="hljs-keyword">try</span>:      
        <span class="hljs-keyword">if</span> int(response[TCP].flags) == <span class="hljs-number">4</span>:         
            <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;172.16.36.&quot;</span>+str(addr)   
    <span class="hljs-keyword">except</span>:      
        <span class="hljs-keyword">pass</span>
</code></pre>
<p>&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x811A;&#x672C;&#x76F8;&#x5F53;&#x7B80;&#x5355;&#x3002; &#x5F53;&#x5FAA;&#x73AF;&#x904D;&#x5386; IP &#x5730;&#x5740;&#x4E2D;&#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x516B;&#x4F4D;&#x5B57;&#x8282;&#x7684;&#x6BCF;&#x4E2A;&#x53EF;&#x80FD;&#x503C;&#x65F6;&#xFF0C;ACK &#x5C01;&#x5305;&#x88AB;&#x53D1;&#x9001;&#x5230; TCP &#x7AEF;&#x53E3; 80&#xFF0C;&#x5E76;&#x4E14;&#x8BC4;&#x4F30;&#x54CD;&#x5E94;&#x6765;&#x786E;&#x5B9A;&#x54CD;&#x5E94;&#x4E2D;&#x7684; TCP &#x6807;&#x5FD7;&#x7684;&#x6574;&#x6570;&#x8F6C;&#x6362;&#x662F;&#x5426;&#x5177;&#x6709;&#x503C;<code>4</code> &#xFF08;&#x4E0E;&#x5355;&#x72EC; RST &#x6807;&#x5FD7;&#x76F8;&#x5173;&#x7684;&#x503C;&#xFF09;&#x3002; &#x5982;&#x679C;&#x6570;&#x636E;&#x5305;&#x5177;&#x6709; RST &#x6807;&#x5FD7;&#xFF0C;&#x5219;&#x811A;&#x672C;&#x5C06;&#x8F93;&#x51FA;&#x8FD4;&#x56DE;&#x54CD;&#x5E94;&#x7684;&#x7CFB;&#x7EDF;&#x7684; IP &#x5730;&#x5740;&#x3002; &#x5982;&#x679C;&#x6CA1;&#x6709;&#x6536;&#x5230;&#x54CD;&#x5E94;&#xFF0C;Python &#x65E0;&#x6CD5;&#x6D4B;&#x8BD5;&#x54CD;&#x5E94;&#x53D8;&#x91CF;&#x7684;&#x503C;&#xFF0C;&#x56E0;&#x4E3A;&#x6CA1;&#x6709;&#x4E3A;&#x5176;&#x8D4B;&#x4EFB;&#x4F55;&#x503C;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x8FD4;&#x56DE;&#x54CD;&#x5E94;&#xFF0C;&#x5C06;&#x53D1;&#x751F;&#x5F02;&#x5E38;&#x3002; &#x5982;&#x679C;&#x8FD4;&#x56DE;&#x5F02;&#x5E38;&#xFF0C;&#x811A;&#x672C;&#x5C06;&#x4F1A;&#x8DF3;&#x8FC7;&#x3002; &#x751F;&#x6210;&#x7684;&#x8F93;&#x51FA;&#x662F;&#x6D3B;&#x52A8;&#x76EE;&#x6807; IP &#x5730;&#x5740;&#x7684;&#x5217;&#x8868;&#x3002; &#x6B64;&#x811A;&#x672C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x53E5;&#x53F7;&#x548C;&#x659C;&#x6760;&#xFF0C;&#x540E;&#x8DDF;&#x53EF;&#x6267;&#x884C;&#x811A;&#x672C;&#x7684;&#x540D;&#x79F0;&#x6267;&#x884C;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ./ACK_Ping.py 
Usage - ./ACK_Ping.py [/24 network address] 
Example - ./ACK_Ping.py 172.16.36.0 
Example will perform a TCP ACK ping scan of the 172.16.36.0/24 range 
root@KaliLinux:~# ./ACK_Ping.py 
172.16.36.1 
172.16.36.2 
172.16.36.132 
172.16.36.135
</code></pre><p>&#x7C7B;&#x4F3C;&#x7684;&#x53D1;&#x73B0;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x4F7F;&#x7528; UDP &#x534F;&#x8BAE;&#x6765;&#x6267;&#x884C;&#x7B2C;&#x56DB;&#x5C42;&#x53D1;&#x73B0;&#x3002; &#x4E3A;&#x4E86;&#x786E;&#x5B9A;&#x6211;&#x4EEC;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; UDP &#x534F;&#x8BAE;&#x53D1;&#x73B0;&#x4E3B;&#x673A;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x786E;&#x5B9A;&#x5982;&#x4F55;&#x4ECE;&#x4EFB;&#x4F55;&#x8FD0;&#x884C; UDP &#x7684;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x89E6;&#x53D1;&#x54CD;&#x5E94;&#xFF0C;&#x800C;&#x4E0D;&#x7BA1;&#x7CFB;&#x7EDF;&#x662F;&#x5426;&#x6709;&#x5728; UDP &#x7AEF;&#x53E3;&#x4E0A;&#x8FD0;&#x884C;&#x670D;&#x52A1;&#x3002; &#x4E3A;&#x4E86;&#x5C1D;&#x8BD5;&#x8FD9;&#x4E2A;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x9996;&#x5148;&#x5728; Scapy &#x4E2D;&#x6784;&#x5EFA;&#x6211;&#x4EEC;&#x7684;&#x8BF7;&#x6C42;&#x6808;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# scapy Welcome to Scapy (2.2.0) 
&gt;&gt;&gt; i = IP() 
&gt;&gt;&gt; i.dst = &quot;172.16.36.135&quot; 
&gt;&gt;&gt; u = UDP() 
&gt;&gt;&gt; request = (i/u) 
&gt;&gt;&gt; request.display()
###[ IP ]###
  version= 4
  ihl= None
  tos= 0x0
  len= None
  id= 1
  flags=
  frag= 0
  ttl= 64
  proto= udp
  chksum= None
  src= 172.16.36.180
  dst= 172.16.36.135
  \options\ 
###[ UDP ]###
     sport= domain
     dport= domain
     len= None
     chksum= None
</code></pre><p>&#x6CE8;&#x610F;&#xFF0C;UDP&#x5BF9;&#x8C61;&#x7684;&#x9ED8;&#x8BA4;&#x6E90;&#x548C;&#x76EE;&#x6807;&#x7AEF;&#x53E3;&#x662F;&#x57DF;&#x540D;&#x7CFB;&#x7EDF;&#xFF08;DNS&#xFF09;&#x3002; &#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x5E38;&#x7528;&#x7684;&#x670D;&#x52A1;&#xFF0C;&#x53EF;&#x7528;&#x4E8E;&#x5C06;&#x57DF;&#x540D;&#x89E3;&#x6790;&#x4E3A; IP &#x5730;&#x5740;&#x3002; &#x53D1;&#x9001;&#x8BF7;&#x6C42;&#x662F;&#x56E0;&#x4E3A;&#x5B83;&#x662F;&#x6709;&#x52A9;&#x4E8E;&#x5224;&#x65AD;&#xFF0C;IP &#x5730;&#x5740;&#x662F;&#x5426;&#x4E0E;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x76F8;&#x5173;&#x8054;&#x3002; &#x53D1;&#x9001;&#x6B64;&#x8BF7;&#x6C42;&#x7684;&#x793A;&#x4F8B;&#x53EF;&#x4EE5;&#x5728;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#x4E2D;&#x770B;&#x5230;&#xFF1A;</p>
<pre><code>&gt;&gt;&gt; reply = sr1(request,timeout=1,verbose=1) 
Begin emission: 
Finished to send 1 packets.
Received 7 packets, got 0 answers, remaining 1 packets
</code></pre><p>&#x5C3D;&#x7BA1;&#x4E0E;&#x76EE;&#x6807; IP &#x5730;&#x5740;&#x76F8;&#x5173;&#x7684;&#x4E3B;&#x673A;&#x662F;&#x6D3B;&#x52A8;&#x7684;&#xFF0C;&#x4F46;&#x6211;&#x4EEC;&#x6CA1;&#x6709;&#x6536;&#x5230;&#x54CD;&#x5E94;&#x3002; &#x8BBD;&#x523A;&#x7684;&#x662F;&#xFF0C;&#x7F3A;&#x4E4F;&#x54CD;&#x5E94;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x7531;&#x4E8E; DNS &#x670D;&#x52A1;&#x6B63;&#x5728;&#x76EE;&#x6807;&#x7CFB;&#x7EDF;&#x4E0A;&#x4F7F;&#x7528;&#x3002;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x6D3B;&#x52A8;&#x670D;&#x52A1;&#x901A;&#x5E38;&#x914D;&#x7F6E;&#x4E3A;&#x4EC5;&#x54CD;&#x5E94;&#x5305;&#x542B;&#x7279;&#x5B9A;&#x5185;&#x5BB9;&#x7684;&#x8BF7;&#x6C42;&#x3002; &#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x81EA;&#x7136;&#x60F3;&#x5230;&#xFF0C;&#x6709;&#x65F6;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x901A;&#x8FC7;&#x63A2;&#x6D4B;&#x672A;&#x8FD0;&#x884C;&#x670D;&#x52A1;&#x7684; UDP &#x7AEF;&#x53E3;&#x6765;&#x9AD8;&#x6548;&#x8BC6;&#x522B;&#x4E3B;&#x673A;&#xFF0C;&#x5047;&#x8BBE; ICMP &#x6D41;&#x91CF;&#x672A;&#x88AB;&#x9632;&#x706B;&#x5899;&#x963B;&#x6B62;&#x3002;  &#x73B0;&#x5728;&#xFF0C;&#x6211;&#x4EEC;&#x5C1D;&#x8BD5;&#x5C06;&#x540C;&#x4E00;&#x8BF7;&#x6C42;&#x53D1;&#x9001;&#x5230;&#x4E0D;&#x5728;&#x4F7F;&#x7528;&#x7684;&#x4E0D;&#x540C; UDP &#x7AEF;&#x53E3;&#xFF1A;</p>
<pre><code>&gt;&gt;&gt; u.dport = 123 
&gt;&gt;&gt; request = (i/u)
&gt;&gt;&gt; reply = sr1(request,timeout=1,verbose=1) 
Begin emission: Finished to send 1 packets.
Received 5 packets, got 1 answers, remaining 0 packets 
&gt;&gt;&gt; reply.display() 
###[ IP ]###
  version= 4L
  ihl= 5L
  tos= 0xc0
  len= 56
  id= 62614
  flags=
  frag= 0L
  ttl= 64
  proto= icmp
  chksum= 0xe412
  src= 172.16.36.135
  dst= 172.16.36.180
  \options\ 
###[ ICMP ]###
     type= dest-unreach
     code= port-unreachable
     chksum= 0x9e72
     unused= 0 
###[ IP in ICMP ]###
        version= 4L
        ihl= 5L
        tos= 0x0
        len= 28
        id= 1
        flags=
        frag= 0L
        ttl= 64
        proto= udp
        chksum= 0xd974
        src= 172.16.36.180
        dst= 172.16.36.135
        \options\
###[ UDP in ICMP ]###
           sport= domain       
           dport= ntp        
           len= 8          
           chksum= 0x5dd2
</code></pre><p>&#x901A;&#x8FC7;&#x5C06;&#x8BF7;&#x6C42;&#x76EE;&#x6807;&#x66F4;&#x6539;&#x4E3A;&#x7AEF;&#x53E3; 123&#xFF0C;&#x7136;&#x540E;&#x91CD;&#x65B0;&#x53D1;&#x9001;&#x5B83;&#xFF0C;&#x6211;&#x4EEC;&#x73B0;&#x5728;&#x4F1A;&#x6536;&#x5230;&#x4E00;&#x4E2A;&#x54CD;&#x5E94;&#xFF0C;&#x8868;&#x660E;&#x76EE;&#x6807;&#x7AEF;&#x53E3;&#x4E0D;&#x53EF;&#x8FBE;&#x3002;&#x5982;&#x679C;&#x68C0;&#x67E5;&#x6B64;&#x54CD;&#x5E94;&#x7684;&#x6E90; IP &#x5730;&#x5740;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5B83;&#x662F;&#x4ECE;&#x53D1;&#x9001;&#x539F;&#x59CB;&#x8BF7;&#x6C42;&#x7684;&#x4E3B;&#x673A;&#x53D1;&#x9001;&#x7684;&#x3002;&#x6B64;&#x54CD;&#x5E94;&#x968F;&#x540E;&#x8868;&#x660E;&#x539F;&#x59CB;&#x76EE;&#x6807; IP &#x5730;&#x5740;&#x5904;&#x7684;&#x4E3B;&#x673A;&#x5904;&#x4E8E;&#x6D3B;&#x52A8;&#x72B6;&#x6001;&#x3002;&#x4E0D;&#x5E78;&#x7684;&#x662F;&#xFF0C;&#x5728;&#x8FD9;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#x5E76;&#x4E0D;&#x603B;&#x662F;&#x8FD4;&#x56DE;&#x54CD;&#x5E94;&#x3002;&#x8FD9;&#x79CD;&#x6280;&#x672F;&#x7684;&#x6548;&#x7387;&#x5728;&#x5F88;&#x5927;&#x7A0B;&#x5EA6;&#x4E0A;&#x53D6;&#x51B3;&#x4E8E;&#x4F60;&#x6B63;&#x5728;&#x63A2;&#x6D4B;&#x7684;&#x7CFB;&#x7EDF;&#x53CA;&#x5176;&#x914D;&#x7F6E;&#x3002;&#x6B63;&#x56E0;&#x4E3A;&#x5982;&#x6B64;&#xFF0C;UDP &#x53D1;&#x73B0;&#x901A;&#x5E38;&#x6BD4; TCP &#x53D1;&#x73B0;&#x66F4;&#x96BE;&#x6267;&#x884C;&#x3002;&#x5B83;&#x4ECE;&#x6765;&#x4E0D;&#x4F1A;&#x50CF;&#x53D1;&#x9001;&#x5E26;&#x6709;&#x5355;&#x4E2A;&#x6807;&#x5FD7;&#x7684; TCP &#x6570;&#x636E;&#x5305;&#x90A3;&#x4E48;&#x7B80;&#x5355;&#x3002;&#x5728;&#x670D;&#x52A1;&#x786E;&#x5B9E;&#x5B58;&#x5728;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x901A;&#x5E38;&#x9700;&#x8981;&#x670D;&#x52A1;&#x7279;&#x5B9A;&#x7684;&#x63A2;&#x6D4B;&#x3002;&#x5E78;&#x8FD0;&#x7684;&#x662F;&#xFF0C;&#x6709;&#x5404;&#x79CD;&#x76F8;&#x5F53;&#x590D;&#x6742;&#x7684; UDP &#x626B;&#x63CF;&#x5DE5;&#x5177;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5404;&#x79CD; UDP &#x8BF7;&#x6C42;&#x548C;&#x670D;&#x52A1;&#x7279;&#x5B9A;&#x7684;&#x63A2;&#x9488;&#xFF0C;&#x6765;&#x786E;&#x5B9A;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x662F;&#x5426;&#x5173;&#x8054;&#x4E86;&#x4EFB;&#x4F55;&#x7ED9;&#x5B9A;&#x7684;IP&#x5730;&#x5740;&#x3002;</p>
<h3 id="&#x5DE5;&#x4F5C;&#x539F;&#x7406;">&#x5DE5;&#x4F5C;&#x539F;&#x7406;</h3>
<p>&#x8FD9;&#x91CC;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4F7F;&#x7528; UDP &#x548C; TCP &#x53D1;&#x73B0;&#x65B9;&#x5F0F;&#x3002; &#x6211;&#x4EEC;&#x80FD;&#x591F;&#x4F7F;&#x7528; Scapy &#x6765;&#x5236;&#x4F5C;&#x81EA;&#x5B9A;&#x4E49;&#x8BF7;&#x6C42;&#xFF0C;&#x6765;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x534F;&#x8BAE;&#x8BC6;&#x522B;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x3002; &#x5728; TCP &#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6211;&#x4EEC;&#x6784;&#x9020;&#x4E86;&#x81EA;&#x5B9A;&#x4E49;&#x7684; ACK &#x5C01;&#x5305;&#x5E76;&#x5C06;&#x5176;&#x53D1;&#x9001;&#x5230;&#x6BCF;&#x4E2A;&#x76EE;&#x6807;&#x7CFB;&#x7EDF;&#x4E0A;&#x7684;&#x4EFB;&#x610F;&#x7AEF;&#x53E3;&#x3002; &#x5728;&#x63A5;&#x6536;&#x5230; RST &#x5E94;&#x7B54;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x7CFB;&#x7EDF;&#x88AB;&#x8BC6;&#x522B;&#x4E3A;&#x6D3B;&#x52A8;&#x7684;&#x3002; &#x6216;&#x8005;&#xFF0C;&#x7A7A;&#x7684; UDP &#x8BF7;&#x6C42;&#x88AB;&#x53D1;&#x9001;&#x5230;&#x4EFB;&#x610F;&#x7AEF;&#x53E3;&#xFF0C;&#x6765;&#x5C1D;&#x8BD5;&#x8BF7;&#x6C42; ICMP &#x7AEF;&#x53E3;&#x4E0D;&#x53EF;&#x8FBE;&#x54CD;&#x5E94;&#x3002; &#x54CD;&#x5E94;&#x53EF;&#x7528;&#x4F5C;&#x6D3B;&#x52A8;&#x7CFB;&#x7EDF;&#x7684;&#x6807;&#x8BC6;&#x3002; &#x7136;&#x540E;&#x8FD9;&#x4E9B;&#x6280;&#x672F;&#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x90FD;&#x53EF;&#x4EE5;&#x5728; Python &#x811A;&#x672C;&#x4E2D;&#x4F7F;&#x7528;&#xFF0C;&#x6765;&#x5BF9;&#x591A;&#x4E2A;&#x4E3B;&#x673A;&#x6216;&#x5730;&#x5740;&#x8303;&#x56F4;&#x6267;&#x884C;&#x53D1;&#x73B0;&#x3002;</p>
<h2 id="212-&#x4F7F;&#x7528;-nmap-&#x63A2;&#x7D22;&#x7B2C;&#x56DB;&#x5C42;">2.12 &#x4F7F;&#x7528; Nmap &#x63A2;&#x7D22;&#x7B2C;&#x56DB;&#x5C42;</h2>
<p>&#x9664;&#x4E86;&#x96C6;&#x6210;&#x5230; Nmap &#x5DE5;&#x5177;&#x4E2D;&#x7684;&#x8BB8;&#x591A;&#x5176;&#x4ED6;&#x626B;&#x63CF;&#x529F;&#x80FD;&#xFF0C;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x9009;&#x9879;&#x7528;&#x4E8E;&#x6267;&#x884C;&#x7B2C;&#x56DB;&#x5C42;&#x53D1;&#x73B0;&#x3002; &#x8FD9;&#x4E2A;&#x5177;&#x4F53;&#x7684;&#x79D8;&#x7C4D;&#x6F14;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x4F7F;&#x7528; Nmap &#x6267;&#x884C; TCP &#x548C; UDP &#x534F;&#x8BAE;&#x7684;&#x7B2C;4&#x5C42;&#x53D1;&#x73B0;&#x3002;</p>
<h3 id="&#x51C6;&#x5907;">&#x51C6;&#x5907;</h3>
<p>&#x4F7F;&#x7528; Nmap &#x6267;&#x884C;&#x7B2C;&#x56DB;&#x5C42;&#x53D1;&#x73B0;&#x4E0D;&#x9700;&#x8981;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#xFF0C;&#x56E0;&#x4E3A; Internet &#x4E0A;&#x7684;&#x8BB8;&#x591A;&#x7CFB;&#x7EDF;&#x90FD;&#x5C06;&#x56DE;&#x590D; TCP &#x548C; UDP &#x8BF7;&#x6C42;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5F3A;&#x70C8;&#x5EFA;&#x8BAE;&#x4F60;&#x53EA;&#x5728;&#x60A8;&#x81EA;&#x5DF1;&#x7684;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x6267;&#x884C;&#x4EFB;&#x4F55;&#x7C7B;&#x578B;&#x7684;&#x7F51;&#x7EDC;&#x626B;&#x63CF;&#xFF0C;&#x9664;&#x975E;&#x4F60;&#x5B8C;&#x5168;&#x719F;&#x6089;&#x60A8;&#x53D7;&#x5230;&#x4EFB;&#x4F55;&#x7BA1;&#x7406;&#x673A;&#x6784;&#x65BD;&#x52A0;&#x7684;&#x6CD5;&#x5F8B;&#x6CD5;&#x89C4;&#x3002;&#x5982;&#x679C;&#x4F60;&#x5E0C;&#x671B;&#x5728;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x6267;&#x884C;&#x6B64;&#x6280;&#x672F;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x54CD;&#x5E94; TCP/UDP &#x8BF7;&#x6C42;&#x7684;&#x7CFB;&#x7EDF;&#x3002;&#x5728;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528; Linux &#x548C; Windows &#x7CFB;&#x7EDF;&#x7684;&#x7EC4;&#x5408;&#x3002;&#x6709;&#x5173;&#x5728;&#x672C;&#x5730;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x8BBE;&#x7F6E;&#x7CFB;&#x7EDF;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x4E2D;&#x7684;&#x201C;&#x5B89;&#x88C5; Metasploitable2&#x201D;&#x548C;&#x201C;&#x5B89;&#x88C5; Windows Server&#x201D;&#x79D8;&#x7C4D;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x672C;&#x8282;&#x8FD8;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#xFF08;&#x5982; VIM &#x6216; Nano&#xFF09;&#x5C06;&#x811A;&#x672C;&#x5199;&#x5165;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3002;&#x6709;&#x5173;&#x7F16;&#x5199;&#x811A;&#x672C;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x4E2D;&#x7684;&#x201C;&#x4F7F;&#x7528;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#xFF08;VIM &#x548C; Nano&#xFF09;&#x201D;&#x79D8;&#x7C4D;&#x3002;</p>
<h3 id="&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;">&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;</h3>
<p>&#x5728; Nmap &#x4E2D;&#x6709;&#x4E00;&#x4E9B;&#x9009;&#x9879;&#x7528;&#x4E8E;&#x53D1;&#x73B0;&#x8FD0;&#x884C; TCP &#x548C; UDP &#x7684;&#x4E3B;&#x673A;&#x3002; Nmap &#x7684; UDP &#x53D1;&#x73B0;&#x5DF2;&#x914D;&#x7F6E;&#x4E3A;&#xFF0C;&#x4F7F;&#x7528;&#x5FC5;&#x9700;&#x7684;&#x552F;&#x4E00;&#x8F7D;&#x8377;&#x6765;&#x89E6;&#x53D1;&#x65E0;&#x54CD;&#x5E94;&#x7684;&#x670D;&#x52A1;&#x3002; &#x4E3A;&#x4E86;&#x4F7F;&#x7528; UDP &#x6267;&#x884C;&#x53D1;&#x73B0;&#x626B;&#x63CF;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<code>-PU</code>&#x9009;&#x9879;&#x548C;&#x7AEF;&#x53E3;&#x6765;&#x6D4B;&#x8BD5;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# nmap 172.16.36.135 -PU53 -sn

Starting Nmap 6.25 ( http://nmap.org ) at 2013-12-11 20:11 EST 
Nmap scan report for 172.16.36.135 Host is up (0.00042s latency). 
MAC Address: 00:0C:29:3D:84:32 (VMware) 
Nmap done: 1 IP address (1 host up) scanned in 0.13 seconds 
This UDP discovery scan can also be modified to perform a scan of a sequential range by using dash notation. In the example provided, we will scan the entire 172.16.36.0/24 address range: 
root@KaliLinux:~# nmap 172.16.36.0-255 -PU53 -sn

Starting Nmap 6.25 ( http://nmap.org ) at 2013-12-17 06:33 EST 
Nmap scan report for 172.16.36.1 
Host is up (0.00020s latency). 
MAC Address: 00:50:56:C0:00:08 (VMware) 
Nmap scan report for 172.16.36.2 
Host is up (0.00018s latency). 
MAC Address: 00:50:56:FF:2A:8E (VMware) 
Nmap scan report for 172.16.36.132 
Host is up (0.00037s latency). 
MAC Address: 00:0C:29:65:FC:D2 (VMware) 
Nmap scan report for 172.16.36.135 
Host is up (0.00041s latency).
MAC Address: 00:0C:29:3D:84:32 (VMware) 
Nmap scan report for 172.16.36.180 
Host is up. 
Nmap scan report for 172.16.36.254 
Host is up (0.00015s latency). 
MAC Address: 00:50:56:EB:E1:8A (VMware) 
Nmap done: 256 IP addresses (6 hosts up) scanned in 3.91 seconds
</code></pre><p>&#x4E0E;&#x4E4B;&#x7C7B;&#x4F3C;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5BF9;&#x8F93;&#x5165;&#x5217;&#x8868;&#x6240;&#x5B9A;&#x4E49;&#x7684;&#x4E00;&#x7CFB;&#x5217; IP &#x5730;&#x5740;&#x6267;&#x884C; Nmap UDP ping &#x8BF7;&#x6C42;&#x3002; &#x5728;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x540C;&#x4E00;&#x76EE;&#x5F55;&#x4E2D;&#x7684;<code>iplist.txt</code>&#x6587;&#x4EF6;&#x6765;&#x626B;&#x63CF;&#x4EE5;&#x4E0B;&#x5217;&#x51FA;&#x7684;&#x6BCF;&#x4E2A;&#x4E3B;&#x673A;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# nmap -iL iplist.txt -sn -PU53
Starting Nmap 6.25 ( http://nmap.org ) at 2013-12-17 06:36 EST 
Nmap scan report for 172.16.36.2 
Host is up (0.00015s latency). 
MAC Address: 00:50:56:FF:2A:8E (VMware) 
Nmap scan report for 172.16.36.1 
Host is up (0.00024s latency). 
MAC Address: 00:50:56:C0:00:08 (VMware) 
Nmap scan report for 172.16.36.135 
Host is up (0.00029s latency). 
MAC Address: 00:0C:29:3D:84:32 (VMware) 
Nmap scan report for 172.16.36.132 
Host is up (0.00030s latency). 
MAC Address: 00:0C:29:65:FC:D2 (VMware) 
Nmap scan report for 172.16.36.180 
Host is up. 
Nmap scan report for 172.16.36.254 
Host is up (0.00021s latency). 
MAC Address: 00:50:56:EB:E1:8A (VMware) 
Nmap done: 6 IP addresses (6 hosts up) scanned in 0.31 seconds
</code></pre><p>&#x5C3D;&#x7BA1;&#x6765;&#x81EA;&#x8FD9;&#x4E9B;&#x793A;&#x4F8B;&#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x7684;&#x8F93;&#x51FA;&#x8868;&#x660E;&#x53D1;&#x73B0;&#x4E86;&#x516D;&#x4E2A;&#x4E3B;&#x673A;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4E0D;&#x4E00;&#x5B9A;&#x6807;&#x8BC6;&#x516D;&#x4E2A;&#x4E3B;&#x673A;&#x90FD;&#x901A;&#x8FC7; UDP &#x53D1;&#x73B0;&#x65B9;&#x6CD5;&#x88AB;&#x53D1;&#x73B0;&#x3002; &#x9664;&#x4E86;&#x5728; UDP &#x7AEF;&#x53E3; 53 &#x4E0A;&#x6267;&#x884C;&#x7684;&#x63A2;&#x6D4B;&#x4E4B;&#x5916;&#xFF0C;Nmap &#x8FD8;&#x5C06;&#x5229;&#x7528;&#x4EFB;&#x4F55;&#x5176;&#x5B83;&#x53D1;&#x73B0;&#x6280;&#x672F;&#xFF0C;&#x6765;&#x53D1;&#x73B0;&#x5728;&#x6307;&#x5B9A;&#x8303;&#x56F4;&#x5185;&#x6216;&#x5728;&#x8F93;&#x5165;&#x5217;&#x8868;&#x5185;&#x7684;&#x4E3B;&#x673A;&#x3002; &#x867D;&#x7136;<code>-sn</code>&#x9009;&#x9879;&#x6709;&#x6548;&#x9632;&#x6B62;&#x4E86; Nmap &#x6267;&#x884C; TCP &#x7AEF;&#x53E3;&#x626B;&#x63CF;&#xFF0C;&#x4F46;&#x5B83;&#x4E0D;&#x4F1A;&#x5B8C;&#x5168;&#x9694;&#x79BB;&#x6211;&#x4EEC;&#x7684; UDP ping &#x8BF7;&#x6C42;&#x3002; &#x867D;&#x7136;&#x6CA1;&#x6709;&#x6709;&#x6548;&#x7684;&#x65B9;&#x6CD5;&#x6765;&#x9694;&#x79BB;&#x8FD9;&#x4E2A;&#x4EFB;&#x52A1;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5206;&#x6790; Wireshark &#x6216; TCPdump &#x4E2D;&#x7684;&#x6D41;&#x91CF;&#xFF0C;&#x6765;&#x786E;&#x5B9A;&#x901A;&#x8FC7; UDP &#x8BF7;&#x6C42;&#x53D1;&#x73B0;&#x7684;&#x4E3B;&#x673A;&#x3002; &#x6216;&#x8005;&#xFF0C;Nmap &#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x4EE5; Scapy &#x7684;&#x76F8;&#x540C;&#x65B9;&#x5F0F;&#xFF0C;&#x6765;&#x6267;&#x884C; TCP ACK ping&#x3002; &#x4E3A;&#x4E86;&#x4F7F;&#x7528; ACK &#x6570;&#x636E;&#x5305;&#x8BC6;&#x522B;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#xFF0C;&#x8BF7;&#x7ED3;&#x5408;&#x4F60;&#x8981;&#x4F7F;&#x7528;&#x7684;&#x7AEF;&#x53E3;&#x4F7F;&#x7528;<code>-PA</code>&#x9009;&#x9879;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# nmap 172.16.36.135 -PA80 -sn

Starting Nmap 6.25 ( http://nmap.org ) at 2013-12-11 20:09 EST 
Nmap scan report for 172.16.36.135 
Host is up (0.00057s latency). 
MAC Address: 00:0C:29:3D:84:32 (VMware) 
Nmap done: 1 IP address (1 host up) scanned in 0.21 seconds
</code></pre><p>TCP ACK ping &#x53D1;&#x73B0;&#x65B9;&#x6CD5;&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7834;&#x6298;&#x53F7;&#x7B26;&#x53F7;&#x5728;&#x4E00;&#x5B9A;&#x8303;&#x56F4;&#x7684;&#x4E3B;&#x673A;&#x4E0A;&#x6267;&#x884C;&#xFF0C;&#x6216;&#x8005;&#x53EF;&#x4EE5;&#x57FA;&#x4E8E;&#x8F93;&#x5165;&#x5217;&#x8868;&#x5728;&#x6307;&#x5B9A;&#x7684;&#x4E3B;&#x673A;&#x5730;&#x5740;&#x4E0A;&#x6267;&#x884C;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# nmap 172.16.36.0-255 -PA80 -sn

Starting Nmap 6.25 ( http://nmap.org ) at 2013-12-17 06:46 EST 
Nmap scan report for 172.16.36.132 
Host is up (0.00033s latency). 
MAC Address: 00:0C:29:65:FC:D2 (VMware) 
Nmap scan report for 172.16.36.135 
Host is up (0.00013s latency). 
MAC Address: 00:0C:29:3D:84:32 (VMware) 
Nmap scan report for 172.16.36.180 
Host is up. 
Nmap done: 256 IP addresses (3 hosts up) scanned in 3.43 seconds 

root@KaliLinux:~# nmap -iL iplist.txt -PA80 -sn

Starting Nmap 6.25 ( http://nmap.org ) at 2013-12-17 06:47 EST 
Nmap scan report for 172.16.36.135 
Host is up (0.00033s latency). 
MAC Address: 00:0C:29:3D:84:32 (VMware)

Nmap scan report for 172.16.36.132 
Host is up (0.00029s latency). 
MAC Address: 00:0C:29:65:FC:D2 (VMware) 
Nmap scan report for 172.16.36.180 
Host is up. 
Nmap done: 3 IP addresses (3 hosts up) scanned in 0.31 seconds
</code></pre><h3 id="&#x5DE5;&#x4F5C;&#x539F;&#x7406;">&#x5DE5;&#x4F5C;&#x539F;&#x7406;</h3>
<p>Nmap &#x7528;&#x4E8E;&#x6267;&#x884C; TCP &#x53D1;&#x73B0;&#x7684;&#x6280;&#x672F;&#x7684;&#x57FA;&#x672C;&#x539F;&#x7406;&#xFF0C;&#x4E0E; Scapy &#x7528;&#x4E8E;&#x6267;&#x884C; TCP &#x53D1;&#x73B0;&#x7684;&#x6280;&#x672F;&#x76F8;&#x540C;&#x3002; Nmap &#x5411;&#x76EE;&#x6807;&#x7CFB;&#x7EDF;&#x4E0A;&#x7684;&#x4EFB;&#x610F;&#x7AEF;&#x53E3;&#x53D1;&#x9001;&#x4E00;&#x7CFB;&#x5217; TCP ACK &#x6570;&#x636E;&#x5305;&#xFF0C;&#x5E76;&#x5C1D;&#x8BD5;&#x8BF7;&#x6C42; RST &#x54CD;&#x5E94;&#x4F5C;&#x4E3A;&#x6D3B;&#x52A8;&#x7CFB;&#x7EDF;&#x7684;&#x6807;&#x8BC6;&#x3002; &#x7136;&#x800C;&#xFF0C;Nmap &#x7528;&#x4E8E;&#x6267;&#x884C; UDP &#x53D1;&#x73B0;&#x7684;&#x6280;&#x672F;&#x6709;&#x70B9;&#x4E0D;&#x540C;&#x4E8E; Scapy &#x7684;&#x6280;&#x672F;&#x3002; Nmap &#x4E0D;&#x4EC5;&#x4EC5;&#x4F9D;&#x8D56;&#x4E8E;&#x53EF;&#x80FD;&#x4E0D;&#x4E00;&#x81F4;&#x6216;&#x963B;&#x585E;&#x7684; ICMP &#x4E3B;&#x673A;&#x4E0D;&#x53EF;&#x8FBE;&#x54CD;&#x5E94;&#xFF0C;&#x800C;&#x4E14;&#x901A;&#x8FC7;&#x5411;&#x76EE;&#x6807;&#x7AEF;&#x53E3;&#x53D1;&#x9001;&#x670D;&#x52A1;&#x7279;&#x5B9A;&#x8BF7;&#x6C42;&#xFF0C;&#x5C1D;&#x8BD5;&#x8BF7;&#x6C42;&#x54CD;&#x5E94;&#xFF0C;&#x6765;&#x6267;&#x884C;&#x4E3B;&#x673A;&#x53D1;&#x73B0;&#x3002;</p>
<h2 id="213-&#x4F7F;&#x7528;-hping3-&#x6765;&#x63A2;&#x7D22;&#x7B2C;&#x56DB;&#x5C42;">2.13 &#x4F7F;&#x7528; hping3 &#x6765;&#x63A2;&#x7D22;&#x7B2C;&#x56DB;&#x5C42;</h2>
<p>&#x6211;&#x4EEC;&#x4E4B;&#x524D;&#x8BA8;&#x8BBA;&#x8FC7;&#xFF0C;&#x4F7F;&#x7528;<code>hping3</code>&#x6765;&#x6267;&#x884C;&#x7B2C;3&#x5C42; ICMP &#x53D1;&#x73B0;&#x3002; &#x9664;&#x4E86;&#x6B64;&#x529F;&#x80FD;&#xFF0C;<code>hping3</code>&#x8FD8;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x6267;&#x884C; UDP &#x548C; TCP &#x4E3B;&#x673A;&#x53D1;&#x73B0;&#x3002; &#x7136;&#x800C;&#xFF0C;&#x5982;&#x524D;&#x6240;&#x8FF0;&#xFF0C;<code>hping3</code>&#x88AB;&#x5F00;&#x53D1;&#x7528;&#x4E8E;&#x6267;&#x884C;&#x5B9A;&#x5411;&#x8BF7;&#x6C42;&#xFF0C;&#x5E76;&#x4E14;&#x9700;&#x8981;&#x4E00;&#x4E9B;&#x811A;&#x672C;&#x6765;&#x5C06;&#x5176;&#x7528;&#x4F5C;&#x6709;&#x6548;&#x7684;&#x626B;&#x63CF;&#x5DE5;&#x5177;&#x3002; &#x8FD9;&#x4E2A;&#x79D8;&#x7C4D;&#x6F14;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x4F7F;&#x7528;<code>hping3</code>&#x6765;&#x6267;&#x884C; TCP &#x548C; UDP &#x534F;&#x8BAE;&#x7684;&#x7B2C;4&#x5C42;&#x53D1;&#x73B0;&#x3002;</p>
<h3 id="&#x51C6;&#x5907;">&#x51C6;&#x5907;</h3>
<p>&#x4F7F;&#x7528;<code>hping3</code>&#x6267;&#x884C;&#x7B2C;&#x56DB;&#x5C42;&#x53D1;&#x73B0;&#x4E0D;&#x9700;&#x8981;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#xFF0C;&#x56E0;&#x4E3A; Internet &#x4E0A;&#x7684;&#x8BB8;&#x591A;&#x7CFB;&#x7EDF;&#x90FD;&#x5C06;&#x56DE;&#x590D; TCP &#x548C; UDP &#x8BF7;&#x6C42;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5F3A;&#x70C8;&#x5EFA;&#x8BAE;&#x4F60;&#x53EA;&#x5728;&#x60A8;&#x81EA;&#x5DF1;&#x7684;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x6267;&#x884C;&#x4EFB;&#x4F55;&#x7C7B;&#x578B;&#x7684;&#x7F51;&#x7EDC;&#x626B;&#x63CF;&#xFF0C;&#x9664;&#x975E;&#x4F60;&#x5B8C;&#x5168;&#x719F;&#x6089;&#x60A8;&#x53D7;&#x5230;&#x4EFB;&#x4F55;&#x7BA1;&#x7406;&#x673A;&#x6784;&#x65BD;&#x52A0;&#x7684;&#x6CD5;&#x5F8B;&#x6CD5;&#x89C4;&#x3002;&#x5982;&#x679C;&#x4F60;&#x5E0C;&#x671B;&#x5728;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x6267;&#x884C;&#x6B64;&#x6280;&#x672F;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x54CD;&#x5E94; TCP/UDP &#x8BF7;&#x6C42;&#x7684;&#x7CFB;&#x7EDF;&#x3002;&#x5728;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528; Linux &#x548C; Windows &#x7CFB;&#x7EDF;&#x7684;&#x7EC4;&#x5408;&#x3002;&#x6709;&#x5173;&#x5728;&#x672C;&#x5730;&#x5B9E;&#x9A8C;&#x73AF;&#x5883;&#x4E2D;&#x8BBE;&#x7F6E;&#x7CFB;&#x7EDF;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x4E2D;&#x7684;&#x201C;&#x5B89;&#x88C5; Metasploitable2&#x201D;&#x548C;&#x201C;&#x5B89;&#x88C5; Windows Server&#x201D;&#x79D8;&#x7C4D;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x672C;&#x8282;&#x8FD8;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#xFF08;&#x5982; VIM &#x6216; Nano&#xFF09;&#x5C06;&#x811A;&#x672C;&#x5199;&#x5165;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3002;&#x6709;&#x5173;&#x7F16;&#x5199;&#x811A;&#x672C;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x7B2C;&#x4E00;&#x7AE0;&#x4E2D;&#x7684;&#x201C;&#x4F7F;&#x7528;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#xFF08;VIM &#x548C; Nano&#xFF09;&#x201D;&#x79D8;&#x7C4D;&#x3002;</p>
<h3 id="&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;">&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;</h3>
<p>&#x4E0E; Nmap &#x4E0D;&#x540C;&#xFF0C;<code>hping3</code>&#x901A;&#x8FC7;&#x9694;&#x79BB;&#x4EFB;&#x52A1;&#xFF0C;&#x80FD;&#x591F;&#x8F7B;&#x6613;&#x8BC6;&#x522B;&#x80FD;&#x591F;&#x4F7F;&#x7528; UDP &#x63A2;&#x9488;&#x53D1;&#x73B0;&#x7684;&#x4E3B;&#x673A;&#x3002; &#x901A;&#x8FC7;&#x4F7F;&#x7528;<code>--udp</code>&#x9009;&#x9879;&#x6307;&#x5B9A; UDP &#x6A21;&#x5F0F;&#xFF0C;&#x53EF;&#x4EE5;&#x4F20;&#x8F93; UDP &#x63A2;&#x9488;&#x6765;&#x5C1D;&#x8BD5;&#x89E6;&#x53D1;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x7684;&#x56DE;&#x590D;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# hping3 --udp 172.16.36.132 
HPING 172.16.36.132 (eth1 172.16.36.132): udp mode set, 28 headers + 0 data bytes 
ICMP Port Unreachable from ip=172.16.36.132 name=UNKNOWN   status=0 port=2792 seq=0 
ICMP Port Unreachable from ip=172.16.36.132 name=UNKNOWN   status=0 port=2793 seq=1 
ICMP Port Unreachable from ip=172.16.36.132 name=UNKNOWN   status=0 port=2794 seq=2 ^F
ICMP Port Unreachable from ip=172.16.36.132 name=UNKNOWN   status=0 port=2795 seq=3 
^C 
--- 172.16.36.132 hping statistic --
4 packets transmitted, 4 packets received, 0% packet loss 
round-trip min/avg/max = 1.8/29.9/113.4 ms
</code></pre><p>&#x5728;&#x63D0;&#x4F9B;&#x7684;&#x6F14;&#x793A;&#x4E2D;&#xFF0C;<code>Ctrl + C</code>&#x7528;&#x4E8E;&#x505C;&#x6B62;&#x8FDB;&#x7A0B;&#x3002;&#x5728; UDP &#x6A21;&#x5F0F;&#x4E0B;&#x4F7F;&#x7528;<code>hping3</code>&#x65F6;&#xFF0C;&#x9664;&#x975E;&#x5728;&#x521D;&#x59CB;&#x547D;&#x4EE4;&#x4E2D;&#x5B9A;&#x4E49;&#x4E86;&#x7279;&#x5B9A;&#x6570;&#x91CF;&#x7684;&#x6570;&#x636E;&#x5305;&#xFF0C;&#x5426;&#x5219;&#x5C06;&#x65E0;&#x9650;&#x7EE7;&#x7EED;&#x53D1;&#x73B0;&#x3002; &#x4E3A;&#x4E86;&#x5B9A;&#x4E49;&#x8981;&#x53D1;&#x9001;&#x7684;&#x5C1D;&#x8BD5;&#x6B21;&#x6570;&#xFF0C;&#x5E94;&#x5305;&#x542B;<code>-c</code>&#x9009;&#x9879;&#x548C;&#x4E00;&#x4E2A;&#x8868;&#x793A;&#x6240;&#x9700;&#x5C1D;&#x8BD5;&#x6B21;&#x6570;&#x7684;&#x6574;&#x6570;&#x503C;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# hping3 --udp 172.16.36.132 -c 1 
HPING 172.16.36.132 (eth1 172.16.36.132): udp mode set, 28 headers + 0 data bytes 
ICMP Port Unreachable from ip=172.16.36.132 name=UNKNOWN   status=0 port=2422 seq=0

--- 172.16.36.132 hping statistic --
1 packets transmitted, 1 packets received, 0% packet loss 
round-trip min/avg/max = 104.8/104.8/104.8 ms
</code></pre><p>&#x867D;&#x7136;<code>hping3</code>&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x4E0D;&#x652F;&#x6301;&#x626B;&#x63CF;&#x591A;&#x4E2A;&#x7CFB;&#x7EDF;&#xFF0C;&#x4F46;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; bash &#x811A;&#x672C;&#x8F7B;&#x6613;&#x7F16;&#x5199;&#x811A;&#x672C;&#x3002; &#x4E3A;&#x4E86;&#x505A;&#x5230;&#x8FD9;&#x4E00;&#x70B9;&#xFF0C;&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x9996;&#x5148;&#x786E;&#x5B9A;&#x4E0E;&#x6D3B;&#x52A8;&#x5730;&#x5740;&#x76F8;&#x5173;&#x7684;&#x8F93;&#x51FA;&#xFF0C;&#x4EE5;&#x53CA;&#x4E0E;&#x975E;&#x54CD;&#x5E94;&#x5730;&#x5740;&#x76F8;&#x5173;&#x7684;&#x8F93;&#x51FA;&#x4E4B;&#x95F4;&#x7684;&#x533A;&#x522B;&#x3002; &#x4E3A;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x5728;&#x672A;&#x5206;&#x914D;&#x4E3B;&#x673A;&#x7684; IP &#x5730;&#x5740;&#x4E0A;&#x4F7F;&#x7528;&#x76F8;&#x540C;&#x7684;&#x547D;&#x4EE4;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# hping3 --udp 172.16.36.131 -c 1 
HPING 172.16.36.131 (eth1 172.16.36.131): udp mode set, 28 headers + 0 data bytes
--- 172.16.36.131 hping statistic 
--1 packets transmitted, 0 packets received, 100% packet loss 
round-trip min/avg/max = 0.0/0.0/0.0 ms
</code></pre><p>&#x901A;&#x8FC7;&#x8BC6;&#x522B;&#x8FD9;&#x4E9B;&#x8BF7;&#x6C42;&#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x7684;&#x76F8;&#x5173;&#x54CD;&#x5E94;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x786E;&#x5B9A;&#x51FA;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;<code>grep</code>&#x7684;&#x552F;&#x4E00;&#x5B57;&#x7B26;&#x4E32;; &#x6B64;&#x5B57;&#x7B26;&#x4E32;&#x80FD;&#x591F;&#x9694;&#x79BB;&#x6210;&#x529F;&#x7684;&#x53D1;&#x73B0;&#x5C1D;&#x8BD5;&#x4E0E;&#x5931;&#x8D25;&#x7684;&#x53D1;&#x73B0;&#x5C1D;&#x8BD5;&#x3002; &#x5728;&#x4EE5;&#x524D;&#x7684;&#x8BF7;&#x6C42;&#x4E2D;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x5DF2;&#x7ECF;&#x6CE8;&#x610F;&#x5230;&#xFF0C;&#x201C;ICMP &#x7AEF;&#x53E3;&#x4E0D;&#x53EF;&#x8FBE;&#x201D;&#x7684;&#x77ED;&#x8BED;&#x4EC5;&#x5728;&#x8FD4;&#x56DE;&#x54CD;&#x5E94;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x663E;&#x793A;&#x3002; &#x57FA;&#x4E8E;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5BF9;<code>Unreachable</code>&#x8FDB;&#x884C;<code>grep</code>&#x6765;&#x63D0;&#x53D6;&#x6210;&#x529F;&#x7684;&#x5C1D;&#x8BD5;&#x3002; &#x4E3A;&#x4E86;&#x786E;&#x5B9A;&#x6B64;&#x65B9;&#x6CD5;&#x5728;&#x811A;&#x672C;&#x4E2D;&#x7684;&#x6709;&#x6548;&#x6027;&#xFF0C;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x5C1D;&#x8BD5;&#x8FDE;&#x63A5;&#x4E24;&#x4E2A;&#x5148;&#x524D;&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x8F93;&#x51FA;&#x4F20;&#x9012;&#x7ED9;&#x6211;&#x4EEC;&#x7684;<code>grep</code>&#x51FD;&#x6570;&#x3002; &#x5047;&#x8BBE;&#x6211;&#x4EEC;&#x9009;&#x62E9;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5BF9;&#x4E8E;&#x6210;&#x529F;&#x7684;&#x5C1D;&#x8BD5;&#x662F;&#x552F;&#x4E00;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x53EA;&#x770B;&#x5230;&#x4E0E;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x76F8;&#x5173;&#x7684;&#x8F93;&#x51FA;&#xFF1A;</p>
<pre><code>root@KaliLiniux:~# hping3 --udp 172.16.36.132 -c 1; hping3 --udp 172.16.36.131 -c 1 | grep &quot;Unreachable&quot;HPING 172.16.36.132 (eth1 172.16.36.132): udp mode set, 28 headers + 0 data bytes 
ICMP Port Unreachable from ip=172.16.36.132 name=UNKNOWN   status=0 port=2836 seq=0

--- 172.16.36.132 hping statistic --
1 packets transmitted, 1 packets received, 0% packet loss 
round-trip min/avg/max = 115.2/115.2/115.2 ms
--- 172.16.36.131 hping statistic --
1 packets transmitted, 0 packets received, 100% packet loss 
round-trip min/avg/max = 0.0/0.0/0.0 ms
</code></pre><p>&#x5C3D;&#x7BA1;&#x4EA7;&#x751F;&#x4E86;&#x671F;&#x671B;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;<code>grep</code>&#x51FD;&#x6570;&#x4F3C;&#x4E4E;&#x4E0D;&#x80FD;&#x6709;&#x6548;&#x7528;&#x4E8E;&#x8F93;&#x51FA;&#x3002; &#x7531;&#x4E8E;<code>hping3</code>&#x4E2D;&#x7684;&#x8F93;&#x51FA;&#x663E;&#x793A;&#x5904;&#x7406;&#xFF0C;&#x5B83;&#x96BE;&#x4EE5;&#x901A;&#x8FC7;&#x7BA1;&#x9053;&#x4F20;&#x9012;&#x5230;<code>grep</code>&#x51FD;&#x6570;&#xFF0C;&#x5E76;&#x53EA;&#x63D0;&#x53D6;&#x6240;&#x9700;&#x7684;&#x884C;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x901A;&#x8FC7;&#x5176;&#x4ED6;&#x65B9;&#x5F0F;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x3002; &#x5177;&#x4F53;&#x6765;&#x8BF4;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x5C1D;&#x8BD5;&#x786E;&#x5B9A;&#x8F93;&#x51FA;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4ECE;&#x6587;&#x4EF6;&#x4E2D;<code>grep</code>&#x3002; &#x4E3A;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x5C1D;&#x8BD5;&#x5C06;&#x5148;&#x524D;&#x4F7F;&#x7528;&#x7684;&#x4E24;&#x4E2A;&#x547D;&#x4EE4;&#x7684;&#x8F93;&#x51FA;&#x4F20;&#x9012;&#x7ED9;<code>handle.txt</code>&#x6587;&#x4EF6;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# hping3 --udp 172.16.36.132 -c 1 &gt;&gt; handle.txt

--- 172.16.36.132 hping statistic --
1 packets transmitted, 1 packets received, 0% packet loss 
round-trip min/avg/max = 28.6/28.6/28.6 ms 
root@KaliLinux:~# hping3 --udp 172.16.36.131 -c 1 &gt;&gt; handle.txt

--- 172.16.36.131 hping statistic --
1 packets transmitted, 0 packets received, 100% packet loss 
round-trip min/avg/max = 0.0/0.0/0.0 ms 
root@KaliLinux:~# ls Desktop  handle.txt 
root@KaliLinux:~# cat handle.txt 
HPING 172.16.36.132 (eth1 172.16.36.132): udp mode set, 28 headers + 0 data bytes 
ICMP Port Unreachable from ip=172.16.36.132 name=UNKNOWN   status=0 port=2121 seq=0 
HPING 172.16.36.131 (eth1 172.16.36.131): udp mode set, 28 headers + 0 data bytes
</code></pre><p>&#x867D;&#x7136;&#x8FD9;&#x79CD;&#x5C1D;&#x8BD5;&#x5E76;&#x4E0D;&#x5B8C;&#x5168;&#x6210;&#x529F;&#xFF0C;&#x56E0;&#x4E3A;&#x8F93;&#x51FA;&#x6CA1;&#x6709;&#x5B8C;&#x5168;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x6587;&#x4EF6;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x901A;&#x8FC7;&#x8BFB;&#x53D6;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x8F93;&#x51FA;&#xFF0C;&#x8DB3;&#x4EE5;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6709;&#x6548;&#x7684;&#x811A;&#x672C;&#x3002; &#x5177;&#x4F53;&#x6765;&#x8BF4;&#xFF0C;&#x6211;&#x4EEC;&#x80FD;&#x591F;&#x91CD;&#x5B9A;&#x5411;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x7684;&#x884C;&#xFF0C;&#x8BE5;&#x884C;&#x53EA;&#x4E0E;&#x6210;&#x529F;&#x7684;<code>ping</code>&#x5C1D;&#x8BD5;&#x76F8;&#x5173;&#x8054;&#xFF0C;&#x5E76;&#x4E14;&#x5305;&#x542B;&#x8BE5;&#x884C;&#x4E2D;&#x76F8;&#x5E94;&#x7684; IP &#x5730;&#x5740;&#x3002; &#x8981;&#x9A8C;&#x8BC1;&#x6B64;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#x662F;&#x5426;&#x53EF;&#x884C;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5C1D;&#x8BD5;&#x5FAA;&#x73AF;&#x8BBF;&#x95EE;<code>/ 24</code>&#x8303;&#x56F4;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x5730;&#x5740;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x7ED3;&#x679C;&#x4F20;&#x9012;&#x5230;<code>handle.txt</code>&#x6587;&#x4EF6;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# for addr in $(seq 1 254); do hping3 --udp 172.16.36.$addr -c 1 &gt;&gt; handle.txt; done
--- 172.16.36.1 hping statistic --
1 packets transmitted, 0 packets received, 100% packet loss 
round-trip min/avg/max = 0.0/0.0/0.0 ms

--- 172.16.36.2 hping statistic --
1 packets transmitted, 0 packets received, 100% packet loss 
round-trip min/avg/max = 0.0/0.0/0.0 ms
--- 172.16.36.3 hping statistic --
1 packets transmitted, 0 packets received, 100% packet loss 
round-trip min/avg/max = 0.0/0.0/0.0 ms
</code></pre><p>&#x901A;&#x8FC7;&#x8FD9;&#x6837;&#x505A;&#xFF0C;&#x4ECD;&#x7136;&#x6709;&#x5927;&#x91CF;&#x7684;&#x8F93;&#x51FA;&#xFF08;&#x63D0;&#x4F9B;&#x7684;&#x8F93;&#x51FA;&#x4E3A;&#x4E86;&#x65B9;&#x4FBF;&#x800C;&#x88AB;&#x622A;&#x65AD;&#xFF09;&#x5305;&#x542B;&#x672A;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x6587;&#x4EF6;&#x7684;&#x8F93;&#x51FA;&#x3002; &#x4F46;&#x662F;&#xFF0C;&#x4EE5;&#x4E0B;&#x811A;&#x672C;&#x7684;&#x6210;&#x529F;&#x4E0D;&#x53D6;&#x51B3;&#x4E8E;&#x521D;&#x59CB;&#x5FAA;&#x73AF;&#x7684;&#x8FC7;&#x591A;&#x8F93;&#x51FA;&#xFF0C;&#x800C;&#x662F;&#x53D6;&#x51B3;&#x4E8E;&#x4ECE;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x4E2D;&#x63D0;&#x53D6;&#x5FC5;&#x8981;&#x4FE1;&#x606F;&#x7684;&#x80FD;&#x529B;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ls 
Desktop  handle.txt 
root@KaliLinux:~# grep Unreachable handle.txt 
ICMP Port Unreachable from ip=172.16.36.132 HPING 172.16.36.133 (eth1 172.16.36.133): udp mode set, 28 headers + 0 data bytes 
ICMP Port Unreachable from ip=172.16.36.135 HPING 172.16.36.136 (eth1 172.16.36.136): udp mode set, 28 headers + 0 data bytes
</code></pre><p>&#x5B8C;&#x6210;&#x626B;&#x63CF;&#x5FAA;&#x73AF;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>ls</code>&#x547D;&#x4EE4;&#x5728;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x4E2D;&#x786E;&#x5B9A;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4ECE;&#x6B64;&#x6587;&#x4EF6;&#x4E2D;&#x5BF9;<code>Unreachable</code>&#x7684;&#x552F;&#x4E00;&#x5B57;&#x7B26;&#x4E32;&#x8FDB;&#x884C;<code>grep</code>&#xFF0C;&#x5982;&#x4E0B;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#x6240;&#x793A;&#x3002; &#x5728;&#x8F93;&#x51FA;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x5217;&#x51FA;&#x4E86;&#x901A;&#x8FC7; UDP &#x63A2;&#x6D4B;&#x53D1;&#x73B0;&#x7684;&#x6BCF;&#x4E2A;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x3002; &#x6B64;&#x65F6;&#xFF0C;&#x5269;&#x4E0B;&#x7684;&#x552F;&#x4E00;&#x4EFB;&#x52A1;&#x662F;&#x4ECE;&#x6B64;&#x8F93;&#x51FA;&#x4E2D;&#x63D0;&#x53D6; IP &#x5730;&#x5740;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x6B64;&#x6574;&#x4E2A;&#x8FC7;&#x7A0B;&#x91CD;&#x65B0;&#x521B;&#x5EFA;&#x4E3A;&#x5355;&#x4E2A;&#x529F;&#x80FD;&#x811A;&#x672C;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# grep Unreachable handle.txt 
ICMP Port Unreachable from ip=172.16.36.132 
HPING 172.16.36.133 (eth1 172.16.36.133): udp mode set, 28 headers + 0 data bytes 
ICMP Port Unreachable from ip=172.16.36.135 
HPING 172.16.36.136 (eth1 172.16.36.136): udp mode set, 28 headers + 0 data bytes 
root@KaliLinux:~# grep Unreachable handle.txt | cut -d &quot; &quot; -f 5 ip=172.16.36.132 ip=172.16.36.135 
root@KaliLinux:~# grep Unreachable handle.txt | cut -d &quot; &quot; -f 5 | cut -d &quot;=&quot; -f 2 172.16.36.132 172.16.36.135
</code></pre><p>&#x901A;&#x8FC7;&#x5C06;&#x8F93;&#x51FA;&#x4F7F;&#x7528;&#x7BA1;&#x9053;&#x8FDE;&#x63A5;&#x5230;&#x4E00;&#x7CFB;&#x5217;<code>cut</code>&#x51FD;&#x6570;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4ECE;&#x8F93;&#x51FA;&#x4E2D;&#x63D0;&#x53D6; IP &#x5730;&#x5740;&#x3002; &#x73B0;&#x5728;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x6210;&#x529F;&#x5730;&#x786E;&#x5B9A;&#x4E86;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#xFF0C;&#x6765;&#x626B;&#x63CF;&#x591A;&#x4E2A;&#x4E3B;&#x673A;&#x5E76;&#x8F7B;&#x6613;&#x8BC6;&#x522B;&#x7ED3;&#x679C;&#xFF0C;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x5C06;&#x5176;&#x96C6;&#x6210;&#x5230;&#x4E00;&#x4E2A;&#x811A;&#x672C;&#x4E2D;&#x3002; &#x5C06;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;&#x7EC4;&#x5408;&#x5728;&#x4E00;&#x8D77;&#x7684;&#x529F;&#x80FD;&#x811A;&#x672C;&#x7684;&#x793A;&#x4F8B;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-sh"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$#</span>&quot;</span> <span class="hljs-_">-ne</span> 1 ]; <span class="hljs-keyword">then</span> 
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Usage - ./udp_sweep.sh [/24 network address]&quot;</span> 
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Example - ./udp_sweep.sh 172.16.36.0&quot;</span> 
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Example will perform a UDP ping sweep of the 172.16.36.0/24 network and output to an output.txt file&quot;</span> 
    <span class="hljs-built_in">exit</span> 
<span class="hljs-keyword">fi</span>

prefix=$(<span class="hljs-built_in">echo</span> <span class="hljs-variable">$1</span> | cut <span class="hljs-_">-d</span> <span class="hljs-string">&apos;.&apos;</span> <span class="hljs-_">-f</span> 1-3)

<span class="hljs-keyword">for</span> addr <span class="hljs-keyword">in</span> $(seq 1 254); <span class="hljs-keyword">do</span> 
    hping3 <span class="hljs-variable">$prefix</span>.<span class="hljs-variable">$addr</span> --udp -c 1 &gt;&gt; handle.txt; 
<span class="hljs-keyword">done</span>

grep Unreachable handle.txt | cut <span class="hljs-_">-d</span> <span class="hljs-string">&quot; &quot;</span> <span class="hljs-_">-f</span> 5 | cut <span class="hljs-_">-d</span> <span class="hljs-string">&quot;=&quot;</span> <span class="hljs-_">-f</span> 2 &gt;&gt; output.txt 
rm handle.txt
</code></pre>
<p>&#x5728;&#x63D0;&#x4F9B;&#x7684; bash &#x811A;&#x672C;&#x4E2D;&#xFF0C;&#x7B2C;&#x4E00;&#x884C;&#x5B9A;&#x4E49;&#x4E86; bash &#x89E3;&#x91CA;&#x5668;&#x7684;&#x4F4D;&#x7F6E;&#x3002; &#x63A5;&#x4E0B;&#x6765;&#x7684;&#x4EE3;&#x7801;&#x5757;&#x6267;&#x884C;&#x6D4B;&#x8BD5;&#x6765;&#x786E;&#x5B9A;&#x662F;&#x5426;&#x63D0;&#x4F9B;&#x4E86;&#x9884;&#x671F;&#x7684;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x3002; &#x8FD9;&#x901A;&#x8FC7;&#x8BC4;&#x4F30;&#x63D0;&#x4F9B;&#x7684;&#x53C2;&#x6570;&#x7684;&#x6570;&#x91CF;&#x662F;&#x5426;&#x4E0D;&#x7B49;&#x4E8E; 1 &#x6765;&#x786E;&#x5B9A;&#x3002;&#x5982;&#x679C;&#x672A;&#x63D0;&#x4F9B;&#x9884;&#x671F;&#x53C2;&#x6570;&#xFF0C;&#x5219;&#x8F93;&#x51FA;&#x811A;&#x672C;&#x7684;&#x7528;&#x6CD5;&#xFF0C;&#x5E76;&#x4E14;&#x9000;&#x51FA;&#x811A;&#x672C;&#x3002; &#x7528;&#x6CD5;&#x8F93;&#x51FA;&#x8868;&#x660E;&#xFF0C;&#x811A;&#x672C;&#x9700;&#x8981;&#x63A5;&#x53D7;<code>/ 24</code>&#x7F51;&#x7EDC;&#x5730;&#x5740;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x3002; &#x4E0B;&#x4E00;&#x884C;&#x4EE3;&#x7801;&#x4ECE;&#x63D0;&#x4F9B;&#x7684;&#x7F51;&#x7EDC;&#x5730;&#x5740;&#x4E2D;&#x63D0;&#x53D6;&#x7F51;&#x7EDC;&#x524D;&#x7F00;&#x3002; &#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x63D0;&#x4F9B;&#x7684;&#x7F51;&#x7EDC;&#x5730;&#x5740;&#x662F;<code>192.168.11.0</code>&#xFF0C;&#x5219;&#x524D;&#x7F00;&#x53D8;&#x91CF;&#x5C06;&#x88AB;&#x8D4B;&#x503C;&#x4E3A;<code>192.168.11</code>&#x3002; &#x7136;&#x540E;&#x5BF9;<code>/ 24</code>&#x8303;&#x56F4;&#x5185;&#x7684;&#x6BCF;&#x4E2A;&#x5730;&#x5740;&#x6267;&#x884C;<code>hping3</code>&#x64CD;&#x4F5C;&#xFF0C;&#x5E76;&#x5C06;&#x6BCF;&#x4E2A;&#x4EFB;&#x52A1;&#x7684;&#x7ED3;&#x679C;&#x8F93;&#x51FA;&#x653E;&#x5165;<code>handle.txt</code>&#x6587;&#x4EF6;&#x4E2D;&#x3002;</p>
<pre><code>root@KaliLinux:~# ./udp_sweep.sh 
Usage - ./udp_sweep.sh [/24 network address] 
Example - ./udp_sweep.sh 172.16.36.0 
Example will perform a UDP ping sweep of the 172.16.36.0/24 network and output to an output.txt file
root@KaliLinux:~# ./udp_sweep.sh 172.16.36.0
--- 172.16.36.1 hping statistic --
1 packets transmitted, 0 packets received, 100% packet loss 
round-trip min/avg/max = 0.0/0.0/0.0 ms
--- 172.16.36.2 hping statistic --
1 packets transmitted, 0 packets received, 100% packet loss 
round-trip min/avg/max = 0.0/0.0/0.0 ms
--- 172.16.36.3 hping statistic --
1 packets transmitted, 0 packets received, 100% packet loss 
round-trip min/avg/max = 0.0/0.0/0.0 ms
                *** {TRUNCATED} ***
root@KaliLinux:~# ls output.txt 
output.txt 
root@KaliLinux:~# cat output.txt 
172.16.36.132 
172.16.36.135 
172.16.36.253
</code></pre><p>&#x5F53;&#x811A;&#x672C;&#x8FD0;&#x884C;&#x65F6;&#xFF0C;&#x4F60;&#x4ECD;&#x7136;&#x4F1A;&#x770B;&#x5230;&#x5728;&#x521D;&#x59CB;&#x5FAA;&#x73AF;&#x4EFB;&#x52A1;&#x65F6;&#x770B;&#x5230;&#x7684;&#x5927;&#x91CF;&#x8F93;&#x51FA;&#x3002; &#x5E78;&#x8FD0;&#x7684;&#x662F;&#xFF0C;&#x4F60;&#x53D1;&#x73B0;&#x7684;&#x4E3B;&#x673A;&#x5217;&#x8868;&#x4E0D;&#x4F1A;&#x5728;&#x6B64;&#x8F93;&#x51FA;&#x4E2D;&#x6D88;&#x5931;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x6BCF;&#x6B21;&#x90FD;&#x4F1A;&#x5199;&#x5165;&#x4F60;&#x7684;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x3002;</p>
<p>&#x4F60;&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>hping3</code>&#x6267;&#x884C; TCP &#x53D1;&#x73B0;&#x3002; TCP &#x6A21;&#x5F0F;&#x5B9E;&#x9645;&#x4E0A;&#x662F;<code>hping3</code>&#x4F7F;&#x7528;&#x7684;&#x9ED8;&#x8BA4;&#x53D1;&#x73B0;&#x6A21;&#x5F0F;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5C06;&#x8981;&#x626B;&#x63CF;&#x7684; IP &#x5730;&#x5740;&#x4F20;&#x9012;&#x5230;<code>hping3</code>&#x6765;&#x4F7F;&#x7528;&#x6B64;&#x6A21;&#x5F0F;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# hping3 172.16.36.132 
HPING 172.16.36.132 (eth1 172.16.36.132): NO FLAGS are set, 40 headers + 0 data bytes 
len=46 ip=172.16.36.132 ttl=64 DF id=0 sport=0 flags=RA seq=0 win=0 rtt=3.7 ms 
len=46 ip=172.16.36.132 ttl=64 DF id=0 sport=0 flags=RA seq=1 win=0 rtt=0.7 ms 
len=46 ip=172.16.36.132 ttl=64 DF id=0 sport=0 flags=RA seq=2 win=0 rtt=2.6 ms 
^C 
--- 172.16.36.132 hping statistic --
3 packets transmitted, 3 packets received, 0% packet loss 
round-trip min/avg/max = 0.7/2.3/3.7 ms
</code></pre><p>&#x6211;&#x4EEC;&#x4E4B;&#x524D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;bash&#x811A;&#x672C;&#x5FAA;&#x73AF;&#x8BBF;&#x95EE;<code>/ 24</code>&#x7F51;&#x7EDC;&#x5E76;&#x4F7F;&#x7528;<code>hping3</code>&#x6267;&#x884C; UDP &#x53D1;&#x73B0;&#xFF0C;&#x4E0E;&#x4E4B;&#x76F8;&#x4F3C;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4E3A; TCP &#x53D1;&#x73B0;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7C7B;&#x4F3C;&#x7684;&#x811A;&#x672C;&#x3002; &#x9996;&#x5148;&#xFF0C;&#x5FC5;&#x987B;&#x786E;&#x5B9A;&#x552F;&#x4E00;&#x77ED;&#x8BED;&#xFF0C;&#x5B83;&#x5B58;&#x5728;&#x4E8E;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x7684;&#x76F8;&#x5173;&#x8F93;&#x51FA;&#x4E2D;&#xFF0C;&#x4F46;&#x4E0D;&#x5728;&#x975E;&#x54CD;&#x5E94;&#x4E3B;&#x673A;&#x7684;&#x76F8;&#x5173;&#x8F93;&#x51FA;&#x4E2D;&#x3002; &#x4E3A;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x8BC4;&#x4F30;&#x6BCF;&#x4E2A;&#x54CD;&#x5E94;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# hping3 172.16.36.132 -c 1 
HPING 172.16.36.132 (eth1 172.16.36.132): NO FLAGS are set, 40 headers + 0 data bytes 
len=46 ip=172.16.36.132 ttl=64 DF id=0 sport=0 flags=RA seq=0 win=0 rtt=3.4 ms
--- 172.16.36.132 hping statistic --
1 packets transmitted, 1 packets received, 0% packet loss 
round-trip min/avg/max = 3.4/3.4/3.4 ms 
root@KaliLinux:~# hping3 172.16.36.131 -c 1 
HPING 172.16.36.131 (eth1 172.16.36.131): NO FLAGS are set, 40 headers + 0 data bytes
--- 172.16.36.131 hping statistic --
1 packets transmitted, 0 packets received, 100% packet loss 
round-trip min/avg/max = 0.0/0.0/0.0 ms
</code></pre><p>&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x957F;&#x5EA6;&#x503C;&#x4EC5;&#x5B58;&#x5728;&#x4E8E;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x7684;&#x76F8;&#x5173;&#x8F93;&#x51FA;&#x4E2D;&#x3002; &#x518D;&#x4E00;&#x6B21;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5F00;&#x53D1;&#x4E00;&#x4E2A;&#x811A;&#x672C;&#xFF0C;&#x5C06;&#x8F93;&#x51FA;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x4E34;&#x65F6;<code>handle</code>&#x6587;&#x4EF6;&#xFF0C;&#x7136;&#x540E;<code>grep</code>&#x6B64;&#x6587;&#x4EF6;&#x7684;&#x8F93;&#x51FA;&#x6765;&#x786E;&#x5B9A;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#xFF1A;</p>
<pre><code class="lang-sh"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$#</span>&quot;</span> <span class="hljs-_">-ne</span> 1 ]; <span class="hljs-keyword">then</span> 
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Usage - ./tcp_sweep.sh [/24 network address]&quot;</span> 
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Example - ./tcp_sweep.sh 172.16.36.0&quot;</span> 
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Example will perform a TCP ping sweep of the 172.16.36.0/24 network and output to an output.txt file&quot;</span> 
    <span class="hljs-built_in">exit</span> 
<span class="hljs-keyword">fi</span>

prefix=$(<span class="hljs-built_in">echo</span> <span class="hljs-variable">$1</span> | cut <span class="hljs-_">-d</span> <span class="hljs-string">&apos;.&apos;</span> <span class="hljs-_">-f</span> 1-3)

<span class="hljs-keyword">for</span> addr <span class="hljs-keyword">in</span> $(seq 1 254); <span class="hljs-keyword">do</span> 
    hping3 <span class="hljs-variable">$prefix</span>.<span class="hljs-variable">$addr</span> -c 1 &gt;&gt; handle.txt; 
<span class="hljs-keyword">done</span>

grep len handle.txt | cut <span class="hljs-_">-d</span> <span class="hljs-string">&quot; &quot;</span> <span class="hljs-_">-f</span> 2 | cut <span class="hljs-_">-d</span> <span class="hljs-string">&quot;=&quot;</span> <span class="hljs-_">-f</span> 2 &gt;&gt; output.txt
 rm handle.txt
</code></pre>
<p>&#x6B64;&#x811A;&#x672C;&#x7684;&#x6267;&#x884C;&#x65B9;&#x5F0F;&#x7C7B;&#x4F3C;&#x4E8E; UDP &#x53D1;&#x73B0;&#x811A;&#x672C;&#x3002; &#x552F;&#x4E00;&#x7684;&#x533A;&#x522B;&#x662F;&#x5728;&#x5FAA;&#x73AF;&#x5E8F;&#x5217;&#x4E2D;&#x6267;&#x884C;&#x7684;&#x547D;&#x4EE4;&#xFF0C;<code>grep</code>&#x503C;&#x548C;&#x63D0;&#x53D6; IP &#x5730;&#x5740;&#x7684;&#x8FC7;&#x7A0B;&#x3002; &#x6267;&#x884C;&#x540E;&#xFF0C;&#x6B64;&#x811A;&#x672C;&#x5C06;&#x751F;&#x6210;&#x4E00;&#x4E2A;<code>output.txt</code>&#x6587;&#x4EF6;&#xFF0C;&#x5176;&#x4E2D;&#x5C06;&#x5305;&#x542B;&#x4F7F;&#x7528; TCP &#x53D1;&#x73B0;&#x65B9;&#x5F0F;&#x6765;&#x53D1;&#x73B0;&#x7684;&#x4E3B;&#x673A;&#x7684;&#x76F8;&#x5173; IP &#x5730;&#x5740;&#x5217;&#x8868;&#x3002;</p>
<pre><code>root@KaliLinux:~# ./tcp_sweep.sh 
Usage - ./tcp_sweep.sh [/24 network address] 
Example - ./tcp_sweep.sh 172.16.36.0 
Example will perform a TCP ping sweep of the 172.16.36.0/24 network and output to an output.txt file 
root@KaliLinux:~# ./tcp_sweep.sh 172.16.36.0
--- 172.16.36.1 hping statistic --
1 packets transmitted, 1 packets received, 0% packet loss 
round-trip min/avg/max = 0.4/0.4/0.4 ms
--- 172.16.36.2 hping statistic --
1 packets transmitted, 1 packets received, 0% packet loss 
round-trip min/avg/max = 0.6/0.6/0.6 ms
--- 172.16.36.3 hping statistic --
1 packets transmitted, 0 packets received, 100% packet loss 
round-trip min/avg/max = 0.0/0.0/0.0 ms
                    *** {TRUNCATED} ***
</code></pre><p>&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>ls</code>&#x547D;&#x4EE4;&#x786E;&#x8BA4;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x5DF2;&#x5199;&#x5165;&#x6267;&#x884C;&#x76EE;&#x5F55;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;<code>cat</code>&#x547D;&#x4EE4;&#x8BFB;&#x53D6;&#x5176;&#x5185;&#x5BB9;&#x3002; &#x8FD9;&#x53EF;&#x4EE5;&#x5728;&#x4EE5;&#x4E0B;&#x793A;&#x4F8B;&#x4E2D;&#x770B;&#x5230;&#xFF1A;</p>
<pre><code>root@KaliLinux:~# ls output.txt 
output.txt 
root@KaliLinux:~# cat output.txt 
172.16.36.1 
172.16.36.2 
172.16.36.132 
172.16.36.135 
172.16.36.253
</code></pre><h3 id="&#x5DE5;&#x4F5C;&#x539F;&#x7406;">&#x5DE5;&#x4F5C;&#x539F;&#x7406;</h3>
<p>&#x5728;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;<code>hping3</code>&#x4F7F;&#x7528; ICMP &#x4E3B;&#x673A;&#x4E0D;&#x53EF;&#x8FBE;&#x54CD;&#x5E94;&#xFF0C;&#x6765;&#x6807;&#x8BC6;&#x5177;&#x6709; UDP &#x8BF7;&#x6C42;&#x7684;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;&#x7A7A;&#x6807;&#x5FD7;&#x626B;&#x63CF;&#x6765;&#x6807;&#x8BC6;&#x5177;&#x6709; TCP &#x8BF7;&#x6C42;&#x7684;&#x6D3B;&#x52A8;&#x4E3B;&#x673A;&#x3002; &#x5BF9;&#x4E8E; UDP &#x53D1;&#x73B0;&#xFF0C;&#x4E00;&#x7CFB;&#x5217;&#x7A7A; UDP &#x8BF7;&#x6C42;&#x88AB;&#x53D1;&#x9001;&#x5230;&#x4EFB;&#x610F;&#x76EE;&#x6807;&#x7AEF;&#x53E3;&#xFF0C;&#x6765;&#x8BD5;&#x56FE;&#x8BF7;&#x6C42;&#x54CD;&#x5E94;&#x3002; &#x5BF9;&#x4E8E; TCP &#x53D1;&#x73B0;&#xFF0C;&#x4E00;&#x7CFB;&#x5217; TCP &#x8BF7;&#x6C42;&#x88AB;&#x53D1;&#x9001;&#x5230;&#x76EE;&#x7684;&#x7AEF;&#x53E3; 0&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x6FC0;&#x6D3B;&#x6807;&#x5FD7;&#x4F4D;&#x3002; &#x6240;&#x63D0;&#x4F9B;&#x7684;&#x793A;&#x4F8B;&#x8BF7;&#x6C42;&#x6FC0;&#x6D3B;&#x4E86; ACK + RST &#x6807;&#x5FD7;&#x7684;&#x54CD;&#x5E94;&#x3002; &#x8FD9;&#x4E9B;&#x4EFB;&#x52A1;&#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x90FD;&#x4F20;&#x9012;&#x7ED9;&#x4E86; bash &#x4E2D;&#x7684;&#x5FAA;&#x73AF;&#xFF0C;&#x6765;&#x5728;&#x591A;&#x4E2A;&#x4E3B;&#x673A;&#x6216;&#x4E00;&#x7CFB;&#x5217;&#x5730;&#x5740;&#x4E0A;&#x6267;&#x884C;&#x626B;&#x63CF;&#x3002;</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="ch1.html" class="navigation navigation-prev " aria-label="Previous page: 第一章 起步">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="ch3.html" class="navigation navigation-next " aria-label="Next page: 第三章 端口扫描">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"第二章 探索扫描","level":"1.3","depth":1,"next":{"title":"第三章 端口扫描","level":"1.4","depth":1,"path":"ch3.md","ref":"ch3.md","articles":[]},"previous":{"title":"第一章 起步","level":"1.2","depth":1,"path":"ch1.md","ref":"ch1.md","articles":[]},"dir":"ltr"},"config":{"plugins":["comment"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"comment":{"highlightCommented":true},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"wizardforcel","pdf":{"pageNumbers":true,"fontSize":16,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Kali Linux 网络扫描秘籍","language":"zh","links":{"sidebar":{"Kali Linux 网络扫描秘籍":"https://www.gitbook.com/book/wizardforcel/kali-linux-network-scanning-cookbook"},"gitbook":true},"gitbook":"*","description":"Kali Linux Network Scanning Cookbook 中文版"},"file":{"path":"ch2.md","mtime":"2016-11-25T09:44:31.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2016-11-26T04:32:05.478Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-comment/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

