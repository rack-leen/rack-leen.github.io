
<!DOCTYPE HTML>
<html lang="zh" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Windoes 16-bit · 逆向工程入门指南</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        <meta name="author" content="wizardforcel">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-comment/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../Part-IV/part4.html" />
    
    
    <link rel="prev" href="Chapter-52.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="輸入並搜尋" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://www.gitbook.com/book/wizardforcel/re-for-beginners" target="_blank" class="custom-link">逆向工程入门指南</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    逆向工程入门指南
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../Part-I/part1.html">
            
                <a href="../Part-I/part1.html">
            
                    
                    Part I 代码模式
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../Part-I/Chapter-01.html">
            
                <a href="../Part-I/Chapter-01.html">
            
                    
                    CPU简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../Part-I/Chapter-02.html">
            
                <a href="../Part-I/Chapter-02.html">
            
                    
                    最简单的函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../Part-I/Chapter-03.html">
            
                <a href="../Part-I/Chapter-03.html">
            
                    
                    Hello,world!
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../Part-I/Chapter-04.html">
            
                <a href="../Part-I/Chapter-04.html">
            
                    
                    函数的开始和结束
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../Part-I/Chapter-05.html">
            
                <a href="../Part-I/Chapter-05.html">
            
                    
                    栈
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../Part-I/Chapter-06.html">
            
                <a href="../Part-I/Chapter-06.html">
            
                    
                    printf()与参数处理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../Part-I/Chapter-07.html">
            
                <a href="../Part-I/Chapter-07.html">
            
                    
                    scanf()
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="../Part-I/Chapter-08.html">
            
                <a href="../Part-I/Chapter-08.html">
            
                    
                    访问实参
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="../Part-I/Chapter-09.html">
            
                <a href="../Part-I/Chapter-09.html">
            
                    
                    一个或者多个字的返回值
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="../Part-I/Chapter-10.html">
            
                <a href="../Part-I/Chapter-10.html">
            
                    
                    指针
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11" data-path="../Part-I/Chapter-11.html">
            
                <a href="../Part-I/Chapter-11.html">
            
                    
                    GOTO操作符
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.12" data-path="../Part-I/Chapter-12.html">
            
                <a href="../Part-I/Chapter-12.html">
            
                    
                    条件转跳
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.13" data-path="../Part-I/Chapter-13.html">
            
                <a href="../Part-I/Chapter-13.html">
            
                    
                    选择结构switch()/case/default
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.14" data-path="../Part-I/Chapter-14.html">
            
                <a href="../Part-I/Chapter-14.html">
            
                    
                    循环
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.15" data-path="../Part-I/Chapter-15.html">
            
                <a href="../Part-I/Chapter-15.html">
            
                    
                    对C-Strings的简单处理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.16" data-path="../Part-I/Chapter-16.html">
            
                <a href="../Part-I/Chapter-16.html">
            
                    
                    用其他东西代替算数操作符
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.17" data-path="../Part-I/Chapter-17.html">
            
                <a href="../Part-I/Chapter-17.html">
            
                    
                    浮点数单元
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.18" data-path="../Part-I/Chapter-18.html">
            
                <a href="../Part-I/Chapter-18.html">
            
                    
                    数组
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.19" data-path="../Part-I/Chapter-19.html">
            
                <a href="../Part-I/Chapter-19.html">
            
                    
                    操纵特定的bit
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.20" data-path="../Part-I/Chapter-20.html">
            
                <a href="../Part-I/Chapter-20.html">
            
                    
                    用线性同余生成器来产生伪随机数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.21" data-path="../Part-I/Chapter-21.html">
            
                <a href="../Part-I/Chapter-21.html">
            
                    
                    结构体
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.22" data-path="../Part-I/Chapter-22.html">
            
                <a href="../Part-I/Chapter-22.html">
            
                    
                    联合体
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.23" data-path="../Part-I/Chapter-23.html">
            
                <a href="../Part-I/Chapter-23.html">
            
                    
                    指向函数的指针
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.24" data-path="../Part-I/Chapter-24.html">
            
                <a href="../Part-I/Chapter-24.html">
            
                    
                    在32位环境中的64位值
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.25" data-path="../Part-I/Chapter-25.html">
            
                <a href="../Part-I/Chapter-25.html">
            
                    
                    SIMD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.26" data-path="../Part-I/Chapter-26.html">
            
                <a href="../Part-I/Chapter-26.html">
            
                    
                    64位化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.27" data-path="../Part-I/Chapter-27.html">
            
                <a href="../Part-I/Chapter-27.html">
            
                    
                    使用SIMD来处理浮点数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.28" data-path="../Part-I/Chapter-28.html">
            
                <a href="../Part-I/Chapter-28.html">
            
                    
                    关于ARM的特殊细节
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.29" data-path="../Part-I/Chapter-29.html">
            
                <a href="../Part-I/Chapter-29.html">
            
                    
                    关于MIPS的特殊细节
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../Part-II/part2.html">
            
                <a href="../Part-II/part2.html">
            
                    
                    Part II 重要的基础知识
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../Part-II/Chapter-30.html">
            
                <a href="../Part-II/Chapter-30.html">
            
                    
                    有符号数的表示
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../Part-II/Chapter-31.html">
            
                <a href="../Part-II/Chapter-31.html">
            
                    
                    字节序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../Part-II/Chapter-32.html">
            
                <a href="../Part-II/Chapter-32.html">
            
                    
                    内存
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../Part-II/Chapter-33.html">
            
                <a href="../Part-II/Chapter-33.html">
            
                    
                    CPU
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../Part-II/Chapter-34.html">
            
                <a href="../Part-II/Chapter-34.html">
            
                    
                    哈希函数
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="part3.html">
            
                <a href="part3.html">
            
                    
                    Part III 更高级些的例子
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="Chapter-35.html">
            
                <a href="Chapter-35.html">
            
                    
                    温度转换
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="Chapter-36.html">
            
                <a href="Chapter-36.html">
            
                    
                    斐波那契数列
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="Chapter-37.html">
            
                <a href="Chapter-37.html">
            
                    
                    CRC32的计算实例
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="Chapter-38.html">
            
                <a href="Chapter-38.html">
            
                    
                    网址的计算实例
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="Chapter-39.html">
            
                <a href="Chapter-39.html">
            
                    
                    循环:几个迭代器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="Chapter-40.html">
            
                <a href="Chapter-40.html">
            
                    
                    Duff’s device
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="Chapter-41.html">
            
                <a href="Chapter-41.html">
            
                    
                    除以9
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="Chapter-42.html">
            
                <a href="Chapter-42.html">
            
                    
                    将字符串转化为数字(atoi())
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="Chapter-43.html">
            
                <a href="Chapter-43.html">
            
                    
                    内联函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="Chapter-44.html">
            
                <a href="Chapter-44.html">
            
                    
                    C99 的约束
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.11" data-path="Chapter-45.md">
            
                <span>
            
                    
                    无分支的abs()函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.12" data-path="Chapter-46.md">
            
                <span>
            
                    
                    参数可变的函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.13" data-path="Chapter-47.md">
            
                <span>
            
                    
                    字符串截取
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.14" data-path="Chapter-48.md">
            
                <span>
            
                    
                    toupper()函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.15" data-path="Chapter-49.html">
            
                <a href="Chapter-49.html">
            
                    
                    不正确的反汇编代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.16" data-path="Chapter-50.html">
            
                <a href="Chapter-50.html">
            
                    
                    花指令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.17" data-path="Chapter-51.html">
            
                <a href="Chapter-51.html">
            
                    
                    C++
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.18" data-path="Chapter-52.html">
            
                <a href="Chapter-52.html">
            
                    
                    负的数组引索
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.19" data-path="Chapter-53.html">
            
                <a href="Chapter-53.html">
            
                    
                    Windoes 16-bit
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../Part-IV/part4.html">
            
                <a href="../Part-IV/part4.html">
            
                    
                    Part IV JAVA
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../Part-IV/Chapter-54.html">
            
                <a href="../Part-IV/Chapter-54.html">
            
                    
                    Java
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../Part-V/part5.html">
            
                <a href="../Part-V/part5.html">
            
                    
                    Part V 在代码里面寻找重要又有趣的东西
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../Part-V/Chapter-55.html">
            
                <a href="../Part-V/Chapter-55.html">
            
                    
                    可执行文件的识别
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../Part-V/Chapter-56.html">
            
                <a href="../Part-V/Chapter-56.html">
            
                    
                    和外部世界的交流(win32)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../Part-V/Chapter-57.html">
            
                <a href="../Part-V/Chapter-57.html">
            
                    
                    字符串
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../Part-V/Chapter-58.html">
            
                <a href="../Part-V/Chapter-58.html">
            
                    
                    调用断言
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../Part-V/Chapter-59.html">
            
                <a href="../Part-V/Chapter-59.html">
            
                    
                    常量
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="../Part-V/Chapter-60.html">
            
                <a href="../Part-V/Chapter-60.html">
            
                    
                    找到真正的指令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="../Part-V/Chapter-61.html">
            
                <a href="../Part-V/Chapter-61.html">
            
                    
                    可疑代码的模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.8" data-path="../Part-V/Chapter-62.html">
            
                <a href="../Part-V/Chapter-62.html">
            
                    
                    在追踪时使用Magic numbers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.9" data-path="../Part-V/Chapter-63.html">
            
                <a href="../Part-V/Chapter-63.html">
            
                    
                    其他东西
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../Part-VI/part6.html">
            
                <a href="../Part-VI/part6.html">
            
                    
                    Part VI 操作系统的特性
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../Part-VI/Chapter-64.html">
            
                <a href="../Part-VI/Chapter-64.html">
            
                    
                    参数传递方法(调用规则)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../Part-VI/Chapter-65.html">
            
                <a href="../Part-VI/Chapter-65.html">
            
                    
                    本地线程储存区
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../Part-VI/Chapter-66.html">
            
                <a href="../Part-VI/Chapter-66.html">
            
                    
                    系统调用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../Part-VI/Chapter-67.html">
            
                <a href="../Part-VI/Chapter-67.html">
            
                    
                    Linux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="../Part-VI/Chapter-68.html">
            
                <a href="../Part-VI/Chapter-68.html">
            
                    
                    Windows-NT
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../Part-VII/part7.html">
            
                <a href="../Part-VII/part7.html">
            
                    
                    Part VII 工具
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../Part-VII/Chapter-69.html">
            
                <a href="../Part-VII/Chapter-69.html">
            
                    
                    反汇编器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../Part-VII/Chapter-70.html">
            
                <a href="../Part-VII/Chapter-70.html">
            
                    
                    调试器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../Part-VII/Chapter-71.html">
            
                <a href="../Part-VII/Chapter-71.html">
            
                    
                    系统调用的追踪
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../Part-VII/Chapter-72.html">
            
                <a href="../Part-VII/Chapter-72.html">
            
                    
                    反编译器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="../Part-VII/Chapter-73.html">
            
                <a href="../Part-VII/Chapter-73.html">
            
                    
                    其他工具
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../Part-IX/part9.html">
            
                <a href="../Part-IX/part9.html">
            
                    
                    Part IX 逆向文件格式的例子
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../Part-IX/Chapter-84.html">
            
                <a href="../Part-IX/Chapter-84.html">
            
                    
                    基本的异或加密
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../Part-IX/Chapter-85.html">
            
                <a href="../Part-IX/Chapter-85.html">
            
                    
                    Millenium 的存档文件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../Part-IX/Chapter-86.html">
            
                <a href="../Part-IX/Chapter-86.html">
            
                    
                    Oracle RDBMS SYM-files
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="../Part-IX/Chapter-87.html">
            
                <a href="../Part-IX/Chapter-87.html">
            
                    
                    Oracle RDBMS MSB-files
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../Afterword/part12.html">
            
                <a href="../Afterword/part12.html">
            
                    
                    后记
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../Afterword/Chapter-99.html">
            
                <a href="../Afterword/Chapter-99.html">
            
                    
                    附录
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../Appendix/Appendix.html">
            
                <a href="../Appendix/Appendix.html">
            
                    
                    附录
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../Appendix/Appendix-A.html">
            
                <a href="../Appendix/Appendix-A.html">
            
                    
                    x86
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../Appendix/Appendix-B.html">
            
                <a href="../Appendix/Appendix-B.html">
            
                    
                    ARM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="../Appendix/Appendix-C.html">
            
                <a href="../Appendix/Appendix-C.html">
            
                    
                    MIPS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.4" data-path="../Appendix/Appendix-D.html">
            
                <a href="../Appendix/Appendix-D.html">
            
                    
                    一些GCC库函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.5" data-path="../Appendix/Appendix-E.html">
            
                <a href="../Appendix/Appendix-E.html">
            
                    
                    一些MIPS库函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.6" data-path="../Appendix/Appendix-F.html">
            
                <a href="../Appendix/Appendix-F.html">
            
                    
                    速查表
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../Acronyms-used.html">
            
                <a href="../Acronyms-used.html">
            
                    
                    缩略词表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../Glossary.html">
            
                <a href="../Glossary.html">
            
                    
                    杂项
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../Idx.html">
            
                <a href="../Idx.html">
            
                    
                    快速引索
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../Bibliography.html">
            
                <a href="../Bibliography.html">
            
                    
                    参考文献
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本書使用 GitBook 釋出
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Windoes 16-bit</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="&#x7B2C;&#x4E94;&#x5341;&#x4E09;&#x7AE0;">&#x7B2C;&#x4E94;&#x5341;&#x4E09;&#x7AE0;</h1>
<h1 id="16&#x4F4D;windows">16&#x4F4D;Windows</h1>
<p>16&#x4F4D;windows&#x7A0B;&#x5E8F;&#x73B0;&#x5728;&#x5F88;&#x5C11;&#x89C1;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x65E7;&#x5F0F;&#x8BA1;&#x7B97;&#x673A;&#x6216;&#x8005;&#x5165;&#x4FB5;&#x8F6F;&#x4EF6;&#x72D7;&#x7684;&#x65F6;&#x5019;&#xFF08;58&#x7AE0;&#xFF09;&#xFF0C;&#x6211;&#x6709;&#x65F6;&#x5019;&#x8FD8;&#x4F1A;&#x9047;&#x5230;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x3002; 16&#x4F4D;&#x7684;windows&#x7248;&#x672C;&#x6700;&#x9AD8;&#x5230;3.11&#xFF0C;95(*&#x6CE8;&#xFF1A;&#x4F5C;&#x8005;&#x7B14;&#x8BEF;&#x5199;&#x6210;&#x4E86;Win96)/98/ME&#x4E5F;&#x652F;&#x6301;16&#x4F4D;&#x4EE3;&#x7801;&#xFF0C;&#x4ED6;&#x4EEC;&#x540C;&#x65F6;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;Windows NT&#x5BB6;&#x65CF;&#x7684;32&#x4F4D;&#x7248;&#x672C;&#x3002;64&#x4F4D;&#x7248;&#x672C;&#x7684;Windows NT&#x5BB6;&#x65CF;&#x5B8C;&#x5168;&#x4E0D;&#x652F;&#x6301;16&#x4F4D;&#x7A0B;&#x5E8F;&#x3002; &#x4EE3;&#x7801;&#x7C7B;&#x4F3C;&#x4E8E;MS-DOS&#x4EE3;&#x7801;&#x3002; &#x6267;&#x884C;&#x6587;&#x4EF6;&#x5E76;&#x4E0D;&#x662F;MZ&#x5F0F;&#x6216;&#x8005;PE&#x6587;&#x4EF6;&#xFF0C;&#x800C;&#x662F;NE&#x5F0F;&#xFF08;&#x6240;&#x8C13;&#x7684;&#x201C;New Executable&#x201D;&#xFF0C;&#x65B0;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#xFF09;&#x3002; &#x6240;&#x6709;&#x7684;&#x4F8B;&#x5B50;&#x90FD;&#x7531;OpenWatcom 1.9&#x7F16;&#x8BD1;&#x5668;&#x7F16;&#x8BD1;&#xFF0C;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x53C2;&#x6570;&#xFF1A;</p>
<p><code>Wcl.exe -i=C:/WATCOM/h/win/ -s -os -bt=windows example.c</code></p>
<h2 id="531-&#x4F8B;&#x5B50;1">53.1 &#x4F8B;&#x5B50;#1</h2>
<pre><code>#include &lt;windows.h&gt;
int PASCAL WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)
{
    MessageBeep(MB_ICONEXCLAMATION);
    return 0;
};
</code></pre><pre><code>WinMain proc near
    push bp
    mov bp, sp
    mov ax, 30h ; &#x2019;0&#x2019; ; MB_ICONEXCLAMATION constant
    push ax
    call MESSAGEBEEP
    xor ax, ax ; return 0
    pop bp
    retn 0Ah
WinMain endp
</code></pre><p>&#x5230;&#x73B0;&#x5728;&#x4E3A;&#x6B62;&#xFF0C;&#x770B;&#x8D77;&#x6765;&#x90FD;&#x5F88;&#x7B80;&#x5355;&#x3002;</p>
<h2 id="532-&#x4F8B;&#x5B50;2">53.2 &#x4F8B;&#x5B50;#2</h2>
<pre><code>#include &lt;windows.h&gt;
int PASCAL WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)
{
    MessageBox (NULL, &quot;hello, world&quot;, &quot;caption&quot;, MB_YESNOCANCEL);
    return 0;
};
</code></pre><pre><code>WinMain proc near
        push bp
        mov bp, sp
        xor ax, ax ; NULL
        push ax
        push ds
        mov ax, offset aHelloWorld ; 0x18. &quot;hello, world&quot;
        push ax
        push ds
        mov ax, offset aCaption ; 0x10. &quot;caption&quot;
        push ax
        mov ax, 3 ; MB_YESNOCANCEL
        push ax
        call MESSAGEBOX
        xor ax, ax ; return 0
        pop bp
        retn 0Ah
WinMain endp
dseg02:0010 aCaption db &#x2019;caption&#x2019;,0
dseg02:0018 aHelloWorld db &#x2019;hello, world&#x2019;,0
</code></pre><p>&#x6709;&#x4E24;&#x4E2A;&#x91CD;&#x8981;&#x7684;&#x4FE1;&#x606F;&#xFF1A;PASCAL&#x8C03;&#x7528;&#x8F6C;&#x6362;&#x8868;&#x660E;&#x5148;&#x4F20;&#x9012;&#x6700;&#x540E;&#x7684;&#x53C2;&#x6570;&#xFF08;MB_YESNOCANCEL&#xFF09;&#xFF0C;&#x7136;&#x540E;&#x624D;&#x662F;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;NULL&#x3002;&#x8FD9;&#x4E2A;&#x8C03;&#x7528;&#x4E5F;&#x8868;&#x660E;&#x4E86;&#x8C03;&#x7528;&#x8005;&#x6062;&#x590D;&#x6808;&#x6307;&#x9488;&#xFF1A;&#x56E0;&#x4E3A;RETN&#x6709;&#x4E00;&#x4E2A;0Ah&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x8FD9;&#x4E2A;&#x610F;&#x5473;&#x7740;&#x6808;&#x6307;&#x9488;&#x5C06;&#x5728;&#x51FD;&#x6570;&#x9000;&#x51FA;&#x65F6;&#x4E0A;&#x79FB;10&#x4E2A;&#x5B57;&#x8282;&#x3002; &#x6307;&#x9488;&#x6309;&#x5BF9;&#x4F20;&#x9012;&#xFF1A;&#x4E00;&#x7EC4;&#x6570;&#x636E;&#x5148;&#x4F20;&#x9012;&#xFF0C;&#x6307;&#x9488;&#x5C31;&#x5728;&#x8FD9;&#x7EC4;&#x6570;&#x636E;&#x91CC;&#x9762;&#x3002;&#x4F8B;&#x5B50;&#x8FD9;&#x91CC;&#x53EA;&#x6709;&#x4E00;&#x7EC4;&#x6570;&#x636E;&#xFF0C;&#x6240;&#x4EE5;DS&#x6C38;&#x8FDC;&#x6307;&#x5411;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x7684;data&#x6BB5;&#x3002;</p>
<h2 id="533-&#x4F8B;&#x5B50;3">53.3 &#x4F8B;&#x5B50;#3</h2>
<pre><code>#include &lt;windows.h&gt;
int PASCAL WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)
{
    int result=MessageBox (NULL, &quot;hello, world&quot;, &quot;caption&quot;, MB_YESNOCANCEL);
    if (result==IDCANCEL)
        MessageBox (NULL, &quot;you pressed cancel&quot;, &quot;caption&quot;, MB_OK);
    else if (result==IDYES)
        MessageBox (NULL, &quot;you pressed yes&quot;, &quot;caption&quot;, MB_OK);
    else if (result==IDNO)
        MessageBox (NULL, &quot;you pressed no&quot;, &quot;caption&quot;, MB_OK);
    return 0;
};
</code></pre><pre><code>WinMain proc near
        push bp
        mov bp, sp
        xor ax, ax ; NULL
        push ax
        push ds
        mov ax, offset aHelloWorld ; &quot;hello, world&quot;
        push ax
        push ds
        mov ax, offset aCaption ; &quot;caption&quot;
        push ax
        mov ax, 3 ; MB_YESNOCANCEL
        push ax
        call MESSAGEBOX
        cmp ax, 2 ; IDCANCEL
        jnz short loc_2F
        xor ax, ax
        push ax
        push ds
        mov ax, offset aYouPressedCanc ; &quot;you pressed cancel&quot;
        jmp short loc_49
        ; ---------------------------------------------------------------------------
        loc_2F:
        cmp ax, 6 ; IDYES
        jnz short loc_3D
        xor ax, ax
        push ax
        push ds
        mov ax, offset aYouPressedYes ; &quot;you pressed yes&quot;
        jmp short loc_49
        ; ---------------------------------------------------------------------------
        loc_3D:
        cmp ax, 7 ; IDNO
        jnz short loc_57
        xor ax, ax
        push ax
        push ds
        mov ax, offset aYouPressedNo ; &quot;you pressed no&quot;
        loc_49:
        push ax
        push ds
        mov ax, offset aCaption ; &quot;caption&quot;
        push ax
        xor ax, ax
        push ax
        call MESSAGEBOX
        loc_57:
        xor ax, ax
        pop bp
        retn 0Ah
WinMain endp
</code></pre><p>&#x5C31;&#x662F;&#x524D;&#x4E00;&#x8282;&#x7684;&#x6269;&#x5C55;&#x800C;&#x5DF2;&#x3002;</p>
<h2 id="534-&#x4F8B;&#x5B50;4">53.4 &#x4F8B;&#x5B50;#4</h2>
<pre><code>#include &lt;windows.h&gt;
int PASCAL func1 (int a, int b, int c)
{
    return a*b+c;
};
long PASCAL func2 (long a, long b, long c)
{
    return a*b+c;
};
long PASCAL func3 (long a, long b, long c, int d)
{
    return a*b+c-d;
};

int PASCAL WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)
{
    func1 (123, 456, 789);
    func2 (600000, 700000, 800000);
    func3 (600000, 700000, 800000, 123);
    return 0;
};
</code></pre><pre><code>func1 proc near
    c = word ptr 4
    b = word ptr 6
    a = word ptr 8
    push bp
    mov bp, sp
    mov ax, [bp+a]
    imul [bp+b]
    add ax, [bp+c]
    pop bp
    retn 6
func1 endp
func2 proc near
    arg_0 = word ptr 4
    arg_2 = word ptr 6
    arg_4 = word ptr 8
    arg_6 = word ptr 0Ah
    arg_8 = word ptr 0Ch
    arg_A = word ptr 0Eh
    push bp
    mov bp, sp
    mov ax, [bp+arg_8]
    mov dx, [bp+arg_A]
    mov bx, [bp+arg_4]
    mov cx, [bp+arg_6]
    call sub_B2 ; long 32-bit multiplication
    add ax, [bp+arg_0]
    adc dx, [bp+arg_2]
    pop bp
    retn 12
func2 endp
func3 proc near
    arg_0 = word ptr 4
    arg_2 = word ptr 6
    arg_4 = word ptr 8
    arg_6 = word ptr 0Ah
    arg_8 = word ptr 0Ch
    arg_A = word ptr 0Eh
    arg_C = word ptr 10h
    push bp
    mov bp, sp
    mov ax, [bp+arg_A]
    mov dx, [bp+arg_C]
    mov bx, [bp+arg_6]
    mov cx, [bp+arg_8]
    call sub_B2 ; long 32-bit multiplication
    mov cx, [bp+arg_2]
    add cx, ax
    mov bx, [bp+arg_4]
    adc bx, dx ; BX=high part, CX=low part
    mov ax, [bp+arg_0]
    cwd ; AX=low part d, DX=high part d
    sub cx, ax
    mov ax, cx
    sbb bx, dx
    mov dx, bx
    pop bp
    retn 14
    func3 endp
    WinMain proc near
    push bp
    mov bp, sp
    mov ax, 123
    push ax
    mov ax, 456
    push ax
    mov ax, 789
    push ax
    call func1
    mov ax, 9 ; high part of 600000
    push ax
    mov ax, 27C0h ; low part of 600000
    push ax
    mov ax, 0Ah ; high part of 700000
    push ax
    mov ax, 0AE60h ; low part of 700000
    push ax
    mov ax, 0Ch ; high part of 800000
    push ax
    mov ax, 3500h ; low part of 800000
    push ax
    call func2
    mov ax, 9 ; high part of 600000
    push ax
    mov ax, 27C0h ; low part of 600000
    push ax
    mov ax, 0Ah ; high part of 700000
    push ax
    mov ax, 0AE60h ; low part of 700000
    push ax
    mov ax, 0Ch ; high part of 800000
    push ax
    mov ax, 3500h ; low part of 800000
    push ax
    mov ax, 7Bh ; 123
    push ax
    call func3
    xor ax, ax ; return 0
    pop bp
    retn 0Ah
WinMain endp
</code></pre><p>32&#x4F4D;&#x7684;&#x503C;&#xFF08;long&#x6570;&#x636E;&#x7C7B;&#x578B;&#x4EE3;&#x8868;32&#x4F4D;&#xFF0C;int&#x4EE3;&#x8868;16&#x4F4D;&#x6570;&#x636E;&#xFF09;&#x5728;16&#x4F4D;&#x6A21;&#x5F0F;&#x4E0B;&#xFF08;MSDOS&#x548C;win16&#xFF09;&#x90FD;&#x4F1A;&#x6309;&#x5BF9;&#x4F20;&#x9012;&#xFF0C;&#x5C31;&#x50CF;64&#x4F4D;&#x6570;&#x636E;&#x5728;32&#x4F4D;&#x73AF;&#x5883;&#x4E0B;&#x4F7F;&#x7528;&#x7684;&#x65B9;&#x5F0F;&#x4E00;&#x6837;&#xFF08;21&#x7AE0;&#xFF09;&#x3002;</p>
<p>Sub_B2&#x5728;&#x8FD9;&#x91CC;&#x662F;&#x4E00;&#x4E2A;&#x7F16;&#x8BD1;&#x5668;&#x751F;&#x6210;&#x7684;&#x5E93;&#x51FD;&#x6570;&#xFF0C;&#x4ED6;&#x7684;&#x4F5C;&#x7528;&#x662F;&#x201C;long&#x4E58;&#x6CD5;&#x201D;&#xFF0C;&#x4F8B;&#x5982;&#x4E24;&#x4E2A;32&#x4F4D;&#x7C7B;&#x578B;&#x60F3;&#x6210;&#xFF0C;&#x5176;&#x4ED6;&#x7684;&#x7F16;&#x8BD1;&#x5668;&#x51FD;&#x6570;&#x5217;&#x5728;&#x4E86;&#x9644;&#x5F55;E, D.&#x4E2D;&#x3002; ADD/ADC&#x6307;&#x4EE4;&#x5BF9;&#x7528;&#x6765;&#x76F8;&#x52A0;&#x4E24;&#x4E2A;&#x503C;&#xFF1A;ADD&#x5C06;&#x8BBE;&#x7F6E;/&#x6E05;&#x7A7A;CF&#x8FDB;&#x4F4D;&#x6807;&#x8BC6;&#xFF0C;ADC&#x5C06;&#x4F1A;&#x4F7F;&#x7528;&#x5B83;&#x3002; SUB/SBB&#x5C06;&#x4F1A;&#x505A;&#x51CF;&#x6CD5;&#xFF0C;SUB&#x4F1A;&#x8BBE;&#x7F6E;/&#x6E05;&#x7A7A;CF&#x6807;&#x8BC6;&#x4F4D;&#xFF0C;SBB&#x5C06;&#x4F1A;&#x4F7F;&#x7528;&#x5B83;&#x3002; 32&#x4F4D;&#x503C;&#x6309;&#x7167;DX:AX&#x5BC4;&#x5B58;&#x5668;&#x5BF9;&#x8FD4;&#x56DE;&#x3002; &#x5E38;&#x6570;&#x540C;&#x6837;&#x5728;WinMain()&#x4E2D;&#x6309;&#x7167;&#x503C;&#x5BF9;&#x7684;&#x65B9;&#x5F0F;&#x4F20;&#x9012;&#x3002; Int&#x7C7B;&#x578B;&#x7684;123&#x5E38;&#x91CF;&#x9996;&#x5148;&#x88AB;&#x8F6C;&#x4E3A;32&#x4F4D;&#x7684;&#x503C;&#xFF0C;&#x4F7F;&#x7528;&#x7684;&#x662F;CWD&#x6307;&#x4EE4;&#x3002;</p>
<h2 id="535-&#x4F8B;&#x5B50;5">53.5 &#x4F8B;&#x5B50;#5</h2>
<pre><code>#include &lt;windows.h&gt;
int PASCAL string_compare (char *s1, char *s2)
{
    while (1)
    {
        if (*s1!=*s2)
            return 0;
        if (*s1==0 || *s2==0)
            return 1; // end of string
        s1++;
        s2++;
    };
};

int PASCAL string_compare_far (char far *s1, char far *s2)
{
    while (1)
    {
        if (*s1!=*s2)
            return 0;
        if (*s1==0 || *s2==0)
            return 1; // end of string
        s1++;
        s2++;
    };
};
void PASCAL remove_digits (char *s)
{
    while (*s)
    {
        if (*s&gt;=&#x2019;0&#x2019; &amp;&amp; *s&lt;=&#x2019;9&#x2019;)
            *s=&#x2019;-&#x2019;;
        s++;
    };
};

char str[]=&quot;hello 1234 world&quot;;
int PASCAL WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)
{
    string_compare (&quot;asd&quot;, &quot;def&quot;);
    string_compare_far (&quot;asd&quot;, &quot;def&quot;);
    remove_digits (str);
    MessageBox (NULL, str, &quot;caption&quot;, MB_YESNOCANCEL);
    return 0;
};
</code></pre><pre><code>string_compare proc near
arg_0 = word ptr 4
arg_2 = word ptr 6
push bp
mov bp, sp
push si
mov si, [bp+arg_0]
mov bx, [bp+arg_2]
loc_12: ; CODE XREF: string_compare+21j
mov al, [bx]
cmp al, [si]
jz short loc_1C
xor ax, ax
jmp short loc_2B
; ---------------------------------------------------------------------------
loc_1C: ; CODE XREF: string_compare+Ej
test al, al
jz short loc_22
jnz short loc_27
loc_22: ; CODE XREF: string_compare+16j
mov ax, 1
jmp short loc_2B
; ---------------------------------------------------------------------------
loc_27: ; CODE XREF: string_compare+18j
inc bx
inc si
jmp short loc_12
; ---------------------------------------------------------------------------
loc_2B: ; CODE XREF: string_compare+12j
; string_compare+1Dj
pop si
pop bp
retn 4
string_compare endp
string_compare_far proc near ; CODE XREF: WinMain+18p
arg_0 = word ptr 4
arg_2 = word ptr 6
arg_4 = word ptr 8
arg_6 = word ptr 0Ah
push bp
mov bp, sp
push si
mov si, [bp+arg_0]
mov bx, [bp+arg_4]
loc_3A: ; CODE XREF: string_compare_far+35j
mov es, [bp+arg_6]
mov al, es:[bx]
mov es, [bp+arg_2]
cmp al, es:[si]
jz short loc_4C
xor ax, ax
jmp short loc_67
; ---------------------------------------------------------------------------
loc_4C: ; CODE XREF: string_compare_far+16j
mov es, [bp+arg_6]
cmp byte ptr es:[bx], 0
jz short loc_5E
mov es, [bp+arg_2]
cmp byte ptr es:[si], 0
jnz short loc_63
loc_5E: ; CODE XREF: string_compare_far+23j
mov ax, 1
jmp short loc_67
; ---------------------------------------------------------------------------
loc_63: ; CODE XREF: string_compare_far+2Cj
inc bx
inc si
jmp short loc_3A
; ---------------------------------------------------------------------------
loc_67: ; CODE XREF: string_compare_far+1Aj
; string_compare_far+31j
pop si
pop bp
retn 8
string_compare_far endp
remove_digits proc near ; CODE XREF: WinMain+1Fp
arg_0 = word ptr 4
push bp
mov bp, sp
mov bx, [bp+arg_0]
loc_72: ; CODE XREF: remove_digits+18j
mov al, [bx]
test al, al
jz short loc_86
cmp al, 30h ; &#x2019;0&#x2019;
jb short loc_83
cmp al, 39h ; &#x2019;9&#x2019;
ja short loc_83
mov byte ptr [bx], 2Dh ; &#x2019;-&#x2019;
loc_83: ; CODE XREF: remove_digits+Ej
; remove_digits+12j
inc bx
jmp short loc_72
; ---------------------------------------------------------------------------
loc_86: ; CODE XREF: remove_digits+Aj
pop bp
retn 2
remove_digits endp
WinMain proc near ; CODE XREF: start+EDp
push bp
mov bp, sp
mov ax, offset aAsd ; &quot;asd&quot;
push ax
mov ax, offset aDef ; &quot;def&quot;
push ax
call string_compare
push ds
mov ax, offset aAsd ; &quot;asd&quot;
push ax
push ds
mov ax, offset aDef ; &quot;def&quot;
push ax
call string_compare_far
mov ax, offset aHello1234World ; &quot;hello 1234 world&quot;
push ax
call remove_digits
xor ax, ax
push ax
push ds
mov ax, offset aHello1234World ; &quot;hello 1234 world&quot;
push ax
push ds
mov ax, offset aCaption ; &quot;caption&quot;
push ax
mov ax, 3 ; MB_YESNOCANCEL
push ax
call MESSAGEBOX
xor ax, ax
pop bp
retn 0Ah
WinMain endp
</code></pre><p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6240;&#x8C13;&#x7684;&#x201C;near&#x201D;&#x6307;&#x9488;&#x548C;&#x201C;far&#x201D;&#x6307;&#x9488;&#xFF1A;&#x53E6;&#x4E00;&#x4E2A;&#x5947;&#x602A;&#x7684;16&#x4F4D;8086&#x73B0;&#x8C61;&#x3002; &#x53EF;&#x4EE5;&#x5728;70&#x7AE0;&#x7EE7;&#x7EED;&#x8BFB;&#x5230;&#x76F8;&#x5173;&#x5185;&#x5BB9;&#x3002; &#x8FD1;&#x6307;&#x9488;&#x5C31;&#x662F;&#x90A3;&#x4E9B;&#x6307;&#x5411;&#x5F53;&#x524D;&#x6570;&#x636E;&#x6BB5;&#x5185;&#x7684;&#x6307;&#x9488;&#x3002;&#x56E0;&#x4E3A;&#xFF0C;string_compare()&#x51FD;&#x6570;&#x4EC5;&#x4EC5;&#x7528;&#x5230;2&#x4E2A;16&#x4F4D;&#x6307;&#x9488;&#xFF0C;&#x800C;&#x4E14;&#x8BBF;&#x95EE;&#x6570;&#x636E;&#x901A;&#x8FC7;DS&#x6307;&#x5411;&#x4E86;&#x5B83;&#xFF08;mov al, es:[bx]&#xFF09;&#x3002;&#x8FDC;&#x6307;&#x9488;&#x4E5F;&#x540C;&#x6837;&#x5728;&#x6211;&#x7684;16&#x4F4D;MessageBox()&#x4F8B;&#x5B50;&#x91CC;&#x9762;&#xFF1A;&#x89C1;30.2&#x8282;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x5728;&#x8BBF;&#x95EE;&#x6587;&#x672C;&#x65F6;&#xFF0C;Windows&#x5185;&#x6838;&#x5E76;&#x4E0D;&#x5173;&#x5FC3;&#x4F7F;&#x7528;&#x90A3;&#x4E2A;&#x6570;&#x636E;&#x6BB5;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x9700;&#x8981;&#x66F4;&#x5B8C;&#x6574;&#x7684;&#x4FE1;&#x606F;&#x3002; &#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x533A;&#x522B;&#x7684;&#x539F;&#x56E0;&#x53EF;&#x80FD;&#x662F;&#x56E0;&#x4E3A;&#x7D27;&#x51D1;&#x7684;&#x7A0B;&#x5E8F;&#x53EF;&#x80FD;&#x4F7F;&#x7528;&#x4EC5;&#x4EC5;&#x4E00;&#x4E2A;64kb&#x7684;&#x6570;&#x636E;&#x6BB5;&#x3002;&#x6240;&#x4EE5;&#x4ED6;&#x5E76;&#x4E0D;&#x9700;&#x8981;&#x4F20;&#x9012;&#x5730;&#x5740;&#x7684;&#x9AD8;&#x4F4D;&#x6570;&#x636E;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x6C38;&#x8FDC;&#x662F;&#x4E0D;&#x53D8;&#x7684;&#x3002;&#x5927;&#x4E00;&#x70B9;&#x7684;&#x7A0B;&#x5E8F;&#x53EF;&#x80FD;&#x4F1A;&#x4F7F;&#x7528;&#x591A;&#x4E2A;64kb&#x6570;&#x636E;&#x6BB5;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x4EEC;&#x6BCF;&#x6B21;&#x64CD;&#x4F5C;&#x90FD;&#x9700;&#x8981;&#x9700;&#x8981;&#x533A;&#x5206;&#x5B83;&#x4EEC;&#x662F;&#x5728;&#x54EA;&#x4E2A;&#x6570;&#x636E;&#x6BB5;&#x91CC;&#x9762;&#x3002; &#x5BF9;&#x4EE3;&#x7801;&#x6BB5;&#x6765;&#x8BF4;&#x4E5F;&#x662F;&#x76F8;&#x540C;&#x7684;&#x6545;&#x4E8B;&#xFF0C;&#x6BD4;&#x8F83;&#x77ED;&#x5C0F;&#x7684;&#x7A0B;&#x5E8F;&#x53EF;&#x80FD;&#x5728;64k&#x7684;&#x6570;&#x636E;&#x6BB5;&#x91CC;&#x9762;&#x5305;&#x542B;&#x6709;&#x6240;&#x6709;&#x7684;&#x53EF;&#x6267;&#x884C;&#x4EE3;&#x7801;&#xFF0C;&#x7136;&#x540E;&#x6240;&#x6709;&#x7684;&#x51FD;&#x6570;&#x90FD;&#x4F1A;&#x7531;CALL NEAR&#x6765;&#x8C03;&#x7528;&#xFF0C;&#x4EE3;&#x7801;&#x4F7F;&#x7528;RETN&#x8FD4;&#x56DE;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x591A;&#x4E2A;&#x4EE3;&#x7801;&#x6BB5;&#x7684;&#x8BDD;&#xFF0C;&#x51FD;&#x6570;&#x5730;&#x5740;&#x5C31;&#x4F1A;&#x6309;&#x5BF9;&#x533A;&#x5206;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;CALL FAR&#x6765;&#x8C03;&#x7528;&#xFF0C;&#x4EE3;&#x7801;&#x4F1A;&#x4F7F;&#x7528;RETF&#x8FD4;&#x56DE;&#x3002; &#x8FD9;&#x5C31;&#x662F;&#x5728;&#x7F16;&#x8BD1;&#x5668;&#x4E2D;&#x6307;&#x5B9A;&#x201C;&#x5185;&#x5B58;&#x6A21;&#x578B;&#x201D;&#x4F1A;&#x53D1;&#x751F;&#x7684;&#x4E8B;&#x60C5;&#x3002; MS-DOS&#x548C;Win16&#x7F16;&#x8BD1;&#x5668;&#x9488;&#x5BF9;&#x6BCF;&#x4E2A;&#x5185;&#x5B58;&#x6A21;&#x578B;&#x90FD;&#x6709;&#x6709;&#x7279;&#x522B;&#x7684;&#x5E93;&#xFF1A;&#x5B83;&#x4EEC;&#x4F1A;&#x56E0;&#x4E3A;&#x6570;&#x636E;&#x548C;&#x4EE3;&#x7801;&#x7684;&#x4E0D;&#x540C;&#x7684;&#x6307;&#x9488;&#x6A21;&#x578B;&#x800C;&#x4E0D;&#x540C;&#x3002;</p>
<h2 id="536-&#x4F8B;&#x5B50;6">53.6 &#x4F8B;&#x5B50;#6</h2>
<pre><code>#include &lt;windows.h&gt;
#include &lt;time.h&gt;
#include &lt;stdio.h&gt;
char strbuf[256];

int PASCAL WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)
{
    struct tm *t;
    time_t unix_time;
    unix_time=time(NULL);
    t=localtime (&amp;unix_time);
    sprintf (strbuf, &quot;%04d-%02d-%02d %02d:%02d:%02d&quot;, t-&gt;tm_year+1900, t-&gt;tm_mon, t-&gt;tm_mday,
    t-&gt;tm_hour, t-&gt;tm_min, t-&gt;tm_sec);
    MessageBox (NULL, strbuf, &quot;caption&quot;, MB_OK);
    return 0;
};
</code></pre><pre><code>WinMain proc near
var_4 = word ptr -4
var_2 = word ptr -2
push bp
mov bp, sp
push ax
push ax
xor ax, ax
call time_
mov [bp+var_4], ax ; low part of UNIX time
mov [bp+var_2], dx ; high part of UNIX time
lea ax, [bp+var_4] ; take a pointer of high part
call localtime_
mov bx, ax ; t
push word ptr [bx] ; second
push word ptr [bx+2] ; minute
push word ptr [bx+4] ; hour
push word ptr [bx+6] ; day
push word ptr [bx+8] ; month
mov ax, [bx+0Ah] ; year
add ax, 1900
push ax
mov ax, offset a04d02d02d02d02 ; &quot;%04d-%02d-%02d %02d:%02d:%02d&quot;
push ax
mov ax, offset strbuf
push ax
call sprintf_
add sp, 10h
xor ax, ax ; NULL
push ax
push ds
mov ax, offset strbuf
push ax
push ds
mov ax, offset aCaption ; &quot;caption&quot;
push ax
xor ax, ax ; MB_OK
push ax
call MESSAGEBOX
xor ax, ax
mov sp, bp
pop bp
retn 0Ah
WinMain endp
</code></pre><p>UNIX&#x65F6;&#x95F4;&#x662F;32&#x4F4D;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x8FD4;&#x56DE;&#x5728;DX:AX&#x5BC4;&#x5B58;&#x5668;&#x5BF9;&#x4E2D;&#xFF0C;&#x800C;&#x4E14;&#x5C06;&#x4ED6;&#x4EEC;&#x5B58;&#x50A8;&#x5230;&#x4E24;&#x4E2A;&#x672C;&#x5730;16&#x4F4D;&#x53D8;&#x91CF;&#x4E2D;&#x3002;&#x7136;&#x540E;&#x4E00;&#x4E2A;&#x6307;&#x5411;&#x503C;&#x5BF9;&#x7684;&#x6307;&#x9488;&#x4F1A;&#x88AB;&#x5F53;&#x4F5C;&#x53C2;&#x6570;&#x4F20;&#x7ED9;localtime()&#x51FD;&#x6570;&#x3002;Localtime()&#x51FD;&#x6570;&#x6709;&#x4E00;&#x4E2A;struct tm&#xFF0C;&#x5B83;&#x5C06;&#x901A;&#x8FC7;C&#x5E93;&#x5206;&#x914D;&#x5185;&#x5B58;&#xFF0C;&#x6240;&#x4EE5;&#x53EA;&#x6709;&#x6307;&#x5411;&#x5B83;&#x7684;&#x6307;&#x9488;&#x8FD4;&#x56DE;&#x4E86;&#x3002;&#x987A;&#x4FBF;&#x4E00;&#x63D0;&#xFF0C;&#x8FD9;&#x4E5F;&#x610F;&#x5473;&#x7740;&#x5728;&#x5B83;&#x7684;&#x7ED3;&#x679C;&#x88AB;&#x4F7F;&#x7528;&#x4E4B;&#x524D;&#xFF0C;&#x51FD;&#x6570;&#x4E0D;&#x80FD;&#x88AB;&#x518D;&#x6B21;&#x8C03;&#x7528;&#x3002; &#x5BF9;time()&#x548C;localtime()&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x6765;&#x8BF4;&#xFF0C;Watcom&#x8C03;&#x7528;&#x8F6C;&#x6362;&#x5C06;&#x4F1A;&#x5728;&#x8FD9;&#x91CC;&#xFF1A;&#x524D;&#x56DB;&#x4E2A;&#x53C2;&#x6570;&#x4F7F;&#x7528;AX&#x3001;DX&#x3001;BX&#x3001;CX&#x4F20;&#x9012;&#xFF0C;&#x5269;&#x4F59;&#x7684;&#x901A;&#x8FC7;&#x6808;&#x6765;&#x4F20;&#x9012;&#x3002;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x8F6C;&#x6362;&#x7684;&#x51FD;&#x6570;&#x4E5F;&#x4F1A;&#x5728;&#x540D;&#x5B57;&#x6700;&#x540E;&#x4F7F;&#x7528;&#x4E0B;&#x5212;&#x7EBF;&#x6765;&#x6807;&#x8BB0;&#x3002; Sprintf()&#x5E76;&#x4E0D;&#x4F7F;&#x7528;PASCAL&#x8C03;&#x7528;&#x8F6C;&#x6362;&#xFF0C;&#x4E5F;&#x4E0D;&#x4F1A;&#x4F7F;&#x7528;watcom&#x8F6C;&#x6362;&#xFF0C;&#x6240;&#x4EE5;&#x53C2;&#x6570;&#x5C06;&#x4F7F;&#x7528;&#x5BFB;&#x5E38;&#x7684;cdecl&#x65B9;&#x5F0F;&#x4F20;&#x9012;&#xFF08;47.1&#x8282;&#xFF09;&#x3002;</p>
<h3 id="5361-&#x5168;&#x5C40;&#x53D8;&#x91CF;">53.6.1 &#x5168;&#x5C40;&#x53D8;&#x91CF;</h3>
<p>&#x8FD9;&#x91CC;&#x7528;&#x540C;&#x6837;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x4F46;&#x662F;&#x53D8;&#x91CF;&#x662F;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#xFF1A;</p>
<pre><code>#include &lt;windows.h&gt;
#include &lt;time.h&gt;
#include &lt;stdio.h&gt;
char strbuf[256];
struct tm *t;
time_t unix_time;

int PASCAL WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)
{
    unix_time=time(NULL);
    t=localtime (&amp;unix_time);
    sprintf (strbuf, &quot;%04d-%02d-%02d %02d:%02d:%02d&quot;, t-&gt;tm_year+1900, t-&gt;tm_mon, t-&gt;tm_mday,
    t-&gt;tm_hour, t-&gt;tm_min, t-&gt;tm_sec);
    MessageBox (NULL, strbuf, &quot;caption&quot;, MB_OK);
    return 0;
};
</code></pre><pre><code>unix_time_low dw 0
unix_time_high dw 0
t dw 0
WinMain proc near
push bp
mov bp, sp
xor ax, ax
call time_
mov unix_time_low, ax
mov unix_time_high, dx
mov ax, offset unix_time_low
call localtime_
mov bx, ax
mov t, ax ; will not be used in future...
push word ptr [bx] ; seconds
push word ptr [bx+2] ; minutes
push word ptr [bx+4] ; hour
push word ptr [bx+6] ; day
push word ptr [bx+8] ; month
mov ax, [bx+0Ah] ; year
add ax, 1900
push ax
mov ax, offset a04d02d02d02d02 ; &quot;%04d-%02d-%02d %02d:%02d:%02d&quot;
push ax
mov ax, offset strbuf
push ax
call sprintf_
add sp, 10h
xor ax, ax ; NULL
push ax
push ds
mov ax, offset strbuf
push ax
push ds
mov ax, offset aCaption ; &quot;caption&quot;
push ax
xor ax, ax ; MB_OK
push ax
call MESSAGEBOX
xor ax, ax ; return 0
pop bp
retn 0Ah
WinMain endp
</code></pre><p>T&#x4E0D;&#x4F1A;&#x88AB;&#x4F7F;&#x7528;&#xFF0C;&#x4F46;&#x662F;&#x7F16;&#x8BD1;&#x5668;&#x8FD8;&#x662F;&#x7528;&#x4EE3;&#x7801;&#x5B58;&#x50A8;&#x4E86;&#x8FD9;&#x4E2A;&#x503C;&#x3002;&#x56E0;&#x4E3A;&#x4ED6;&#x5E76;&#x4E0D;&#x786E;&#x5B9A;&#xFF0C;&#x4E5F;&#x8BB8;&#x8FD9;&#x4E2A;&#x503C;&#x4F1A;&#x5728;&#x67D0;&#x4E2A;&#x5730;&#x65B9;&#x88AB;&#x7528;&#x5230;&#x3002;</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Chapter-52.html" class="navigation navigation-prev " aria-label="Previous page: 负的数组引索">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../Part-IV/part4.html" class="navigation navigation-next " aria-label="Next page: Part IV JAVA">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Windoes 16-bit","level":"1.4.19","depth":2,"next":{"title":"Part IV JAVA","level":"1.5","depth":1,"path":"Part-IV/part4.md","ref":"Part-IV/part4.md","articles":[{"title":"Java","level":"1.5.1","depth":2,"path":"Part-IV/Chapter-54.md","ref":"Part-IV/Chapter-54.md","articles":[]}]},"previous":{"title":"负的数组引索","level":"1.4.18","depth":2,"path":"Part-III/Chapter-52.md","ref":"Part-III/Chapter-52.md","articles":[]},"dir":"ltr"},"config":{"plugins":["comment"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"comment":{"highlightCommented":true},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"wizardforcel","pdf":{"pageNumbers":true,"fontSize":16,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"逆向工程入门指南","language":"zh","links":{"sidebar":{"逆向工程入门指南":"https://www.gitbook.com/book/wizardforcel/re-for-beginners"},"gitbook":true},"gitbook":"*","description":""},"file":{"path":"Part-III/Chapter-53.md","mtime":"2017-01-03T07:50:52.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-01-03T07:55:06.624Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-comment/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

