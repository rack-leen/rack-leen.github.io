
<!DOCTYPE HTML>
<html lang="zh" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>MNIST的对抗噪声 · TensorFlow 教程（Hvass）</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="wizardforcel">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-comment/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../13_Visual_Analysis_zh_CN/13_Visual_Analysis_zh_CN.html" />
    
    
    <link rel="prev" href="../11_Adversarial_Examples_zh_CN/11_Adversarial_Examples_zh_CN.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="輸入並搜尋" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://www.gitbook.com/book/wizardforcel/tf-tut-hvass" target="_blank" class="custom-link">TensorFlow 教程（Hvass）</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    TensorFlow 教程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../01_Simple_Linear_Model_zh_CN/01_Simple_Linear_Model_zh_CN.html">
            
                <a href="../01_Simple_Linear_Model_zh_CN/01_Simple_Linear_Model_zh_CN.html">
            
                    
                    简单线性模型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../02_Convolutional_Neural_Network_zh_CN/02_Convolutional_Neural_Network_zh_CN.html">
            
                <a href="../02_Convolutional_Neural_Network_zh_CN/02_Convolutional_Neural_Network_zh_CN.html">
            
                    
                    卷积神经网络
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../03_PrettyTensor_zh_CN/03_PrettyTensor_zh_CN.html">
            
                <a href="../03_PrettyTensor_zh_CN/03_PrettyTensor_zh_CN.html">
            
                    
                    PrettyTensor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../04_Save_Restore_zh_CN/04_Save_Restore_zh_CN.html">
            
                <a href="../04_Save_Restore_zh_CN/04_Save_Restore_zh_CN.html">
            
                    
                    保存 & 恢复
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../05_Ensemble_Learning_zh_CN/05_Ensemble_Learning_zh_CN.html">
            
                <a href="../05_Ensemble_Learning_zh_CN/05_Ensemble_Learning_zh_CN.html">
            
                    
                    集成学习
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../06_CIFAR-10_zh_CN/06_CIFAR-10_zh_CN.html">
            
                <a href="../06_CIFAR-10_zh_CN/06_CIFAR-10_zh_CN.html">
            
                    
                    CIFAR-10
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../07_Inception_Model_zh_CN/07_Inception_Model_zh_CN.html">
            
                <a href="../07_Inception_Model_zh_CN/07_Inception_Model_zh_CN.html">
            
                    
                    Inception 模型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../08_Transfer_Learning_zh_CN/08_Transfer_Learning_zh_CN.html">
            
                <a href="../08_Transfer_Learning_zh_CN/08_Transfer_Learning_zh_CN.html">
            
                    
                    迁移学习
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../09_Video_Data_zh_CN/09_Video_Data_zh_CN.html">
            
                <a href="../09_Video_Data_zh_CN/09_Video_Data_zh_CN.html">
            
                    
                    视频数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../11_Adversarial_Examples_zh_CN/11_Adversarial_Examples_zh_CN.html">
            
                <a href="../11_Adversarial_Examples_zh_CN/11_Adversarial_Examples_zh_CN.html">
            
                    
                    对抗样本
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.12" data-path="12_Adversarial_Noise_MNIST_zh_CN.html">
            
                <a href="12_Adversarial_Noise_MNIST_zh_CN.html">
            
                    
                    MNIST的对抗噪声
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../13_Visual_Analysis_zh_CN/13_Visual_Analysis_zh_CN.html">
            
                <a href="../13_Visual_Analysis_zh_CN/13_Visual_Analysis_zh_CN.html">
            
                    
                    可视化分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../14_DeepDream_zh_CN/14_DeepDream_zh_CN.html">
            
                <a href="../14_DeepDream_zh_CN/14_DeepDream_zh_CN.html">
            
                    
                    DeepDream
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../15_Style_Transfer_zh_CN/15_Style_Transfer_zh_CN.html">
            
                <a href="../15_Style_Transfer_zh_CN/15_Style_Transfer_zh_CN.html">
            
                    
                    风格迁移
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本書使用 GitBook 釋出
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >MNIST的对抗噪声</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="tensorflow-&#x6559;&#x7A0B;-12">TensorFlow &#x6559;&#x7A0B; #12</h1>
<h1 id="mnist&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;">MNIST&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;</h1>
<p>by <a href="http://www.hvass-labs.org/" target="_blank">Magnus Erik Hvass Pedersen</a>
/ <a href="https://github.com/Hvass-Labs/TensorFlow-Tutorials" target="_blank">GitHub</a> / <a href="https://www.youtube.com/playlist?list=PL9Hr9sNUjfsmEu1ZniY0XpHSzl5uihcXZ" target="_blank">Videos on YouTube</a><br>&#x4E2D;&#x6587;&#x7FFB;&#x8BD1; <a href="https://zhuanlan.zhihu.com/insight-pixel" target="_blank">thrillerist</a>/<a href="https://github.com/thrillerist/TensorFlow-Tutorials" target="_blank">Github</a></p>
<h2 id="&#x4ECB;&#x7ECD;">&#x4ECB;&#x7ECD;</h2>
<p>&#x4E4B;&#x524D;&#x7684;&#x6559;&#x7A0B;#11&#x5C55;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x627E;&#x5230;&#x6700;&#x5148;&#x8FDB;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x5BF9;&#x6297;&#x6837;&#x672C;&#xFF0C;&#x5B83;&#x4F1A;&#x5F15;&#x8D77;&#x7F51;&#x7EDC;&#x8BEF;&#x5206;&#x7C7B;&#x56FE;&#x50CF;&#xFF0C;&#x5373;&#x4F7F;&#x5728;&#x4EBA;&#x773C;&#x770B;&#x6765;&#x56FE;&#x50CF;&#x5B8C;&#x5168;&#x76F8;&#x540C;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5728;&#x6DFB;&#x52A0;&#x4E86;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x4E4B;&#x540E;&#xFF0C;&#x4E00;&#x5F20;&#x9E66;&#x9E49;&#x7684;&#x56FE;&#x50CF;&#x4F1A;&#x88AB;&#x8BEF;&#x5206;&#x7C7B;&#x6210;&#x4E66;&#x67B6;&#xFF0C;&#x4F46;&#x5728;&#x4EBA;&#x7C7B;&#x773C;&#x4E2D;&#x56FE;&#x50CF;&#x5B8C;&#x5168;&#x6CA1;&#x4EC0;&#x4E48;&#x53D8;&#x5316;&#x3002;</p>
<p>&#x6559;&#x7A0B;#11&#x662F;&#x901A;&#x8FC7;&#x6BCF;&#x5F20;&#x56FE;&#x50CF;&#x7684;&#x4F18;&#x5316;&#x8FC7;&#x7A0B;&#x6765;&#x5BFB;&#x627E;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x7684;&#x3002;&#x7531;&#x4E8E;&#x566A;&#x58F0;&#x662F;&#x4E13;&#x95E8;&#x4E3A;&#x67D0;&#x5F20;&#x56FE;&#x50CF;&#x751F;&#x6210;&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x53EF;&#x80FD;&#x4E0D;&#x662F;&#x901A;&#x7528;&#x7684;&#xFF0C;&#x65E0;&#x6CD5;&#x5728;&#x5176;&#x4ED6;&#x56FE;&#x50CF;&#x4E0A;&#x8D77;&#x4F5C;&#x7528;&#x3002;</p>
<p>&#x672C;&#x6559;&#x7A0B;&#x5C06;&#x4F1A;&#x627E;&#x5230;&#x90A3;&#x4E9B;&#x5BFC;&#x81F4;&#x51E0;&#x4E4E;&#x6240;&#x6709;&#x8F93;&#x5165;&#x56FE;&#x50CF;&#x90FD;&#x88AB;&#x8BEF;&#x5206;&#x7C7B;&#x6210;&#x76EE;&#x6807;&#x7C7B;&#x522B;&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x3002;&#x6211;&#x4EEC;&#x4F7F;&#x7528;MNIST&#x624B;&#x5199;&#x6570;&#x5B57;&#x6570;&#x636E;&#x96C6;&#x4E3A;&#x4F8B;&#x3002;&#x73B0;&#x5728;&#xFF0C;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x5BF9;&#x4EBA;&#x773C;&#x662F;&#x6E05;&#x6670;&#x53EF;&#x89C1;&#x7684;&#xFF0C;&#x4F46;&#x4EBA;&#x7C7B;&#x8FD8;&#x662F;&#x80FD;&#x591F;&#x5F88;&#x5BB9;&#x6613;&#x5730;&#x8FA8;&#x8BA4;&#x51FA;&#x6570;&#x5B57;&#xFF0C;&#x7136;&#x800C;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x51E0;&#x4E4E;&#x5C06;&#x6240;&#x6709;&#x56FE;&#x50CF;&#x8BEF;&#x5206;&#x7C7B;&#x3002;</p>
<p>&#x8FD9;&#x7BC7;&#x6559;&#x7A0B;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x8FD8;&#x4F1A;&#x8BD5;&#x7740;&#x8BA9;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5BF9;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x514D;&#x75AB;&#x3002;</p>
<p>&#x6559;&#x7A0B; #11 &#x7528;Numpy&#x6765;&#x505A;&#x5BF9;&#x6297;&#x4F18;&#x5316;&#x3002;&#x5728;&#x8FD9;&#x7BC7;&#x6559;&#x7A0B;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x4F1A;&#x76F4;&#x63A5;&#x5728;TensorFlow&#x91CC;&#x5B9E;&#x73B0;&#x4F18;&#x5316;&#x8FC7;&#x7A0B;&#x3002;&#x8FD9;&#x4F1A;&#x66F4;&#x5FEB;&#x901F;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x5728;&#x4F7F;&#x7528;GPU&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x56E0;&#x4E3A;&#x4E0D;&#x7528;&#x6BCF;&#x6B21;&#x8FED;&#x4EE3;&#x90FD;&#x5728;GPU&#x91CC;&#x62F7;&#x8D1D;&#x6570;&#x636E;&#x3002;</p>
<p>&#x63A8;&#x8350;&#x4F60;&#x5148;&#x5B66;&#x4E60;&#x6559;&#x7A0B; #11&#x3002;&#x4F60;&#x4E5F;&#x9700;&#x8981;&#x5927;&#x6982;&#x5730;&#x719F;&#x6089;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#xFF0C;&#x8BE6;&#x89C1;&#x6559;&#x7A0B; #01&#x548C; #02&#x3002;</p>
<h2 id="&#x6D41;&#x7A0B;&#x56FE;">&#x6D41;&#x7A0B;&#x56FE;</h2>
<p>&#x4E0B;&#x9762;&#x7684;&#x56FE;&#x8868;&#x76F4;&#x63A5;&#x5C55;&#x793A;&#x4E86;&#x4E4B;&#x540E;&#x5B9E;&#x73B0;&#x7684;&#x5377;&#x79EF;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x4E2D;&#x6570;&#x636E;&#x7684;&#x4F20;&#x9012;&#x3002;</p>
<p>&#x4F8B;&#x5B50;&#x5C55;&#x793A;&#x7684;&#x662F;&#x6570;&#x5B57;7&#x7684;&#x8F93;&#x5165;&#x56FE;&#x50CF;&#x3002;&#x968F;&#x540E;&#x5728;&#x56FE;&#x50CF;&#x4E0A;&#x6DFB;&#x52A0;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x3002;&#x7EA2;&#x8272;&#x7684;&#x566A;&#x58F0;&#x70B9;&#x662F;&#x6B63;&#x503C;&#xFF0C;&#x5B83;&#x8BA9;&#x50CF;&#x7D20;&#x503C;&#x66F4;&#x6DF1;&#xFF0C;&#x84DD;&#x8272;&#x566A;&#x58F0;&#x70B9;&#x662F;&#x8D1F;&#x503C;&#xFF0C;&#x8BA9;&#x8F93;&#x5165;&#x56FE;&#x50CF;&#x5728;&#x6B64;&#x5904;&#x7684;&#x989C;&#x8272;&#x66F4;&#x6D45;&#x3002;</p>
<p>&#x8FD9;&#x4E9B;&#x566A;&#x58F0;&#x56FE;&#x50CF;&#x4F20;&#x5230;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x4E2D;&#xFF0C;&#x7136;&#x540E;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x9884;&#x6D4B;&#x6570;&#x5B57;&#x3002;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x8BA9;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x76F8;&#x4FE1;&#x8FD9;&#x5F20;&#x6570;&#x5B57;7&#x7684;&#x56FE;&#x50CF;&#x663E;&#x793A;&#x7684;&#x662F;&#x6570;&#x5B57;3&#x3002;&#x566A;&#x58F0;&#x5BF9;&#x4EBA;&#x773C;&#x662F;&#x6E05;&#x6670;&#x53EF;&#x89C1;&#x7684;&#xFF0C;&#x4F46;&#x4EBA;&#x7C7B;&#x4ECD;&#x7136;&#x53EF;&#x4EE5;&#x5BB9;&#x6613;&#x5730;&#x8FA8;&#x8BA4;&#x51FA;&#x6570;&#x5B57;7&#x6765;&#x3002;</p>
<p>&#x8FD9;&#x8FB9;&#x503C;&#x5F97;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x5355;&#x4E00;&#x7684;&#x566A;&#x58F0;&#x6A21;&#x5F0F;&#x4F1A;&#x5BFC;&#x81F4;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5C06;&#x51E0;&#x4E4E;&#x6240;&#x6709;&#x7684;&#x8F93;&#x5165;&#x56FE;&#x50CF;&#x90FD;&#x8BEF;&#x5206;&#x7C7B;&#x6210;&#x671F;&#x671B;&#x7684;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x3002;</p>
<p>&#x5728;&#x8FD9;&#x4E2A;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x4E2D;&#x6709;&#x4E24;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x4F18;&#x5316;&#x7A0B;&#x5E8F;&#x3002;&#x9996;&#x5148;&#xFF0C;&#x6211;&#x4EEC;&#x4F18;&#x5316;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x53D8;&#x91CF;&#x6765;&#x5206;&#x7C7B;&#x8BAD;&#x7EC3;&#x96C6;&#x7684;&#x56FE;&#x50CF;&#x3002;&#x8FD9;&#x662F;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x5E38;&#x89C4;&#x4F18;&#x5316;&#x8FC7;&#x7A0B;&#x3002;&#x4E00;&#x65E6;&#x5206;&#x7C7B;&#x51C6;&#x786E;&#x7387;&#x8DB3;&#x591F;&#x9AD8;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x5207;&#x6362;&#x5230;&#x7B2C;&#x4E8C;&#x4E2A;&#x4F18;&#x5316;&#x7A0B;&#x5E8F;&#xFF0C;&#xFF08;&#x5B83;&#x7528;&#x6765;&#xFF09;&#x5BFB;&#x627E;&#x5355;&#x4E00;&#x6A21;&#x5F0F;&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#xFF0C;&#x4F7F;&#x5F97;&#x6240;&#x6709;&#x7684;&#x8F93;&#x5165;&#x56FE;&#x50CF;&#x90FD;&#x88AB;&#x8BEF;&#x5206;&#x7C7B;&#x6210;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x3002;</p>
<p>&#x8FD9;&#x4E24;&#x4E2A;&#x4F18;&#x5316;&#x7A0B;&#x5E8F;&#x662F;&#x5B8C;&#x5168;&#x72EC;&#x7ACB;&#x7684;&#x3002;&#x7B2C;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x53EA;&#x4FEE;&#x6539;&#x91CF;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x53D8;&#x91CF;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x7A0B;&#x5E8F;&#x53EA;&#x4FEE;&#x6539;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> IPython.display <span class="hljs-keyword">import</span> Image
Image(<span class="hljs-string">&apos;images/12_adversarial_noise_flowchart.png&apos;</span>)
</code></pre>
<p><img src="output_4_0.png" alt="png"></p>
<h2 id="&#x5BFC;&#x5165;">&#x5BFC;&#x5165;</h2>
<pre><code class="lang-python">%matplotlib inline
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> timedelta
<span class="hljs-keyword">import</span> math

<span class="hljs-comment"># We also need PrettyTensor.</span>
<span class="hljs-keyword">import</span> prettytensor <span class="hljs-keyword">as</span> pt
</code></pre>
<p>&#x4F7F;&#x7528;Python3.5.2&#xFF08;Anaconda&#xFF09;&#x5F00;&#x53D1;&#xFF0C;TensorFlow&#x7248;&#x672C;&#x662F;&#xFF1A;</p>
<pre><code class="lang-python">tf.__version__
</code></pre>
<pre><code>&apos;0.12.0-rc0&apos;
</code></pre><p>PrettyTensor &#x7248;&#x672C;:</p>
<pre><code class="lang-python">pt.__version__
</code></pre>
<pre><code>&apos;0.7.1&apos;
</code></pre><h2 id="&#x8F7D;&#x5165;&#x6570;&#x636E;">&#x8F7D;&#x5165;&#x6570;&#x636E;</h2>
<p>MNIST&#x6570;&#x636E;&#x96C6;&#x5927;&#x7EA6;12MB&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x5728;&#x7ED9;&#x5B9A;&#x8DEF;&#x5F84;&#x4E2D;&#x627E;&#x5230;&#x5C31;&#x4F1A;&#x81EA;&#x52A8;&#x4E0B;&#x8F7D;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> tensorflow.examples.tutorials.mnist <span class="hljs-keyword">import</span> input_data
data = input_data.read_data_sets(<span class="hljs-string">&apos;data/MNIST/&apos;</span>, one_hot=<span class="hljs-keyword">True</span>)
</code></pre>
<pre><code>Extracting data/MNIST/train-images-idx3-ubyte.gz
Extracting data/MNIST/train-labels-idx1-ubyte.gz
Extracting data/MNIST/t10k-images-idx3-ubyte.gz
Extracting data/MNIST/t10k-labels-idx1-ubyte.gz
</code></pre><p>&#x73B0;&#x5728;&#x5DF2;&#x7ECF;&#x8F7D;&#x5165;&#x4E86;MNIST&#x6570;&#x636E;&#x96C6;&#xFF0C;&#x5B83;&#x7531;70,000&#x5F20;&#x56FE;&#x50CF;&#x548C;&#x5BF9;&#x5E94;&#x7684;&#x6807;&#x7B7E;&#xFF08;&#x6BD4;&#x5982;&#x56FE;&#x50CF;&#x7684;&#x7C7B;&#x522B;&#xFF09;&#x7EC4;&#x6210;&#x3002;&#x6570;&#x636E;&#x96C6;&#x5206;&#x6210;&#x4E09;&#x4EFD;&#x4E92;&#x76F8;&#x72EC;&#x7ACB;&#x7684;&#x5B50;&#x96C6;&#x3002;&#x6211;&#x4EEC;&#x5728;&#x6559;&#x7A0B;&#x4E2D;&#x53EA;&#x7528;&#x8BAD;&#x7EC3;&#x96C6;&#x548C;&#x6D4B;&#x8BD5;&#x96C6;&#x3002;</p>
<pre><code class="lang-python">print(<span class="hljs-string">&quot;Size of:&quot;</span>)
print(<span class="hljs-string">&quot;- Training-set:\t\t{}&quot;</span>.format(len(data.train.labels)))
print(<span class="hljs-string">&quot;- Test-set:\t\t{}&quot;</span>.format(len(data.test.labels)))
print(<span class="hljs-string">&quot;- Validation-set:\t{}&quot;</span>.format(len(data.validation.labels)))
</code></pre>
<pre><code>Size of:
- Training-set:        55000
- Test-set:        10000
- Validation-set:    5000
</code></pre><p>&#x7C7B;&#x578B;&#x6807;&#x7B7E;&#x4F7F;&#x7528;One-Hot&#x7F16;&#x7801;&#xFF0C;&#x8FD9;&#x610F;&#x5916;&#x6BCF;&#x4E2A;&#x6807;&#x7B7E;&#x662F;&#x957F;&#x4E3A;10&#x7684;&#x5411;&#x91CF;&#xFF0C;&#x9664;&#x4E86;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x4E4B;&#x5916;&#xFF0C;&#x5176;&#x4ED6;&#x7684;&#x90FD;&#x4E3A;&#x96F6;&#x3002;&#x8FD9;&#x4E2A;&#x5143;&#x7D20;&#x7684;&#x7D22;&#x5F15;&#x5C31;&#x662F;&#x7C7B;&#x522B;&#x7684;&#x6570;&#x5B57;&#xFF0C;&#x5373;&#x76F8;&#x5E94;&#x56FE;&#x7247;&#x4E2D;&#x753B;&#x7684;&#x6570;&#x5B57;&#x3002;&#x6211;&#x4EEC;&#x4E5F;&#x9700;&#x8981;&#x6D4B;&#x8BD5;&#x6570;&#x636E;&#x96C6;&#x7C7B;&#x522B;&#x6570;&#x5B57;&#x7684;&#x6574;&#x578B;&#x503C;&#xFF0C;&#x73B0;&#x5728;&#x8BA1;&#x7B97;&#x5B83;&#x3002;</p>
<pre><code class="lang-python">data.test.cls = np.argmax(data.test.labels, axis=<span class="hljs-number">1</span>)
</code></pre>
<h3 id="&#x6570;&#x636E;&#x7EF4;&#x5EA6;">&#x6570;&#x636E;&#x7EF4;&#x5EA6;</h3>
<p>&#x5728;&#x4E0B;&#x9762;&#x7684;&#x6E90;&#x7801;&#x4E2D;&#xFF0C;&#x6709;&#x5F88;&#x591A;&#x5730;&#x65B9;&#x7528;&#x5230;&#x4E86;&#x6570;&#x636E;&#x7EF4;&#x5EA6;&#x3002;&#x5B83;&#x4EEC;&#x53EA;&#x5728;&#x4E00;&#x4E2A;&#x5730;&#x65B9;&#x5B9A;&#x4E49;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5728;&#x4EE3;&#x7801;&#x4E2D;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x6570;&#x5B57;&#x800C;&#x4E0D;&#x662F;&#x76F4;&#x63A5;&#x5199;&#x6570;&#x5B57;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-comment"># We know that MNIST images are 28 pixels in each dimension.</span>
img_size = <span class="hljs-number">28</span>

<span class="hljs-comment"># Images are stored in one-dimensional arrays of this length.</span>
img_size_flat = img_size * img_size

<span class="hljs-comment"># Tuple with height and width of images used to reshape arrays.</span>
img_shape = (img_size, img_size)

<span class="hljs-comment"># Number of colour channels for the images: 1 channel for gray-scale.</span>
num_channels = <span class="hljs-number">1</span>

<span class="hljs-comment"># Number of classes, one class for each of 10 digits.</span>
num_classes = <span class="hljs-number">10</span>
</code></pre>
<h3 id="&#x7528;&#x6765;&#x7ED8;&#x5236;&#x56FE;&#x50CF;&#x7684;&#x5E2E;&#x52A9;&#x51FD;&#x6570;">&#x7528;&#x6765;&#x7ED8;&#x5236;&#x56FE;&#x50CF;&#x7684;&#x5E2E;&#x52A9;&#x51FD;&#x6570;</h3>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7528;&#x6765;&#x5728;3x3&#x7684;&#x6805;&#x683C;&#x4E2D;&#x753B;9&#x5F20;&#x56FE;&#x50CF;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x6BCF;&#x5F20;&#x56FE;&#x50CF;&#x4E0B;&#x9762;&#x5199;&#x51FA;&#x771F;&#x5B9E;&#x7C7B;&#x522B;&#x548C;&#x9884;&#x6D4B;&#x7C7B;&#x522B;&#x3002;&#x5982;&#x679C;&#x63D0;&#x4F9B;&#x4E86;&#x566A;&#x58F0;&#xFF0C;&#x5C31;&#x5C06;&#x5176;&#x6DFB;&#x52A0;&#x5230;&#x6240;&#x6709;&#x56FE;&#x50CF;&#x4E0A;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">plot_images</span><span class="hljs-params">(images, cls_true, cls_pred=None, noise=<span class="hljs-number">0.0</span>)</span>:</span>
    <span class="hljs-keyword">assert</span> len(images) == len(cls_true) == <span class="hljs-number">9</span>

    <span class="hljs-comment"># Create figure with 3x3 sub-plots.</span>
    fig, axes = plt.subplots(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>)
    fig.subplots_adjust(hspace=<span class="hljs-number">0.3</span>, wspace=<span class="hljs-number">0.3</span>)

    <span class="hljs-keyword">for</span> i, ax <span class="hljs-keyword">in</span> enumerate(axes.flat):
        <span class="hljs-comment"># Get the i&apos;th image and reshape the array.</span>
        image = images[i].reshape(img_shape)

        <span class="hljs-comment"># Add the adversarial noise to the image.</span>
        image += noise

        <span class="hljs-comment"># Ensure the noisy pixel-values are between 0 and 1.</span>
        image = np.clip(image, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)

        <span class="hljs-comment"># Plot image.</span>
        ax.imshow(image,
                  cmap=<span class="hljs-string">&apos;binary&apos;</span>, interpolation=<span class="hljs-string">&apos;nearest&apos;</span>)

        <span class="hljs-comment"># Show true and predicted classes.</span>
        <span class="hljs-keyword">if</span> cls_pred <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
            xlabel = <span class="hljs-string">&quot;True: {0}&quot;</span>.format(cls_true[i])
        <span class="hljs-keyword">else</span>:
            xlabel = <span class="hljs-string">&quot;True: {0}, Pred: {1}&quot;</span>.format(cls_true[i], cls_pred[i])

        <span class="hljs-comment"># Show the classes as the label on the x-axis.</span>
        ax.set_xlabel(xlabel)

        <span class="hljs-comment"># Remove ticks from the plot.</span>
        ax.set_xticks([])
        ax.set_yticks([])

    <span class="hljs-comment"># Ensure the plot is shown correctly with multiple plots</span>
    <span class="hljs-comment"># in a single Notebook cell.</span>
    plt.show()
</code></pre>
<h3 id="&#x7ED8;&#x5236;&#x51E0;&#x5F20;&#x56FE;&#x50CF;&#x6765;&#x770B;&#x770B;&#x6570;&#x636E;&#x662F;&#x5426;&#x6B63;&#x786E;">&#x7ED8;&#x5236;&#x51E0;&#x5F20;&#x56FE;&#x50CF;&#x6765;&#x770B;&#x770B;&#x6570;&#x636E;&#x662F;&#x5426;&#x6B63;&#x786E;</h3>
<pre><code class="lang-python"><span class="hljs-comment"># Get the first images from the test-set.</span>
images = data.test.images[<span class="hljs-number">0</span>:<span class="hljs-number">9</span>]

<span class="hljs-comment"># Get the true classes for those images.</span>
cls_true = data.test.cls[<span class="hljs-number">0</span>:<span class="hljs-number">9</span>]

<span class="hljs-comment"># Plot the images and labels using our helper-function above.</span>
plot_images(images=images, cls_true=cls_true)
</code></pre>
<p><img src="output_25_0.png" alt="png"></p>
<h2 id="tensorflow&#x56FE;&#xFF08;graph&#xFF09;">TensorFlow&#x56FE;&#xFF08;Graph&#xFF09;</h2>
<p>&#x73B0;&#x5728;&#x5C06;&#x4F7F;&#x7528;TensorFlow&#x548C;PrettyTensor&#x6784;&#x5EFA;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x8BA1;&#x7B97;&#x56FE;&#x3002; &#x4E0E;&#x5F80;&#x5E38;&#x4E00;&#x6837;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4E3A;&#x56FE;&#x50CF;&#x521B;&#x5EFA;&#x5360;&#x4F4D;&#x7B26;&#x53D8;&#x91CF;&#xFF0C;&#x5C06;&#x5176;&#x9001;&#x5230;&#x8BA1;&#x7B97;&#x56FE;&#x4E2D;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x6DFB;&#x52A0;&#x5230;&#x56FE;&#x50CF;&#x4E2D;&#x3002;&#x63A5;&#x7740;&#x628A;&#x566A;&#x58F0;&#x56FE;&#x50CF;&#x7528;&#x4F5C;&#x5377;&#x79EF;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x8F93;&#x5165;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x7F51;&#x7EDC;&#x6709;&#x4E24;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x4F18;&#x5316;&#x7A0B;&#x5E8F;&#x3002;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x672C;&#x8EAB;&#x53D8;&#x91CF;&#x7684;&#x4E00;&#x4E2A;&#x5E38;&#x89C4;&#x4F18;&#x5316;&#x8FC7;&#x7A0B;&#xFF0C;&#x4EE5;&#x53CA;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x4F18;&#x5316;&#x8FC7;&#x7A0B;&#x3002; &#x4E24;&#x4E2A;&#x4F18;&#x5316;&#x8FC7;&#x7A0B;&#x90FD;&#x76F4;&#x63A5;&#x5728;TensorFlow&#x4E2D;&#x5B9E;&#x73B0;&#x3002;</p>
<h3 id="&#x5360;&#x4F4D;&#x7B26;-&#xFF08;placeholder&#xFF09;&#x53D8;&#x91CF;">&#x5360;&#x4F4D;&#x7B26; &#xFF08;Placeholder&#xFF09;&#x53D8;&#x91CF;</h3>
<p>&#x5360;&#x4F4D;&#x7B26;&#x53D8;&#x91CF;&#x4E3A;TensorFlow&#x4E2D;&#x7684;&#x8BA1;&#x7B97;&#x56FE;&#x63D0;&#x4F9B;&#x4E86;&#x8F93;&#x5165;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5728;&#x6BCF;&#x6B21;&#x6267;&#x884C;&#x56FE;&#x7684;&#x65F6;&#x5019;&#x66F4;&#x6539;&#x3002; &#x6211;&#x4EEC;&#x79F0;&#x4E3A;feeding&#x5360;&#x4F4D;&#x7B26;&#x53D8;&#x91CF;&#x3002;</p>
<p>&#x9996;&#x5148;&#xFF0C;&#x6211;&#x4EEC;&#x4E3A;&#x8F93;&#x5165;&#x56FE;&#x50CF;&#x5B9A;&#x4E49;&#x5360;&#x4F4D;&#x7B26;&#x53D8;&#x91CF;&#x3002; &#x8FD9;&#x5141;&#x8BB8;&#x6211;&#x4EEC;&#x6539;&#x53D8;&#x8F93;&#x5165;&#x5230;TensorFlow&#x56FE;&#x4E2D;&#x7684;&#x56FE;&#x50CF;&#x3002; &#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x5F20;&#x91CF;&#xFF0C;&#x4EE3;&#x8868;&#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x591A;&#x7EF4;&#x6570;&#x7EC4;&#x3002; &#x6570;&#x636E;&#x7C7B;&#x578B;&#x8BBE;&#x4E3A;<code>float32</code>&#xFF0C;&#x5F62;&#x72B6;&#x8BBE;&#x4E3A;<code>[None&#xFF0C;img_size_flat]</code>&#xFF0C;&#x5176;&#x4E2D;<code>None</code>&#x4EE3;&#x8868;&#x5F20;&#x91CF;&#x53EF;&#x4EE5;&#x4FDD;&#x5B58;&#x4EFB;&#x610F;&#x6570;&#x91CF;&#x7684;&#x56FE;&#x50CF;&#xFF0C;&#x6BCF;&#x4E2A;&#x56FE;&#x50CF;&#x662F;&#x957F;&#x5EA6;&#x4E3A;<code>img_size_flat</code>&#x7684;&#x5411;&#x91CF;&#x3002;</p>
<pre><code class="lang-python">x = tf.placeholder(tf.float32, shape=[<span class="hljs-keyword">None</span>, img_size_flat], name=<span class="hljs-string">&apos;x&apos;</span>)
</code></pre>
<p>&#x5377;&#x79EF;&#x5C42;&#x5E0C;&#x671B;<code>x</code>&#x88AB;&#x7F16;&#x7801;&#x4E3A;4&#x7EF4;&#x5F20;&#x91CF;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5C06;&#x5B83;&#x7684;&#x5F62;&#x72B6;&#x8F6C;&#x6362;&#x81F3;<code>[num_images, img_height, img_width, num_channels]</code>&#x3002;&#x6CE8;&#x610F;<code>img_height == img_width == img_size</code>&#xFF0C;&#x5982;&#x679C;&#x7B2C;&#x4E00;&#x7EF4;&#x7684;&#x5927;&#x5C0F;&#x8BBE;&#x4E3A;-1&#xFF0C; num_images&#x7684;&#x5927;&#x5C0F;&#x4E5F;&#x4F1A;&#x88AB;&#x81EA;&#x52A8;&#x63A8;&#x5BFC;&#x51FA;&#x6765;&#x3002;&#x8F6C;&#x6362;&#x8FD0;&#x7B97;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-python">x_image = tf.reshape(x, [<span class="hljs-number">-1</span>, img_size, img_size, num_channels])
</code></pre>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x4E3A;&#x8F93;&#x5165;&#x53D8;&#x91CF;x&#x4E2D;&#x7684;&#x56FE;&#x50CF;&#x6240;&#x5BF9;&#x5E94;&#x7684;&#x771F;&#x5B9E;&#x6807;&#x7B7E;&#x5B9A;&#x4E49;&#x5360;&#x4F4D;&#x7B26;&#x53D8;&#x91CF;&#x3002;&#x53D8;&#x91CF;&#x7684;&#x5F62;&#x72B6;&#x662F;<code>[None, num_classes]</code>&#xFF0C;&#x8FD9;&#x4EE3;&#x8868;&#x7740;&#x5B83;&#x4FDD;&#x5B58;&#x4E86;&#x4EFB;&#x610F;&#x6570;&#x91CF;&#x7684;&#x6807;&#x7B7E;&#xFF0C;&#x6BCF;&#x4E2A;&#x6807;&#x7B7E;&#x662F;&#x957F;&#x5EA6;&#x4E3A;<code>num_classes</code>&#x7684;&#x5411;&#x91CF;&#xFF0C;&#x672C;&#x4F8B;&#x4E2D;&#x957F;&#x5EA6;&#x4E3A;10&#x3002;</p>
<pre><code class="lang-python">y_true = tf.placeholder(tf.float32, shape=[<span class="hljs-keyword">None</span>, num_classes], name=<span class="hljs-string">&apos;y_true&apos;</span>)
</code></pre>
<p>&#x6211;&#x4EEC;&#x4E5F;&#x53EF;&#x4EE5;&#x4E3A;&#x7C7B;&#x522B;&#x53F7;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x5360;&#x4F4D;&#x7B26;&#xFF0C;&#x4F46;&#x8FD9;&#x91CC;&#x7528;argmax&#x6765;&#x8BA1;&#x7B97;&#x5B83;&#x3002;&#x8FD9;&#x91CC;&#x53EA;&#x662F;TensorFlow&#x4E2D;&#x7684;&#x4E00;&#x4E9B;&#x64CD;&#x4F5C;&#x7B26;&#xFF0C;&#x6CA1;&#x6709;&#x6267;&#x884C;&#x4EC0;&#x4E48;&#x8FD0;&#x7B97;&#x3002;</p>
<pre><code class="lang-python">y_true_cls = tf.argmax(y_true, dimension=<span class="hljs-number">1</span>)
</code></pre>
<h3 id="&#x5BF9;&#x6297;&#x566A;&#x58F0;">&#x5BF9;&#x6297;&#x566A;&#x58F0;</h3>
<p>&#x8F93;&#x5165;&#x56FE;&#x50CF;&#x7684;&#x50CF;&#x7D20;&#x503C;&#x5728;0.0&#x5230;1.0&#x4E4B;&#x95F4;&#x3002;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x662F;&#x5728;&#x8F93;&#x5165;&#x56FE;&#x50CF;&#x4E0A;&#x6DFB;&#x52A0;&#x6216;&#x5220;&#x9664;&#x7684;&#x6570;&#x503C;&#x3002;</p>
<p>&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x7684;&#x754C;&#x9650;&#x8BBE;&#x4E3A;0.35&#xFF0C;&#x5219;&#x566A;&#x58F0;&#x5728;&#x6B63;&#x8D1F;0.35&#x4E4B;&#x95F4;&#x3002;</p>
<pre><code class="lang-python">noise_limit = <span class="hljs-number">0.35</span>
</code></pre>
<p>&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x7684;&#x4F18;&#x5316;&#x5668;&#x4F1A;&#x8BD5;&#x56FE;&#x6700;&#x5C0F;&#x5316;&#x4E24;&#x4E2A;&#x635F;&#x5931;&#x5EA6;&#x91CF;&#xFF1A;(1)&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5E38;&#x89C4;&#x7684;&#x635F;&#x5931;&#x5EA6;&#x91CF;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x4F1A;&#x627E;&#x5230;&#x4F7F;&#x5F97;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x5206;&#x7C7B;&#x51C6;&#x786E;&#x7387;&#x6700;&#x9AD8;&#x7684;&#x566A;&#x58F0;&#xFF1B;(2)L2-loss&#x5EA6;&#x91CF;&#xFF0C;&#x5B83;&#x4F1A;&#x4FDD;&#x6301;&#x5C3D;&#x53EF;&#x80FD;&#x4F4E;&#x7684;&#x566A;&#x58F0;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x7684;&#x6743;&#x91CD;&#x51B3;&#x5B9A;&#x4E86;&#x4E0E;&#x5E38;&#x89C4;&#x7684;&#x635F;&#x5931;&#x5EA6;&#x91CF;&#x76F8;&#x6BD4;&#xFF0C;L2-loss&#x7684;&#x91CD;&#x8981;&#x6027;&#x3002;&#x901A;&#x5E38;&#x63A5;&#x8FD1;&#x96F6;&#x7684;L2&#x6743;&#x91CD;&#x8868;&#x73B0;&#x7684;&#x66F4;&#x597D;&#x3002;</p>
<pre><code class="lang-python">noise_l2_weight = <span class="hljs-number">0.02</span>
</code></pre>
<p>&#x5F53;&#x6211;&#x4EEC;&#x4E3A;&#x566A;&#x58F0;&#x521B;&#x5EFA;&#x53D8;&#x91CF;&#x65F6;&#xFF0C;&#x5FC5;&#x987B;&#x544A;&#x77E5;TensorFlow&#x5B83;&#x5C5E;&#x4E8E;&#x54EA;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x96C6;&#x5408;&#xFF0C;&#x8FD9;&#x6837;&#xFF0C;&#x540E;&#x9762;&#x5C31;&#x80FD;&#x901A;&#x77E5;&#x4E24;&#x4E2A;&#x4F18;&#x5316;&#x5668;&#x8981;&#x66F4;&#x65B0;&#x54EA;&#x4E9B;&#x53D8;&#x91CF;&#x3002;</p>
<p>&#x9996;&#x5148;&#x4E3A;&#x53D8;&#x91CF;&#x96C6;&#x5408;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x540D;&#x79F0;&#x3002;&#x8FD9;&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x3002;</p>
<pre><code class="lang-python">ADVERSARY_VARIABLES = <span class="hljs-string">&apos;adversary_variables&apos;</span>
</code></pre>
<p>&#x63A5;&#x7740;&#xFF0C;&#x521B;&#x5EFA;&#x566A;&#x58F0;&#x53D8;&#x91CF;&#x6240;&#x5C5E;&#x96C6;&#x5408;&#x7684;&#x5217;&#x8868;&#x3002;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5C06;&#x566A;&#x58F0;&#x53D8;&#x91CF;&#x6DFB;&#x52A0;&#x5230;&#x96C6;&#x5408;<code>tf.GraphKeys.VARIABLES</code>&#x4E2D;&#xFF0C;&#x5B83;&#x5C31;&#x4F1A;&#x548C;TensorFlow&#x56FE;&#x4E2D;&#x7684;&#x5176;&#x4ED6;&#x53D8;&#x91CF;&#x4E00;&#x8D77;&#x88AB;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x4F46;&#x4E0D;&#x4F1A;&#x88AB;&#x4F18;&#x5316;&#x3002;&#x8FD9;&#x91CC;&#x6709;&#x70B9;&#x6DF7;&#x4E71;&#x3002;</p>
<pre><code class="lang-python">collections = [tf.GraphKeys.VARIABLES, ADVERSARY_VARIABLES]
</code></pre>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4E3A;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x6DFB;&#x52A0;&#x65B0;&#x7684;&#x53D8;&#x91CF;&#x3002;&#x5B83;&#x4F1A;&#x88AB;&#x521D;&#x59CB;&#x5316;&#x4E3A;&#x96F6;&#x3002;&#x5B83;&#x662F;&#x4E0D;&#x53EF;&#x8BAD;&#x7EC3;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x5E76;&#x4E0D;&#x4F1A;&#x4E0E;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x4E2D;&#x7684;&#x5176;&#x4ED6;&#x53D8;&#x91CF;&#x4E00;&#x8D77;&#x88AB;&#x4F18;&#x5316;&#x3002;&#x8FD9;&#x8BA9;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x4E24;&#x4E2A;&#x72EC;&#x7ACB;&#x7684;&#x4F18;&#x5316;&#x7A0B;&#x5E8F;&#x3002;</p>
<pre><code class="lang-python">x_noise = tf.Variable(tf.zeros([img_size, img_size, num_channels]),
                      name=<span class="hljs-string">&apos;x_noise&apos;</span>, trainable=<span class="hljs-keyword">False</span>,
                      collections=collections)
</code></pre>
<p>&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x4F1A;&#x88AB;&#x9650;&#x5236;&#x5728;&#x6211;&#x4EEC;&#x4E0A;&#x9762;&#x8BBE;&#x5B9A;&#x7684;&#x566A;&#x58F0;&#x754C;&#x9650;&#x5185;&#x3002;&#x6CE8;&#x610F;&#x6B64;&#x65F6;&#x5E76;&#x672A;&#x5728;&#x8BA1;&#x7B97;&#x56FE;&#x8868;&#x5185;&#x8FDB;&#x884C;&#x8BA1;&#x7B97;&#xFF0C;&#x5728;&#x4F18;&#x5316;&#x6B65;&#x9AA4;&#x4E4B;&#x540E;&#x6267;&#x884C;&#xFF0C;&#x8BE6;&#x89C1;&#x4E0B;&#x6587;&#x3002;</p>
<pre><code class="lang-python">x_noise_clip = tf.assign(x_noise, tf.clip_by_value(x_noise,
                                                   -noise_limit,
                                                   noise_limit))
</code></pre>
<p>&#x566A;&#x58F0;&#x56FE;&#x50CF;&#x53EA;&#x662F;&#x8F93;&#x5165;&#x56FE;&#x50CF;&#x548C;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x7684;&#x603B;&#x548C;&#x3002;</p>
<pre><code class="lang-python">x_noisy_image = x_image + x_noise
</code></pre>
<p>&#x628A;&#x566A;&#x58F0;&#x56FE;&#x50CF;&#x6DFB;&#x52A0;&#x5230;&#x8F93;&#x5165;&#x56FE;&#x50CF;&#x4E0A;&#x65F6;&#xFF0C;&#x5B83;&#x53EF;&#x80FD;&#x4F1A;&#x6EA2;&#x51FA;&#x6709;&#x6548;&#x56FE;&#x50CF;&#xFF08;&#x50CF;&#x7D20;&#xFF09;&#x7684;&#x8FB9;&#x754C;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x88C1;&#x526A;/&#x9650;&#x5236;&#x566A;&#x58F0;&#x56FE;&#x50CF;&#xFF0C;&#x786E;&#x4FDD;&#x5B83;&#x7684;&#x50CF;&#x7D20;&#x503C;&#x5728;0&#x5230;1&#x4E4B;&#x95F4;&#x3002;</p>
<pre><code class="lang-python">x_noisy_image = tf.clip_by_value(x_noisy_image, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)
</code></pre>
<h3 id="&#x5377;&#x79EF;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;">&#x5377;&#x79EF;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;</h3>
<p>&#x6211;&#x4EEC;&#x4F1A;&#x7528;PrettyTensor&#x6765;&#x6784;&#x9020;&#x5377;&#x79EF;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x3002;&#x9996;&#x5148;&#x9700;&#x8981;&#x5C06;&#x566A;&#x58F0;&#x56FE;&#x50CF;&#x7684;&#x5F20;&#x91CF;&#x5C01;&#x88C5;&#x5230;PrettyTensor&#x5BF9;&#x8C61;&#x4E2D;&#xFF0C;&#x8BE5;&#x5BF9;&#x8C61;&#x63D0;&#x4F9B;&#x4E86;&#x6784;&#x9020;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x51FD;&#x6570;&#x3002;</p>
<pre><code class="lang-python">x_pretty = pt.wrap(x_noisy_image)
</code></pre>
<p>&#x5C06;&#x8F93;&#x5165;&#x56FE;&#x50CF;&#x5C01;&#x88C5;&#x5230;PrettyTensor&#x5BF9;&#x8C61;&#x4E4B;&#x540E;&#xFF0C;&#x7528;&#x51E0;&#x884C;&#x4EE3;&#x7801;&#x5C31;&#x80FD;&#x6DFB;&#x52A0;&#x5377;&#x79EF;&#x5C42;&#x548C;&#x5168;&#x8FDE;&#x63A5;&#x5C42;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-keyword">with</span> pt.defaults_scope(activation_fn=tf.nn.relu):
    y_pred, loss = x_pretty.\
        conv2d(kernel=<span class="hljs-number">5</span>, depth=<span class="hljs-number">16</span>, name=<span class="hljs-string">&apos;layer_conv1&apos;</span>).\
        max_pool(kernel=<span class="hljs-number">2</span>, stride=<span class="hljs-number">2</span>).\
        conv2d(kernel=<span class="hljs-number">5</span>, depth=<span class="hljs-number">36</span>, name=<span class="hljs-string">&apos;layer_conv2&apos;</span>).\
        max_pool(kernel=<span class="hljs-number">2</span>, stride=<span class="hljs-number">2</span>).\
        flatten().\
        fully_connected(size=<span class="hljs-number">128</span>, name=<span class="hljs-string">&apos;layer_fc1&apos;</span>).\
        softmax_classifier(num_classes=num_classes, labels=y_true)
</code></pre>
<p>&#x6CE8;&#x610F;&#xFF0C;&#x5728;<code>with</code>&#x4EE3;&#x7801;&#x5757;&#x4E2D;&#xFF0C;<code>pt.defaults_scope(activation_fn=tf.nn.relu)</code> &#x628A; <code>activation_fn=tf.nn.relu</code>&#x5F53;&#x4F5C;&#x6BCF;&#x4E2A;&#x7684;&#x5C42;&#x53C2;&#x6570;&#xFF0C;&#x56E0;&#x6B64;&#x8FD9;&#x4E9B;&#x5C42;&#x90FD;&#x7528;&#x5230;&#x4E86; Rectified Linear Units (ReLU) &#x3002;defaults_scope&#x4F7F;&#x6211;&#x4EEC;&#x80FD;&#x66F4;&#x65B9;&#x4FBF;&#x5730;&#x4FEE;&#x6539;&#x6240;&#x6709;&#x5C42;&#x7684;&#x53C2;&#x6570;&#x3002;</p>
<h3 id="&#x6B63;&#x5E38;&#x8BAD;&#x7EC3;&#x7684;&#x4F18;&#x5316;&#x5668;">&#x6B63;&#x5E38;&#x8BAD;&#x7EC3;&#x7684;&#x4F18;&#x5316;&#x5668;</h3>
<p>&#x8FD9;&#x662F;&#x4F1A;&#x5728;&#x5E38;&#x89C4;&#x4F18;&#x5316;&#x7A0B;&#x5E8F;&#x91CC;&#x88AB;&#x8BAD;&#x7EC3;&#x7684;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x53D8;&#x91CF;&#x5217;&#x8868;&#x3002;&#x6CE8;&#x610F;&#xFF0C;<code>&apos;x_noise:0&apos;</code>&#x4E0D;&#x5728;&#x5217;&#x8868;&#x91CC;&#xFF0C;&#x56E0;&#x6B64;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x5E76;&#x4E0D;&#x4F1A;&#x4F18;&#x5316;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x3002;</p>
<pre><code class="lang-python">[var.name <span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> tf.trainable_variables()]
</code></pre>
<pre><code>[&apos;layer_conv1/weights:0&apos;,
 &apos;layer_conv1/bias:0&apos;,
 &apos;layer_conv2/weights:0&apos;,
 &apos;layer_conv2/bias:0&apos;,
 &apos;layer_fc1/weights:0&apos;,
 &apos;layer_fc1/bias:0&apos;,
 &apos;fully_connected/weights:0&apos;,
 &apos;fully_connected/bias:0&apos;]
</code></pre><p>&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x4E2D;&#x8FD9;&#x4E9B;&#x53D8;&#x91CF;&#x7684;&#x4F18;&#x5316;&#x7531;Adam-optimizer&#x5B8C;&#x6210;&#xFF0C;&#x5B83;&#x7528;&#x5230;&#x4E0A;&#x9762;PretyTensor&#x6784;&#x9020;&#x7684;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x6240;&#x8FD4;&#x56DE;&#x7684;&#x635F;&#x5931;&#x5EA6;&#x91CF;&#x3002;</p>
<p>&#x6B64;&#x65F6;&#x4E0D;&#x6267;&#x884C;&#x4F18;&#x5316;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x8FD9;&#x91CC;&#x6839;&#x672C;&#x6CA1;&#x6709;&#x8BA1;&#x7B97;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x662F;&#x628A;&#x4F18;&#x5316;&#x5BF9;&#x8C61;&#x6DFB;&#x52A0;&#x5230;TensorFlow&#x56FE;&#x8868;&#x4E2D;&#xFF0C;&#x4EE5;&#x4FBF;&#x7A0D;&#x540E;&#x8FD0;&#x884C;&#x3002;</p>
<pre><code class="lang-python">optimizer = tf.train.AdamOptimizer(learning_rate=<span class="hljs-number">1e-4</span>).minimize(loss)
</code></pre>
<h3 id="&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x7684;&#x4F18;&#x5316;&#x5668;">&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x7684;&#x4F18;&#x5316;&#x5668;</h3>
<p>&#x83B7;&#x53D6;&#x53D8;&#x91CF;&#x5217;&#x8868;&#xFF0C;&#x8FD9;&#x4E9B;&#x662F;&#x9700;&#x8981;&#x5728;&#x7B2C;&#x4E8C;&#x4E2A;&#x7A0B;&#x5E8F;&#x91CC;&#x4E3A;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x505A;&#x4F18;&#x5316;&#x7684;&#x53D8;&#x91CF;&#x3002;</p>
<pre><code class="lang-python">adversary_variables = tf.get_collection(ADVERSARY_VARIABLES)
</code></pre>
<p>&#x5C55;&#x793A;&#x53D8;&#x91CF;&#x540D;&#x79F0;&#x5217;&#x8868;&#x3002;&#x8FD9;&#x91CC;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#xFF0C;&#x662F;&#x6211;&#x4EEC;&#x5728;&#x4E0A;&#x9762;&#x521B;&#x5EFA;&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x53D8;&#x91CF;&#x3002;</p>
<pre><code class="lang-python">[var.name <span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> adversary_variables]
</code></pre>
<pre><code>[&apos;x_noise:0&apos;]
</code></pre><p>&#x6211;&#x4EEC;&#x4F1A;&#x5C06;&#x5E38;&#x89C4;&#x4F18;&#x5316;&#x7684;&#x635F;&#x5931;&#x51FD;&#x6570;&#x4E0E;&#x6240;&#x8C13;&#x7684;L2-loss&#x76F8;&#x7ED3;&#x5408;&#x3002;&#x8FD9;&#x5C06;&#x4F1A;&#x5F97;&#x5230;&#x5728;&#x6700;&#x4F73;&#x5206;&#x7C7B;&#x51C6;&#x786E;&#x7387;&#x4E0B;&#x7684;&#x6700;&#x5C0F;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x3002;</p>
<p>L2-loss&#x7531;&#x4E00;&#x4E2A;&#x901A;&#x5E38;&#x8BBE;&#x7F6E;&#x4E3A;&#x63A5;&#x8FD1;&#x96F6;&#x7684;&#x6743;&#x91CD;&#x7F29;&#x653E;&#x3002;</p>
<pre><code class="lang-python">l2_loss_noise = noise_l2_weight * tf.nn.l2_loss(x_noise)
</code></pre>
<p>&#x5C06;&#x6B63;&#x5E38;&#x7684;&#x635F;&#x5931;&#x51FD;&#x6570;&#x548C;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x7684;L2-loss&#x76F8;&#x7ED3;&#x5408;&#x3002;</p>
<pre><code class="lang-python">loss_adversary = loss + l2_loss_noise
</code></pre>
<p>&#x73B0;&#x5728;&#x53EF;&#x4EE5;&#x4E3A;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x521B;&#x5EFA;&#x4F18;&#x5316;&#x5668;&#x3002;&#x7531;&#x4E8E;&#x4F18;&#x5316;&#x5668;&#x5E76;&#x4E0D;&#x80FD;&#x66F4;&#x65B0;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x6240;&#x6709;&#x53D8;&#x91CF;&#xFF0C;&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x9700;&#x8981;&#x66F4;&#x65B0;&#x7684;&#x53D8;&#x91CF;&#x7684;&#x5217;&#x8868;&#xFF0C;&#x5373;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x53D8;&#x91CF;&#x3002;&#x6CE8;&#x610F;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;&#x5B66;&#x4E60;&#x7387;&#x6BD4;&#x4E0A;&#x9762;&#x7684;&#x5E38;&#x89C4;&#x4F18;&#x5316;&#x5668;&#x8981;&#x5927;&#x5F88;&#x591A;&#x3002;</p>
<pre><code class="lang-python">optimizer_adversary = tf.train.AdamOptimizer(learning_rate=<span class="hljs-number">1e-2</span>).minimize(loss_adversary, var_list=adversary_variables)
</code></pre>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x4E3A;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x521B;&#x5EFA;&#x4E86;&#x4E24;&#x4E2A;&#x4F18;&#x5316;&#x5668;&#xFF0C;&#x4E00;&#x4E2A;&#x7528;&#x4E8E;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x53D8;&#x91CF;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x7528;&#x4E8E;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x7684;&#x5355;&#x4E2A;&#x53D8;&#x91CF;&#x3002;</p>
<h3 id="&#x6027;&#x80FD;&#x5EA6;&#x91CF;">&#x6027;&#x80FD;&#x5EA6;&#x91CF;</h3>
<p>&#x5728;TensorFlow&#x56FE;&#x8868;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x53E6;&#x5916;&#x4E00;&#x4E9B;&#x64CD;&#x4F5C;&#xFF0C;&#x4EE5;&#x4FBF;&#x5728;&#x4F18;&#x5316;&#x8FC7;&#x7A0B;&#x4E2D;&#x5411;&#x7528;&#x6237;&#x5C55;&#x793A;&#x8FDB;&#x5EA6;&#x3002;</p>
<p>&#x9996;&#x5148;&#xFF0C;&#x8BA1;&#x7B97;&#x51FA;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x8F93;&#x51FA;<code>y_pred</code>&#x7684;&#x9884;&#x6D4B;&#x7C7B;&#x522B;&#x53F7;&#xFF0C;&#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x5305;&#x542B;10&#x4E2A;&#x5143;&#x7D20;&#x7684;&#x5411;&#x91CF;&#x3002;&#x7C7B;&#x578B;&#x53F7;&#x662F;&#x6700;&#x5927;&#x5143;&#x7D20;&#x7684;&#x7D22;&#x5F15;&#x3002;</p>
<pre><code class="lang-python">y_pred_cls = tf.argmax(y_pred, dimension=<span class="hljs-number">1</span>)
</code></pre>
<p>&#x63A5;&#x7740;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5E03;&#x5C14;&#x6570;&#x7EC4;&#xFF0C;&#x7528;&#x6765;&#x8868;&#x793A;&#x6BCF;&#x5F20;&#x56FE;&#x50CF;&#x7684;&#x9884;&#x6D4B;&#x7C7B;&#x578B;&#x662F;&#x5426;&#x4E0E;&#x771F;&#x5B9E;&#x7C7B;&#x578B;&#x76F8;&#x540C;&#x3002;</p>
<pre><code class="lang-python">correct_prediction = tf.equal(y_pred_cls, y_true_cls)
</code></pre>
<p>&#x4E0A;&#x9762;&#x7684;&#x8BA1;&#x7B97;&#x5148;&#x5C06;&#x5E03;&#x5C14;&#x503C;&#x5411;&#x91CF;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x6210;&#x6D6E;&#x70B9;&#x578B;&#x5411;&#x91CF;&#xFF0C;&#x8FD9;&#x6837;&#x5B50;False&#x5C31;&#x53D8;&#x6210;0&#xFF0C;True&#x53D8;&#x6210;1&#xFF0C;&#x7136;&#x540E;&#x8BA1;&#x7B97;&#x8FD9;&#x4E9B;&#x503C;&#x7684;&#x5E73;&#x5747;&#x6570;&#xFF0C;&#x4EE5;&#x6B64;&#x6765;&#x8BA1;&#x7B97;&#x5206;&#x7C7B;&#x7684;&#x51C6;&#x786E;&#x5EA6;&#x3002;</p>
<pre><code class="lang-python">accuracy = tf.reduce_mean(tf.cast(correct_prediction, tf.float32))
</code></pre>
<h2 id="&#x8FD0;&#x884C;tensorflow">&#x8FD0;&#x884C;TensorFlow</h2>
<h3 id="&#x521B;&#x5EFA;tensorflow&#x4F1A;&#x8BDD;&#xFF08;session&#xFF09;">&#x521B;&#x5EFA;TensorFlow&#x4F1A;&#x8BDD;&#xFF08;session&#xFF09;</h3>
<p>&#x4E00;&#x65E6;&#x521B;&#x5EFA;&#x4E86;TensorFlow&#x56FE;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;TensorFlow&#x4F1A;&#x8BDD;&#xFF0C;&#x7528;&#x6765;&#x8FD0;&#x884C;&#x56FE;&#x3002;</p>
<pre><code class="lang-python">session = tf.Session()
</code></pre>
<h3 id="&#x521D;&#x59CB;&#x5316;&#x53D8;&#x91CF;">&#x521D;&#x59CB;&#x5316;&#x53D8;&#x91CF;</h3>
<p>&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5728;&#x5F00;&#x59CB;&#x4F18;&#x5316;<code>weights</code>&#x548C;<code>biases</code>&#x53D8;&#x91CF;&#x4E4B;&#x524D;&#x5BF9;&#x5B83;&#x4EEC;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#x3002;</p>
<pre><code class="lang-python">session.run(tf.global_variables_initializer())
</code></pre>
<p>&#x5E2E;&#x52A9;&#x51FD;&#x6570;&#x5C06;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x521D;&#x59CB;&#x5316;/&#x91CD;&#x7F6E;&#x4E3A;&#x96F6;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">init_noise</span><span class="hljs-params">()</span>:</span>
    session.run(tf.variables_initializer([x_noise]))
</code></pre>
<p>&#x8C03;&#x7528;&#x51FD;&#x6570;&#x6765;&#x521D;&#x59CB;&#x5316;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x3002;</p>
<pre><code class="lang-python">init_noise()
</code></pre>
<h3 id="&#x7528;&#x6765;&#x4F18;&#x5316;&#x8FED;&#x4EE3;&#x7684;&#x5E2E;&#x52A9;&#x51FD;&#x6570;">&#x7528;&#x6765;&#x4F18;&#x5316;&#x8FED;&#x4EE3;&#x7684;&#x5E2E;&#x52A9;&#x51FD;&#x6570;</h3>
<p>&#x5728;&#x8BAD;&#x7EC3;&#x96C6;&#x4E2D;&#x6709;55,000&#x5F20;&#x56FE;&#x3002;&#x7528;&#x5168;&#x90E8;&#x56FE;&#x50CF;&#x8BA1;&#x7B97;&#x6A21;&#x578B;&#x7684;&#x68AF;&#x5EA6;&#x4F1A;&#x82B1;&#x5F88;&#x591A;&#x65F6;&#x95F4;&#x3002;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x5728;&#x4F18;&#x5316;&#x5668;&#x7684;&#x6BCF;&#x6B21;&#x8FED;&#x4EE3;&#x91CC;&#x53EA;&#x7528;&#x5230;&#x4E86;&#x4E00;&#x5C0F;&#x90E8;&#x5206;&#x7684;&#x56FE;&#x50CF;&#x3002;</p>
<p>&#x5982;&#x679C;&#x5185;&#x5B58;&#x8017;&#x5C3D;&#x5BFC;&#x81F4;&#x7535;&#x8111;&#x6B7B;&#x673A;&#x6216;&#x53D8;&#x5F97;&#x5F88;&#x6162;&#xFF0C;&#x4F60;&#x5E94;&#x8BE5;&#x8BD5;&#x7740;&#x51CF;&#x5C11;&#x8FD9;&#x4E9B;&#x6570;&#x91CF;&#xFF0C;&#x4F46;&#x540C;&#x65F6;&#x53EF;&#x80FD;&#x8FD8;&#x9700;&#x8981;&#x66F4;&#x4F18;&#x5316;&#x7684;&#x8FED;&#x4EE3;&#x3002;</p>
<pre><code class="lang-python">train_batch_size = <span class="hljs-number">64</span>
</code></pre>
<p>&#x4E0B;&#x9762;&#x7684;&#x51FD;&#x6570;&#x7528;&#x6765;&#x6267;&#x884C;&#x4E00;&#x5B9A;&#x6570;&#x91CF;&#x7684;&#x4F18;&#x5316;&#x8FED;&#x4EE3;&#xFF0C;&#x4EE5;&#x6B64;&#x6765;&#x9010;&#x6E10;&#x6539;&#x5584;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x53D8;&#x91CF;&#x3002;&#x5728;&#x6BCF;&#x6B21;&#x8FED;&#x4EE3;&#x4E2D;&#xFF0C;&#x4F1A;&#x4ECE;&#x8BAD;&#x7EC3;&#x96C6;&#x4E2D;&#x9009;&#x62E9;&#x65B0;&#x7684;&#x4E00;&#x6279;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;TensorFlow&#x5728;&#x8FD9;&#x4E9B;&#x8BAD;&#x7EC3;&#x6837;&#x672C;&#x4E0A;&#x6267;&#x884C;&#x4F18;&#x5316;&#x3002;&#x6BCF;100&#x6B21;&#x8FED;&#x4EE3;&#x4F1A;&#x6253;&#x5370;&#x51FA;&#x8FDB;&#x5EA6;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4E0E;&#x4E4B;&#x524D;&#x6559;&#x7A0B;&#x4E2D;&#x7684;&#x76F8;&#x4F3C;&#xFF0C;&#x9664;&#x4E86;&#x73B0;&#x5728;&#x5B83;&#x591A;&#x4E86;&#x4E00;&#x4E2A;&#x5BF9;&#x6297;&#x76EE;&#x6807;&#x7C7B;&#x522B;(adversary target-class)&#x7684;&#x53C2;&#x6570;&#x3002;&#x5F53;&#x76EE;&#x6807;&#x7C7B;&#x522B;&#x8BBE;&#x4E3A;&#x6574;&#x6570;&#x65F6;&#xFF0C;&#x5C06;&#x4F1A;&#x7528;&#x5B83;&#x53D6;&#x4EE3;&#x8BAD;&#x7EC3;&#x96C6;&#x4E2D;&#x7684;&#x771F;&#x5B9E;&#x7C7B;&#x522B;&#x53F7;&#x3002;&#x4E5F;&#x4F1A;&#x7528;&#x5BF9;&#x6297;&#x4F18;&#x5316;&#x5668;&#x4EE3;&#x66FF;&#x5E38;&#x89C4;&#x4F18;&#x5316;&#x5668;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x6BCF;&#x6B21;&#x4F18;&#x5316;&#x4E4B;&#x540E;&#xFF0C;&#x566A;&#x58F0;&#x5C06;&#x88AB;&#x9650;&#x5236;/&#x622A;&#x65AD;&#x5230;&#x5141;&#x8BB8;&#x7684;&#x8303;&#x56F4;&#x3002;&#x8FD9;&#x91CC;&#x4F18;&#x5316;&#x4E86;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#xFF0C;&#x5E76;&#x5FFD;&#x7565;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x4E2D;&#x7684;&#x5176;&#x4ED6;&#x53D8;&#x91CF;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">optimize</span><span class="hljs-params">(num_iterations, adversary_target_cls=None)</span>:</span>
    <span class="hljs-comment"># Start-time used for printing time-usage below.</span>
    start_time = time.time()

    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(num_iterations):

        <span class="hljs-comment"># Get a batch of training examples.</span>
        <span class="hljs-comment"># x_batch now holds a batch of images and</span>
        <span class="hljs-comment"># y_true_batch are the true labels for those images.</span>
        x_batch, y_true_batch = data.train.next_batch(train_batch_size)

        <span class="hljs-comment"># If we are searching for the adversarial noise, then</span>
        <span class="hljs-comment"># use the adversarial target-class instead.</span>
        <span class="hljs-keyword">if</span> adversary_target_cls <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">None</span>:
            <span class="hljs-comment"># The class-labels are One-Hot encoded.</span>

            <span class="hljs-comment"># Set all the class-labels to zero.</span>
            y_true_batch = np.zeros_like(y_true_batch)

            <span class="hljs-comment"># Set the element for the adversarial target-class to 1.</span>
            y_true_batch[:, adversary_target_cls] = <span class="hljs-number">1.0</span>

        <span class="hljs-comment"># Put the batch into a dict with the proper names</span>
        <span class="hljs-comment"># for placeholder variables in the TensorFlow graph.</span>
        feed_dict_train = {x: x_batch,
                           y_true: y_true_batch}

        <span class="hljs-comment"># If doing normal optimization of the neural network.</span>
        <span class="hljs-keyword">if</span> adversary_target_cls <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
            <span class="hljs-comment"># Run the optimizer using this batch of training data.</span>
            <span class="hljs-comment"># TensorFlow assigns the variables in feed_dict_train</span>
            <span class="hljs-comment"># to the placeholder variables and then runs the optimizer.</span>
            session.run(optimizer, feed_dict=feed_dict_train)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># Run the adversarial optimizer instead.</span>
            <span class="hljs-comment"># Note that we have &apos;faked&apos; the class above to be</span>
            <span class="hljs-comment"># the adversarial target-class instead of the true class.</span>
            session.run(optimizer_adversary, feed_dict=feed_dict_train)

            <span class="hljs-comment"># Clip / limit the adversarial noise. This executes</span>
            <span class="hljs-comment"># another TensorFlow operation. It cannot be executed</span>
            <span class="hljs-comment"># in the same session.run() as the optimizer, because</span>
            <span class="hljs-comment"># it may run in parallel so the execution order is not</span>
            <span class="hljs-comment"># guaranteed. We need the clip to run after the optimizer.</span>
            session.run(x_noise_clip)

        <span class="hljs-comment"># Print status every 100 iterations.</span>
        <span class="hljs-keyword">if</span> (i % <span class="hljs-number">100</span> == <span class="hljs-number">0</span>) <span class="hljs-keyword">or</span> (i == num_iterations - <span class="hljs-number">1</span>):
            <span class="hljs-comment"># Calculate the accuracy on the training-set.</span>
            acc = session.run(accuracy, feed_dict=feed_dict_train)

            <span class="hljs-comment"># Message for printing.</span>
            msg = <span class="hljs-string">&quot;Optimization Iteration: {0:&gt;6}, Training Accuracy: {1:&gt;6.1%}&quot;</span>

            <span class="hljs-comment"># Print it.</span>
            print(msg.format(i, acc))

    <span class="hljs-comment"># Ending time.</span>
    end_time = time.time()

    <span class="hljs-comment"># Difference between start and end-times.</span>
    time_dif = end_time - start_time

    <span class="hljs-comment"># Print the time-usage.</span>
    print(<span class="hljs-string">&quot;Time usage: &quot;</span> + str(timedelta(seconds=int(round(time_dif)))))
</code></pre>
<h3 id="&#x83B7;&#x53D6;&#x53CA;&#x7ED8;&#x5236;&#x566A;&#x58F0;&#x7684;&#x5E2E;&#x52A9;&#x51FD;&#x6570;">&#x83B7;&#x53D6;&#x53CA;&#x7ED8;&#x5236;&#x566A;&#x58F0;&#x7684;&#x5E2E;&#x52A9;&#x51FD;&#x6570;</h3>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4ECE;TensorFlow&#x56FE;&#x8868;&#x4E2D;&#x83B7;&#x53D6;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_noise</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-comment"># Run the TensorFlow session to retrieve the contents of</span>
    <span class="hljs-comment"># the x_noise variable inside the graph.</span>
    noise = session.run(x_noise)

    <span class="hljs-keyword">return</span> np.squeeze(noise)
</code></pre>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7ED8;&#x5236;&#x4E86;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#xFF0C;&#x5E76;&#x6253;&#x5370;&#x4E00;&#x4E9B;&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">plot_noise</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-comment"># Get the adversarial noise from inside the TensorFlow graph.</span>
    noise = get_noise()

    <span class="hljs-comment"># Print statistics.</span>
    print(<span class="hljs-string">&quot;Noise:&quot;</span>)
    print(<span class="hljs-string">&quot;- Min:&quot;</span>, noise.min())
    print(<span class="hljs-string">&quot;- Max:&quot;</span>, noise.max())
    print(<span class="hljs-string">&quot;- Std:&quot;</span>, noise.std())

    <span class="hljs-comment"># Plot the noise.</span>
    plt.imshow(noise, interpolation=<span class="hljs-string">&apos;nearest&apos;</span>, cmap=<span class="hljs-string">&apos;seismic&apos;</span>,
               vmin=<span class="hljs-number">-1.0</span>, vmax=<span class="hljs-number">1.0</span>)
</code></pre>
<h3 id="&#x7528;&#x6765;&#x7ED8;&#x5236;&#x9519;&#x8BEF;&#x6837;&#x672C;&#x7684;&#x5E2E;&#x52A9;&#x51FD;&#x6570;">&#x7528;&#x6765;&#x7ED8;&#x5236;&#x9519;&#x8BEF;&#x6837;&#x672C;&#x7684;&#x5E2E;&#x52A9;&#x51FD;&#x6570;</h3>
<p>&#x51FD;&#x6570;&#x7528;&#x6765;&#x7ED8;&#x5236;&#x6D4B;&#x8BD5;&#x96C6;&#x4E2D;&#x88AB;&#x8BEF;&#x5206;&#x7C7B;&#x7684;&#x6837;&#x672C;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">plot_example_errors</span><span class="hljs-params">(cls_pred, correct)</span>:</span>
    <span class="hljs-comment"># This function is called from print_test_accuracy() below.</span>

    <span class="hljs-comment"># cls_pred is an array of the predicted class-number for</span>
    <span class="hljs-comment"># all images in the test-set.</span>

    <span class="hljs-comment"># correct is a boolean array whether the predicted class</span>
    <span class="hljs-comment"># is equal to the true class for each image in the test-set.</span>

    <span class="hljs-comment"># Negate the boolean array.</span>
    incorrect = (correct == <span class="hljs-keyword">False</span>)

    <span class="hljs-comment"># Get the images from the test-set that have been</span>
    <span class="hljs-comment"># incorrectly classified.</span>
    images = data.test.images[incorrect]

    <span class="hljs-comment"># Get the predicted classes for those images.</span>
    cls_pred = cls_pred[incorrect]

    <span class="hljs-comment"># Get the true classes for those images.</span>
    cls_true = data.test.cls[incorrect]

    <span class="hljs-comment"># Get the adversarial noise from inside the TensorFlow graph.</span>
    noise = get_noise()

    <span class="hljs-comment"># Plot the first 9 images.</span>
    plot_images(images=images[<span class="hljs-number">0</span>:<span class="hljs-number">9</span>],
                cls_true=cls_true[<span class="hljs-number">0</span>:<span class="hljs-number">9</span>],
                cls_pred=cls_pred[<span class="hljs-number">0</span>:<span class="hljs-number">9</span>],
                noise=noise)
</code></pre>
<h3 id="&#x7ED8;&#x5236;&#x6DF7;&#x6DC6;&#xFF08;confusion&#xFF09;&#x77E9;&#x9635;&#x7684;&#x5E2E;&#x52A9;&#x51FD;&#x6570;">&#x7ED8;&#x5236;&#x6DF7;&#x6DC6;&#xFF08;confusion&#xFF09;&#x77E9;&#x9635;&#x7684;&#x5E2E;&#x52A9;&#x51FD;&#x6570;</h3>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">plot_confusion_matrix</span><span class="hljs-params">(cls_pred)</span>:</span>
    <span class="hljs-comment"># This is called from print_test_accuracy() below.</span>

    <span class="hljs-comment"># cls_pred is an array of the predicted class-number for</span>
    <span class="hljs-comment"># all images in the test-set.</span>

    <span class="hljs-comment"># Get the true classifications for the test-set.</span>
    cls_true = data.test.cls

    <span class="hljs-comment"># Get the confusion matrix using sklearn.</span>
    cm = confusion_matrix(y_true=cls_true,
                          y_pred=cls_pred)

    <span class="hljs-comment"># Print the confusion matrix as text.</span>
    print(cm)
</code></pre>
<h3 id="&#x5C55;&#x793A;&#x6027;&#x80FD;&#x7684;&#x5E2E;&#x52A9;&#x51FD;&#x6570;">&#x5C55;&#x793A;&#x6027;&#x80FD;&#x7684;&#x5E2E;&#x52A9;&#x51FD;&#x6570;</h3>
<p>&#x51FD;&#x6570;&#x7528;&#x6765;&#x6253;&#x5370;&#x6D4B;&#x8BD5;&#x96C6;&#x4E0A;&#x7684;&#x5206;&#x7C7B;&#x51C6;&#x786E;&#x5EA6;&#x3002;</p>
<p>&#x4E3A;&#x6D4B;&#x8BD5;&#x96C6;&#x4E0A;&#x7684;&#x6240;&#x6709;&#x56FE;&#x7247;&#x8BA1;&#x7B97;&#x5206;&#x7C7B;&#x4F1A;&#x82B1;&#x8D39;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x76F4;&#x63A5;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x6765;&#x8C03;&#x7528;&#x4E0A;&#x9762;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x4E0D;&#x7528;&#x6BCF;&#x6B21;&#x90FD;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x4E86;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x53EF;&#x80FD;&#x4F1A;&#x5360;&#x7528;&#x5F88;&#x591A;&#x7535;&#x8111;&#x5185;&#x5B58;&#xFF0C;&#x8FD9;&#x4E5F;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;&#x5C06;&#x6D4B;&#x8BD5;&#x96C6;&#x5206;&#x6210;&#x66F4;&#x5C0F;&#x7684;&#x51E0;&#x4E2A;&#x90E8;&#x5206;&#x3002;&#x5982;&#x679C;&#x4F60;&#x7684;&#x7535;&#x8111;&#x5185;&#x5B58;&#x6BD4;&#x8F83;&#x5C0F;&#x6216;&#x6B7B;&#x673A;&#x4E86;&#xFF0C;&#x5C31;&#x8981;&#x8BD5;&#x7740;&#x964D;&#x4F4E;batch-size&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-comment"># Split the test-set into smaller batches of this size.</span>
test_batch_size = <span class="hljs-number">256</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">print_test_accuracy</span><span class="hljs-params">(show_example_errors=False,
                        show_confusion_matrix=False)</span>:</span>

    <span class="hljs-comment"># Number of images in the test-set.</span>
    num_test = len(data.test.images)

    <span class="hljs-comment"># Allocate an array for the predicted classes which</span>
    <span class="hljs-comment"># will be calculated in batches and filled into this array.</span>
    cls_pred = np.zeros(shape=num_test, dtype=np.int)

    <span class="hljs-comment"># Now calculate the predicted classes for the batches.</span>
    <span class="hljs-comment"># We will just iterate through all the batches.</span>
    <span class="hljs-comment"># There might be a more clever and Pythonic way of doing this.</span>

    <span class="hljs-comment"># The starting index for the next batch is denoted i.</span>
    i = <span class="hljs-number">0</span>

    <span class="hljs-keyword">while</span> i &lt; num_test:
        <span class="hljs-comment"># The ending index for the next batch is denoted j.</span>
        j = min(i + test_batch_size, num_test)

        <span class="hljs-comment"># Get the images from the test-set between index i and j.</span>
        images = data.test.images[i:j, :]

        <span class="hljs-comment"># Get the associated labels.</span>
        labels = data.test.labels[i:j, :]

        <span class="hljs-comment"># Create a feed-dict with these images and labels.</span>
        feed_dict = {x: images,
                     y_true: labels}

        <span class="hljs-comment"># Calculate the predicted class using TensorFlow.</span>
        cls_pred[i:j] = session.run(y_pred_cls, feed_dict=feed_dict)

        <span class="hljs-comment"># Set the start-index for the next batch to the</span>
        <span class="hljs-comment"># end-index of the current batch.</span>
        i = j

    <span class="hljs-comment"># Convenience variable for the true class-numbers of the test-set.</span>
    cls_true = data.test.cls

    <span class="hljs-comment"># Create a boolean array whether each image is correctly classified.</span>
    correct = (cls_true == cls_pred)

    <span class="hljs-comment"># Calculate the number of correctly classified images.</span>
    <span class="hljs-comment"># When summing a boolean array, False means 0 and True means 1.</span>
    correct_sum = correct.sum()

    <span class="hljs-comment"># Classification accuracy is the number of correctly classified</span>
    <span class="hljs-comment"># images divided by the total number of images in the test-set.</span>
    acc = float(correct_sum) / num_test

    <span class="hljs-comment"># Print the accuracy.</span>
    msg = <span class="hljs-string">&quot;Accuracy on Test-Set: {0:.1%} ({1} / {2})&quot;</span>
    print(msg.format(acc, correct_sum, num_test))

    <span class="hljs-comment"># Plot some examples of mis-classifications, if desired.</span>
    <span class="hljs-keyword">if</span> show_example_errors:
        print(<span class="hljs-string">&quot;Example errors:&quot;</span>)
        plot_example_errors(cls_pred=cls_pred, correct=correct)

    <span class="hljs-comment"># Plot the confusion matrix, if desired.</span>
    <span class="hljs-keyword">if</span> show_confusion_matrix:
        print(<span class="hljs-string">&quot;Confusion Matrix:&quot;</span>)
        plot_confusion_matrix(cls_pred=cls_pred)
</code></pre>
<h2 id="&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x5E38;&#x89C4;&#x4F18;&#x5316;">&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x5E38;&#x89C4;&#x4F18;&#x5316;</h2>
<p>&#x6B64;&#x65F6;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x8FD8;&#x6CA1;&#x6709;&#x6548;&#x679C;&#xFF0C;&#x56E0;&#x4E3A;&#x4E0A;&#x9762;&#x53EA;&#x5C06;&#x5B83;&#x521D;&#x59CB;&#x5316;&#x4E3A;&#x96F6;&#xFF0C;&#x5728;&#x4F18;&#x5316;&#x8FC7;&#x7A0B;&#x4E2D;&#x5E76;&#x672A;&#x66F4;&#x65B0;&#x3002;</p>
<pre><code class="lang-python">optimize(num_iterations=<span class="hljs-number">1000</span>)
</code></pre>
<pre><code>Optimization Iteration:      0, Training Accuracy:  12.5%
Optimization Iteration:    100, Training Accuracy:  90.6%
Optimization Iteration:    200, Training Accuracy:  84.4%
Optimization Iteration:    300, Training Accuracy:  84.4%
Optimization Iteration:    400, Training Accuracy:  89.1%
Optimization Iteration:    500, Training Accuracy:  87.5%
Optimization Iteration:    600, Training Accuracy:  93.8%
Optimization Iteration:    700, Training Accuracy:  93.8%
Optimization Iteration:    800, Training Accuracy:  93.8%
Optimization Iteration:    900, Training Accuracy:  96.9%
Optimization Iteration:    999, Training Accuracy:  92.2%
Time usage: 0:00:03
</code></pre><p>&#x6D4B;&#x8BD5;&#x96C6;&#x4E0A;&#x7684;&#x5206;&#x7C7B;&#x51C6;&#x786E;&#x7387;&#x5927;&#x7EA6;96-97%&#x3002;&#xFF08;&#x6BCF;&#x6B21;&#x8FD0;&#x884C;Python Notobook&#x65F6;&#xFF0C;&#x7ED3;&#x679C;&#x4F1A;&#x6709;&#x6240;&#x53D8;&#x5316;&#x3002;&#xFF09;</p>
<pre><code class="lang-python">print_test_accuracy(show_example_errors=<span class="hljs-keyword">True</span>)
</code></pre>
<pre><code>Accuracy on Test-Set: 96.3% (9633 / 10000)
Example errors:
</code></pre><p><img src="output_113_1.png" alt="png"></p>
<h2 id="&#x5BFB;&#x627E;&#x5BF9;&#x6297;&#x566A;&#x58F0;">&#x5BFB;&#x627E;&#x5BF9;&#x6297;&#x566A;&#x58F0;</h2>
<p>&#x5728;&#x6211;&#x4EEC;&#x5F00;&#x59CB;&#x4F18;&#x5316;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x4E4B;&#x524D;&#xFF0C;&#x5148;&#x5C06;&#x5B83;&#x521D;&#x59CB;&#x5316;&#x4E3A;&#x96F6;&#x3002;&#x4E0A;&#x9762;&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#x4E86;&#x8FD9;&#x4E00;&#x6B65;&#xFF0C;&#x4F46;&#x8FD9;&#x91CC;&#x518D;&#x6267;&#x884C;&#x4E00;&#x6B21;&#xFF0C;&#x4EE5;&#x9632;&#x4F60;&#x7528;&#x5176;&#x4ED6;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x91CD;&#x65B0;&#x8FD0;&#x884C;&#x4EE3;&#x7801;&#x3002;</p>
<pre><code class="lang-python">init_noise()
</code></pre>
<p>&#x73B0;&#x5728;&#x6267;&#x884C;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x7684;&#x4F18;&#x5316;&#x3002;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x5BF9;&#x6297;&#x4F18;&#x5316;&#x5668;&#x800C;&#x4E0D;&#x662F;&#x5E38;&#x89C4;&#x4F18;&#x5316;&#x5668;&#xFF0C;&#x8FD9;&#x8BF4;&#x660E;&#x5B83;&#x53EA;&#x4F18;&#x5316;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x53D8;&#x91CF;&#xFF0C;&#x540C;&#x65F6;&#x5FFD;&#x7565;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x4E2D;&#x7684;&#x5176;&#x4ED6;&#x53D8;&#x91CF;&#x3002;</p>
<pre><code class="lang-python">optimize(num_iterations=<span class="hljs-number">1000</span>, adversary_target_cls=<span class="hljs-number">3</span>)
</code></pre>
<pre><code>Optimization Iteration:      0, Training Accuracy:   6.2%
Optimization Iteration:    100, Training Accuracy:  93.8%
Optimization Iteration:    200, Training Accuracy:  96.9%
Optimization Iteration:    300, Training Accuracy:  98.4%
Optimization Iteration:    400, Training Accuracy:  95.3%
Optimization Iteration:    500, Training Accuracy:  96.9%
Optimization Iteration:    600, Training Accuracy: 100.0%
Optimization Iteration:    700, Training Accuracy:  98.4%
Optimization Iteration:    800, Training Accuracy:  95.3%
Optimization Iteration:    900, Training Accuracy:  93.8%
Optimization Iteration:    999, Training Accuracy: 100.0%
Time usage: 0:00:03
</code></pre><p>&#x73B0;&#x5728;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x5DF2;&#x7ECF;&#x88AB;&#x4F18;&#x5316;&#x4E86;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x4E00;&#x5F20;&#x56FE;&#x50CF;&#x4E2D;&#x5C55;&#x793A;&#x51FA;&#x6765;&#x3002;&#x7EA2;&#x8272;&#x50CF;&#x7D20;&#x663E;&#x793A;&#x4E86;&#x6B63;&#x566A;&#x58F0;&#x503C;&#xFF0C;&#x84DD;&#x8272;&#x50CF;&#x7D20;&#x663E;&#x793A;&#x4E86;&#x8D1F;&#x566A;&#x58F0;&#x503C;&#x3002;&#x8FD9;&#x4E2A;&#x566A;&#x58F0;&#x6A21;&#x5F0F;&#x5C06;&#x4F1A;&#x88AB;&#x6DFB;&#x52A0;&#x5230;&#x6BCF;&#x5F20;&#x8F93;&#x5165;&#x56FE;&#x50CF;&#x4E2D;&#x3002;&#x6B63;&#x566A;&#x58F0;&#x503C;&#xFF08;&#x7EA2;&#xFF09;&#x4F7F;&#x50CF;&#x7D20;&#x53D8;&#x6697;&#xFF0C;&#x8D1F;&#x566A;&#x58F0;&#x503C;&#xFF08;&#x84DD;&#xFF09;&#x4F7F;&#x50CF;&#x7D20;&#x53D8;&#x4EAE;&#x3002;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;</p>
<pre><code class="lang-python">plot_noise()
</code></pre>
<pre><code>Noise:
- Min: -0.35
- Max: 0.35
- Std: 0.195455
</code></pre><p><img src="output_120_1.png" alt="png"></p>
<p>&#x5F53;&#x6D4B;&#x8BD5;&#x96C6;&#x7684;&#x6240;&#x6709;&#x56FE;&#x50CF;&#x4E0A;&#x90FD;&#x6DFB;&#x52A0;&#x4E86;&#x8BE5;&#x566A;&#x58F0;&#x4E4B;&#x540E;&#xFF0C;&#x6839;&#x636E;&#x9009;&#x5B9A;&#x7684;&#x76EE;&#x6807;&#x7C7B;&#x522B;&#xFF0C;&#x5206;&#x7C7B;&#x51C6;&#x786E;&#x7387;&#x901A;&#x5E38;&#x5728;&#x662F;10-15%&#x4E4B;&#x95F4;&#x3002;&#x6211;&#x4EEC;&#x4E5F;&#x80FD;&#x4ECE;&#x6DF7;&#x6DC6;&#x77E9;&#x9635;&#x4E2D;&#x770B;&#x51FA;&#xFF0C;&#x6D4B;&#x8BD5;&#x96C6;&#x4E2D;&#x7684;&#x5927;&#x591A;&#x6570;&#x56FE;&#x50CF;&#x90FD;&#x88AB;&#x5206;&#x7C7B;&#x6210;&#x671F;&#x671B;&#x7684;&#x76EE;&#x6807;&#x7C7B;&#x522B;&#x2014;&#x2014;&#x5C3D;&#x7BA1;&#x6709;&#x4E9B;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x6BD4;&#x5176;&#x4ED6;&#x7684;&#x9700;&#x8981;&#x66F4;&#x591A;&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x627E;&#x5230;&#x4E86;&#x4F7F;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#xFF0C;&#x4F7F;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5C06;&#x6D4B;&#x8BD5;&#x96C6;&#x4E2D;&#x7EDD;&#x5927;&#x90E8;&#x5206;&#x56FE;&#x50CF;&#x8BEF;&#x5206;&#x7C7B;&#x6210;&#x671F;&#x671B;&#x7684;&#x7C7B;&#x522B;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x4E5F;&#x53EF;&#x4EE5;&#x753B;&#x51FA;&#x4E00;&#x4E9B;&#x5E26;&#x6709;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x7684;&#x8BEF;&#x5206;&#x7C7B;&#x56FE;&#x50CF;&#x6837;&#x672C;&#x3002;&#x566A;&#x58F0;&#x6E05;&#x6670;&#x53EF;&#x89C1;&#xFF0C;&#x4F46;&#x4EBA;&#x773C;&#x8FD8;&#x662F;&#x53EF;&#x4EE5;&#x8F7B;&#x6613;&#x5730;&#x5206;&#x8FA8;&#x51FA;&#x6570;&#x5B57;&#x3002;</p>
<pre><code class="lang-python">print_test_accuracy(show_example_errors=<span class="hljs-keyword">True</span>,
                    show_confusion_matrix=<span class="hljs-keyword">True</span>)
</code></pre>
<pre><code>Accuracy on Test-Set: 13.2% (1323 / 10000)
Example errors:
</code></pre><p><img src="output_122_1.png" alt="png"></p>
<pre><code>Confusion Matrix:
[[  85    0    0  895    0    0    0    0    0    0]
 [   0    0    0 1135    0    0    0    0    0    0]
 [   0    0   46  986    0    0    0    0    0    0]
 [   0    0    0 1010    0    0    0    0    0    0]
 [   0    0    0  959   20    0    0    0    3    0]
 [   0    0    0  847    0   45    0    0    0    0]
 [   0    0    0  914    0    1   42    0    1    0]
 [   0    0    0  977    0    0    0   51    0    0]
 [   0    0    0  952    0    0    0    0   22    0]
 [   0    0    1 1006    0    0    0    0    0    2]]
</code></pre><h2 id="&#x6240;&#x6709;&#x76EE;&#x6807;&#x7C7B;&#x522B;&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;">&#x6240;&#x6709;&#x76EE;&#x6807;&#x7C7B;&#x522B;&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;</h2>
<p>&#x8FD9;&#x662F;&#x5E2E;&#x52A9;&#x51FD;&#x6570;&#x7528;&#x4E8E;&#x5BFB;&#x627E;&#x6240;&#x6709;&#x76EE;&#x6807;&#x7C7B;&#x522B;&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x3002;&#x51FD;&#x6570;&#x4ECE;&#x7C7B;&#x578B;&#x53F7;0&#x904D;&#x5386;&#x5230;9&#xFF0C;&#x6267;&#x884C;&#x4E0A;&#x9762;&#x7684;&#x4F18;&#x5316;&#x3002;&#x7136;&#x540E;&#x5C06;&#x7ED3;&#x679C;&#x4FDD;&#x5B58;&#x5230;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#x4E2D;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_all_noise</span><span class="hljs-params">(num_iterations=<span class="hljs-number">1000</span>)</span>:</span>
    <span class="hljs-comment"># Adversarial noise for all target-classes.</span>
    all_noise = []

    <span class="hljs-comment"># For each target-class.</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(num_classes):
        print(<span class="hljs-string">&quot;Finding adversarial noise for target-class:&quot;</span>, i)

        <span class="hljs-comment"># Reset the adversarial noise to zero.</span>
        init_noise()

        <span class="hljs-comment"># Optimize the adversarial noise.</span>
        optimize(num_iterations=num_iterations,
                 adversary_target_cls=i)

        <span class="hljs-comment"># Get the adversarial noise from inside the TensorFlow graph.</span>
        noise = get_noise()

        <span class="hljs-comment"># Append the noise to the array.</span>
        all_noise.append(noise)

        <span class="hljs-comment"># Print newline.</span>
        print()

    <span class="hljs-keyword">return</span> all_noise
</code></pre>
<pre><code class="lang-python">all_noise = find_all_noise(num_iterations=<span class="hljs-number">300</span>)
</code></pre>
<pre><code>Finding adversarial noise for target-class: 0
Optimization Iteration:      0, Training Accuracy:   9.4%
Optimization Iteration:    100, Training Accuracy:  90.6%
Optimization Iteration:    200, Training Accuracy:  92.2%
Optimization Iteration:    299, Training Accuracy:  93.8%
Time usage: 0:00:01

Finding adversarial noise for target-class: 1
Optimization Iteration:      0, Training Accuracy:   7.8%
Optimization Iteration:    100, Training Accuracy:  62.5%
Optimization Iteration:    200, Training Accuracy:  62.5%
Optimization Iteration:    299, Training Accuracy:  75.0%
Time usage: 0:00:01

Finding adversarial noise for target-class: 2
Optimization Iteration:      0, Training Accuracy:   7.8%
Optimization Iteration:    100, Training Accuracy:  93.8%
Optimization Iteration:    200, Training Accuracy:  95.3%
Optimization Iteration:    299, Training Accuracy:  96.9%
Time usage: 0:00:01

Finding adversarial noise for target-class: 3
Optimization Iteration:      0, Training Accuracy:   6.2%
Optimization Iteration:    100, Training Accuracy:  98.4%
Optimization Iteration:    200, Training Accuracy:  96.9%
Optimization Iteration:    299, Training Accuracy:  98.4%
Time usage: 0:00:01

Finding adversarial noise for target-class: 4
Optimization Iteration:      0, Training Accuracy:  12.5%
Optimization Iteration:    100, Training Accuracy:  81.2%
Optimization Iteration:    200, Training Accuracy:  82.8%
Optimization Iteration:    299, Training Accuracy:  82.8%
Time usage: 0:00:01

Finding adversarial noise for target-class: 5
Optimization Iteration:      0, Training Accuracy:   7.8%
Optimization Iteration:    100, Training Accuracy:  96.9%
Optimization Iteration:    200, Training Accuracy:  96.9%
Optimization Iteration:    299, Training Accuracy:  98.4%
Time usage: 0:00:01

Finding adversarial noise for target-class: 6
Optimization Iteration:      0, Training Accuracy:   6.2%
Optimization Iteration:    100, Training Accuracy:  93.8%
Optimization Iteration:    200, Training Accuracy:  92.2%
Optimization Iteration:    299, Training Accuracy:  96.9%
Time usage: 0:00:01

Finding adversarial noise for target-class: 7
Optimization Iteration:      0, Training Accuracy:  12.5%
Optimization Iteration:    100, Training Accuracy:  98.4%
Optimization Iteration:    200, Training Accuracy:  93.8%
Optimization Iteration:    299, Training Accuracy:  92.2%
Time usage: 0:00:01

Finding adversarial noise for target-class: 8
Optimization Iteration:      0, Training Accuracy:   4.7%
Optimization Iteration:    100, Training Accuracy:  96.9%
Optimization Iteration:    200, Training Accuracy:  93.8%
Optimization Iteration:    299, Training Accuracy:  96.9%
Time usage: 0:00:01

Finding adversarial noise for target-class: 9
Optimization Iteration:      0, Training Accuracy:   7.8%
Optimization Iteration:    100, Training Accuracy:  84.4%
Optimization Iteration:    200, Training Accuracy:  87.5%
Optimization Iteration:    299, Training Accuracy:  90.6%
Time usage: 0:00:01
</code></pre><h3 id="&#x7ED8;&#x5236;&#x6240;&#x6709;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;">&#x7ED8;&#x5236;&#x6240;&#x6709;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;</h3>
<p>&#x8FD9;&#x4E2A;&#x5E2E;&#x52A9;&#x51FD;&#x6570;&#x7528;&#x4E8E;&#x5728;&#x6805;&#x683C;&#x4E2D;&#x7ED8;&#x5236;&#x6240;&#x6709;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#xFF08;0&#x5230;9&#xFF09;&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">plot_all_noise</span><span class="hljs-params">(all_noise)</span>:</span>    
    <span class="hljs-comment"># Create figure with 10 sub-plots.</span>
    fig, axes = plt.subplots(<span class="hljs-number">2</span>, <span class="hljs-number">5</span>)
    fig.subplots_adjust(hspace=<span class="hljs-number">0.2</span>, wspace=<span class="hljs-number">0.1</span>)

    <span class="hljs-comment"># For each sub-plot.</span>
    <span class="hljs-keyword">for</span> i, ax <span class="hljs-keyword">in</span> enumerate(axes.flat):
        <span class="hljs-comment"># Get the adversarial noise for the i&apos;th target-class.</span>
        noise = all_noise[i]

        <span class="hljs-comment"># Plot the noise.</span>
        ax.imshow(noise,
                  cmap=<span class="hljs-string">&apos;seismic&apos;</span>, interpolation=<span class="hljs-string">&apos;nearest&apos;</span>,
                  vmin=<span class="hljs-number">-1.0</span>, vmax=<span class="hljs-number">1.0</span>)

        <span class="hljs-comment"># Show the classes as the label on the x-axis.</span>
        ax.set_xlabel(i)

        <span class="hljs-comment"># Remove ticks from the plot.</span>
        ax.set_xticks([])
        ax.set_yticks([])

    <span class="hljs-comment"># Ensure the plot is shown correctly with multiple plots</span>
    <span class="hljs-comment"># in a single Notebook cell.</span>
    plt.show()
</code></pre>
<pre><code class="lang-python">plot_all_noise(all_noise)
</code></pre>
<p><img src="output_130_0.png" alt="png"></p>
<p>&#x7EA2;&#x8272;&#x50CF;&#x7D20;&#x663E;&#x793A;&#x6B63;&#x566A;&#x58F0;&#x503C;&#xFF0C;&#x84DD;&#x8272;&#x50CF;&#x7D20;&#x663E;&#x793A;&#x8D1F;&#x566A;&#x58F0;&#x503C;&#x3002;</p>
<p>&#x5728;&#x5176;&#x4E2D;&#x4E00;&#x4E9B;&#x566A;&#x58F0;&#x56FE;&#x50CF;&#x4E2D;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6570;&#x5B57;&#x7684;&#x75D5;&#x8FF9;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x76EE;&#x6807;&#x7C7B;&#x578B;0&#x7684;&#x566A;&#x58F0;&#x663E;&#x793A;&#x4E86;&#x4E00;&#x4E2A;&#x88AB;&#x84DD;&#x8272;&#x5305;&#x56F4;&#x7684;&#x7EA2;&#x5708;&#x3002;&#x8FD9;&#x8BF4;&#x660E;&#x4F1A;&#x4EE5;&#x5706;&#x5F62;&#x72B6;&#x5C06;&#x4E00;&#x4E9B;&#x566A;&#x58F0;&#x6DFB;&#x52A0;&#x5230;&#x56FE;&#x50CF;&#x4E2D;&#xFF0C;&#x5E76;&#x6291;&#x5236;&#x5176;&#x4ED6;&#x50CF;&#x7D20;&#x3002;&#x8FD9;&#x8DB3;&#x4EE5;&#x8BA9;MNIST&#x6570;&#x636E;&#x96C6;&#x4E2D;&#x7684;&#x5927;&#x90E8;&#x5206;&#x56FE;&#x50CF;&#x88AB;&#x8BEF;&#x5206;&#x7C7B;&#x6210;0&#x3002;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#x662F;3&#x7684;&#x566A;&#x58F0;&#xFF0C;&#x56FE;&#x50CF;&#x7684;&#x7EA2;&#x8272;&#x50CF;&#x7D20;&#x4E5F;&#x663E;&#x793A;&#x4E86;&#x6570;&#x5B57;3&#x7684;&#x75D5;&#x8FF9;&#x3002;&#x4F46;&#x5176;&#x4ED6;&#x7C7B;&#x522B;&#x7684;&#x566A;&#x58F0;&#x4E0D;&#x592A;&#x660E;&#x663E;&#x3002;</p>
<h2 id="&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x7684;&#x514D;&#x75AB;">&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x7684;&#x514D;&#x75AB;</h2>
<p>&#x73B0;&#x5728;&#x8BD5;&#x7740;&#x8BA9;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5BF9;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x514D;&#x75AB;&#x3002;&#x6211;&#x4EEC;&#x91CD;&#x65B0;&#x8BAD;&#x7EC3;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#xFF0C;&#x4F7F;&#x5176;&#x5FFD;&#x7565;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x3002;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x53EF;&#x4EE5;&#x91CD;&#x590D;&#x591A;&#x6B21;&#x3002;</p>
<h3 id="&#x5E2E;&#x52A9;&#x51FD;&#x6570;&#x521B;&#x5EFA;&#x4E86;&#x5BF9;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x514D;&#x75AB;&#x7684;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;">&#x5E2E;&#x52A9;&#x51FD;&#x6570;&#x521B;&#x5EFA;&#x4E86;&#x5BF9;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x514D;&#x75AB;&#x7684;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;</h3>
<p>&#x8FD9;&#x662F;&#x4F7F;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5BF9;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x514D;&#x75AB;&#x7684;&#x5E2E;&#x52A9;&#x51FD;&#x6570;&#x3002;&#x9996;&#x5148;&#x8FD0;&#x884C;&#x4F18;&#x5316;&#x6765;&#x627E;&#x5230;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x3002;&#x63A5;&#x7740;&#x6267;&#x884C;&#x5E38;&#x89C4;&#x4F18;&#x5316;&#x4F7F;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5BF9;&#x8BE5;&#x566A;&#x58F0;&#x514D;&#x75AB;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">make_immune</span><span class="hljs-params">(target_cls, num_iterations_adversary=<span class="hljs-number">500</span>,
                num_iterations_immune=<span class="hljs-number">200</span>)</span>:</span>

    print(<span class="hljs-string">&quot;Target-class:&quot;</span>, target_cls)
    print(<span class="hljs-string">&quot;Finding adversarial noise ...&quot;</span>)

    <span class="hljs-comment"># Find the adversarial noise.</span>
    optimize(num_iterations=num_iterations_adversary,
             adversary_target_cls=target_cls)

    <span class="hljs-comment"># Newline.</span>
    print()

    <span class="hljs-comment"># Print classification accuracy.</span>
    print_test_accuracy(show_example_errors=<span class="hljs-keyword">False</span>,
                        show_confusion_matrix=<span class="hljs-keyword">False</span>)

    <span class="hljs-comment"># Newline.</span>
    print()

    print(<span class="hljs-string">&quot;Making the neural network immune to the noise ...&quot;</span>)

    <span class="hljs-comment"># Try and make the neural network immune to this noise.</span>
    <span class="hljs-comment"># Note that the adversarial noise has not been reset to zero</span>
    <span class="hljs-comment"># so the x_noise variable still holds the noise.</span>
    <span class="hljs-comment"># So we are training the neural network to ignore the noise.</span>
    optimize(num_iterations=num_iterations_immune)

    <span class="hljs-comment"># Newline.</span>
    print()

    <span class="hljs-comment"># Print classification accuracy.</span>
    print_test_accuracy(show_example_errors=<span class="hljs-keyword">False</span>,
                        show_confusion_matrix=<span class="hljs-keyword">False</span>)
</code></pre>
<h3 id="&#x5BF9;&#x76EE;&#x6807;&#x7C7B;&#x578B;3&#x7684;&#x566A;&#x58F0;&#x514D;&#x75AB;">&#x5BF9;&#x76EE;&#x6807;&#x7C7B;&#x578B;3&#x7684;&#x566A;&#x58F0;&#x514D;&#x75AB;</h3>
<p>&#x9996;&#x5148;&#x5C1D;&#x8BD5;&#x4F7F;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5BF9;&#x76EE;&#x6807;&#x7C7B;&#x578B;3&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x514D;&#x75AB;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x5148;&#x627E;&#x5230;&#x5BFC;&#x81F4;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x8BEF;&#x5206;&#x7C7B;&#x6D4B;&#x8BD5;&#x96C6;&#x4E0A;&#x5927;&#x591A;&#x6570;&#x56FE;&#x50CF;&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x3002;&#x63A5;&#x7740;&#x6267;&#x884C;&#x5E38;&#x89C4;&#x4F18;&#x5316;&#xFF0C;&#x5176;&#x53D8;&#x91CF;&#x7ECF;&#x8FC7;&#x5FAE;&#x8C03;&#x4ECE;&#x800C;&#x5FFD;&#x7565;&#x566A;&#x58F0;&#xFF0C;&#x4F7F;&#x5F97;&#x5206;&#x7C7B;&#x51C6;&#x786E;&#x7387;&#x518D;&#x6B21;&#x8FBE;&#x5230;95-97%&#x3002;</p>
<pre><code class="lang-python">make_immune(target_cls=<span class="hljs-number">3</span>)
</code></pre>
<pre><code>Target-class: 3
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   3.1%
Optimization Iteration:    100, Training Accuracy:  93.8%
Optimization Iteration:    200, Training Accuracy:  93.8%
Optimization Iteration:    300, Training Accuracy:  96.9%
Optimization Iteration:    400, Training Accuracy:  96.9%
Optimization Iteration:    499, Training Accuracy:  96.9%
Time usage: 0:00:02

Accuracy on Test-Set: 14.4% (1443 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  42.2%
Optimization Iteration:    100, Training Accuracy:  90.6%
Optimization Iteration:    199, Training Accuracy:  89.1%
Time usage: 0:00:01

Accuracy on Test-Set: 95.3% (9529 / 10000)
</code></pre><p>&#x73B0;&#x5728;&#x8BD5;&#x7740;&#x518D;&#x6B21;&#x8FD0;&#x884C;&#x5B83;&#x3002; &#x73B0;&#x5728;&#x66F4;&#x96BE;&#x4E3A;&#x76EE;&#x6807;&#x7C7B;&#x522B;3&#x627E;&#x5230;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x3002;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x4F3C;&#x4E4E;&#x5DF2;&#x7ECF;&#x53D8;&#x5F97;&#x5BF9;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x6709;&#x4E9B;&#x514D;&#x75AB;&#x3002;</p>
<pre><code class="lang-python">make_immune(target_cls=<span class="hljs-number">3</span>)
</code></pre>
<pre><code>Target-class: 3
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   7.8%
Optimization Iteration:    100, Training Accuracy:  32.8%
Optimization Iteration:    200, Training Accuracy:  32.8%
Optimization Iteration:    300, Training Accuracy:  29.7%
Optimization Iteration:    400, Training Accuracy:  34.4%
Optimization Iteration:    499, Training Accuracy:  26.6%
Time usage: 0:00:02

Accuracy on Test-Set: 72.1% (7207 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  75.0%
Optimization Iteration:    100, Training Accuracy:  93.8%
Optimization Iteration:    199, Training Accuracy:  92.2%
Time usage: 0:00:01

Accuracy on Test-Set: 95.2% (9519 / 10000)
</code></pre><h3 id="&#x5BF9;&#x6240;&#x6709;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x7684;&#x566A;&#x58F0;&#x514D;&#x75AB;">&#x5BF9;&#x6240;&#x6709;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x7684;&#x566A;&#x58F0;&#x514D;&#x75AB;</h3>
<p>&#x73B0;&#x5728;&#xFF0C;&#x8BD5;&#x7740;&#x4F7F;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5BF9;&#x6240;&#x6709;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x7684;&#x566A;&#x58F0;&#x514D;&#x75AB;&#x3002;&#x4E0D;&#x5E78;&#x7684;&#x662F;&#xFF0C;&#x770B;&#x8D77;&#x6765;&#x5E76;&#x4E0D;&#x592A;&#x597D;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>):
    make_immune(target_cls=i)

    <span class="hljs-comment"># Print newline.</span>
    print()
</code></pre>
<pre><code>Target-class: 0
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   4.7%
Optimization Iteration:    100, Training Accuracy:  73.4%
Optimization Iteration:    200, Training Accuracy:  75.0%
Optimization Iteration:    300, Training Accuracy:  85.9%
Optimization Iteration:    400, Training Accuracy:  81.2%
Optimization Iteration:    499, Training Accuracy:  90.6%
Time usage: 0:00:02

Accuracy on Test-Set: 23.3% (2326 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  34.4%
Optimization Iteration:    100, Training Accuracy:  95.3%
Optimization Iteration:    199, Training Accuracy:  95.3%
Time usage: 0:00:01

Accuracy on Test-Set: 95.6% (9559 / 10000)

Target-class: 1
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:  12.5%
Optimization Iteration:    100, Training Accuracy:  57.8%
Optimization Iteration:    200, Training Accuracy:  62.5%
Optimization Iteration:    300, Training Accuracy:  62.5%
Optimization Iteration:    400, Training Accuracy:  67.2%
Optimization Iteration:    499, Training Accuracy:  67.2%
Time usage: 0:00:02

Accuracy on Test-Set: 42.2% (4218 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  59.4%
Optimization Iteration:    100, Training Accuracy:  93.8%
Optimization Iteration:    199, Training Accuracy:  95.3%
Time usage: 0:00:01

Accuracy on Test-Set: 95.5% (9555 / 10000)

Target-class: 2
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   6.2%
Optimization Iteration:    100, Training Accuracy:  43.8%
Optimization Iteration:    200, Training Accuracy:  57.8%
Optimization Iteration:    300, Training Accuracy:  70.3%
Optimization Iteration:    400, Training Accuracy:  68.8%
Optimization Iteration:    499, Training Accuracy:  71.9%
Time usage: 0:00:02

Accuracy on Test-Set: 46.4% (4639 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  59.4%
Optimization Iteration:    100, Training Accuracy:  96.9%
Optimization Iteration:    199, Training Accuracy:  92.2%
Time usage: 0:00:01

Accuracy on Test-Set: 95.5% (9545 / 10000)

Target-class: 3
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   6.2%
Optimization Iteration:    100, Training Accuracy:  48.4%
Optimization Iteration:    200, Training Accuracy:  46.9%
Optimization Iteration:    300, Training Accuracy:  53.1%
Optimization Iteration:    400, Training Accuracy:  50.0%
Optimization Iteration:    499, Training Accuracy:  48.4%
Time usage: 0:00:02

Accuracy on Test-Set: 56.5% (5648 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  54.7%
Optimization Iteration:    100, Training Accuracy:  93.8%
Optimization Iteration:    199, Training Accuracy:  96.9%
Time usage: 0:00:01

Accuracy on Test-Set: 95.8% (9581 / 10000)

Target-class: 4
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   9.4%
Optimization Iteration:    100, Training Accuracy:  85.9%
Optimization Iteration:    200, Training Accuracy:  85.9%
Optimization Iteration:    300, Training Accuracy:  87.5%
Optimization Iteration:    400, Training Accuracy:  95.3%
Optimization Iteration:    499, Training Accuracy:  92.2%
Time usage: 0:00:02

Accuracy on Test-Set: 15.6% (1557 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  18.8%
Optimization Iteration:    100, Training Accuracy:  95.3%
Optimization Iteration:    199, Training Accuracy:  96.9%
Time usage: 0:00:01

Accuracy on Test-Set: 95.6% (9557 / 10000)

Target-class: 5
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:  18.8%
Optimization Iteration:    100, Training Accuracy:  71.9%
Optimization Iteration:    200, Training Accuracy:  90.6%
Optimization Iteration:    300, Training Accuracy:  95.3%
Optimization Iteration:    400, Training Accuracy:  89.1%
Optimization Iteration:    499, Training Accuracy:  92.2%
Time usage: 0:00:02

Accuracy on Test-Set: 17.4% (1745 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  15.6%
Optimization Iteration:    100, Training Accuracy:  96.9%
Optimization Iteration:    199, Training Accuracy:  95.3%
Time usage: 0:00:01

Accuracy on Test-Set: 96.0% (9601 / 10000)

Target-class: 6
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:  10.9%
Optimization Iteration:    100, Training Accuracy:  81.2%
Optimization Iteration:    200, Training Accuracy:  93.8%
Optimization Iteration:    300, Training Accuracy:  92.2%
Optimization Iteration:    400, Training Accuracy:  89.1%
Optimization Iteration:    499, Training Accuracy:  92.2%
Time usage: 0:00:02

Accuracy on Test-Set: 17.6% (1762 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  20.3%
Optimization Iteration:    100, Training Accuracy:  93.8%
Optimization Iteration:    199, Training Accuracy:  95.3%
Time usage: 0:00:01

Accuracy on Test-Set: 95.7% (9570 / 10000)

Target-class: 7
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:  14.1%
Optimization Iteration:    100, Training Accuracy:  93.8%
Optimization Iteration:    200, Training Accuracy:  98.4%
Optimization Iteration:    300, Training Accuracy: 100.0%
Optimization Iteration:    400, Training Accuracy:  96.9%
Optimization Iteration:    499, Training Accuracy: 100.0%
Time usage: 0:00:02

Accuracy on Test-Set: 12.8% (1281 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  12.5%
Optimization Iteration:    100, Training Accuracy:  98.4%
Optimization Iteration:    199, Training Accuracy:  98.4%
Time usage: 0:00:01

Accuracy on Test-Set: 95.9% (9587 / 10000)

Target-class: 8
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   4.7%
Optimization Iteration:    100, Training Accuracy:  64.1%
Optimization Iteration:    200, Training Accuracy:  81.2%
Optimization Iteration:    300, Training Accuracy:  71.9%
Optimization Iteration:    400, Training Accuracy:  78.1%
Optimization Iteration:    499, Training Accuracy:  84.4%
Time usage: 0:00:02

Accuracy on Test-Set: 24.9% (2493 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  25.0%
Optimization Iteration:    100, Training Accuracy:  95.3%
Optimization Iteration:    199, Training Accuracy:  96.9%
Time usage: 0:00:01

Accuracy on Test-Set: 96.0% (9601 / 10000)

Target-class: 9
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   9.4%
Optimization Iteration:    100, Training Accuracy:  48.4%
Optimization Iteration:    200, Training Accuracy:  50.0%
Optimization Iteration:    300, Training Accuracy:  53.1%
Optimization Iteration:    400, Training Accuracy:  64.1%
Optimization Iteration:    499, Training Accuracy:  65.6%
Time usage: 0:00:02

Accuracy on Test-Set: 45.5% (4546 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  51.6%
Optimization Iteration:    100, Training Accuracy:  95.3%
Optimization Iteration:    199, Training Accuracy:  95.3%
Time usage: 0:00:01

Accuracy on Test-Set: 96.2% (9615 / 10000)
</code></pre><h3 id="&#x5BF9;&#x6240;&#x6709;&#x76EE;&#x6807;&#x7C7B;&#x522B;&#x514D;&#x75AB;&#xFF08;&#x6267;&#x884C;&#x4E24;&#x6B21;&#xFF09;">&#x5BF9;&#x6240;&#x6709;&#x76EE;&#x6807;&#x7C7B;&#x522B;&#x514D;&#x75AB;&#xFF08;&#x6267;&#x884C;&#x4E24;&#x6B21;&#xFF09;</h3>
<p>&#x73B0;&#x5728;&#x8BD5;&#x7740;&#x6267;&#x884C;&#x4E24;&#x6B21;&#xFF0C;&#x4F7F;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5BF9;&#x6240;&#x6709;&#x76EE;&#x6807;&#x7C7B;&#x522B;&#x7684;&#x566A;&#x58F0;&#x514D;&#x75AB;&#x3002;&#x4E0D;&#x5E78;&#x7684;&#x662F;&#xFF0C;&#x7ED3;&#x679C;&#x4E5F;&#x4E0D;&#x592A;&#x597D;&#x3002;</p>
<p>&#x4F7F;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x514D;&#x53D7;&#x4E00;&#x4E2A;&#x5BF9;&#x6297;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x7684;&#x5F71;&#x54CD;&#xFF0C;&#x4F3C;&#x4E4E;&#x4F7F;&#x5F97;&#x5B83;&#x5BF9;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x5931;&#x53BB;&#x4E86;&#x514D;&#x75AB;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>):
    make_immune(target_cls=i)

    <span class="hljs-comment"># Print newline.</span>
    print()

    make_immune(target_cls=i)

    <span class="hljs-comment"># Print newline.</span>
    print()
</code></pre>
<pre><code>Target-class: 0
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   7.8%
Optimization Iteration:    100, Training Accuracy:  53.1%
Optimization Iteration:    200, Training Accuracy:  73.4%
Optimization Iteration:    300, Training Accuracy:  79.7%
Optimization Iteration:    400, Training Accuracy:  84.4%
Optimization Iteration:    499, Training Accuracy:  95.3%
Time usage: 0:00:02

Accuracy on Test-Set: 29.2% (2921 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  29.7%
Optimization Iteration:    100, Training Accuracy:  96.9%
Optimization Iteration:    199, Training Accuracy:  95.3%
Time usage: 0:00:01

Accuracy on Test-Set: 96.2% (9619 / 10000)

Target-class: 0
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   1.6%
Optimization Iteration:    100, Training Accuracy:  12.5%
Optimization Iteration:    200, Training Accuracy:   7.8%
Optimization Iteration:    300, Training Accuracy:  18.8%
Optimization Iteration:    400, Training Accuracy:   9.4%
Optimization Iteration:    499, Training Accuracy:   9.4%
Time usage: 0:00:02

Accuracy on Test-Set: 94.4% (9437 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  89.1%
Optimization Iteration:    100, Training Accuracy:  98.4%
Optimization Iteration:    199, Training Accuracy:  93.8%
Time usage: 0:00:01

Accuracy on Test-Set: 96.4% (9635 / 10000)

Target-class: 1
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   7.8%
Optimization Iteration:    100, Training Accuracy:  42.2%
Optimization Iteration:    200, Training Accuracy:  60.9%
Optimization Iteration:    300, Training Accuracy:  75.0%
Optimization Iteration:    400, Training Accuracy:  70.3%
Optimization Iteration:    499, Training Accuracy:  85.9%
Time usage: 0:00:02

Accuracy on Test-Set: 28.7% (2875 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  39.1%
Optimization Iteration:    100, Training Accuracy:  98.4%
Optimization Iteration:    199, Training Accuracy:  95.3%
Time usage: 0:00:01

Accuracy on Test-Set: 96.4% (9643 / 10000)

Target-class: 1
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   7.8%
Optimization Iteration:    100, Training Accuracy:  15.6%
Optimization Iteration:    200, Training Accuracy:  18.8%
Optimization Iteration:    300, Training Accuracy:  12.5%
Optimization Iteration:    400, Training Accuracy:   9.4%
Optimization Iteration:    499, Training Accuracy:  12.5%
Time usage: 0:00:02

Accuracy on Test-Set: 94.3% (9428 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  95.3%
Optimization Iteration:    100, Training Accuracy:  95.3%
Optimization Iteration:    199, Training Accuracy:  92.2%
Time usage: 0:00:01

Accuracy on Test-Set: 96.9% (9685 / 10000)

Target-class: 2
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   6.2%
Optimization Iteration:    100, Training Accuracy:  60.9%
Optimization Iteration:    200, Training Accuracy:  64.1%
Optimization Iteration:    300, Training Accuracy:  71.9%
Optimization Iteration:    400, Training Accuracy:  75.0%
Optimization Iteration:    499, Training Accuracy:  82.8%
Time usage: 0:00:02

Accuracy on Test-Set: 34.3% (3427 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  31.2%
Optimization Iteration:    100, Training Accuracy: 100.0%
Optimization Iteration:    199, Training Accuracy:  98.4%
Time usage: 0:00:01

Accuracy on Test-Set: 96.6% (9657 / 10000)

Target-class: 2
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   6.2%
Optimization Iteration:    100, Training Accuracy:   9.4%
Optimization Iteration:    200, Training Accuracy:  14.1%
Optimization Iteration:    300, Training Accuracy:  10.9%
Optimization Iteration:    400, Training Accuracy:   7.8%
Optimization Iteration:    499, Training Accuracy:  17.2%
Time usage: 0:00:02

Accuracy on Test-Set: 94.3% (9435 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  96.9%
Optimization Iteration:    100, Training Accuracy:  98.4%
Optimization Iteration:    199, Training Accuracy:  96.9%
Time usage: 0:00:01

Accuracy on Test-Set: 96.6% (9664 / 10000)

Target-class: 3
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:  14.1%
Optimization Iteration:    100, Training Accuracy:  20.3%
Optimization Iteration:    200, Training Accuracy:  40.6%
Optimization Iteration:    300, Training Accuracy:  57.8%
Optimization Iteration:    400, Training Accuracy:  54.7%
Optimization Iteration:    499, Training Accuracy:  64.1%
Time usage: 0:00:02

Accuracy on Test-Set: 48.4% (4837 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  54.7%
Optimization Iteration:    100, Training Accuracy:  98.4%
Optimization Iteration:    199, Training Accuracy: 100.0%
Time usage: 0:00:01

Accuracy on Test-Set: 96.5% (9650 / 10000)

Target-class: 3
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   4.7%
Optimization Iteration:    100, Training Accuracy:  10.9%
Optimization Iteration:    200, Training Accuracy:  17.2%
Optimization Iteration:    300, Training Accuracy:  15.6%
Optimization Iteration:    400, Training Accuracy:   1.6%
Optimization Iteration:    499, Training Accuracy:   9.4%
Time usage: 0:00:02

Accuracy on Test-Set: 95.7% (9570 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  95.3%
Optimization Iteration:    100, Training Accuracy:  90.6%
Optimization Iteration:    199, Training Accuracy:  98.4%
Time usage: 0:00:01

Accuracy on Test-Set: 96.7% (9667 / 10000)

Target-class: 4
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   7.8%
Optimization Iteration:    100, Training Accuracy:  67.2%
Optimization Iteration:    200, Training Accuracy:  78.1%
Optimization Iteration:    300, Training Accuracy:  79.7%
Optimization Iteration:    400, Training Accuracy:  81.2%
Optimization Iteration:    499, Training Accuracy:  96.9%
Time usage: 0:00:02

Accuracy on Test-Set: 23.7% (2373 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  26.6%
Optimization Iteration:    100, Training Accuracy:  95.3%
Optimization Iteration:    199, Training Accuracy:  96.9%
Time usage: 0:00:01

Accuracy on Test-Set: 96.3% (9632 / 10000)

Target-class: 4
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   4.7%
Optimization Iteration:    100, Training Accuracy:   7.8%
Optimization Iteration:    200, Training Accuracy:  12.5%
Optimization Iteration:    300, Training Accuracy:  15.6%
Optimization Iteration:    400, Training Accuracy:   7.8%
Optimization Iteration:    499, Training Accuracy:  14.1%
Time usage: 0:00:02

Accuracy on Test-Set: 92.0% (9197 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  92.2%
Optimization Iteration:    100, Training Accuracy:  95.3%
Optimization Iteration:    199, Training Accuracy:  95.3%
Time usage: 0:00:01

Accuracy on Test-Set: 96.3% (9632 / 10000)

Target-class: 5
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   4.7%
Optimization Iteration:    100, Training Accuracy:  57.8%
Optimization Iteration:    200, Training Accuracy:  76.6%
Optimization Iteration:    300, Training Accuracy:  85.9%
Optimization Iteration:    400, Training Accuracy:  89.1%
Optimization Iteration:    499, Training Accuracy:  85.9%
Time usage: 0:00:02

Accuracy on Test-Set: 23.0% (2297 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  28.1%
Optimization Iteration:    100, Training Accuracy:  93.8%
Optimization Iteration:    199, Training Accuracy:  98.4%
Time usage: 0:00:01

Accuracy on Test-Set: 96.6% (9663 / 10000)

Target-class: 5
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   6.2%
Optimization Iteration:    100, Training Accuracy:  10.9%
Optimization Iteration:    200, Training Accuracy:  18.8%
Optimization Iteration:    300, Training Accuracy:  18.8%
Optimization Iteration:    400, Training Accuracy:  20.3%
Optimization Iteration:    499, Training Accuracy:  21.9%
Time usage: 0:00:02

Accuracy on Test-Set: 88.2% (8824 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  93.8%
Optimization Iteration:    100, Training Accuracy:  93.8%
Optimization Iteration:    199, Training Accuracy:  93.8%
Time usage: 0:00:01

Accuracy on Test-Set: 96.7% (9665 / 10000)

Target-class: 6
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   7.8%
Optimization Iteration:    100, Training Accuracy:  40.6%
Optimization Iteration:    200, Training Accuracy:  53.1%
Optimization Iteration:    300, Training Accuracy:  51.6%
Optimization Iteration:    400, Training Accuracy:  56.2%
Optimization Iteration:    499, Training Accuracy:  62.5%
Time usage: 0:00:02

Accuracy on Test-Set: 44.0% (4400 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  39.1%
Optimization Iteration:    100, Training Accuracy:  96.9%
Optimization Iteration:    199, Training Accuracy:  93.8%
Time usage: 0:00:01

Accuracy on Test-Set: 96.4% (9642 / 10000)

Target-class: 6
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   4.7%
Optimization Iteration:    100, Training Accuracy:  17.2%
Optimization Iteration:    200, Training Accuracy:  12.5%
Optimization Iteration:    300, Training Accuracy:  14.1%
Optimization Iteration:    400, Training Accuracy:  20.3%
Optimization Iteration:    499, Training Accuracy:   7.8%
Time usage: 0:00:02

Accuracy on Test-Set: 94.6% (9457 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  93.8%
Optimization Iteration:    100, Training Accuracy: 100.0%
Optimization Iteration:    199, Training Accuracy:  95.3%
Time usage: 0:00:01

Accuracy on Test-Set: 96.8% (9682 / 10000)

Target-class: 7
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   4.7%
Optimization Iteration:    100, Training Accuracy:  65.6%
Optimization Iteration:    200, Training Accuracy:  89.1%
Optimization Iteration:    300, Training Accuracy:  82.8%
Optimization Iteration:    400, Training Accuracy:  85.9%
Optimization Iteration:    499, Training Accuracy:  90.6%
Time usage: 0:00:02

Accuracy on Test-Set: 18.1% (1809 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  23.4%
Optimization Iteration:    100, Training Accuracy:  95.3%
Optimization Iteration:    199, Training Accuracy:  93.8%
Time usage: 0:00:01

Accuracy on Test-Set: 96.8% (9682 / 10000)

Target-class: 7
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:  12.5%
Optimization Iteration:    100, Training Accuracy:  10.9%
Optimization Iteration:    200, Training Accuracy:  18.8%
Optimization Iteration:    300, Training Accuracy:  18.8%
Optimization Iteration:    400, Training Accuracy:  28.1%
Optimization Iteration:    499, Training Accuracy:  18.8%
Time usage: 0:00:02

Accuracy on Test-Set: 84.1% (8412 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  84.4%
Optimization Iteration:    100, Training Accuracy: 100.0%
Optimization Iteration:    199, Training Accuracy: 100.0%
Time usage: 0:00:01

Accuracy on Test-Set: 97.0% (9699 / 10000)

Target-class: 8
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   7.8%
Optimization Iteration:    100, Training Accuracy:  48.4%
Optimization Iteration:    200, Training Accuracy:  46.9%
Optimization Iteration:    300, Training Accuracy:  71.9%
Optimization Iteration:    400, Training Accuracy:  70.3%
Optimization Iteration:    499, Training Accuracy:  75.0%
Time usage: 0:00:02

Accuracy on Test-Set: 36.8% (3678 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  48.4%
Optimization Iteration:    100, Training Accuracy:  96.9%
Optimization Iteration:    199, Training Accuracy:  93.8%
Time usage: 0:00:01

Accuracy on Test-Set: 97.0% (9699 / 10000)

Target-class: 8
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   7.8%
Optimization Iteration:    100, Training Accuracy:  14.1%
Optimization Iteration:    200, Training Accuracy:  12.5%
Optimization Iteration:    300, Training Accuracy:   7.8%
Optimization Iteration:    400, Training Accuracy:   4.7%
Optimization Iteration:    499, Training Accuracy:   9.4%
Time usage: 0:00:02

Accuracy on Test-Set: 96.2% (9625 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  96.9%
Optimization Iteration:    100, Training Accuracy:  98.4%
Optimization Iteration:    199, Training Accuracy:  95.3%
Time usage: 0:00:01

Accuracy on Test-Set: 97.2% (9720 / 10000)

Target-class: 9
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   9.4%
Optimization Iteration:    100, Training Accuracy:  23.4%
Optimization Iteration:    200, Training Accuracy:  43.8%
Optimization Iteration:    300, Training Accuracy:  37.5%
Optimization Iteration:    400, Training Accuracy:  45.3%
Optimization Iteration:    499, Training Accuracy:  39.1%
Time usage: 0:00:02

Accuracy on Test-Set: 64.9% (6494 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  67.2%
Optimization Iteration:    100, Training Accuracy:  95.3%
Optimization Iteration:    199, Training Accuracy:  98.4%
Time usage: 0:00:01

Accuracy on Test-Set: 97.5% (9746 / 10000)

Target-class: 9
Finding adversarial noise ...
Optimization Iteration:      0, Training Accuracy:   9.4%
Optimization Iteration:    100, Training Accuracy:   7.8%
Optimization Iteration:    200, Training Accuracy:  10.9%
Optimization Iteration:    300, Training Accuracy:  15.6%
Optimization Iteration:    400, Training Accuracy:  12.5%
Optimization Iteration:    499, Training Accuracy:   4.7%
Time usage: 0:00:02

Accuracy on Test-Set: 97.1% (9709 / 10000)

Making the neural network immune to the noise ...
Optimization Iteration:      0, Training Accuracy:  98.4%
Optimization Iteration:    100, Training Accuracy: 100.0%
Optimization Iteration:    199, Training Accuracy:  95.3%
Time usage: 0:00:01

Accuracy on Test-Set: 97.7% (9768 / 10000)
</code></pre><h3 id="&#x7ED8;&#x5236;&#x5BF9;&#x6297;&#x566A;&#x58F0;">&#x7ED8;&#x5236;&#x5BF9;&#x6297;&#x566A;&#x58F0;</h3>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x5BF9;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x548C;&#x5BF9;&#x6297;&#x7F51;&#x7EDC;&#x90FD;&#x8FDB;&#x884C;&#x4E86;&#x5F88;&#x591A;&#x4F18;&#x5316;&#x3002;&#x8BA9;&#x6211;&#x4EEC;&#x770B;&#x770B;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x957F;&#x4EC0;&#x4E48;&#x6837;&#x3002;</p>
<pre><code class="lang-python">plot_noise()
</code></pre>
<pre><code>Noise:
- Min: -0.35
- Max: 0.35
- Std: 0.270488
</code></pre><p><img src="output_146_1.png" alt="png"></p>
<p>&#x6709;&#x8DA3;&#x7684;&#x662F;&#xFF0C;&#x76F8;&#x6BD4;&#x4F18;&#x5316;&#x4E4B;&#x524D;&#x7684;&#x5E72;&#x51C0;&#x56FE;&#x50CF;&#xFF0C;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5728;&#x566A;&#x58F0;&#x56FE;&#x50CF;&#x4E0A;&#x6709;&#x66F4;&#x9AD8;&#x7684;&#x5206;&#x7C7B;&#x51C6;&#x786E;&#x7387;&#x3002;</p>
<pre><code class="lang-python">print_test_accuracy(show_example_errors=<span class="hljs-keyword">True</span>,
                    show_confusion_matrix=<span class="hljs-keyword">True</span>)
</code></pre>
<pre><code>Accuracy on Test-Set: 97.7% (9768 / 10000)
Example errors:
</code></pre><p><img src="output_148_1.png" alt="png"></p>
<pre><code>Confusion Matrix:
[[ 972    0    1    0    0    0    2    1    3    1]
 [   0 1119    4    0    0    2    2    0    8    0]
 [   3    0 1006    9    1    1    1    5    4    2]
 [   1    0    1  997    0    5    0    4    2    0]
 [   0    1    3    0  955    0    3    1    2   17]
 [   1    0    0    9    0  876    3    0    2    1]
 [   6    4    0    0    3    6  934    0    5    0]
 [   2    4   18    3    1    0    0  985    2   13]
 [   4    0    4    3    4    1    1    3  950    4]
 [   6    6    0    7    4    5    0    4    3  974]]
</code></pre><h3 id="&#x5E72;&#x51C0;&#x56FE;&#x50CF;&#x4E0A;&#x7684;&#x6027;&#x80FD;">&#x5E72;&#x51C0;&#x56FE;&#x50CF;&#x4E0A;&#x7684;&#x6027;&#x80FD;</h3>
<p>&#x73B0;&#x5728;&#x5C06;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x91CD;&#x7F6E;&#x4E3A;&#x96F6;&#xFF0C;&#x770B;&#x770B;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5728;&#x5E72;&#x51C0;&#x56FE;&#x50CF;&#x4E0A;&#x7684;&#x8868;&#x73B0;&#x3002;</p>
<pre><code class="lang-python">init_noise()
</code></pre>
<p>&#x76F8;&#x6BD4;&#x566A;&#x58F0;&#x56FE;&#x50CF;&#xFF0C;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5728;&#x5E72;&#x51C0;&#x56FE;&#x50CF;&#x4E0A;&#x8868;&#x73B0;&#x7684;&#x8981;&#x66F4;&#x5DEE;&#x4E00;&#x70B9;&#x3002;</p>
<pre><code class="lang-python">print_test_accuracy(show_example_errors=<span class="hljs-keyword">True</span>,
                    show_confusion_matrix=<span class="hljs-keyword">True</span>)
</code></pre>
<pre><code>Accuracy on Test-Set: 92.2% (9222 / 10000)
Example errors:
</code></pre><p><img src="output_152_1.png" alt="png"></p>
<pre><code>Confusion Matrix:
[[ 970    0    1    0    0    1    8    0    0    0]
 [   0 1121    5    0    0    0    9    0    0    0]
 [   2    1 1028    0    0    0    1    0    0    0]
 [   1    0   27  964    0   13    2    2    1    0]
 [   0    2    3    0  957    0   20    0    0    0]
 [   3    0    2    2    0  875   10    0    0    0]
 [   4    1    0    0    1    1  951    0    0    0]
 [  10   21   61    3   14    3    0  913    3    0]
 [  29    2   91    7    7   26   70    1  741    0]
 [  20   18   10   12  150   65   11   12    9  702]]
</code></pre><h2 id="&#x5173;&#x95ED;tensorflow&#x4F1A;&#x8BDD;">&#x5173;&#x95ED;TensorFlow&#x4F1A;&#x8BDD;</h2>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x7528;TensorFlow&#x5B8C;&#x6210;&#x4E86;&#x4EFB;&#x52A1;&#xFF0C;&#x5173;&#x95ED;session&#xFF0C;&#x91CA;&#x653E;&#x8D44;&#x6E90;&#x3002;</p>
<pre><code class="lang-python"><span class="hljs-comment"># This has been commented out in case you want to modify and experiment</span>
<span class="hljs-comment"># with the Notebook without having to restart it.</span>
<span class="hljs-comment"># session.close()</span>
</code></pre>
<h2 id="&#x8BA8;&#x8BBA;">&#x8BA8;&#x8BBA;</h2>
<p>&#x5728;&#x4E0A;&#x9762;&#x7684;&#x5B9E;&#x9A8C;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x6211;&#x4EEC;&#x80FD;&#x591F;&#x4F7F;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5BF9;&#x5355;&#x4E2A;&#x76EE;&#x6807;&#x7C7B;&#x522B;&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x514D;&#x75AB;&#x3002;&#x8FD9;&#x4F7F;&#x5F97;&#x4E0D;&#x53EF;&#x80FD;&#x627E;&#x5230;&#x5F15;&#x8D77;&#x8BEF;&#x5206;&#x7C7B;&#x5230;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x663E;&#x7136;&#x4E5F;&#x4E0D;&#x53EF;&#x80FD;&#x4F7F;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x540C;&#x65F6;&#x5BF9;&#x6240;&#x6709;&#x76EE;&#x6807;&#x7C7B;&#x522B;&#x514D;&#x75AB;&#x3002;&#x53EF;&#x80FD;&#x7528;&#x5176;&#x4ED6;&#x65B9;&#x6CD5;&#x80FD;&#x591F;&#x505A;&#x5230;&#x8FD9;&#x4E00;&#x70B9;&#x3002;</p>
<p>&#x4E00;&#x79CD;&#x5EFA;&#x8BAE;&#x662F;&#x5BF9;&#x4E0D;&#x540C;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x8FDB;&#x884C;&#x4EA4;&#x53C9;&#x7684;&#x514D;&#x75AB;&#x8BAD;&#x7EC3;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4F9D;&#x6B21;&#x5BF9;&#x6BCF;&#x4E2A;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x8FDB;&#x884C;&#x5B8C;&#x5168;&#x7684;&#x4F18;&#x5316;&#x3002;&#x5BF9;&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x505A;&#x4E9B;&#x5C0F;&#x4FEE;&#x6539;&#x5C31;&#x80FD;&#x505A;&#x5230;&#x8FD9;&#x4E00;&#x70B9;&#x3002;</p>
<p>&#x53E6;&#x4E00;&#x4E2A;&#x5EFA;&#x8BAE;&#x662F;&#x8BBE;&#x7F6E;&#x4E24;&#x5C42;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#xFF0C;&#x5171;11&#x4E2A;&#x7F51;&#x7EDC;&#x3002;&#x7B2C;&#x4E00;&#x5C42;&#x7F51;&#x7EDC;&#x7528;&#x6765;&#x5BF9;&#x8F93;&#x5165;&#x56FE;&#x50CF;&#x8FDB;&#x884C;&#x5206;&#x7C7B;&#x3002;&#x8FD9;&#x4E2A;&#x7F51;&#x7EDC;&#x6CA1;&#x6709;&#x5BF9;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x514D;&#x75AB;&#x3002;&#x7136;&#x540E;&#x6839;&#x636E;&#x7B2C;&#x4E00;&#x5C42;&#x7684;&#x9884;&#x6D4B;&#x7C7B;&#x578B;&#x9009;&#x62E9;&#x7B2C;&#x4E8C;&#x5C42;&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x7F51;&#x7EDC;&#x3002;&#x7B2C;&#x4E8C;&#x5C42;&#x4E2D;&#x7684;&#x7F51;&#x7EDC;&#x5BF9;&#x5404;&#x81EA;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x514D;&#x75AB;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x4E00;&#x4E2A;&#x5BF9;&#x6297;&#x6837;&#x672C;&#x53EF;&#x80FD;&#x7CCA;&#x5F04;&#x7B2C;&#x4E00;&#x5C42;&#x7684;&#x7F51;&#x7EDC;&#xFF0C;&#x4F46;&#x7B2C;&#x4E8C;&#x5C42;&#x4E2D;&#x7684;&#x7F51;&#x7EDC;&#x4F1A;&#x514D;&#x4E8E;&#x7279;&#x5B9A;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x566A;&#x58F0;&#x7684;&#x5F71;&#x54CD;&#x3002;</p>
<p>&#x8FD9;&#x53EF;&#x80FD;&#x4F7F;&#x7528;&#x4E86;&#x7C7B;&#x578B;&#x6570;&#x91CF;&#x6BD4;&#x8F83;&#x5C11;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x6570;&#x91CF;&#x5F88;&#x5927;&#x5C31;&#x53D8;&#x5F97;&#x4E0D;&#x53EF;&#x884C;&#xFF0C;&#x6BD4;&#x5982;ImageNet&#x6709;1000&#x4E2A;&#x7C7B;&#x522B;&#xFF0C;&#x8FD9;&#x6837;&#x6211;&#x4EEC;&#x5728;&#x7B2C;&#x4E8C;&#x5C42;&#x4E2D;&#x9700;&#x8981;&#x8BAD;&#x7EC3;1000&#x4E2A;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#xFF0C;&#x8FD9;&#x5E76;&#x4E0D;&#x5B9E;&#x9645;&#x3002;</p>
<h2 id="&#x603B;&#x7ED3;">&#x603B;&#x7ED3;</h2>
<p>&#x8FD9;&#x7BC7;&#x6559;&#x7A0B;&#x5C55;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x627E;&#x5230;MNIST&#x6570;&#x636E;&#x96C6;&#x624B;&#x5199;&#x6570;&#x5B57;&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x3002; &#x6BCF;&#x4E2A;&#x76EE;&#x6807;&#x7C7B;&#x522B;&#x90FD;&#x627E;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x5355;&#x4E00;&#x7684;&#x566A;&#x58F0;&#x6A21;&#x5F0F;&#xFF0C;&#x5B83;&#x5BFC;&#x81F4;&#x51E0;&#x4E4E;&#x6240;&#x6709;&#x7684;&#x8F93;&#x5165;&#x56FE;&#x50CF;&#x90FD;&#x88AB;&#x8BEF;&#x5206;&#x7C7B;&#x4E3A;&#x76EE;&#x6807;&#x7C7B;&#x522B;&#x3002;</p>
<p>MNIST&#x6570;&#x636E;&#x96C6;&#x7684;&#x566A;&#x58F0;&#x6A21;&#x5F0F;&#x5BF9;&#x4EBA;&#x773C;&#x6E05;&#x6670;&#x53EF;&#x89C1;&#x3002;&#x4F46;&#x53EF;&#x80FD;&#x5728;&#x9AD8;&#x5206;&#x8FA8;&#x7387;&#x56FE;&#x50CF;&#x4E0A;&#xFF08;&#x6BD4;&#x5982;ImageNet&#x6570;&#x636E;&#x96C6;&#xFF09;&#x5DE5;&#x4F5C;&#x7684;&#x5927;&#x578B;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x53EF;&#x4EE5;&#x627E;&#x5230;&#x66F4;&#x7EC6;&#x5FAE;&#x7684;&#x566A;&#x58F0;&#x6A21;&#x5F0F;&#x3002;</p>
<p>&#x672C;&#x6559;&#x7A0B;&#x4E5F;&#x5C1D;&#x8BD5;&#x4E86;&#x4F7F;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x514D;&#x53D7;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x5F71;&#x54CD;&#x7684;&#x65B9;&#x6CD5;&#x3002; &#x8FD9;&#x5BF9;&#x5355;&#x4E2A;&#x76EE;&#x6807;&#x7C7B;&#x522B;&#x6709;&#x6548;&#xFF0C;&#x4F46;&#x6240;&#x6D4B;&#x8BD5;&#x7684;&#x65B9;&#x6CD5;&#x65E0;&#x6CD5;&#x4F7F;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x540C;&#x65F6;&#x5BF9;&#x6240;&#x6709;&#x5BF9;&#x6297;&#x76EE;&#x6807;&#x7C7B;&#x522B;&#x514D;&#x75AB;&#x3002;</p>
<h2 id="&#x7EC3;&#x4E60;">&#x7EC3;&#x4E60;</h2>
<p>&#x4E0B;&#x9762;&#x4F7F;&#x4E00;&#x4E9B;&#x53EF;&#x80FD;&#x4F1A;&#x8BA9;&#x4F60;&#x63D0;&#x5347;TensorFlow&#x6280;&#x80FD;&#x7684;&#x4E00;&#x4E9B;&#x5EFA;&#x8BAE;&#x7EC3;&#x4E60;&#x3002;&#x4E3A;&#x4E86;&#x5B66;&#x4E60;&#x5982;&#x4F55;&#x66F4;&#x5408;&#x9002;&#x5730;&#x4F7F;&#x7528;TensorFlow&#xFF0C;&#x5B9E;&#x8DF5;&#x7ECF;&#x9A8C;&#x662F;&#x5F88;&#x91CD;&#x8981;&#x7684;&#x3002;</p>
<p>&#x5728;&#x4F60;&#x5BF9;&#x8FD9;&#x4E2A;Notebook&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#x4E4B;&#x524D;&#xFF0C;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x5148;&#x5907;&#x4EFD;&#x4E00;&#x4E0B;&#x3002;</p>
<ul>
<li>&#x5C1D;&#x8BD5;&#x4E3A;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x4F7F;&#x7528;&#x66F4;&#x5C11;&#x6216;&#x66F4;&#x591A;&#x7684;&#x4F18;&#x5316;&#x8FED;&#x4EE3;&#x6570;&#x3002;</li>
<li>&#x6559;&#x7A0B;#11&#x53EA;&#x9700;&#x5C11;&#x4E8E;30&#x6B21;&#x7684;&#x8FED;&#x4EE3;&#x6B21;&#x6570;&#x5C31;&#x80FD;&#x627E;&#x5230;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#xFF0C;&#x76F8;&#x6BD4;&#x4E4B;&#x4E0B;&#x4E3A;&#x4EC0;&#x4E48;&#x8FD9;&#x7BC7;&#x6559;&#x7A0B;&#x9700;&#x8981;&#x66F4;&#x591A;&#x8FED;&#x4EE3;&#xFF1F;</li>
<li>&#x5C1D;&#x8BD5;&#x8BBE;&#x7F6E;&#x4E0D;&#x540C;&#x7684;<code>noise_limit</code> &#x548C; <code>noise_l2_weight</code>&#x3002;&#x8FD9;&#x4F1A;&#x5982;&#x4F55;&#x5F71;&#x54CD;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x4EE5;&#x53CA;&#x5206;&#x7C7B;&#x51C6;&#x786E;&#x7387;&#xFF1F;</li>
<li>&#x8BD5;&#x7740;&#x4E3A;&#x76EE;&#x6807;&#x7C7B;&#x578B;1&#x5BFB;&#x627E;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x3002;&#x5B83;&#x662F;&#x5426;&#x9002;&#x7528;&#x4E8E;&#x76EE;&#x6807;&#x7C7B;&#x578B;3&#xFF1F;</li>
<li>&#x4F60;&#x80FD;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x66F4;&#x597D;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4F7F;&#x5F97;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5BF9;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x514D;&#x75AB;&#x5417;&#xFF1F;</li>
<li>&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x5BF9;&#x5355;&#x4E2A;&#x56FE;&#x50CF;&#x4EA7;&#x751F;&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x514D;&#x75AB;&#xFF0C;&#x5C31;&#x50CF;&#x6559;&#x7A0B; #11 &#x4E2D;&#x6240;&#x505A;&#x7684;&#x90A3;&#x6837;&#xFF1F;</li>
<li>&#x5C1D;&#x8BD5;&#x7528;&#x4E0D;&#x540C;&#x7684;&#x914D;&#x7F6E;&#x521B;&#x5EFA;&#x53E6;&#x4E00;&#x4E2A;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x3002;&#x4E00;&#x4E2A;&#x7F51;&#x7EDC;&#x4E0A;&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#x5BF9;&#x53E6;&#x4E00;&#x4E2A;&#x7F51;&#x7EDC;&#x6709;&#x6548;&#x5417;&#xFF1F;</li>
<li>&#x7528;CIFAR-10&#x6570;&#x636E;&#x96C6;&#x4EE3;&#x66FF;MNIST&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x590D;&#x7528;&#x6559;&#x7A0B; #06 &#x4E2D;&#x7684;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;&#x3002;</li>
<li>&#x4F60;&#x4F1A;&#x5982;&#x4F55;&#x627E;&#x5230;Inception&#x6A21;&#x578B;&#x548C;ImageNet&#x6570;&#x636E;&#x96C6;&#x7684;&#x5BF9;&#x6297;&#x566A;&#x58F0;&#xFF1F;</li>
<li>&#x5411;&#x670B;&#x53CB;&#x89E3;&#x91CA;&#x7A0B;&#x5E8F;&#x5982;&#x4F55;&#x5DE5;&#x4F5C;&#x3002;</li>
</ul>
<h2 id="license-mit">License (MIT)</h2>
<p>Copyright (c) 2016 by <a href="http://www.hvass-labs.org/" target="_blank">Magnus Erik Hvass Pedersen</a></p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the &quot;Software&quot;), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../11_Adversarial_Examples_zh_CN/11_Adversarial_Examples_zh_CN.html" class="navigation navigation-prev " aria-label="Previous page: 对抗样本">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../13_Visual_Analysis_zh_CN/13_Visual_Analysis_zh_CN.html" class="navigation navigation-next " aria-label="Next page: 可视化分析">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"MNIST的对抗噪声","level":"1.12","depth":1,"next":{"title":"可视化分析","level":"1.13","depth":1,"path":"13_Visual_Analysis_zh_CN/13_Visual_Analysis_zh_CN.md","ref":"13_Visual_Analysis_zh_CN/13_Visual_Analysis_zh_CN.md","articles":[]},"previous":{"title":"对抗样本","level":"1.11","depth":1,"path":"11_Adversarial_Examples_zh_CN/11_Adversarial_Examples_zh_CN.md","ref":"11_Adversarial_Examples_zh_CN/11_Adversarial_Examples_zh_CN.md","articles":[]},"dir":"ltr"},"config":{"plugins":["comment"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"comment":{"highlightCommented":true},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"wizardforcel","pdf":{"pageNumbers":true,"fontSize":16,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"TensorFlow 教程（Hvass）","language":"zh","links":{"sidebar":{"TensorFlow 教程（Hvass）":"https://www.gitbook.com/book/wizardforcel/tf-tut-hvass"},"gitbook":true},"gitbook":"*","description":"Tensorflow 教程（Hvass）"},"file":{"path":"12_Adversarial_Noise_MNIST_zh_CN/12_Adversarial_Noise_MNIST_zh_CN.md","mtime":"2017-09-18T01:21:37.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2017-09-18T01:34:14.068Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-comment/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

