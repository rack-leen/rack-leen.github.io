<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>LFS系统构建03-安装基础系统软件 | rack-leen's blog</title><meta name="description" content="LFS系统构建03-安装基础系统软件"><meta name="keywords" content="LFS,LFS系统构建"><meta name="author" content="rack-leen"><meta name="copyright" content="rack-leen"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="LFS系统构建03-安装基础系统软件"><meta name="twitter:description" content="LFS系统构建03-安装基础系统软件"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><meta property="og:type" content="article"><meta property="og:title" content="LFS系统构建03-安装基础系统软件"><meta property="og:url" content="http://yoursite.com/2019/06/04/LFS/LFS%E7%B3%BB%E7%BB%9F%E6%9E%84%E5%BB%BA03-%E5%AE%89%E8%A3%85%E5%9F%BA%E7%A1%80%E7%B3%BB%E7%BB%9F%E8%BD%AF%E4%BB%B6/"><meta property="og:site_name" content="rack-leen's blog"><meta property="og:description" content="LFS系统构建03-安装基础系统软件"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'true'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.15/dist/snackbar.min.css"><link rel="canonical" href="http://yoursite.com/2019/06/04/LFS/LFS%E7%B3%BB%E7%BB%9F%E6%9E%84%E5%BB%BA03-%E5%AE%89%E8%A3%85%E5%9F%BA%E7%A1%80%E7%B3%BB%E7%BB%9F%E8%BD%AF%E4%BB%B6/"><link rel="prev" title="LFS系统构建04-系统配置" href="http://yoursite.com/2019/06/07/LFS/LFS%E7%B3%BB%E7%BB%9F%E6%9E%84%E5%BB%BA04-%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE/"><link rel="next" title="LFS系统构建02-编译基本工具" href="http://yoursite.com/2019/06/03/LFS/LFS%E7%B3%BB%E7%BB%9F%E6%9E%84%E5%BB%BA02-%E7%BC%96%E8%AF%91%E5%9F%BA%E6%9C%AC%E5%B7%A5%E5%85%B7/"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"PIBV7VGBEP","apiKey":"5b1fef2837ae17299ea73b8c5b0bfad5","indexName":"rack","hits":5000,"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://rack-leen.top/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'true',
  highlight_lang: 'true',
  highlight_shrink: 'true',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  copyright: undefined,
  copy_copyright_js: false,
  ClickShowText: {"text":"富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善","fontSize":"15px"},
  medium_zoom: 'true',
  Snackbar: {"bookmark":{"title":"Snackbar.bookmark.title","message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"}
  
}</script><meta name="generator" content="Hexo 4.2.1"></head><body><canvas class="fireworks"></canvas><div id="header"> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">rack-leen's blog</a></span><i class="fa fa-bars fa-fw toggle-menu pull_right close" aria-hidden="true"></i><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/Home"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></span><span class="pull_right" id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></span></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="lazyload avatar_img" src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'"></div><div class="mobile_post_data"><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">181</div></a></div></div><div class="mobile_data_item is_center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">50</div></a></div></div><div class="mobile_data_item is_center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">65</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/Home"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#lfs系统构建03-安装基础系统软件"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">LFS系统构建03-安装基础系统软件</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#准备虚拟内核文件系统"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">准备虚拟内核文件系统</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#开始进入构建的lfs环境"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">开始进入构建的lfs环境</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#创建主要目录"><span class="toc_mobile_items-number">1.3.</span> <span class="toc_mobile_items-text">创建主要目录</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#创建重要文件和符号连接"><span class="toc_mobile_items-number">1.4.</span> <span class="toc_mobile_items-text">创建重要文件和符号连接</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#linux-api-头文件"><span class="toc_mobile_items-number">1.5.</span> <span class="toc_mobile_items-text">linux api 头文件</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#man-pages"><span class="toc_mobile_items-number">1.6.</span> <span class="toc_mobile_items-text">man-pages</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#glibc"><span class="toc_mobile_items-number">1.7.</span> <span class="toc_mobile_items-text">glibc</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#gawk"><span class="toc_mobile_items-number">1.8.</span> <span class="toc_mobile_items-text">gawk</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#适应工具链"><span class="toc_mobile_items-number">1.9.</span> <span class="toc_mobile_items-text">适应工具链</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#zlib"><span class="toc_mobile_items-number">1.10.</span> <span class="toc_mobile_items-text">zlib</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#file"><span class="toc_mobile_items-number">1.11.</span> <span class="toc_mobile_items-text">file</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#readline"><span class="toc_mobile_items-number">1.12.</span> <span class="toc_mobile_items-text">readline</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#m4"><span class="toc_mobile_items-number">1.13.</span> <span class="toc_mobile_items-text">m4</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#bc"><span class="toc_mobile_items-number">1.14.</span> <span class="toc_mobile_items-text">bc</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#texinfo"><span class="toc_mobile_items-number">1.15.</span> <span class="toc_mobile_items-text">texinfo</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#binutils"><span class="toc_mobile_items-number">1.16.</span> <span class="toc_mobile_items-text">binutils</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#gmp"><span class="toc_mobile_items-number">1.17.</span> <span class="toc_mobile_items-text">gmp</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#mpfr"><span class="toc_mobile_items-number">1.18.</span> <span class="toc_mobile_items-text">mpfr</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#mpc"><span class="toc_mobile_items-number">1.19.</span> <span class="toc_mobile_items-text">mpc</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#shadow"><span class="toc_mobile_items-number">1.20.</span> <span class="toc_mobile_items-text">shadow</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#gcc-第三次安装"><span class="toc_mobile_items-number">1.21.</span> <span class="toc_mobile_items-text">gcc(第三次安装)</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#bzip"><span class="toc_mobile_items-number">1.22.</span> <span class="toc_mobile_items-text">bzip</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#pkg-config"><span class="toc_mobile_items-number">1.23.</span> <span class="toc_mobile_items-text">pkg-config</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#ncurses"><span class="toc_mobile_items-number">1.24.</span> <span class="toc_mobile_items-text">ncurses</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#attr"><span class="toc_mobile_items-number">1.25.</span> <span class="toc_mobile_items-text">attr</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#acl"><span class="toc_mobile_items-number">1.26.</span> <span class="toc_mobile_items-text">acl</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#libcap"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">libcap</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#sed"><span class="toc_mobile_items-number">2.1.</span> <span class="toc_mobile_items-text">sed</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#psmisc"><span class="toc_mobile_items-number">2.2.</span> <span class="toc_mobile_items-text">psmisc</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#lana-etc"><span class="toc_mobile_items-number">2.3.</span> <span class="toc_mobile_items-text">lana-etc</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#bison"><span class="toc_mobile_items-number">2.4.</span> <span class="toc_mobile_items-text">bison</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#flex"><span class="toc_mobile_items-number">2.5.</span> <span class="toc_mobile_items-text">flex</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#grep"><span class="toc_mobile_items-number">2.6.</span> <span class="toc_mobile_items-text">grep</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#bash"><span class="toc_mobile_items-number">2.7.</span> <span class="toc_mobile_items-text">bash</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#libtool"><span class="toc_mobile_items-number">2.8.</span> <span class="toc_mobile_items-text">libtool</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#gdbm"><span class="toc_mobile_items-number">2.9.</span> <span class="toc_mobile_items-text">gdbm</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#gperf"><span class="toc_mobile_items-number">2.10.</span> <span class="toc_mobile_items-text">gperf</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#expat"><span class="toc_mobile_items-number">2.11.</span> <span class="toc_mobile_items-text">expat</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#inetutils"><span class="toc_mobile_items-number">2.12.</span> <span class="toc_mobile_items-text">inetutils</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#perl"><span class="toc_mobile_items-number">2.13.</span> <span class="toc_mobile_items-text">perl</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#xml-parser"><span class="toc_mobile_items-number">2.14.</span> <span class="toc_mobile_items-text">XML-Parser</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#intltool"><span class="toc_mobile_items-number">2.15.</span> <span class="toc_mobile_items-text">intltool</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#autoconf"><span class="toc_mobile_items-number">2.16.</span> <span class="toc_mobile_items-text">autoconf</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#automake"><span class="toc_mobile_items-number">2.17.</span> <span class="toc_mobile_items-text">automake</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#xz"><span class="toc_mobile_items-number">2.18.</span> <span class="toc_mobile_items-text">xz</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#kmod"><span class="toc_mobile_items-number">2.19.</span> <span class="toc_mobile_items-text">kmod</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#gettext"><span class="toc_mobile_items-number">2.20.</span> <span class="toc_mobile_items-text">gettext</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#elfutils"><span class="toc_mobile_items-number">2.21.</span> <span class="toc_mobile_items-text">elfutils</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#libffi"><span class="toc_mobile_items-number">2.22.</span> <span class="toc_mobile_items-text">libffi</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#openssl"><span class="toc_mobile_items-number">2.23.</span> <span class="toc_mobile_items-text">openssl</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#python"><span class="toc_mobile_items-number">2.24.</span> <span class="toc_mobile_items-text">Python</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#ninja"><span class="toc_mobile_items-number">2.25.</span> <span class="toc_mobile_items-text">ninja</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#meson"><span class="toc_mobile_items-number">2.26.</span> <span class="toc_mobile_items-text">meson</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#coreutils"><span class="toc_mobile_items-number">2.27.</span> <span class="toc_mobile_items-text">coreutils</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#check"><span class="toc_mobile_items-number">2.28.</span> <span class="toc_mobile_items-text">check</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#diffutils"><span class="toc_mobile_items-number">2.29.</span> <span class="toc_mobile_items-text">diffutils</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#gawk-v2"><span class="toc_mobile_items-number">2.30.</span> <span class="toc_mobile_items-text">gawk</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#findutils"><span class="toc_mobile_items-number">2.31.</span> <span class="toc_mobile_items-text">findutils</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#groff"><span class="toc_mobile_items-number">2.32.</span> <span class="toc_mobile_items-text">groff</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#grub"><span class="toc_mobile_items-number">2.33.</span> <span class="toc_mobile_items-text">grub</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#less"><span class="toc_mobile_items-number">2.34.</span> <span class="toc_mobile_items-text">less</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#gzip"><span class="toc_mobile_items-number">2.35.</span> <span class="toc_mobile_items-text">gzip</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#iproute"><span class="toc_mobile_items-number">2.36.</span> <span class="toc_mobile_items-text">iproute</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#kbd"><span class="toc_mobile_items-number">2.37.</span> <span class="toc_mobile_items-text">kbd</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#libpipeline"><span class="toc_mobile_items-number">2.38.</span> <span class="toc_mobile_items-text">libpipeline</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#make"><span class="toc_mobile_items-number">2.39.</span> <span class="toc_mobile_items-text">make</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#man-db"><span class="toc_mobile_items-number">2.40.</span> <span class="toc_mobile_items-text">man-db</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#patch"><span class="toc_mobile_items-number">2.41.</span> <span class="toc_mobile_items-text">patch</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#tar"><span class="toc_mobile_items-number">2.42.</span> <span class="toc_mobile_items-text">tar</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#vim"><span class="toc_mobile_items-number">2.43.</span> <span class="toc_mobile_items-text">vim</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#procps"><span class="toc_mobile_items-number">2.44.</span> <span class="toc_mobile_items-text">procps</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#utils-linux"><span class="toc_mobile_items-number">2.45.</span> <span class="toc_mobile_items-text">utils-linux</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#e2fsprogs"><span class="toc_mobile_items-number">2.46.</span> <span class="toc_mobile_items-text">e2fsprogs</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#sysklogd"><span class="toc_mobile_items-number">2.47.</span> <span class="toc_mobile_items-text">sysklogd</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#sysvinit"><span class="toc_mobile_items-number">2.48.</span> <span class="toc_mobile_items-text">sysvinit</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#eudev"><span class="toc_mobile_items-number">2.49.</span> <span class="toc_mobile_items-text">eudev</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#再次剥离-可选"><span class="toc_mobile_items-number">2.50.</span> <span class="toc_mobile_items-text">再次剥离(可选)</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#清理"><span class="toc_mobile_items-number">2.51.</span> <span class="toc_mobile_items-text">清理</span></a></li></ol></li></ol></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#lfs系统构建03-安装基础系统软件"><span class="toc-number">1.</span> <span class="toc-text">LFS系统构建03-安装基础系统软件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#准备虚拟内核文件系统"><span class="toc-number">1.1.</span> <span class="toc-text">准备虚拟内核文件系统</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#开始进入构建的lfs环境"><span class="toc-number">1.2.</span> <span class="toc-text">开始进入构建的lfs环境</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#创建主要目录"><span class="toc-number">1.3.</span> <span class="toc-text">创建主要目录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#创建重要文件和符号连接"><span class="toc-number">1.4.</span> <span class="toc-text">创建重要文件和符号连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#linux-api-头文件"><span class="toc-number">1.5.</span> <span class="toc-text">linux api 头文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#man-pages"><span class="toc-number">1.6.</span> <span class="toc-text">man-pages</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#glibc"><span class="toc-number">1.7.</span> <span class="toc-text">glibc</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gawk"><span class="toc-number">1.8.</span> <span class="toc-text">gawk</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#适应工具链"><span class="toc-number">1.9.</span> <span class="toc-text">适应工具链</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#zlib"><span class="toc-number">1.10.</span> <span class="toc-text">zlib</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#file"><span class="toc-number">1.11.</span> <span class="toc-text">file</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#readline"><span class="toc-number">1.12.</span> <span class="toc-text">readline</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#m4"><span class="toc-number">1.13.</span> <span class="toc-text">m4</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bc"><span class="toc-number">1.14.</span> <span class="toc-text">bc</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#texinfo"><span class="toc-number">1.15.</span> <span class="toc-text">texinfo</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#binutils"><span class="toc-number">1.16.</span> <span class="toc-text">binutils</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gmp"><span class="toc-number">1.17.</span> <span class="toc-text">gmp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mpfr"><span class="toc-number">1.18.</span> <span class="toc-text">mpfr</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mpc"><span class="toc-number">1.19.</span> <span class="toc-text">mpc</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#shadow"><span class="toc-number">1.20.</span> <span class="toc-text">shadow</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gcc-第三次安装"><span class="toc-number">1.21.</span> <span class="toc-text">gcc(第三次安装)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bzip"><span class="toc-number">1.22.</span> <span class="toc-text">bzip</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pkg-config"><span class="toc-number">1.23.</span> <span class="toc-text">pkg-config</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ncurses"><span class="toc-number">1.24.</span> <span class="toc-text">ncurses</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#attr"><span class="toc-number">1.25.</span> <span class="toc-text">attr</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#acl"><span class="toc-number">1.26.</span> <span class="toc-text">acl</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#libcap"><span class="toc-number">2.</span> <span class="toc-text">libcap</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#sed"><span class="toc-number">2.1.</span> <span class="toc-text">sed</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#psmisc"><span class="toc-number">2.2.</span> <span class="toc-text">psmisc</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lana-etc"><span class="toc-number">2.3.</span> <span class="toc-text">lana-etc</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bison"><span class="toc-number">2.4.</span> <span class="toc-text">bison</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flex"><span class="toc-number">2.5.</span> <span class="toc-text">flex</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#grep"><span class="toc-number">2.6.</span> <span class="toc-text">grep</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bash"><span class="toc-number">2.7.</span> <span class="toc-text">bash</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#libtool"><span class="toc-number">2.8.</span> <span class="toc-text">libtool</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gdbm"><span class="toc-number">2.9.</span> <span class="toc-text">gdbm</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gperf"><span class="toc-number">2.10.</span> <span class="toc-text">gperf</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#expat"><span class="toc-number">2.11.</span> <span class="toc-text">expat</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#inetutils"><span class="toc-number">2.12.</span> <span class="toc-text">inetutils</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#perl"><span class="toc-number">2.13.</span> <span class="toc-text">perl</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#xml-parser"><span class="toc-number">2.14.</span> <span class="toc-text">XML-Parser</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#intltool"><span class="toc-number">2.15.</span> <span class="toc-text">intltool</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#autoconf"><span class="toc-number">2.16.</span> <span class="toc-text">autoconf</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#automake"><span class="toc-number">2.17.</span> <span class="toc-text">automake</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#xz"><span class="toc-number">2.18.</span> <span class="toc-text">xz</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#kmod"><span class="toc-number">2.19.</span> <span class="toc-text">kmod</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gettext"><span class="toc-number">2.20.</span> <span class="toc-text">gettext</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#elfutils"><span class="toc-number">2.21.</span> <span class="toc-text">elfutils</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#libffi"><span class="toc-number">2.22.</span> <span class="toc-text">libffi</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#openssl"><span class="toc-number">2.23.</span> <span class="toc-text">openssl</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#python"><span class="toc-number">2.24.</span> <span class="toc-text">Python</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ninja"><span class="toc-number">2.25.</span> <span class="toc-text">ninja</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#meson"><span class="toc-number">2.26.</span> <span class="toc-text">meson</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#coreutils"><span class="toc-number">2.27.</span> <span class="toc-text">coreutils</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#check"><span class="toc-number">2.28.</span> <span class="toc-text">check</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#diffutils"><span class="toc-number">2.29.</span> <span class="toc-text">diffutils</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gawk-v2"><span class="toc-number">2.30.</span> <span class="toc-text">gawk</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#findutils"><span class="toc-number">2.31.</span> <span class="toc-text">findutils</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#groff"><span class="toc-number">2.32.</span> <span class="toc-text">groff</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#grub"><span class="toc-number">2.33.</span> <span class="toc-text">grub</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#less"><span class="toc-number">2.34.</span> <span class="toc-text">less</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gzip"><span class="toc-number">2.35.</span> <span class="toc-text">gzip</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#iproute"><span class="toc-number">2.36.</span> <span class="toc-text">iproute</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#kbd"><span class="toc-number">2.37.</span> <span class="toc-text">kbd</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#libpipeline"><span class="toc-number">2.38.</span> <span class="toc-text">libpipeline</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#make"><span class="toc-number">2.39.</span> <span class="toc-text">make</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#man-db"><span class="toc-number">2.40.</span> <span class="toc-text">man-db</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#patch"><span class="toc-number">2.41.</span> <span class="toc-text">patch</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#tar"><span class="toc-number">2.42.</span> <span class="toc-text">tar</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#vim"><span class="toc-number">2.43.</span> <span class="toc-text">vim</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#procps"><span class="toc-number">2.44.</span> <span class="toc-text">procps</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#utils-linux"><span class="toc-number">2.45.</span> <span class="toc-text">utils-linux</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#e2fsprogs"><span class="toc-number">2.46.</span> <span class="toc-text">e2fsprogs</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sysklogd"><span class="toc-number">2.47.</span> <span class="toc-text">sysklogd</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sysvinit"><span class="toc-number">2.48.</span> <span class="toc-text">sysvinit</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#eudev"><span class="toc-number">2.49.</span> <span class="toc-text">eudev</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#再次剥离-可选"><span class="toc-number">2.50.</span> <span class="toc-text">再次剥离(可选)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#清理"><span class="toc-number">2.51.</span> <span class="toc-text">清理</span></a></li></ol></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png)"><div id="post-info"><div id="post-title"><div class="posttitle">LFS系统构建03-安装基础系统软件</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-06-04<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2019-06-08</time><span class="post-meta__separator mobile_hidden">|</span><span class="mobile_hidden"><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/LFS/">LFS</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/LFS/LFS%E7%B3%BB%E7%BB%9F%E6%9E%84%E5%BB%BA/">LFS系统构建</a></span><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon" aria-hidden="true"></i><span>字数总计: </span><span class="word-count">5.5k</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon" aria-hidden="true"></i><span>阅读时长: 33 分钟</span><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true">       </i><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h3 id="lfs系统构建03-安装基础系统软件"><a class="header-anchor" href="#lfs系统构建03-安装基础系统软件">¶</a>LFS系统构建03-安装基础系统软件</h3>
<h4 id="准备虚拟内核文件系统"><a class="header-anchor" href="#准备虚拟内核文件系统">¶</a>准备虚拟内核文件系统</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mkdir -pv $LFS/&#123;dev,proc,sys,run&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash">创建初始化设备节点</span></span><br><span class="line">mknod -m 600 $LFS/dev/console c 5 1</span><br><span class="line">mknod -m 666 $LFS/dev/null c 1 3</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">挂载/dev</span></span><br><span class="line">mount -v --bind /dev $LFS/dev</span><br><span class="line"><span class="meta">#</span><span class="bash">挂载虚拟文件系统</span></span><br><span class="line">mount -vt devpts devpts $LFS/dev/pts -o gid=5,mode=620</span><br><span class="line">mount -vt proc proc $LFS/proc</span><br><span class="line">mount -vt sysfs sysfs $LFS/sys</span><br><span class="line">mount -vt tmpfs tmpfs $LFS/run</span><br><span class="line"></span><br><span class="line">if [ -h $LFS/dev/shm ]; then</span><br><span class="line">mkdir -pv $LFS/$(readlink $LFS/dev/shm)</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h4 id="开始进入构建的lfs环境"><a class="header-anchor" href="#开始进入构建的lfs环境">¶</a>开始进入构建的lfs环境</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">chroot "$LFS" /tools/bin/env -i \</span><br><span class="line">HOME=/root</span><br><span class="line">\</span><br><span class="line">TERM="$TERM"</span><br><span class="line">\</span><br><span class="line">PS1='(lfs chroot) \u:\w\$ ' \</span><br><span class="line">PATH=/bin:/usr/bin:/sbin:/usr/sbin:/tools/bin \</span><br><span class="line">/tools/bin/bash --login +h</span><br></pre></td></tr></table></figure>
<h4 id="创建主要目录"><a class="header-anchor" href="#创建主要目录">¶</a>创建主要目录</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mkdir -pv /&#123;bin,boot,etc/&#123;opt,sysconfig&#125;,home,lib/firmware,mnt,opt&#125;</span><br><span class="line">mkdir -pv /&#123;media/&#123;floppy,cdrom&#125;,sbin,srv,var&#125;</span><br><span class="line">install -dv -m 0750 /root</span><br><span class="line">install -dv -m 1777 /tmp /var/tmp</span><br><span class="line">mkdir -pv /usr/&#123;,local/&#125;&#123;bin,include,lib,sbin,src&#125;</span><br><span class="line">mkdir -pv /usr/&#123;,local/&#125;share/&#123;color,dict,doc,info,locale,man&#125;</span><br><span class="line">mkdir -v /usr/&#123;,local/&#125;share/&#123;misc,terminfo,zoneinfo&#125;</span><br><span class="line">mkdir -v /usr/libexec</span><br><span class="line">mkdir -pv /usr/&#123;,local/&#125;share/man/man&#123;1..8&#125;</span><br><span class="line">case $(uname -m) in</span><br><span class="line">x86_64) mkdir -v /lib64 ;;</span><br><span class="line">esac</span><br><span class="line">mkdir -v /var/&#123;log,mail,spool&#125;</span><br><span class="line">ln -sv /run /var/run</span><br><span class="line">ln -sv /run/lock /var/lock</span><br><span class="line">mkdir -pv /var/&#123;opt,cache,lib/&#123;color,misc,locate&#125;,local&#125;</span><br></pre></td></tr></table></figure>
<h4 id="创建重要文件和符号连接"><a class="header-anchor" href="#创建重要文件和符号连接">¶</a>创建重要文件和符号连接</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">ln -sv /tools/bin/&#123;bash,cat,chmod,dd,echo,ln,mkdir,pwd,rm,stty,touch&#125; /bin</span><br><span class="line">ln -sv /tools/bin/&#123;env,install,perl,printf&#125; /usr/bin</span><br><span class="line">ln -sv /tools/lib/libgcc_s.so&#123;,.1&#125; /usr/lib</span><br><span class="line">ln -sv /tools/lib/libstdc++.&#123;a,so&#123;,.6&#125;&#125; /usr/lib</span><br><span class="line">install -vdm755 /usr/lib/pkgconfig</span><br><span class="line">ln -sv bash /bin/sh</span><br><span class="line">ln -sv /proc/self/mounts /etc/mtab</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cat &gt; /etc/passwd &lt;&lt; "EOF"</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">bin:x:1:1:bin:/dev/null:/bin/false</span><br><span class="line">daemon:x:6:6:Daemon User:/dev/null:/bin/false</span><br><span class="line">messagebus:x:18:18:D-Bus Message Daemon User:/var/run/dbus:/bin/false</span><br><span class="line">nobody:x:99:99:Unprivileged User:/dev/null:/bin/false</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cat &gt; /etc/group &lt;&lt; "EOF"</span><br><span class="line">root:x:0:</span><br><span class="line">bin:x:1:daemon</span><br><span class="line">sys:x:2:</span><br><span class="line">kmem:x:3:</span><br><span class="line">tape:x:4:</span><br><span class="line">tty:x:5:</span><br><span class="line">daemon:x:6:</span><br><span class="line">floppy:x:7:</span><br><span class="line">disk:x:8:</span><br><span class="line">lp:x:9:</span><br><span class="line">dialout:x:10:</span><br><span class="line">audio:x:11:</span><br><span class="line">video:x:12:</span><br><span class="line">utmp:x:13:</span><br><span class="line">usb:x:14:</span><br><span class="line">cdrom:x:15:</span><br><span class="line">adm:x:16:</span><br><span class="line">messagebus:x:18:</span><br><span class="line">input:x:24:</span><br><span class="line">mail:x:34:</span><br><span class="line">kvm:x:61:</span><br><span class="line">wheel:x:97:</span><br><span class="line">nogroup:x:99:</span><br><span class="line">users:x:999:</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">exec /tools/bin/bash --login +h</span><br><span class="line"></span><br><span class="line">touch /var/log/&#123;btmp,lastlog,faillog,wtmp&#125;</span><br><span class="line">chgrp -v utmp /var/log/lastlog</span><br><span class="line">chmod -v 664 /var/log/lastlog</span><br><span class="line">chmod -v 600 /var/log/btmp</span><br></pre></td></tr></table></figure>
<h4 id="linux-api-头文件"><a class="header-anchor" href="#linux-api-头文件">¶</a>linux api 头文件</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources/</span><br><span class="line">tar xvf linux-4.20.12.tar.xz</span><br><span class="line">cd linux-4.20.12</span><br><span class="line">make mrproper</span><br><span class="line"></span><br><span class="line">make INSTALL_HDR_PATH=dest headers_install</span><br><span class="line">find dest/include \( -name .install -o -name ..install.cmd \) -delete</span><br><span class="line">cp -rv dest/include/* /usr/include</span><br></pre></td></tr></table></figure>
<h4 id="man-pages"><a class="header-anchor" href="#man-pages">¶</a>man-pages</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar xvf man-pages-4.16.tar.xz</span><br><span class="line">cd man-pages-4.16</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="glibc"><a class="header-anchor" href="#glibc">¶</a>glibc</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources/</span><br><span class="line">cd glibc-2.29</span><br><span class="line">patch -Np1 -i ../glibc-2.29-fhs-1.patch</span><br><span class="line">ln -sfv /tools/lib/gcc /usr/lib</span><br><span class="line"></span><br><span class="line">case $(uname -m) in</span><br><span class="line">i?86)</span><br><span class="line">GCC_INCDIR=/usr/lib/gcc/$(uname -m)-pc-linux-gnu/8.2.0/include</span><br><span class="line">ln -sfv ld-linux.so.2 /lib/ld-lsb.so.3</span><br><span class="line">;;</span><br><span class="line">x86_64) GCC_INCDIR=/usr/lib/gcc/x86_64-pc-linux-gnu/8.2.0/include</span><br><span class="line">ln -sfv ../lib/ld-linux-x86-64.so.2 /lib64</span><br><span class="line">ln -sfv ../lib/ld-linux-x86-64.so.2 /lib64/ld-lsb-x86-64.so.3</span><br><span class="line">;;</span><br><span class="line">esac</span><br><span class="line"></span><br><span class="line">rm -f /usr/include/limits.h</span><br><span class="line">mkdir -v build</span><br><span class="line">cd build</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="gawk"><a class="header-anchor" href="#gawk">¶</a>gawk</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">tar xvf gawk-4.2.1.tar.xz</span><br><span class="line">cd gawk-4.2.1</span><br><span class="line">sed -i 's/extras//' Makefile.in</span><br><span class="line">unset GCC_INCDIR</span><br><span class="line"></span><br><span class="line">case $(uname -m) in</span><br><span class="line">i?86)</span><br><span class="line">ln -sfnv $PWD/elf/ld-linux.so.2</span><br><span class="line">/lib ;;</span><br><span class="line">x86_64) ln -sfnv $PWD/elf/ld-linux-x86-64.so.2 /lib ;;</span><br><span class="line">esac</span><br><span class="line"></span><br><span class="line">touch /etc/ld.so.conf</span><br><span class="line">sed '/test-installation/s@$(PERL)@echo not running@' -i ../Makefile</span><br><span class="line"></span><br><span class="line">cp -v ../nscd/nscd.conf /etc/nscd.conf</span><br><span class="line">mkdir -pv /var/cache/nscd</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">配置语言环境</span></span><br><span class="line">mkdir -pv /usr/lib/locale</span><br><span class="line">localedef -i POSIX -f UTF-8 C.UTF-8 2&gt; /dev/null || true</span><br><span class="line">localedef -i en_US -f ISO-8859-1 en_US</span><br><span class="line">localedef -i en_US -f UTF-8 en_US.UTF-8</span><br><span class="line">localedef -i zh_CN -f GB18030 zh_CN.GB18030</span><br><span class="line">localedef -i zh_CN -f UTF-8 zh_CN.UTF-8</span><br><span class="line">make localedata/install-locales</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">增加 nsswitch.conf</span></span><br><span class="line">cat &gt; /etc/nsswitch.conf &lt;&lt; "EOF"</span><br><span class="line"><span class="meta">#</span><span class="bash"> Begin /etc/nsswitch.conf</span></span><br><span class="line">passwd: files</span><br><span class="line">group: files</span><br><span class="line">shadow: files</span><br><span class="line">hosts: files dns</span><br><span class="line">networks: files</span><br><span class="line">protocols: files</span><br><span class="line">services: files</span><br><span class="line">ethers: files</span><br><span class="line">rpc: files</span><br><span class="line"><span class="meta">#</span><span class="bash"> End /etc/nsswitch.conf</span></span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">增加时区数据</span></span><br><span class="line">tar -zxvf ../../tzdata2018i.tar.gz</span><br><span class="line">ZONEINFO=/usr/share/zoneinfo</span><br><span class="line">mkdir -pv $ZONEINFO/&#123;posix,right&#125;</span><br><span class="line"></span><br><span class="line">for tz in etcetera southamerica northamerica europe africa antarctica asia australasia backward pacificnew systemv; do zic -L /dev/null -d $ZONEINFO $&#123;tz&#125; ; zic -L /dev/null -d $ZONEINFO/posix $&#123;tz&#125; ; zic -L leapseconds -d $ZONEINFO/right $&#123;tz&#125; ; done</span><br><span class="line">cp -v zone.tab zone1970.tab iso3166.tab $ZONEINFO</span><br><span class="line">zic -d $ZONEINFO -p Asia/ShangHai</span><br><span class="line"><span class="meta">#</span><span class="bash">用命令更改时区</span></span><br><span class="line">tzselect</span><br><span class="line">cp -v /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br><span class="line">unset ZONEINFO</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">配置动态加载</span></span><br><span class="line"></span><br><span class="line">cat &gt; /etc/ld.so.conf &lt;&lt; "EOF"</span><br><span class="line"><span class="meta">#</span><span class="bash"> Begin /etc/ld.so.conf</span></span><br><span class="line">/usr/local/lib</span><br><span class="line">/opt/lib</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">cat &gt;&gt; /etc/ld.so.conf &lt;&lt; "EOF"</span><br><span class="line"><span class="meta">#</span><span class="bash"> Add an include directory</span></span><br><span class="line">include /etc/ld.so.conf.d/*.conf</span><br><span class="line">EOF</span><br><span class="line">mkdir -pv /etc/ld.so.conf.d</span><br></pre></td></tr></table></figure>
<h4 id="适应工具链"><a class="header-anchor" href="#适应工具链">¶</a>适应工具链</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">mv -v /tools/bin/&#123;ld,ld-old&#125;</span><br><span class="line">renamed '/tools/bin/ld' -&gt; '/tools/bin/ld-old'</span><br><span class="line"></span><br><span class="line">mv -v /tools/$(uname -m)-pc-linux-gnu/bin/&#123;ld,ld-old&#125;</span><br><span class="line">renamed '/tools/x86_64-pc-linux-gnu/bin/ld' -&gt; '/tools/x86_64-pc-linux-gnu/bin/ld-old'</span><br><span class="line"></span><br><span class="line">mv -v /tools/bin/&#123;ld-new,ld&#125;</span><br><span class="line">renamed '/tools/bin/ld-new' -&gt; '/tools/bin/ld'</span><br><span class="line"></span><br><span class="line">ln -sv /tools/bin/ld /tools/$(uname -m)-pc-linux-gnu/bin/ld</span><br><span class="line">'/tools/x86_64-pc-linux-gnu/bin/ld' -&gt; '/tools/bin/ld'</span><br><span class="line"></span><br><span class="line">gcc -dumpspecs | sed -e 's@/tools@@g' -e '/\*startfile_prefix_spec:/&#123;n;s@.*@/usr/lib/ @&#125;' -e '/\*cpp:/&#123;n;s@$@ -isystem /usr/include@&#125;' &gt; `dirname $(gcc --print-libgcc-file-name)`/specs</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">测试工具链</span></span><br><span class="line">echo 'int main()&#123;&#125;' &gt; dummy.c</span><br><span class="line">cc dummy.c -v -Wl,--verbose &amp;&gt; dummy.log</span><br><span class="line">readelf -l a.out | grep ': /lib'</span><br><span class="line"><span class="meta">#</span><span class="bash">测试成功</span></span><br><span class="line">[Requesting program interpreter: /lib64/ld-linux-x86-64.so.2]</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">确保我们设置用正确的开启文件</span></span><br><span class="line">grep -o '/usr/lib.*/crt[1in].*succeeded' dummy.log</span><br><span class="line"><span class="meta">#</span><span class="bash">出现以下三行表示测试成功</span></span><br><span class="line">/usr/lib/../lib/crt1.o succeeded</span><br><span class="line">/usr/lib/../lib/crti.o succeeded</span><br><span class="line">/usr/lib/../lib/crtn.o succeeded</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">验证编译搜索的头文件是否正确</span></span><br><span class="line">grep -B1 '^ /usr/include' dummy.log</span><br><span class="line"><span class="meta">#</span><span class="bash">测试成功</span></span><br><span class="line"><span class="meta">#</span><span class="bash">include &lt;...&gt; search starts here:</span></span><br><span class="line"> /usr/include</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">验证库的搜索路径</span></span><br><span class="line"> grep 'SEARCH.*/usr/lib' dummy.log |sed 's|; |\n|g'</span><br><span class="line"> SEARCH_DIR("=/tools/x86_64-pc-linux-gnu/lib64")</span><br><span class="line">SEARCH_DIR("/usr/lib")</span><br><span class="line">SEARCH_DIR("/lib")</span><br><span class="line">SEARCH_DIR("=/tools/x86_64-pc-linux-gnu/lib");</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">确保我们用的是正确的libc</span></span><br><span class="line">grep "/lib.*/libc.so.6 " dummy.log</span><br><span class="line">attempt to open /lib/libc.so.6 succeeded</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">确保gcc用的是正确的动态链接库</span></span><br><span class="line">grep found dummy.log</span><br><span class="line">found ld-linux-x86-64.so.2 at /lib/ld-linux-x86-64.so.2</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">测试成功后删除</span></span><br><span class="line">rm -v dummy.c a.out dummy.log</span><br></pre></td></tr></table></figure>
<h4 id="zlib"><a class="header-anchor" href="#zlib">¶</a>zlib</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tar xvf zlib-1.2.11.tar.xz</span><br><span class="line">cd zlib-1.2.11</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line">mv -v /usr/lib/libz.so.* /lib</span><br><span class="line">ln -sfv ../../lib/$(readlink /usr/lib/libz.so) /usr/lib/libz.so</span><br></pre></td></tr></table></figure>
<h4 id="file"><a class="header-anchor" href="#file">¶</a>file</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf file-5.36.tar.gz</span><br><span class="line">cd file-5.36</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="readline"><a class="header-anchor" href="#readline">¶</a>readline</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf readline-8.0.tar.gz</span><br><span class="line">cd readline-8.0</span><br><span class="line"></span><br><span class="line">sed -i '/MV.*old/d' Makefile.in</span><br><span class="line">sed -i '/&#123;OLDSUFF&#125;/c:' support/shlib-install</span><br><span class="line"></span><br><span class="line">./configure --prefix=/usr --disable-static --docdir=/usr/share/doc/readline-8.0</span><br><span class="line">make SHLIB_LIBS="-L/tools/lib -lncursesw"</span><br><span class="line">make SHLIB_LIBS="-L/tools/lib -lncursesw" install</span><br><span class="line"></span><br><span class="line">mv -v /usr/lib/lib&#123;readline,history&#125;.so.* /lib</span><br><span class="line">chmod -v u+w /lib/lib&#123;readline,history&#125;.so.*</span><br><span class="line">ln -sfv ../../lib/$(readlink /usr/lib/libreadline.so) /usr/lib/libreadline.so</span><br><span class="line">ln -sfv ../../lib/$(readlink /usr/lib/libhistory.so ) /usr/lib/libhistory.so</span><br><span class="line">install -v -m644 doc/*.&#123;ps,pdf,html,dvi&#125; /usr/share/doc/readline-8.0</span><br></pre></td></tr></table></figure>
<h4 id="m4"><a class="header-anchor" href="#m4">¶</a>m4</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf m4-1.4.18.tar.xz</span><br><span class="line">cd m4-1.4.18</span><br><span class="line"></span><br><span class="line">sed -i 's/IO_ftrylockfile/IO_EOF_SEEN/' lib/*.c</span><br><span class="line">echo "#define _IO_IN_BACKUP 0x100" &gt;&gt; lib/stdio-impl.h</span><br><span class="line"></span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="bc"><a class="header-anchor" href="#bc">¶</a>bc</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf bc-1.07.1.tar.gz </span><br><span class="line">cd bc-1.07.1</span><br><span class="line"></span><br><span class="line">cat &gt; bc/fix-libmath_h &lt;&lt; "EOF"</span><br><span class="line"><span class="meta">#</span><span class="bash">! /bin/bash</span></span><br><span class="line">sed -e '1</span><br><span class="line">s/^/&#123;"/' \</span><br><span class="line">-e</span><br><span class="line">'s/$/",/' \</span><br><span class="line">-e '2,$ s/^/"/' \</span><br><span class="line">-e</span><br><span class="line">'$ d'</span><br><span class="line">\</span><br><span class="line">-i libmath.h</span><br><span class="line">sed -e '$ s/$/0&#125;/' \</span><br><span class="line">-i libmath.h</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">ln -sv /tools/lib/libncursesw.so.6 /usr/lib/libncursesw.so.6</span><br><span class="line">ln -sfv libncursesw.so.6 /usr/lib/libncurses.so</span><br><span class="line">sed -i -e '/flex/s/as_fn_error/: ;; # &amp;/' configure</span><br><span class="line"></span><br><span class="line">./configure --prefix=/usr --with-readline --mandir=/usr/share/man --infodir=/usr/share/info</span><br><span class="line">make</span><br><span class="line"><span class="meta">#</span><span class="bash">如果出现makeinfo: <span class="built_in">command</span> not found</span></span><br><span class="line">提前编译安装texinfo,使其提供makeinfo就能解决</span><br><span class="line"></span><br><span class="line">echo "quit" | ./bc/bc -l Test/checklib.b</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="texinfo"><a class="header-anchor" href="#texinfo">¶</a>texinfo</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sed -i '5481,5485 s/(&#123;/(\\&#123;/' tp/Texinfo/Parser.pm</span><br><span class="line">./configure --prefix=/usr --disable-static</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make TEXMF=/usr/share/texmf install-tex</span><br></pre></td></tr></table></figure>
<h4 id="binutils"><a class="header-anchor" href="#binutils">¶</a>binutils</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tar xvf binutils-2.32.tar.xz </span><br><span class="line">cd binutils-2.32</span><br><span class="line">expect -c "spawn ls"</span><br><span class="line">mkdir -v build</span><br><span class="line">cd build/</span><br><span class="line"></span><br><span class="line">../configure --prefix=/usr --enable-gold --enable-ld=default --enable-plugins --enable-shared --disable-werror --enable-64-bit-bfd --with-system-zlib</span><br><span class="line">make tooldir=/usr</span><br><span class="line">make -k check</span><br><span class="line">make tooldir=/usr install</span><br></pre></td></tr></table></figure>
<h4 id="gmp"><a class="header-anchor" href="#gmp">¶</a>gmp</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf gmp-6.1.2.tar.xz</span><br><span class="line">cd gmp-6.1.2</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">如果你是32位的机子，但是运行64位的cpu,就需要使用这句</span></span><br><span class="line">ABI=32 ./configure ...</span><br><span class="line"></span><br><span class="line">cp -v configfsf.guess config.guess</span><br><span class="line">cp -v configfsf.sub　config.sub</span><br><span class="line">./configure --prefix=/usr --enable-cxx --disable-static --docdir=/usr/share/doc/gmp-6.1.2</span><br><span class="line">make</span><br><span class="line">make html</span><br><span class="line">make check 2&gt;&amp;1 | tee gmp-check-log</span><br><span class="line">awk '/# PASS:/&#123;total+=$3&#125; ; END&#123;print total&#125;' gmp-check-log</span><br><span class="line">make install</span><br><span class="line">make install-html</span><br></pre></td></tr></table></figure>
<h4 id="mpfr"><a class="header-anchor" href="#mpfr">¶</a>mpfr</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf mpfr-4.0.2.tar.xz </span><br><span class="line">./configure --prefix=/usr --disable-static --enable-thread-safe --docdir=/usr/share/doc/mpfr-4.0.2</span><br><span class="line">make</span><br><span class="line">make html</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">make install-html</span><br></pre></td></tr></table></figure>
<h4 id="mpc"><a class="header-anchor" href="#mpc">¶</a>mpc</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf mpc-1.1.0.tar.gz</span><br><span class="line">cd mpc-1.1.0</span><br><span class="line">./configure --prefix=/usr --disable-static --docdir=/usr/share/doc/mpc-1.1.0</span><br><span class="line">make</span><br><span class="line">make html</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">make install-html</span><br></pre></td></tr></table></figure>
<h4 id="shadow"><a class="header-anchor" href="#shadow">¶</a>shadow</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf shadow-4.6.tar.xz</span><br><span class="line">cd shadow-4.6</span><br><span class="line">sed -i 's/groups$(EXEEXT) //' src/Makefile.in</span><br><span class="line">find man -name Makefile.in -exec sed -i 's/groups\.1 / /' &#123;&#125; \;</span><br><span class="line">find man -name Makefile.in -exec sed -i 's/getspnam\.3 / /' &#123;&#125; \;</span><br><span class="line">find man -name Makefile.in -exec sed -i 's/passwd\.5 / /' &#123;&#125; \;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">用更安全的sha-512来加密</span></span><br><span class="line">sed -i -e 's@#ENCRYPT_METHOD DES@ENCRYPT_METHOD SHA512@' \</span><br><span class="line">-e 's@/var/spool/mail@/var/mail@' etc/login.defs</span><br><span class="line">sed -i 's/1000/999/' etc/useradd</span><br><span class="line"><span class="meta">#</span><span class="bash">加上Cracklib支持</span></span><br><span class="line">sed -i 's@DICTPATH.*@DICTPATH\t/lib/cracklib/pw_dict@' etc/login.defs</span><br><span class="line">./configure --sysconfdir=/etc --with-group-name-max-length=32</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">mv -v /usr/bin/passwd /bin</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">配置shadow</span></span><br><span class="line">pwconv #将密码shadow</span><br><span class="line">grpconv #将组密码shadow</span><br><span class="line"></span><br><span class="line">passwd root</span><br></pre></td></tr></table></figure>
<h4 id="gcc-第三次安装"><a class="header-anchor" href="#gcc-第三次安装">¶</a>gcc(第三次安装)</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf gcc-8.2.0.tar.xz</span><br><span class="line">cd gcc-8.2.0</span><br><span class="line"></span><br><span class="line">case $(uname -m) in</span><br><span class="line">x86_64)</span><br><span class="line">sed -e '/m64=/s/lib64/lib/' \</span><br><span class="line">-i.orig gcc/config/i386/t-linux64</span><br><span class="line">;;</span><br><span class="line">esac</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">移除之前安装的gcc</span></span><br><span class="line">rm -f /usr/lib/gcc</span><br><span class="line">mkdir -v build</span><br><span class="line">cd build/</span><br><span class="line"></span><br><span class="line">../configure --prefix=/usr --enable-languages=c,c++ --disable-multilib --disable-bootstrap --disable-libmpx --with-system-zlib</span><br><span class="line">make</span><br><span class="line">ulimit -s 32768</span><br><span class="line">rm ../gcc/testsuite/g++.dg/pr83239.C</span><br><span class="line">chown -Rv nobody .</span><br><span class="line">su nobody -s /bin/bash -c "PATH=$PATH make -k check"</span><br><span class="line">../contrib/test_summary</span><br><span class="line">make install</span><br><span class="line">ln -sv ../usr/bin/cpp /lib</span><br><span class="line">ln -sv gcc /usr/bin/cc</span><br><span class="line"></span><br><span class="line">install -v -dm755 /usr/lib/bfd-plugins</span><br><span class="line">ln -sfv ../../libexec/gcc/$(gcc -dumpmachine)/8.2.0/liblto_plugin.so /usr/lib/bfd-plugins/</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">测试gcc</span></span><br><span class="line">echo 'int main()&#123;&#125;' &gt; dummy.c</span><br><span class="line">cc dummy.c -v -Wl,--verbose &amp;&gt; dummy.log</span><br><span class="line">readelf -l a.out | grep ': /lib'</span><br><span class="line"><span class="meta">#</span><span class="bash">测试结果 ok</span></span><br><span class="line">[Requesting program interpreter: /lib64/ld-linux-x86-64.so.2]</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">确保开启文件正确 ok</span></span><br><span class="line">grep -o '/usr/lib.*/crt[1in].*succeeded' dummy.log</span><br><span class="line">/usr/lib/gcc/x86_64-pc-linux-gnu/8.2.0/../../../../lib/crt1.o succeeded</span><br><span class="line">/usr/lib/gcc/x86_64-pc-linux-gnu/8.2.0/../../../../lib/crti.o succeeded</span><br><span class="line">/usr/lib/gcc/x86_64-pc-linux-gnu/8.2.0/../../../../lib/crtn.o succeeded</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">验证编译时搜索的头文件 ok</span></span><br><span class="line">grep -B4 '^ /usr/include' dummy.log</span><br><span class="line"><span class="meta">#</span><span class="bash">include &lt;...&gt; search starts here:</span></span><br><span class="line"> /usr/lib/gcc/x86_64-pc-linux-gnu/8.2.0/include</span><br><span class="line"> /usr/local/include</span><br><span class="line"> /usr/lib/gcc/x86_64-pc-linux-gnu/8.2.0/include-fixed</span><br><span class="line"> /usr/include</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">验证新链接器的搜索路径 ok</span></span><br><span class="line">grep 'SEARCH.*/usr/lib'dummy.log |sed 's|; |\n|g'</span><br><span class="line">SEARCH_DIR("/usr/x86_64-pc-linux-gnu/lib64")</span><br><span class="line">SEARCH_DIR("/usr/local/lib64")</span><br><span class="line">SEARCH_DIR("/lib64")</span><br><span class="line">SEARCH_DIR("/usr/lib64")</span><br><span class="line">SEARCH_DIR("/usr/x86_64-pc-linux-gnu/lib")</span><br><span class="line">SEARCH_DIR("/usr/local/lib")</span><br><span class="line">SEARCH_DIR("/lib")</span><br><span class="line">SEARCH_DIR("/usr/lib");</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">确保用的是正确的libc ok</span></span><br><span class="line">grep "/lib.*/libc.so.6 " dummy.log</span><br><span class="line">attempt to open /lib/libc.so.6 succeeded</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">确保用的是正确的动态链接库</span></span><br><span class="line">grep found dummy.log</span><br><span class="line">found ld-linux-x86-64.so.2 at /lib/ld-linux-x86-64.so.2</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">删除测试文件</span></span><br><span class="line">rm -v dummy.c a.out dummy.log</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mkdir -pv /usr/share/gdb/auto-load/usr/lib</span><br><span class="line">mv -v /usr/lib/*gdb.py /usr/share/gdb/auto-load/usr/lib</span><br></pre></td></tr></table></figure>
<h4 id="bzip"><a class="header-anchor" href="#bzip">¶</a>bzip</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf bzip2-1.0.6.tar.gz</span><br><span class="line">cd bzip2-1.0.6</span><br><span class="line">patch -Np1 -i ../bzip2-1.0.6-install_docs-1.patch</span><br><span class="line">sed -i 's@\(ln -s -f \)$(PREFIX)/bin/@\1@' Makefile</span><br><span class="line">sed -i "s@(PREFIX)/man@(PREFIX)/share/man@g" Makefile</span><br><span class="line">make -f Makefile-libbz2_so</span><br><span class="line">make clean</span><br><span class="line">make</span><br><span class="line">make PREFIX=/usr install</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cp -v bzip2-shared /bin/bzip2</span><br><span class="line">cp -av libbz2.so* /lib</span><br><span class="line">ln -sv ../../lib/libbz2.so.1.0 /usr/lib/libbz2.so</span><br><span class="line">rm -v /usr/bin/&#123;bunzip2,bzcat,bzip2&#125;</span><br><span class="line">ln -sv bzip2 /bin/bunzip2</span><br><span class="line">ln -sv bzip2 /bin/bzcat</span><br></pre></td></tr></table></figure>
<h4 id="pkg-config"><a class="header-anchor" href="#pkg-config">¶</a>pkg-config</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf pkg-config-0.29.2.tar.gz </span><br><span class="line">cd pkg-config-0.29.2</span><br><span class="line">./configure --prefix=/usr --with-internal-glib --disable-host-tool --docdir=/usr/share/doc/pkg-config-0.29.2</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="ncurses"><a class="header-anchor" href="#ncurses">¶</a>ncurses</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf ncurses-6.1.tar.gz</span><br><span class="line">cd ncurses-6.1</span><br><span class="line">sed -i '/LIBTOOL_INSTALL/d' c++/Makefile.in</span><br><span class="line"></span><br><span class="line">./configure --prefix=/usr --mandir=/usr/share/man --with-shared --without-debug --without-normal --enable-pc-files --enable-widec</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">mv -v /usr/lib/libncursesw.so.6* /lib</span><br><span class="line">ln -sfv ../../lib/$(readlink /usr/lib/libncursesw.so) /usr/lib/libncursesw.so</span><br><span class="line"></span><br><span class="line">for lib in ncurses form panel menu ; do rm -vf /usr/lib/lib$&#123;lib&#125;.so; echo "INPUT(-l$&#123;lib&#125;w)" &gt; /usr/lib/lib$&#123;lib&#125;.so; ln -sfv $&#123;lib&#125;w.pc /usr/lib/pkgconfig/$&#123;lib&#125;.pc; done</span><br><span class="line"></span><br><span class="line">rm -vf /usr/lib/libcursesw.so</span><br><span class="line">echo "INPUT(-lncursesw)" &gt; /usr/lib/libcursesw.so</span><br><span class="line">ln -sfv libncurses.so /usr/lib/libcurses.so</span><br><span class="line"></span><br><span class="line">mkdir -v /usr/share/doc/ncurses-6.1</span><br><span class="line">cp -v -R doc/* /usr/share/doc/ncurses-6.1</span><br></pre></td></tr></table></figure>
<h4 id="attr"><a class="header-anchor" href="#attr">¶</a>attr</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf attr-2.4.48.tar.gz </span><br><span class="line">cd attr-2.4.48</span><br><span class="line">./configure --prefix=/usr --bindir=/bin --disable-static --sysconfdir=/etc --docdir=/usr/share/doc/attr-2.4.48</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">mv -v /usr/lib/libattr.so.* /lib</span><br><span class="line">ln -sfv ../../lib/$(readlink /usr/lib/libattr.so) /usr/lib/libattr.so</span><br></pre></td></tr></table></figure>
<h4 id="acl"><a class="header-anchor" href="#acl">¶</a>acl</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf acl-2.2.53.tar.gz</span><br><span class="line">cd acl-2.2.53</span><br><span class="line">./configure --prefix=/usr --bindir=/bin --disable-static --libexecdir=/usr/lib --docdir=/usr/share/doc/acl-2.2.53</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">mv -v /usr/lib/libacl.so.* /lib</span><br><span class="line">ln -sfv ../../lib/$(readlink /usr/lib/libacl.so) /usr/lib/libacl.so</span><br></pre></td></tr></table></figure>
<h3 id="libcap"><a class="header-anchor" href="#libcap">¶</a>libcap</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf libcap-2.26.tar.xz</span><br><span class="line">cd libcap-2.26</span><br><span class="line">sed -i '/install.*STALIBNAME/d' libcap/Makefile</span><br><span class="line">make</span><br><span class="line">make RAISE_SETFCAP=no lib=lib prefix=/usr install</span><br><span class="line">chmod -v 755 /usr/lib/libcap.so.2.26</span><br><span class="line"></span><br><span class="line">mv -v /usr/lib/libcap.so.* /lib</span><br><span class="line">ln -sfv ../../lib/$(readlink /usr/lib/libcap.so) /usr/lib/libcap.so</span><br></pre></td></tr></table></figure>
<h4 id="sed"><a class="header-anchor" href="#sed">¶</a>sed</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf sed-4.7.tar.xz</span><br><span class="line">cd sed-4.7</span><br><span class="line">sed -i 's/usr/tools/' build-aux/help2man</span><br><span class="line">sed -i 's/testsuite.panic-tests.sh//' Makefile.in</span><br><span class="line"></span><br><span class="line">./configure --prefix=/usr --bindir=/bin</span><br><span class="line">make</span><br><span class="line">make html</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line">install -d -m755 /usr/share/doc/sed-4.7</span><br><span class="line">install -m644 doc/sed.html /usr/share/doc/sed-4.7</span><br></pre></td></tr></table></figure>
<h4 id="psmisc"><a class="header-anchor" href="#psmisc">¶</a>psmisc</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf psmisc-23.2.tar.xz</span><br><span class="line">cd psmisc-23.2</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">mv -v /usr/bin/fuser /bin</span><br><span class="line">mv -v /usr/bin/killall /bin</span><br></pre></td></tr></table></figure>
<h4 id="lana-etc"><a class="header-anchor" href="#lana-etc">¶</a>lana-etc</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -jxvf iana-etc-2.30.tar.bz2</span><br><span class="line">cd iana-etc-2.30</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="bison"><a class="header-anchor" href="#bison">¶</a>bison</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf bison-3.3.2.tar.xz</span><br><span class="line">cd bison-3.3.2</span><br><span class="line">./configure --prefix=/usr --docdir=/usr/share/doc/bison-3.3.2</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="flex"><a class="header-anchor" href="#flex">¶</a>flex</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf flex-2.6.4.tar.gz</span><br><span class="line">cd flex-2.6.4</span><br><span class="line">sed -i "/math.h/a #include &lt;malloc.h&gt;" src/flexdef.h</span><br><span class="line">HELP2MAN=/tools/bin/true ./configure --prefix=/usr --docdir=/usr/share/doc/flex-2.6.4</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">ln -sv flex /usr/bin/lex</span><br></pre></td></tr></table></figure>
<h4 id="grep"><a class="header-anchor" href="#grep">¶</a>grep</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf grep-3.3.tar.xz</span><br><span class="line">cd grep-3.3</span><br><span class="line">./configure --prefix=/usr --bindir=/bin</span><br><span class="line">make</span><br><span class="line">make -k check</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="bash"><a class="header-anchor" href="#bash">¶</a>bash</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf bash-5.0.tar.gz</span><br><span class="line">cd bash-5.0</span><br><span class="line">./configure --prefix=/usr --docdir=/usr/share/doc/bash-5.0 --without-bash-malloc --with-installed-readline</span><br><span class="line">make</span><br><span class="line">chown -Rv nobody .</span><br><span class="line">su nobody -s /bin/bash -c "PATH=$PATH HOME=/home make tests"</span><br><span class="line">make install</span><br><span class="line">mv -vf /usr/bin/bash /bin</span><br><span class="line">exec /bin/bash --login +h</span><br></pre></td></tr></table></figure>
<h4 id="libtool"><a class="header-anchor" href="#libtool">¶</a>libtool</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf libtool-2.4.6.tar.xz</span><br><span class="line">cd libtool-2.4.6</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="gdbm"><a class="header-anchor" href="#gdbm">¶</a>gdbm</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf gdbm-1.18.1.tar.gz</span><br><span class="line">cd gdbm-1.18.1</span><br><span class="line">./configure --prefix=/usr --disable-static --enable-libgdbm-compat</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="gperf"><a class="header-anchor" href="#gperf">¶</a>gperf</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf gperf-3.1.tar.gz</span><br><span class="line">cd gperf-3.1</span><br><span class="line">./configure --prefix=/usr --docdir=/usr/share/doc/gperf-3.1</span><br><span class="line">make</span><br><span class="line">make -j1 check</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="expat"><a class="header-anchor" href="#expat">¶</a>expat</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -jxvf expat-2.2.6.tar.bz2</span><br><span class="line">cd expat-2.2.6</span><br><span class="line">sed -i 's|usr/bin/env |bin/|' run.sh.in</span><br><span class="line">./configure --prefix=/usr --disable-static --docdir=/usr/share/doc/expat-2.2.6</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">install -v -m644 doc/*.&#123;html,png,css&#125; /usr/share/doc/expat-2.2.6</span><br></pre></td></tr></table></figure>
<h4 id="inetutils"><a class="header-anchor" href="#inetutils">¶</a>inetutils</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf inetutils-1.9.4.tar.xz</span><br><span class="line">cd inetutils-1.9.4</span><br><span class="line">./configure --prefix=/usr --localstatedir=/var --disable-logger --disable-whois --disable-rcp --disable-rexec --disable-rlogin --disable-rsh --disable-servers</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line">mv -v /usr/bin/&#123;hostname,ping,ping6,traceroute&#125; /bin</span><br><span class="line">mv -v /usr/bin/ifconfig /sbin</span><br></pre></td></tr></table></figure>
<h4 id="perl"><a class="header-anchor" href="#perl">¶</a>perl</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf perl-5.28.1.tar.xz</span><br><span class="line">cd perl-5.28.1</span><br><span class="line">echo "127.0.0.1 localhost $(hostname)" &gt; /etc/hosts</span><br><span class="line">export BUILD_ZLIB=False</span><br><span class="line">export BUILD_BZIP2=0</span><br><span class="line"></span><br><span class="line">sh Configure -des -Dprefix=/usr -Dvendorprefix=/usr -Dman1dir=/usr/share/man/man1 -Dman3dir=/usr/share/man/man3 -Dpager="/usr/bin/less -isR" -Duseshrplib -Dusethreads</span><br><span class="line">make</span><br><span class="line">make -k check</span><br><span class="line">make install</span><br><span class="line">unset BUILD_ZLIB BUILD_BZIP2</span><br></pre></td></tr></table></figure>
<h4 id="xml-parser"><a class="header-anchor" href="#xml-parser">¶</a>XML-Parser</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf XML-Parser-2.44.tar.gz</span><br><span class="line">cd XML-Parser-2.44</span><br><span class="line">perl Makefile.PL</span><br><span class="line">make</span><br><span class="line">make test</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="intltool"><a class="header-anchor" href="#intltool">¶</a>intltool</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf intltool-0.51.0.tar.gz </span><br><span class="line">cd intltool-0.51.0</span><br><span class="line">sed -i 's:\\\$&#123;:\\\$\\&#123;:' intltool-update.in</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">install -v -Dm644 doc/I18N-HOWTO /usr/share/doc/intltool-0.51.0/I18N-HOWTO</span><br></pre></td></tr></table></figure>
<h4 id="autoconf"><a class="header-anchor" href="#autoconf">¶</a>autoconf</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf autoconf-2.69.tar.xz</span><br><span class="line">cd autoconf-2.69</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="automake"><a class="header-anchor" href="#automake">¶</a>automake</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf automake-1.16.1.tar.xz </span><br><span class="line">cd automake-1.16.1</span><br><span class="line">./configure --prefix=/usr --docdir=/usr/share/doc/automake-1.16.1</span><br><span class="line">make</span><br><span class="line">make -j4 check</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="xz"><a class="header-anchor" href="#xz">¶</a>xz</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf xz-5.2.4.tar.xz</span><br><span class="line">cd xz-5.2.4</span><br><span class="line">./configure --prefix=/usr --disable-static --docdir=/usr/share/doc/xz-5.2.4</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">mv -v /usr/bin/&#123;lzma,unlzma,lzcat,xz,unxz,xzcat&#125; /bin</span><br><span class="line">mv -v /usr/lib/liblzma.so.* /lib</span><br><span class="line">ln -svf ../../lib/$(readlink /usr/lib/liblzma.so) /usr/lib/liblzma.so</span><br></pre></td></tr></table></figure>
<h4 id="kmod"><a class="header-anchor" href="#kmod">¶</a>kmod</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf kmod-26.tar.xz </span><br><span class="line">cd kmod-26</span><br><span class="line">./configure --prefix=/usr --bindir=/bin --sysconfdir=/etc --with-rootlibdir=/lib --with-xz --with-zlib</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line">for target in depmod insmod lsmod modinfo modprobe rmmod; do</span><br><span class="line">ln -sfv ../bin/kmod /sbin/$target</span><br><span class="line">done</span><br><span class="line">ln -sfv kmod /bin/lsmod</span><br></pre></td></tr></table></figure>
<h4 id="gettext"><a class="header-anchor" href="#gettext">¶</a>gettext</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf gettext-0.19.8.1.tar.xz</span><br><span class="line">cd gettext-0.19.8.1</span><br><span class="line">sed -i '/^TESTS =/d' gettext-runtime/tests/Makefile.in &amp;&amp; sed -i 's/test-lock..EXEEXT.//' gettext-tools/gnulib-tests/Makefile.in</span><br><span class="line">sed -e '/AppData/&#123;N;N;p;s/\.appdata\./.metainfo./&#125;' -i gettext-tools/its/appdata.loc</span><br><span class="line">./configure --prefix=/usr --disable-static --docdir=/usr/share/doc/gettext-0.19.8.1</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">chmod -v 0755 /usr/lib/preloadable_libintl.so</span><br></pre></td></tr></table></figure>
<h4 id="elfutils"><a class="header-anchor" href="#elfutils">¶</a>elfutils</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -jxvf elfutils-0.176.tar.bz2</span><br><span class="line">cd elfutils-0.176</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make -C libelf install</span><br><span class="line">install -vm644 config/libelf.pc /usr/lib/pkgconfig</span><br></pre></td></tr></table></figure>
<h4 id="libffi"><a class="header-anchor" href="#libffi">¶</a>libffi</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf libffi-3.2.1.tar.gz</span><br><span class="line">cd libffi-3.2.1</span><br><span class="line">sed -e '/^includesdir/ s/$(libdir).*$/$(includedir)/' -i include/Makefile.in</span><br><span class="line">sed -e '/^includedir/ s/=.*$/=@includedir@/' -e 's/^Cflags: -I$&#123;includedir&#125;/Cflags:/' -i libffi.pc.in</span><br><span class="line"></span><br><span class="line">./configure --prefix=/usr --disable-static --with-gcc-arch=native</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="openssl"><a class="header-anchor" href="#openssl">¶</a>openssl</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf openssl-1.1.1a.tar.gz</span><br><span class="line">cd openssl-1.1.1a</span><br><span class="line">./config --prefix=/usr --openssldir=/etc/ssl --libdir=lib shared zlib-dynamic</span><br><span class="line">make</span><br><span class="line">make test</span><br><span class="line">sed -i '/INSTALL_LIBS/s/libcrypto.a libssl.a//' Makefile</span><br><span class="line">make MANSUFFIX=ssl install</span><br><span class="line">mv -v /usr/share/doc/openssl /usr/share/doc/openssl-1.1.1a</span><br><span class="line">cp -vfr doc/* /usr/share/doc/openssl-1.1.1a</span><br></pre></td></tr></table></figure>
<h4 id="python"><a class="header-anchor" href="#python">¶</a>Python</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf Python-3.7.2.tar.xz</span><br><span class="line">cd Python-3.7.2</span><br><span class="line">./configure --prefix=/usr --enable-shared --with-system-expat --with-system-ffi --with-ensurepip=yes</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">chmod -v 755 /usr/lib/libpython3.7m.so</span><br><span class="line">chmod -v 755 /usr/lib/libpython3.so</span><br><span class="line">install -v -dm755 /usr/share/doc/python-3.7.2/html</span><br><span class="line">tar --strip-components=1 --no-same-owner --no-same-permissions -C /usr/share/doc/python-3.7.2/html -jxvf ../python-3.7.2-docs-html.tar.bz2</span><br></pre></td></tr></table></figure>
<h4 id="ninja"><a class="header-anchor" href="#ninja">¶</a>ninja</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf ninja-1.9.0.tar.gz</span><br><span class="line">cd ninja-1.9.0</span><br><span class="line">export NINJAJOBS=4</span><br><span class="line"></span><br><span class="line">sed -i '/int Guess/a \</span><br><span class="line">int    j = 0;\</span><br><span class="line">char* jobs = getenv( "NINJAJOBS" );\</span><br><span class="line">if ( jobs != NULL ) j = atoi( jobs );\</span><br><span class="line">if ( j &gt; 0 ) return j;\</span><br><span class="line">' src/ninja.cc</span><br><span class="line"></span><br><span class="line">python3 configure.py --bootstrap</span><br><span class="line">python3 configure.py</span><br><span class="line">./ninja ninja_test</span><br><span class="line">./ninja_test --gtest_filter=-SubprocessTest.SetWithLots</span><br><span class="line"></span><br><span class="line">install -vm755 ninja /usr/bin/</span><br><span class="line">install -vDm644 misc/bash-completion /usr/share/bash-completion/completions/ninja</span><br><span class="line">install -vDm644 misc/zsh-completion /usr/share/zsh/site-functions/_ninja</span><br></pre></td></tr></table></figure>
<h4 id="meson"><a class="header-anchor" href="#meson">¶</a>meson</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf meson-0.49.2.tar.gz </span><br><span class="line">cd meson-0.49.2</span><br><span class="line">python3 setup.py build</span><br><span class="line">python3 setup.py install --root=dest</span><br><span class="line">cp -rv dest/* /</span><br></pre></td></tr></table></figure>
<h4 id="coreutils"><a class="header-anchor" href="#coreutils">¶</a>coreutils</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf coreutils-8.30.tar.xz </span><br><span class="line">cd coreutils-8.30</span><br><span class="line">patch -Np1 -i ../coreutils-8.30-i18n-1.patch</span><br><span class="line">sed -i '/test.lock/s/^/#/' gnulib-tests/gnulib.mk</span><br><span class="line">autoreconf -fiv </span><br><span class="line">FORCE_UNSAFE_CONFIGURE=1 ./configure --prefix=/usr --enable-no-install-program=kill,uptime</span><br><span class="line">FORCE_UNSAFE_CONFIGURE=1 make</span><br><span class="line">make NON_ROOT_USERNAME=nobody check-root</span><br><span class="line">echo "dummy:x:1000:nobody" &gt;&gt; /etc/group</span><br><span class="line">chown -Rv nobody .</span><br><span class="line">su nobody -s /bin/bash -c "PATH=$PATH make RUN_EXPENSIVE_TESTS=yes check"</span><br><span class="line">sed -i '/dummy/d' /etc/group</span><br><span class="line">make install</span><br><span class="line">mv -v /usr/bin/&#123;cat,chgrp,chmod,chown,cp,date,dd,df,echo&#125; /bin</span><br><span class="line">mv -v /usr/bin/&#123;false,ln,ls,mkdir,mknod,mv,pwd,rm&#125; /bin</span><br><span class="line">mv -v /usr/bin/&#123;rmdir,stty,sync,true,uname&#125; /bin</span><br><span class="line">mv -v /usr/bin/chroot /usr/sbin</span><br><span class="line">mv -v /usr/share/man/man1/chroot.1 /usr/share/man/man8/chroot.8</span><br><span class="line">sed -i s/\"1\"/\"8\"/1 /usr/share/man/man8/chroot.8</span><br><span class="line">mv -v /usr/bin/&#123;head,nice,sleep,touch&#125; /bin</span><br></pre></td></tr></table></figure>
<h4 id="check"><a class="header-anchor" href="#check">¶</a>check</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf check-0.12.0.tar.gz</span><br><span class="line">cd check-0.12.0</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">sed -i '1 s/tools/usr/' /usr/bin/checkmk</span><br></pre></td></tr></table></figure>
<h4 id="diffutils"><a class="header-anchor" href="#diffutils">¶</a>diffutils</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf diffutils-3.7.tar.xz </span><br><span class="line">cd diffutils-3.7</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="gawk-v2"><a class="header-anchor" href="#gawk-v2">¶</a>gawk</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -xvf gawk-4.2.1.tar.xz</span><br><span class="line">cd gawk-4.2.1</span><br><span class="line">sed -i 's/extras//' Makefile.in</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">mkdir -v /usr/share/doc/gawk-4.2.1</span><br><span class="line">cp -v doc/&#123;awkforai.txt,*.&#123;eps,pdf,jpg&#125;&#125; /usr/share/doc/gawk-4.2.1</span><br></pre></td></tr></table></figure>
<h4 id="findutils"><a class="header-anchor" href="#findutils">¶</a>findutils</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf findutils-4.6.0.tar.gz </span><br><span class="line">cd findutils-4.6.0</span><br><span class="line">sed -i 's/test-lock..EXEEXT.//' tests/Makefile.in</span><br><span class="line">sed -i 's/IO_ftrylockfile/IO_EOF_SEEN/' gl/lib/*.c</span><br><span class="line">sed -i '/unistd/a #include &lt;sys/sysmacros.h&gt;' gl/lib/mountlist.c</span><br><span class="line">echo "#define _IO_IN_BACKUP 0x100" &gt;&gt; gl/lib/stdio-impl.h</span><br><span class="line">./configure --prefix=/usr --localstatedir=/var/lib/locate</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">mv -v /usr/bin/find /bin</span><br><span class="line">sed -i 's|find:=$&#123;BINDIR&#125;|find:=/bin|' /usr/bin/updatedb</span><br></pre></td></tr></table></figure>
<h4 id="groff"><a class="header-anchor" href="#groff">¶</a>groff</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf groff-1.22.4.tar.gz</span><br><span class="line">cd groff-1.22.4</span><br><span class="line">PAGE=A4 ./configure --prefix=/usr</span><br><span class="line">make -j1</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="grub"><a class="header-anchor" href="#grub">¶</a>grub</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf grub-2.02.tar.xz</span><br><span class="line">cd grub-2.02</span><br><span class="line">./configure --prefix=/usr --sbindir=/sbin --sysconfdir=/etc --disable-efiemu --disable-werror</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">mv -v /etc/bash_completion.d/grub /usr/share/bash-completion/completions</span><br></pre></td></tr></table></figure>
<h4 id="less"><a class="header-anchor" href="#less">¶</a>less</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf less-530.tar.gz</span><br><span class="line">cd less-530</span><br><span class="line">./configure --prefix=/usr --sysconfdir=/etc</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="gzip"><a class="header-anchor" href="#gzip">¶</a>gzip</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf gzip-1.10.tar.xz</span><br><span class="line">cd gzip-1.10</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">mv -v /usr/bin/gzip /bin</span><br></pre></td></tr></table></figure>
<h4 id="iproute"><a class="header-anchor" href="#iproute">¶</a>iproute</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf iproute2-4.20.0.tar.xz </span><br><span class="line">cd iproute2-4.20.0</span><br><span class="line">sed -i /ARPD/d Makefile</span><br><span class="line">rm -fv man/man8/arpd.8</span><br><span class="line">sed -i 's/.m_ipt.o//' tc/Makefile</span><br><span class="line">make</span><br><span class="line">make DOCDIR=/usr/share/doc/iproute2-4.20.0 install</span><br></pre></td></tr></table></figure>
<h4 id="kbd"><a class="header-anchor" href="#kbd">¶</a>kbd</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf kbd-2.0.4.tar.xz </span><br><span class="line">cd kbd-2.0.4</span><br><span class="line">patch -Np1 -i ../kbd-2.0.4-backspace-1.patch</span><br><span class="line">sed -i 's/\(RESIZECONS_PROGS=\)yes/\1no/g' configure</span><br><span class="line">sed -i 's/resizecons.8 //' docs/man/man8/Makefile.in</span><br><span class="line">PKG_CONFIG_PATH=/tools/lib/pkgconfig ./configure --prefix=/usr --disable-vlock</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">mkdir -v /usr/share/doc/kbd-2.0.4</span><br><span class="line">cp -R -v docs/doc/* /usr/share/doc/kbd-2.0.4</span><br></pre></td></tr></table></figure>
<h4 id="libpipeline"><a class="header-anchor" href="#libpipeline">¶</a>libpipeline</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf libpipeline-1.5.1.tar.gz</span><br><span class="line">cd libpipeline-1.5.1</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="make"><a class="header-anchor" href="#make">¶</a>make</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf make-4.2.1.tar.gz </span><br><span class="line">cd make-4.2.1</span><br><span class="line">sed -i '211,217 d; 219,229 d; 232 d' glob/glob.c</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make PERL5LIB=$PWD/tests/ check</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="man-db"><a class="header-anchor" href="#man-db">¶</a>man-db</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf man-db-2.8.5.tar.xz</span><br><span class="line">cd man-db-2.8.5</span><br><span class="line">./configure --prefix=/usr --docdir=/usr/share/doc/man-db-2.8.5 --sysconfdir=/etc --disable-setuid --enable-cache-owner=bin --with-browser=/usr/bin/lynx --with-vgrind=/usr/bin/vgrind --with-grap=/usr/bin/grap --with-systemdtmpfilesdir= --with-systemdsystemunitdir=</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="patch"><a class="header-anchor" href="#patch">¶</a>patch</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf patch-2.7.6.tar.xz</span><br><span class="line">cd patch-2.7.6</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="tar"><a class="header-anchor" href="#tar">¶</a>tar</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf tar-1.31.tar.xz</span><br><span class="line">cd tar-1.31</span><br><span class="line">sed -i 's/abort.*/FALLTHROUGH;/' src/extract.c</span><br><span class="line">FORCE_UNSAFE_CONFIGURE=1 ./configure --prefix=/usr --bindir=/bin</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">make -C doc install-html docdir=/usr/share/doc/tar-1.31</span><br></pre></td></tr></table></figure>
<h4 id="vim"><a class="header-anchor" href="#vim">¶</a>vim</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -jxvf vim-8.1.tar.bz2</span><br><span class="line">cd vim81/</span><br><span class="line">echo '#define SYS_VIMRC_FILE "/etc/vimrc"' &gt;&gt; src/feature.h</span><br><span class="line">./configure --prefix=/usr</span><br><span class="line">make</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 测试结果</span></span><br><span class="line">LANG=en_US.UTF-8 make -j1 test &amp;&gt; vim-test.log</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line">ln -sv vim /usr/bin/vi</span><br><span class="line"></span><br><span class="line">for L in /usr/share/man/&#123;,*/&#125;man1/vim.1; do</span><br><span class="line">ln -sv vim.1 $(dirname $L)/vi.1</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">ln -sv ../vim/vim81/doc /usr/share/doc/vim-8.1</span><br><span class="line"></span><br><span class="line">cat &gt; /etc/vimrc &lt;&lt; "EOF"</span><br><span class="line">" Begin /etc/vimrc</span><br><span class="line">" Ensure defaults are set before customizing settings, not after</span><br><span class="line">source $VIMRUNTIME/defaults.vim</span><br><span class="line">let skip_defaults_vim=1</span><br><span class="line">set nocompatible</span><br><span class="line">set backspace=2</span><br><span class="line">set mouse=</span><br><span class="line">syntax on</span><br><span class="line">if (&amp;term == "xterm") || (&amp;term == "putty")</span><br><span class="line">set background=dark</span><br><span class="line">endif</span><br><span class="line">" End /etc/vimrc</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">vim -c ':options'</span><br></pre></td></tr></table></figure>
<h4 id="procps"><a class="header-anchor" href="#procps">¶</a>procps</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf procps-ng-3.3.15.tar.xz</span><br><span class="line">cd procps-ng-3.3.15</span><br><span class="line">./configure --prefix=/usr --exec-prefix= --libdir=/usr/lib --docdir=/usr/share/doc/procps-ng-3.3.15 --disable-static --disable-kill</span><br><span class="line">make</span><br><span class="line">sed -i -r 's|(pmap_initname)\\\$|\1|' testsuite/pmap.test/pmap.exp</span><br><span class="line">sed -i '/set tty/d' testsuite/pkill.test/pkill.exp</span><br><span class="line">rm testsuite/pgrep.test/pgrep.exp</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line">mv -v /usr/lib/libprocps.so.* /lib</span><br><span class="line">ln -sfv ../../lib/$(readlink /usr/lib/libprocps.so) /usr/lib/libprocps.so</span><br></pre></td></tr></table></figure>
<h4 id="utils-linux"><a class="header-anchor" href="#utils-linux">¶</a>utils-linux</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf util-linux-2.33.1.tar.xz</span><br><span class="line">cd util-linux-2.33.1</span><br><span class="line">mkdir -pv /var/lib/hwclock</span><br><span class="line">rm -vf /usr/include/&#123;blkid,libmount,uuid&#125;</span><br><span class="line">./configure ADJTIME_PATH=/var/lib/hwclock/adjtime --docdir=/usr/share/doc/util-linux-2.33.1 --disable-chfn-chsh --disable-login --disable-nologin --disable-su --disable-setpriv --disable-runuser --disable-pylibmount --disable-static --without-python --without-systemd --without-systemdsystemunitdir</span><br><span class="line">make</span><br><span class="line">chown -Rv nobody .</span><br><span class="line">su nobody -s /bin/bash -c "PATH=$PATH make -k check"</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="e2fsprogs"><a class="header-anchor" href="#e2fsprogs">¶</a>e2fsprogs</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf e2fsprogs-1.44.5.tar.gz </span><br><span class="line">cd e2fsprogs-1.44.5</span><br><span class="line">mkdir -v build</span><br><span class="line">cd build</span><br><span class="line"></span><br><span class="line">../configure --prefix=/usr --bindir=/bin --with-root-prefix="" --enable-elf-shlibs --disable-libblkid --disable-libuuid --disable-uuidd --disable-fsck</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line">make install-libs</span><br><span class="line"></span><br><span class="line">chmod -v u+w /usr/lib/&#123;libcom_err,libe2p,libext2fs,libss&#125;.a</span><br><span class="line">gunzip -v /usr/share/info/libext2fs.info.gz</span><br><span class="line"></span><br><span class="line">install-info --dir-file=/usr/share/info/dir /usr/share/info/libext2fs.info</span><br><span class="line"></span><br><span class="line">makeinfo -o doc/com_err.info ../lib/et/com_err.texinfo</span><br><span class="line">install -v -m644 doc/com_err.info /usr/share/info</span><br><span class="line"></span><br><span class="line">install-info --dir-file=/usr/share/info/dir /usr/share/info/com_err.info</span><br></pre></td></tr></table></figure>
<h4 id="sysklogd"><a class="header-anchor" href="#sysklogd">¶</a>sysklogd</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf sysklogd-1.5.1.tar.gz</span><br><span class="line">cd sysklogd-1.5.1</span><br><span class="line">sed -i '/Error loading kernel symbols/&#123;n;n;d&#125;' ksym_mod.c</span><br><span class="line">sed -i 's/union wait/int/' syslogd.c</span><br><span class="line">make</span><br><span class="line">make BINDIR=/sbin install</span><br><span class="line"></span><br><span class="line">cat &gt; /etc/syslog.conf &lt;&lt; "EOF"</span><br><span class="line"><span class="meta">#</span><span class="bash"> Begin /etc/syslog.conf</span></span><br><span class="line">auth,authpriv.* -/var/log/auth.log</span><br><span class="line">*.*;auth,authpriv.none -/var/log/sys.log</span><br><span class="line">daemon.* -/var/log/daemon.log</span><br><span class="line">kern.* -/var/log/kern.log</span><br><span class="line">mail.* -/var/log/mail.log</span><br><span class="line">user.* -/var/log/user.log</span><br><span class="line">*.emerg *</span><br><span class="line"><span class="meta">#</span><span class="bash"> End /etc/syslog.conf</span></span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
<h4 id="sysvinit"><a class="header-anchor" href="#sysvinit">¶</a>sysvinit</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar xvf sysvinit-2.93.tar.xz</span><br><span class="line">cd sysvinit-2.93</span><br><span class="line">patch -Np1 -i ../sysvinit-2.93-consolidated-1.patch</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="eudev"><a class="header-anchor" href="#eudev">¶</a>eudev</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">cd $LFS/sources</span><br><span class="line">tar -zxvf eudev-3.2.7.tar.gz</span><br><span class="line">cd eudev-3.2.7</span><br><span class="line"></span><br><span class="line">cat &gt; config.cache &lt;&lt; "EOF"</span><br><span class="line">HAVE_BLKID=1</span><br><span class="line">BLKID_LIBS="-lblkid"</span><br><span class="line">BLKID_CFLAGS="-I/tools/include"</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">./configure --prefix=/usr --bindir=/sbin --sbindir=/sbin --libdir=/usr/lib --sysconfdir=/etc --libexecdir=/lib --with-rootprefix= --with-rootlibdir=/lib --enable-manpages --disable-static --config-cache</span><br><span class="line"></span><br><span class="line">LIBRARY_PATH=/tools/lib make</span><br><span class="line"></span><br><span class="line">mkdir -pv /lib/udev/rules.d</span><br><span class="line">mkdir -pv /etc/udev/rules.d</span><br><span class="line"></span><br><span class="line">make LD_LIBRARY_PATH=/tools/lib check</span><br><span class="line">make LD_LIBRARY_PATH=/tools/lib install</span><br><span class="line">tar -jxvf ../udev-lfs-20171102.tar.bz2</span><br><span class="line">make -f udev-lfs-20171102/Makefile.lfs install</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">配置</span></span><br><span class="line">LD_LIBRARY_PATH=/tools/lib udevadm hwdb --update</span><br></pre></td></tr></table></figure>
<h4 id="再次剥离-可选"><a class="header-anchor" href="#再次剥离-可选">¶</a>再次剥离(可选)</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">在blfs中ｕ用valgrind 或 gdb运行测试时需要这些调试信息</span></span><br><span class="line">save_lib="ld-2.29.so libc-2.29.so libpthread-2.29.so libthread_db-1.0.so"</span><br><span class="line">cd /lib</span><br><span class="line">for LIB in $save_lib; do</span><br><span class="line">objcopy --only-keep-debug $LIB $LIB.dbg</span><br><span class="line">strip --strip-unneeded $LIB</span><br><span class="line">objcopy --add-gnu-debuglink=$LIB.dbg $LIB</span><br><span class="line">done</span><br><span class="line">save_usrlib="libquadmath.so.0.0.0 libstdc++.so.6.0.25</span><br><span class="line">libitm.so.1.0.0 libatomic.so.1.2.0"</span><br><span class="line">cd /usr/lib</span><br><span class="line">for LIB in $save_usrlib; do</span><br><span class="line">objcopy --only-keep-debug $LIB $LIB.dbg</span><br><span class="line">strip --strip-unneeded $LIB</span><br><span class="line">objcopy --add-gnu-debuglink=$LIB.dbg $LIB</span><br><span class="line">done</span><br><span class="line">unset LIB save_lib save_usrlib</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">确保二进制能运行</span></span><br><span class="line">exec /tools/bin/bash</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">安全剥离二进制和库</span></span><br><span class="line">/tools/bin/find /usr/lib -type f -name \*.a \</span><br><span class="line">-exec /tools/bin/strip --strip-debug &#123;&#125; ';'</span><br><span class="line">/tools/bin/find /lib /usr/lib -type f \( -name \*.so* -a ! -name \*dbg \) \</span><br><span class="line">-exec /tools/bin/strip --strip-unneeded &#123;&#125; ';'</span><br><span class="line">/tools/bin/find /&#123;bin,sbin&#125; /usr/&#123;bin,sbin,libexec&#125; -type f \</span><br><span class="line">-exec /tools/bin/strip --strip-all &#123;&#125; ';'</span><br></pre></td></tr></table></figure>
<h4 id="清理"><a class="header-anchor" href="#清理">¶</a>清理</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">rm -rf /tmp/*</span><br><span class="line"></span><br><span class="line">exit</span><br><span class="line"></span><br><span class="line">sudo chroot "$LFS" /usr/bin/env -i HOME=/root TERM="$TERM" PS1='(lfs chroot) \u:\w\$ ' PATH=/bin:/usr/bin:/sbin:/usr/sbin /bin/bash --login</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rm -f /usr/lib/lib&#123;bfd,opcodes&#125;.a</span><br><span class="line">rm -f /usr/lib/libbz2.a</span><br><span class="line">rm -f /usr/lib/lib&#123;com_err,e2p,ext2fs,ss&#125;.a</span><br><span class="line">rm -f /usr/lib/libltdl.a</span><br><span class="line">rm -f /usr/lib/libfl.a</span><br><span class="line">rm -f /usr/lib/libz.a</span><br><span class="line">find /usr/lib /usr/libexec -name \*.la -delete</span><br></pre></td></tr></table></figure>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">rack-leen</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2019/06/04/LFS/LFS%E7%B3%BB%E7%BB%9F%E6%9E%84%E5%BB%BA03-%E5%AE%89%E8%A3%85%E5%9F%BA%E7%A1%80%E7%B3%BB%E7%BB%9F%E8%BD%AF%E4%BB%B6/">http://yoursite.com/2019/06/04/LFS/LFS%E7%B3%BB%E7%BB%9F%E6%9E%84%E5%BB%BA03-%E5%AE%89%E8%A3%85%E5%9F%BA%E7%A1%80%E7%B3%BB%E7%BB%9F%E8%BD%AF%E4%BB%B6/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com">rack-leen's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/LFS/">LFS    </a><a class="post-meta__tags" href="/tags/LFS%E7%B3%BB%E7%BB%9F%E6%9E%84%E5%BB%BA/">LFS系统构建    </a></div><div class="post_share"><div class="addthis_inline_share_toolbox"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=null" async></script></div></div><div class="post-reward"><a class="reward-button"><i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.png"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.png"><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2019/06/07/LFS/LFS%E7%B3%BB%E7%BB%9F%E6%9E%84%E5%BB%BA04-%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>LFS系统构建04-系统配置</span></div></a></div><div class="next-post pull_right"><a href="/2019/06/03/LFS/LFS%E7%B3%BB%E7%BB%9F%E6%9E%84%E5%BB%BA02-%E7%BC%96%E8%AF%91%E5%9F%BA%E6%9C%AC%E5%B7%A5%E5%85%B7/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>LFS系统构建02-编译基本工具</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2019/06/07/LFS/LFS系统构建06-定制LFS镜像/" title="LFS系统构建06-定制LFS镜像"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><div class="relatedPosts_title">LFS系统构建06-定制LFS镜像</div></a></div><div class="relatedPosts_item"><a href="/2019/06/07/LFS/LFS系统构建05-制作LFS系统引导/" title="LFS系统构建05-制作LFS系统引导"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><div class="relatedPosts_title">LFS系统构建05-制作LFS系统引导</div></a></div><div class="relatedPosts_item"><a href="/2019/06/07/LFS/LFS系统构建04-系统配置/" title="LFS系统构建04-系统配置"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><div class="relatedPosts_title">LFS系统构建04-系统配置</div></a></div><div class="relatedPosts_item"><a href="/2019/06/03/LFS/LFS系统构建02-编译基本工具/" title="LFS系统构建02-编译基本工具"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><div class="relatedPosts_title">LFS系统构建02-编译基本工具</div></a></div><div class="relatedPosts_item"><a href="/2019/06/03/LFS/LFS系统构建01-宿主机环境搭建/" title="LFS系统构建01-宿主机环境搭建"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><div class="relatedPosts_title">LFS系统构建01-宿主机环境搭建</div></a></div><div class="relatedPosts_item"><a href="/2019/06/03/LFS/LFS资料收集/" title="LFS资料收集"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><div class="relatedPosts_title">LFS资料收集</div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = false == true ? true : false;
var verify = false == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'MfUQEbakEraMCGDu6l1C7pHQ-gzGzoHsz',
  appKey:'pGQbdqjwcLQijkbDoU09liQ9',
  placeholder:'Please leave your footprints',
  avatar:'monsterid',
  guest_info:guest_info,
  pageSize:'10',
  lang:'en',
  recordIP: true
});</script></div></div></div><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png)"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By rack-leen</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">简</a><i class="darkmode fa fa-sun-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script async src="/js/search/algolia.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>$(function () {
  $('span.katex-display').wrap('<div class="katex-wrap"></div>')
})</script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.15/dist/snackbar.min.js"></script><script id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script id="ribbon_piao" mobile="true" src="/js/third-party/piao.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="/js/third-party/canvas-nest.js"></script><script src="/js/baidupush.js"> </script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true; // make power mode colorful
POWERMODE.shake = true; // turn off shake
document.body.addEventListener('input', POWERMODE);
</script><script src="/js/tw_cn.js"></script><script>translateInitilization()
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="/js/third-party/click_heart.js"></script><script src="/js/third-party/ClickShowText.js"></script><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":140,"height":260},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>